A Systematic Characterization of IM Threats Using Honeypots
Spiros Antonatos,Iasonas Polakis,ThanasisPetsas and EvangelosP. Markatos
InstituteofComputerScience,
FoundationforResearch andTechnologyHellas
{antonat,polakis,petsas,markatos}@ics.forth.gr
Abstract timeformofcommunication,incontrasttootherforms
suchase-mail,makeIMnetworksanattractiveplatform
Thepopularityofinstantmessaging(IM)serviceshas forattackerstolaunchtheircampaigns.Attackerseither
recentlyattractedtheinterestofattackersthattrytosend exploitvulnerabilitiesoftheIMclientsoftware,orsteal
malicious URLs or files to the contact lists of compro- accountinformationthroughphishingschemes. Oncea
misedinstantmessagingaccountsorclients. Thiswork user account has been compromised, the attack propa-
focuses on a systematic characterization of IM threats gatesbytargetingthevictim’scontacts. Theattackvec-
based on the information collected by HoneyBuddy, a torsareeitherfiletransfersorinstantmessagesthatcon-
honeypot-likeinfrastructurefordetectingmaliciousac- tain URLs of websites controlled by the attacker. As
tivities in IM networks. HoneyBuddy finds and adds users tend to trust content sent from their contacts, the
contacts to its honeypot messengers by querying pop- probabilityofusersacceptingthetransferorclickingthe
ular search engines for IM contacts or by advertising URL is higher than in the case of traditional phishing
its accounts on contact finder sites. Our deployment campaignsormaliciouswebsites.
hasshownthatwith oversix thousandcontactswe can
Thisworkfocusesonthecharacterizationanddetec-
gatherbetween50and110maliciousURLsperdayas
tion of attacks against IM users. Our proposed archi-
wellasexecutables. Ourexperimentsshowthat21%of
tecture,calledHoneyBuddy,isbasedontheconceptof
our collected executable samples were notgathered by
honeypots.Honeypotsarecloselymonitoreddecoyma-
other malware collection infrastructures, while 93% of
chinesthatarenotusedbyahumanoperatorbutrather
theidentifiedIMphishingdomainswerenotrecordedby
wait to be attacked [35]. In a similar fashion, we have
popular blacklist mechanisms. Furthermore, our find-
deployedIM honeypots: decoy IM accountswith hun-
ings show that the malicious domains are hosted by
dredsofcontactsontheirfriendlist, thatwaitforcom-
a limited number of hosts that remain practically un-
promisedIMaccountstosendthemmaliciousURLsor
changedthroughouttime.
files. Unlike traditional honeypots which wait for at-
tackers passively, HoneyBuddy follows a more active
approach. By crawling the web or by advertising the
1 Introduction accountson severalsites, we have managedto find ac-
counts of real users and invite them to be our friends.
Ourdecoyaccountshaveoversixthousandusersintheir
InstantmessagingisoneofthemostpopularInternet
contactlistsandreceivebetween50and110unsolicited
activities. Accordingto an oldersurvey[7], morethan
URLsperday.
82 million people in Europe and 69 million people in
NorthAmericauseaninstantmessenger.Amorerecent Inthispaper,ourmaingoalistopresentanin-depth
studybyLeskovecetal. [29]revealsthatthenumberof analysisandcharacterizationofthecollectedURLsand
MSNmessenger(themostpopularIMclient)usershas malware. Our results show that 93% of the phishing
reached240million,with7billionexchangedmessages URLs caught by HoneyBuddy are not present in other
per day. Reports estimate over 400 million registered popular existinging blacklist mechanisms, such as the
Skype users[18], and 2.1 billion instant messages sent Google blacklist. Additionally, as much as 87% of all
perdaybyAIMusers[2]. maliciousURLscollectedbyourinfrastructureisincor-
Thislargeuser-baseandthefactthatIMisanearreal- rectlyflaggedassafebycommercialanti-phishingprod-ucts,suchasNortonSafeWeb. Wealsocross-reference users for signs of contamination. Furthermore, the use
the malware caught by our system with other collec- of pidgin [15] prevents their system from detecting at-
tion infrastructures and find that 21% of our samples tacks that exploit vulnerabilities in dominating instant
are zero-day malware instances. During our analysis messaging software such as the MSN live messenger
of the top-level domains that host malicious URLs we [11].
tracethephishingdomainsbacktoasmallnumberofIP Trivedietal. addresstheproblemofinstantmessag-
addresses,revealingalargenetworkofcollaboratingat- ingspam(spim)andhowtoutilizehoneypotstoextract
tackers. Wealsofoundthat10ofthosedomainsbelong network and content characteristics of spim[37]. They
tofast-fluxnetworks. Ourstudyrevealsthatscamsthat setupanopenSOCKSproxythatonlyallowsoutbound
propagatethroughIM networksare specifically crafted connectionstoIMservers. Theanalysisofthecollected
for this communication channel and are different from data reveals several characteristics of spim campaigns.
thosefoundinemailspam. An interesting result is that advertised URLs lead to a
Weprovideanattackerprofilebasedonourfindings small numberof websites, somethingthat is confirmed
anddescribetwodifferentstrategiesfordeployingspam by our findings. However, there are several major dif-
campaigns. We argue that different technical aspects ferenceswithourwork. Whiletheyfocusonspimcam-
of the IM attacks lead to radically different spamming paigns,ourhoneypotdetectsalltypesofinstantmessag-
strategies. Next,weexaminetheeffectivenessofIMat- ingthreatsmentionedinsection3,andalsohandlesma-
tackcampaignsbasedonthelaunchingofourown(be- licious file transfers. Furthermore, they propose a pas-
nign) attack campaigns. This experiment reveals that sive architecture that waits for spimmers to connect to
12%oftheusersvisitURLssenttothembyourdummy theiropenproxywhileoursystemactivelybroadensits
accounts, and 4% are willing to run an executable of view by connectingwith a diverseand wide-spreadset
unknown origin. Finally, we deploy the prototype im- ofIMusers. Finally,theirapproachwillnotworkwith
plementationofourmyMSNhoneypotservice,anearly encryptedinstantmessagingtraffic,suchasSkypetraf-
detectionservicethatcaninformusersiftheiraccounts fic.
orIMclientshavebeencompromised.
Mannan et al. conduct a survey and provide an
The remainderof the paper is structured as follows.
overviewofthreatsagainstinstantmessagingusersand
In section 2, an overview of related work is presented.
existingsecuritymeasures[33]. Severalscenariosofat-
Section 3 describes the various attacks that target IM
tacks against IM users are presented, as well as the
users. Section 4 provides a detailed description of the
weaknessesofdefaultsecurityandprivacyfeaturespro-
HoneyBuddyarchitecture,whilesections5and6arean
vided by IM client software. They conclude that ex-
analysis of the data collected by our infrastructure. In
isting public and enterprise IM systems fail to provide
section 7 we provide an attacker profile based on our
sufficient security and protect users from existing IM
findings, and in section 8 we describe our own benign
threats. Hindocha[28] providesan overview of several
campaignand present the results. In section 9 we pro-
IM clients and protocols, threats to instant messaging
posedefensesagainstIMattackcampaigns. Finally,we
likewormsandtrojans,andissuesregardingIMblock-
summarizeandconcludeinsection10.
ing.
Liu et al. [31] propose an architecture, for detect-
2 Related Work ingandfilteringspim,thatincorporateswidelydeployed
spam-filteringtechniquesandnewtechniquesspecificto
Xieetal. proposeHoneyIM[39],asystemthatuses spim based on the analysis of spim characteristics. In
decoyaccountsin users’contactlists, to detectcontent follow-uppublications[32,30],theauthorsfocusonin-
sentbyIMmalware.HoneyIMcanbedeployedinaen- stant messaging worms. In [32] worm propagation is
terprisenetworkandalertnetworkadministratorsofma- modeled and traced through multicast event tree trac-
liciouscontent,provideattackinformation,andperform ing,whilein[30]aformalIMwormmodelingbasedon
network-wide blocking. HoneyIM has a limited view branchingprocess is presented. Williamson et al. [38]
of the IM attack landscape due to its passive architec- apply virus throttling as a mitigation measure against
tureandenterprisedeployment. Toovercomethesedis- virusesand wormsthat spread throughinstant messag-
advantages, HoneyBuddy is an active architecture that ing. Theyexplorehowseveralthrottleparametersdelay
constantly adds new “buddies” to its decoy accounts, propagationwithoutinterferingwithnormaltraffic.
transcendingthe narrow confines of an enterprise level Provos et al. [36] follow a different approach than
deployment,andmonitorsavarietyofinstantmessaging oursforlocatingURLsthatdistributemaliciouscontent.TheyactivelyscanalargenumberofURLstolocatema-
licious actions and focus only on drive-by downloads,
while we passively collect URLs from spam messages
in IM traffic. A very interesting fact is that their find-
ingsshowthatthereisadifferencebetweenthedomains
of the frontend servers that contain URLs that exploit
vulnerabilitiesinusers’browsersorplugins,andthedo-
mainsofthebackendserversthatdistributethemalware.
However, our results based on URLs collected by the
HoneyBuddyinfrastructuredonotrevealanysuchfron-
tend servers. All malware samples were downloaded
fromthesamedomainwithoutredirectiontoadifferent
domain.Thishighlightsadifferentapproachtomalware
distribution between drive-by downloads and phishing
campaigns.
Figure 1. Screenshot from an MSN phish
ingsite.
3 Attacks onInstantMessaging networks
ThehighpopulationofIMnetworksmakestheman Lateron,thephishingsiteownerlogsinastheuserand
attractive target for attackers that try to exploit them sendsmessagestothevictim’scontactlist. Ascreenshot
formaliciouspurposes,suchasspreadingmalwareand ofsuchaphishingsiteisdisplayedinFigure1. Astudy
scamming. We identify four different scenarios of at- ofthephishingdomainsispresentedinsection5.
tacksonIMnetworks. Exploiting weak privacy settings. Even in the ab-
Malware infection. Recent malware instances [27] sence of malware infection or stolen credentials, some
can attach to a victim’s instant messaging client and messengersprovidethe optionto allow incoming mes-
startsendingURLsthatpointtomaliciouswebsites, or sagesfrompeoplewhoarenotintheuser’scontactlist.
spreadthemselvesby sendingexecutables. In the most We tested the latest clientversionsof the mostpopular
commoncasethemalwareinstancelogsintotheIMnet- IM services: MSN live messenger(version14.0.8089),
work, randomlyselects users from the victim’scontact Skype(version4.1),Yahoo(version10)andAIM(ver-
list,sendsthemaliciousURLsorfilesandthenimmedi- sion 7.1). MSN live messenger is the only IM client
atelylogsout.Inordertobemoreappealingtopotential we tested that has a privacy setting enabled by default
victims, the URLs point to domains whose name con- thatblocksmessagesfromaccountsnotcontainedinthe
tainstheusernameoftherecipient,forexamplehttp: contact list. Skype, Yahoo and AIM by default allow
//contact_username.party-pics.com. The anyonetosendinstantmessagestoouraccount,butthis
vastmajorityoftheattackcampaignswehavedetected settingcanbeopted-out.Attackersexploitthesesettings
sendmessagesinEnglish. However,webelievethatat- tosendunsolicitedmessagestoIMusers.
tackerswillsoonshifttowardslocalizedmessages,asis Exploiting client software. IM clientsoftware suf-
the case with one localized phishing site that we have fersfromtheproblemofmonocultures.Onceanexploit
detected. isdiscovered,thenautomaticallymillionsofclientscan
Compromised accounts. Attackers can also use beinfectedimmediately[26]. Whileinthecaseofmal-
compromised credentials to log in as several different wareinfectionexploitstakeadvantageoftheIMclientto
users and flood the victims’ contact lists. Many ser- spread,thiscaseinvolvestheattackwheretheIMclient
vices, like MSN, use unified credentialsfor e-mailand isusedtoinfecttherestofthemachine.
instantmessaging,makinglife easierforattackers. At-
tackerscanharvestIM accountsbysetting upphishing
4 Designandimplementation
sitesfortheservice,byplantingkey-loggersorthrough
socialengineering.Arelativelyknownattackcampaign
is that of websites advertisinga service that can reveal HoneyBuddywasdesignedtakingintoconsideration
to users if someone has blocked them. If the user en- thefourattackscenariosdescribedinsection3. Incon-
tersher IM credentialsin the website, she is redirected trast to previous work[39], HoneyBuddy does not use
toapagefromanotherdomainwherenothinghappens. modifiedversionsofopensource alternatives. Itratheruses the latest version of the original clients, the same messenger can only have a limited number of friends
software most users install. The main reason for this in its contact list, it is preferable to run multiple mes-
choice is that direct attacks on IM client software will sengers. Forresourceefficiencyreasons,weusedMSN
be detected. The basic conceptbehindHoneyBuddyis Polygamy [12] in order to run multiple MSN messen-
toaddrandomaccountstoadecoyIMaccountandmon- gersonasingleplatformwithouttheneedofadditional
itor the incoming connections. As HoneyBuddy is in virtualmachines.
factahoneypot,anyincomingcommunicationisbyde- Theinspectionmodulemonitorsthelogsofthemes-
fault suspicious. For our prototypewe chose the MSN sengersfor maliciousURLs. It additionallychecksthe
service due to its popularity. However, the design of defaultdownloadfolderfornewfiletransfers. Aninter-
HoneyBuddyisgenericenoughtoallowthefastimple- estingfindingisthatwereceivedURLsandmalwarein
mentationofotherservicesaswell,likeAIM,Skypeand theHotmailinboxesofouraccounts.Thus,weextended
Yahoo messengers. Furthermore, MSN live messenger theinspectionmoduletoalsofetchandanalyzee-mails,
2009inter-operateswithYahoo,andisplannedtointro- so as to extract URLs and executableattachments. All
duceinteroperabilitywith GoogleTalk, AIM andother maliciousURLsarestoredinadatabaseandarequeried
services, rendering our architecture deployable for all everyonehourtochecktheiruptimestatus.
major instant messaging services1. All deployed mes-
sengersruninafullypatchedWindowsXPSP3system. 4.2 Contactsources
4.1 Architecture We used two major sources for finding and adding
contacts. The first one was queries for contact files
ande-mailaccountsbelongingtothe@hotmail.comand
HoneyBuddyhasthreemaincomponents;aharvest-
@live.com domains. Simple queries like “filetype:ctt
ingmodule,ascript-basedenginethathandlestheMSN
msn”or“inurl:’@hotmail.com”wereabletoprovideus
messengerclientsandtheinspectionmodule.
with thousands of contacts. We also harvested e-mail
The harvesting module is responsible for gathering
accountsfrom other popularsites like buddyfetch.
accountsthatwilllaterbeaddedtothedecoyaccounts.
com[4], from which we extracted 38,000 hotmail ad-
All harvested accountsare inserted in CTT files (MSN
dresses. Overall,wehaveinvited14,912contactstobe-
contact files) that are imported in the messengers and
come friends with our accounts. 3,012 of those (20%)
all accounts listed are automatically invited. Another
acceptedourinvitation.Theexactnumberofinvitations
wayistosearchfore-mailaddressesthatbelongtothe
andacceptancesper decoyaccountisdisplayedin Fig-
@hotmail.com and @live.com domains. Other poten-
ure2.ThefivedecoyaccountsdenotedinFigure2asde-
tial sources are sites where users advertise their MSN
coyaccounts14to18,sentathousandinvitationseach,
account, such as [10]. A more advanced method is to
to addresses extracted from buddyfetch.com. We
harvestaccount names from popularsocial networking
planonaddingtheremainingaccountstooursystemin
sites.
the near future. More advanced methodsof harvesting
Thescript-basedenginestartsthemessengersandin-
[17]canbebasedonpopularsocialnetworkingsiteslike
vites all contactsgatheredfromthe harvestingmodule.
Facebook. By crawlingsuchnetworks, one can collect
BasedontheAutoItsoftware[3],wecanautomatically
IMaccountsfromaccessibleprofilepages.
start the application, import CTT files and invite other
Other potential sources are sites where users adver-
accountstoourfriendlist. TheAutoITsoftwareallows
tise their MSN account, such as messengerfinder
the manipulation of the windows of an application the
[10]. Themessengerfindersitecontainsmorethan
samewayauserwouldmanuallyclick,monitorthesta-
25,000activemessengercontactsthatareadvertisedby
tus of the application and check for new windows (in
theirownersforsocialnetworkingpurposes. Weadver-
order to check for incoming messages). After encoun-
tisedouraccountsonthissiteandinstructedourhoney-
tering an attacker that waited for a reply to his initial
potmessengerstoacceptanyfriendrequest. Sofar,we
message before sending the malicious URL, we modi-
have added3,505contactswhile this numberincreases
fied our system to send a random automated response
daily. Theexactnumberof contactsperdecoyaccount
to each incoming message. When an incoming mes-
isshowninFigure3.
sage comes and includes a request for a file transfer,
the engine automatically accepts the transfer. As each
4.3 Hardeningagainstdirectattacks
1AnexperimentaldeploymentofSkypeandYahoohoneypotscol-
lectedtoofewURLstoextractanyconclusions. HoneyBuddy runs the latest version of the original1 2 3 4 5 6 7 9 10 11 12 13 14 15 16 17 18
decoy accounts
stcatnoC
1100
1000
900
800
700
600
500
400
300
200
100
0
1 2 3 4 5
decoy accounts
invited accepted
Figure 2. Number of friend invitations sent
and number of accepted invitations, per de
coyaccount.
deviecer
snoitativnI
1200
1100
1000
900
800
700
600
500
400
300
200
100
0
added contacts
Figure3.Numberofinvitationsourdecoyac
countsreceivedandacceptedafterbeingad
vertisedonmessengerfinder.com
IMclientsoftwareandis,thus,vulnerabletoinfections. 5 Collecteddata analysis
In order to preventinfectionsthat will render our hon-
eypotuselessandmakeitaplatformforfurtherattacks, In this section we provide an analysis of data col-
the honeypot messengers run inside Argos[34]. Argos lectedbytheHoneyBuddyinfrastructure,fromthe27th
is a containmentenvironmentthat is based on memory ofFebruarytothe16thofSeptember2009. Despitethe
taintingtechniques.Inanutshell,Argosmarksallbytes technical simplicity of our system, we were surprised
comingfromthe networkas dirtyand trackstheir flow bythefactthatpopulardefensemechanismshadnotde-
in the system memory. If a dirty byte is passed to the tectedthemajorityofourcollecteddata.Duringthecol-
processor for execution, then we have an exploitation lectionperiod,theHoneyBuddyinfrastructurecollected
attemptsincehoneypotsneverdownloadsoftwaretoex- 6,966uniqueURLsthatbelongto742uniquetop-level
ecute.Whenanexploitisdetected,theapplicationunder domains.
attackisrestartedandallattackinformationisloggedto Duringthe firstweeksof Honeybuddyoperationwe
an alert file. This way, our system cannot be used as wereabletofetchallURLsthroughthewgettool.How-
an attack platform as it is immune to remote exploits. ever, malicious sites changed their behavior to avoid
Adisadvantageofcontainmentenvironmentsisthatap- these fetches. Their pages now serve an obfuscated
plications run 20 to 40 times slower than in a vanilla pieceof Javascriptcodethatchangesthewindowloca-
system. However, in the case of HoneyBuddy this is tiontoaURLlikehttp://www.malicious.com/
not a problem as messengers are hardly demanding in ?key=<randomkeyhere>. Ifa userhasnotvisited
terms of computing power and memory requirements, the page with the key, then all subsequentrequests are
sincemostofthetimetheyareidleandwaitforincom- ignoredandeventuallyherIPaddressisblockedfor24
ing messages. In our experiments, each MSN client’s hours. This behavioral change has forced us to fetch
memoryfootprintis50-80MBandconsumesnegligible URLsthroughtheCrowbar[6]environmentthatallows
CPUresources. runningjavascriptscrapersagainstaDOMto automate
websitesscraping.
Our first step was to provide a simple classification
We have to note, however, that during our experi-
forthoseURLs. Our fivemajorcategorieswerephish-
ments we have not yet encountered any attempts from
ing,porn,dating,adware2andmalware.Theresultsare
attackerstryingtoexploittheIMclientsoftware. While
summarizedinFigure4. 1,933oftheURLsin142top-
thistypeofattackmaynotbecommonnow,webelieve
level domains were phishing for MSN accounts, 1,240
thatwhenIMattacksbecomemorewidespread,ourim-
plementation will provide useful information for such 2Wecharacterizesitesthatpromotethird-partyaddonsfortheMSN
attacks. messenger(likeextrawinks,emoticonsetc.)asadwaresitesPhishing Porn Dating Adware Malware
Category
secnaraeppA
URLs TLDs
2000
1500
1000
500
200
100
50
20
0 50 100 150 200 250 300 350 400 450 500
Uptime (hours)
Figure4.ClassificationofcollectedURLs
egatnecreP
100
90
80
70
60
50
All URLs
40 Phishing
30 Porn
Adware
20 Unknown
10
0
Figure5.CDFofuptimeofURLspercategory
wereporn,567weredatingservicesand251siteswere 5.1 MSNphishing
adware. While porn,datingandadwarecanbe consid-
eredasharmless,thephishingsitesposeasecuritydan-
Attackers try to gather MSN credentials by tricking
gerforusers. Furthermore,77URLsredirectedtoexe-
theuserintoenteringherMSNe-mailandpasswordin
cutablefilesortopagesthatcontainedadirectlinktoa
abogussite. Thesesitesfalselyadvertiseaservicethat
“.exe”or“.scr”file.WeclassifytheseURLsasmalware.
willrevealtotheuserwhichaccountsfromhercontact
list have blocked her. To validate that these phishing
sites actually steal user credentials, we created several
We also spotted several sites that advertise
MSNaccountsandenteredthemintothephishingsites.
subscription-based services for mobile phones. When
Eachaccounthadoneofourdecoyaccountsasafriend.
theusersentertheirmobilephonenumber,theyreceive
The decoy account received messages from the stolen
a subscription request. Once they subscribe to the
MSN accounts that advertised the phishing site. How-
service, they get charged for receiving SMS messages.
ever,theattackersdidnotchangethepasswordsofany
These sites claim to give away free mobile devices to
of the compromised accounts. After the attackers had
the subscribers of the service or promote quiz games
started using our victim accounts, we submited “friend
that may attract victims, such as love calculators etc.
requests” towards these accounts. We wanted to see
These sites are highly localized. We visited them
whether attackers will interfere with such matters and
fromdifferentgeographiclocationsusingthe Planetlab
automatically accept requests. None of the submitted
infrastructure [16] and got different pages in the lan-
requestswereaccepted.
guage of the origin country. An interesting fact is that
whenthesite cannotfindthegeolocationoftheuser,it Allphishingsiteswevisitedsharedoneofthreedif-
redirectshertoanMSNphishingsite. ferent“looks”. A screenshotofsuch a site is shownin
Figure1. WeanalyzedthesourceHTMLcodeofallthe
three “looks” and there was absolutely zero difference
Oursecondstepwastoanalyzetheuptimeofthecol- among the pages with the same look. This means the
lectedURLs. TheuptimegraphcanbeseeninFigure5. phishing pages with the same look had the exact same
On average, a site is functional approximately for 240 size and contained the same images and forms. This
hours (10 days). We also plotted the uptime graph for indicatesthatthemajorityofthedifferentphishingcam-
each category. We notice that porn and MSN phishing paigns might be deployed by a number of collaborat-
sites present much higher uptime than adware and un- ingattackers. Wealsodetectedalocalizedphishingsite
classified sites. Half of the MSN phishing sites were whichcontainedtranslatedcontent,atechniqueusedin
aliveforupto250hours(tenandahalfdays),whilead- e-mailspamcampaigns[20]. Thenumberofsyntactical
ware presenta shorterlifetimeof upto 80hours(three andgrammaticalerrorsrevealedthatthetexttranslation
andahalfdays). wasdoneautomatically. Forthetimebeing,simplepat-tern matching for specific text segmentsis efficientfor indirectmalwareset. Wepresentthetwocategoriesand
detectingthesesites. Anotherdetectionmechanismisto proceedtofurtheranalyzethecollectedsamples.
querythevariousURLblacklists. The first category contains malware samples col-
WequeriedtheGoogleblacklistthroughtheGoogle lected either through direct file transfers (uncommon
SafeBrowsingAPI[8]tocheckifitincludedthephish- case) or by visiting URLs that were redirected to exe-
ingsiteswediscovered. Fromthe142uniquetop-level cutable files. In the case of the URLs, the e-mail ac-
domains(TLD)thathostedphishingsitesandwerede- countofthevictimwasalwaysappendedasaparameter
tected by HoneyBuddy,only 11 were listed by Google to make it look morerealistic. In some cases attackers
blacklist. Thatmeansthat93%ofthedomainscaptured usedpopularkeywords,likeFacebook.
byHoneyBuddywere notlisted elsewhereontheirday Thesecondcategory,theindirectone,containsmal-
ofdetection,makingHoneyBuddyanattractivesolution ware samples collected in two types of cases. In the
for MSN phishing detection. The average delay from firstcase,usersarepresentedwithawebpagethatalerts
whenoursystemdetectedoneofthe11sitesuntilitwas them that they need to download the latest version of
includedintheGoogleblacklistwasaroundtwoweeks, the “adobe flash plugin” so as to play a certain video
leavinga time windowof 15daysforattackersto trick strip,andarepromptedtodownloadtheinstallerwhich
users. Firefox, one of the most popular browsers uses is, obviously, malware. In the second case, users are
theGoogleSafeBrowsingAPIasananti-phishingmea- redirectedto a page promptingthem to install a screen
sure. We also comparedour findingswith the blacklist saver. This “.scr” file they are prompted to download
maintainedbySURBL[22]andURLblacklist.com[24]. and install is a malicious file that infects the machine
SURBL detected only 1 out of the 142 MSN phishing uponexecution.
domains(0.7%)andnoneoftheadwaredomains.None Due to the small volume of files, we were able to
ofthephishingoradwaresiteswerelistedbyURLblack- manually check these files using the Anubis analysis
list.com. center [1]. All of them were characterized as danger-
Averyinterestingfactwasthatwhenresolved,allthe ous , while some of them were bots that connected to
unique top level domains translated to a much smaller an IRC C&C server. By joining the IRC network, we
numberof uniqueIP addresses. This factconfirmsour downloaded even more malware samples (not listed in
initial theory that all these phishing campaigns lead to thissection).
a limited numberof collaboratingattackers. To further
In order to verify how original our samples are, we
investigatethisbehaviour,weconductedanexperiment
submittedthemtotheVirusTotal[25]service. VirusTo-
foraperiodofalmosttwomonths,presentedinSection
talisalargemalwarecollectioncenterwiththeprimary
6.
goalof providinga free onlinevirusand malwarescan
At the time of writing this paper, our infrastructure
reportforuploadedsamples.Thereasonwechosetouse
collectedtwonewtypesofmaliciousURLsthatdemon-
VirusTotalistwofold. First,VirusTotalreceivesaround
strate an evolution in the behaviour of IM scam cam-
100,000sampleseverydayfromamultitudeofsources
paigns. The first type is a phishing site that instead of
resulting in a large database of malware samples. The
advertising a service for MSN users, has recreated the
secondandmostimportantreasonisthatVirusTotalcol-
exact“look and feel” of the WindowsLive login page.
laborateswith a largenumberofwellknownanti-virus
ThesecondtypeisasitethatoffersaJavaapplettocon- vendors3andusestheiranti-virusenginesand,therefore,
vert hosted images into a slideshow. The Java applet
canprovideuswithanaccuratepictureoftheefficiency
is not signed from a trusted source and requires unre-
ofup-to-date,state-of-the-artdefensesolutionsforhome
stricted access to the victim’s machine. Our disassem-
users.
blyshowedthattheappletdownloadsaPE32executable
Four collected samples had not been seen by Virus-
fromanotherdomainandexecutesit.
Totalbefore,thatis21%ofoursampleswerepreviously
unseen malware instances. Figure 6 shows the relative
5.2 Malwaresampleanalysis
detection delay compared to the date the samples en-
teredtheVirusTotaldatabase. Thebasebarofthestack
In this section we provide an analysis of the mal-
graph(solidwhite) showshowmanysampleswere de-
warecollectedbytheHoneyBuddyinfrastructure,from
tectedwithadelayofoneormoredays,themiddlebar
the 1st to the 31st of March 2009. Our infrastructure
(solid black) displaysthe numberof samples that were
collected 19 unique malware samples. We distinguish
the malware collected by the HoneyBuddy infrastruc- 3Foracompletelistrefertohttp://www.virustotal.com/
ture intotwo categories, the directmalware setand the sobre.html0 1 2 3 4
Week
selpmas
fo
rebmuN
>1 days Same day Not detected by VirusTotal
8
7
6
5
4
3
2
1
0
0 20 40 60 80 100
Percentage of samples
Figure 6. Detection delay of collected sam
ples compared to the VirusTotal database.
21%ofthesampleswerepreviouslyunseen,
while26% were collected the same day they
enteredtheVirusTotaldatabase.
)%(
etar
noitceted
V/A
80
70
60
50
40
30
20
10
0
Figure7.Cumulativedistributionfunctionof
detection rate for collected samples based
on VirusTotal reports. 42% of the samples
were detected by 50% of the anti virus en
gines.
detected the same day as VirusTotal while the top bar longed to phishing domains while 7 downloaded mal-
showsthenumberofsamplesnotincludedintheVirus- waresamples.
Total database. Five samples (26%)were collected the Whilethemajorityoftheattachmentswerepictures,
samedaytheyenteredtheVirusTotaldatabase,whilethe severalwerewindowsmediafilesandofficedocuments.
maximumdetectiondelaywasfivedays. WecheckedtheVirusTotaldatabasefortheMD5hashes
We also checked the VirusTotal analysis reports for of the files but found no matches. This was expected,
thecollectedsamples.42%ofthesamplesweredetected since hotmail scans incoming emails for malware and
byhalfoftheanti-virusengines,whilethemaximumde- blocks executables. The most interesting attachments
tectionratewas77%.However,thedatesoftheanalysis were two “.zip” files. Once extracted, the zip files re-
reports were one month after the collection date as we turneda“.lnk”file. Uponinspection,wefoundthatthe
didnotsubmitthesamplesthedaytheywerecaptured. fileswerecommandlinescriptsthatconnecttoanFTP
The one month delay means higher detection rates for siteanddownloadandexecutemalicioussoftware. For
theanti-virusenginesastheyupdatetheirsignaturefiles amoredetailedanalysisofthefilerefertothisreportby
daily.Eveninthatcase,itcanbeobservedthatthereare F-Secure[9].
samplesthatarerecognizedbyonlyonethirdoftheanti-
virusproducts. Thecumulativedistributionfunctionof 5.4 Comparisontoemailspam
detectionratescanbeseeninFigure7.
An important aspect of IM based attacks that we
5.3 Mailboxanalysis wanted to explore was whether they are scams that
use other commmunication channels as well or if they
In this section we present an analysis of the emails are unique to this attack medium. In particular, we
we foundin the mailboxesof ourdecoyaccounts. Our wanted to explore similarities between the campaigns
analysisfocusesontwoaspectsoftheincomingemails. collected by HoneyBuddy and scams that propagate
First,whetherthebodyoftheemailcontainsanyURLs throughemailsthatarecollectedbyspamtraps. Weob-
and, second, whether the email contains any attach- tained458,615spamemailscollectedbySpamArchive
ments. The decoy accounts received a total of 4,209 [19]fromthe27thofFebruarytothe16thofSeptember
emails, 403 of which contained a total of 1,136 at- 2009. From these emails we extracted 467,211unique
tachments. The emails contained 5,581 URLs which URLsthatbelongedto 52,000uniqueTLDs. We com-
were passed to our classifier. The goal of the classifi- pared them to our 6,966 unique URLs and found only
cation was to only identify phishing URLs and URLs onecommoninstanceofa well-knownbenignwebsite.
thatdownloadedmalware. 26ofthereceivedURLsbe- ThisresultwasexpectedsinceURLsinIMattacksusu-Date
sniamod/sesserdda
PI
fo
#
130
110
90
70
50
30
20
10
21 26 31 05 10 15 20 25 30 04 09
AUG
Date
Domains IP addresses
Figure 8. Number of distinct phishing do
mains and the IP addresses they resolve to
overtime.
sniamod/sesserdda
PI
fo
#
23
22
21
20
19
18
17
16
15
21 26 31 05 10 15 20 25 30 04 09
AUG
Domains IP addresses
Figure 9. Number of distinct malware
distributing domains and the IP addresses
theyresolvetoovertime.
ally containthe target’susername. Next, we compared terthecollectionperiodandnoteachURLindividually
the uniqueTLDs and found21 commondomains, 9 of uponcollection,resultsinapotentiallyhigherdetection
which were popularand benigndomains. From the 12 rate for the Norton Safe Web service. Even so, Nor-
suspiciousdomains,3wereclassifiedasporn,3hosted tonSafeWebflaggedonly13%ofthesubmittedURLs
malware,2werefordating,1wasforadwareand3were as dangerous or suspicious. Specifically, 246 phishing
notassignedtoaknowncategory.Noneofthecommon and10malware-distributingURLswerereportedasma-
TLDshostedmsnphishingscams,theprevalentthreatof liciouswhileallotherpageswerecharacterizedassafe.
IMnetworks. Therefore,wecanconcludethatattackers That means that over 87% of the malicious URLs col-
have crafted scams specific to this new attack medium lected by HoneyBuddy had not been properly catego-
thatare fundamentallydifferentto existing emailspam rized as dangerous by one of the largest security ven-
campaigns. dors.
Theresultsofthiscomparisonareastrongindication
thatscamsthatpropagatethroughIMnetworksarenew 6 Hostinganalysis
campaignsand not email spam campaignsthat utilized
a new attack channel. They present their own unique
The fact that all the top-leveldomains of the URLs
propertiesthatdifferentiatethemfromtraditionalscams
collectedfromourinitialexperimenttranslatedtoavery
thatpropagatethroughspamemails.
small number of IP addresses, urged us to conduct a
newexperimentthatmightrevealmoreinformation.For
5.5 Comparison to commercial anti phishing a period of 50 days during July and August of 2009,
product weperiodicallyrannslookup[14]foreachoftheunique
top level domains our system had collected up to that
Multiple anti-virus vendors provide software prod- moment,inordertogathermoreinformationregarding
ucts designedto protectusers frommalicioussites. To how and where attackers host phishing and malware-
verify whether the URLs we collect have already been distributing domains. Here we present the results for
seenbylargevendorsthatofferanti-phishingproducts, eachcategoryofdomainsseparatelyandhighlighttheir
we evaluatedour URLs using such a service. We used particularbehaviour.
theNortonSafeWebservice[13]providedbySymantec The experimentgaveusfurtherinsightin regardsto
[23], where users can submit a URL and receive a re- thesmallnumberofIPaddressesthathostamultitudeof
portthatcontainsinformationregardingpossiblethreats phishingcampaigns. Alltopleveldomainstranslatedto
from the specific website. We submitted the 2,010 one or two IP addresses, while 98%of them translated
phishingandmalwareURLscollectedbyourinfrastruc- to only one. Furthermore,ten of the top leveldomains
tureafterthecollectionperiod.SubmittingtheURLsaf- belongedtofast-fluxnetworksandtranslatedtoadiffer-DE NL
CA
CA
CN (4.76%)(4.76%)(4.76%)
(13.0%)
(4.0%)
FR
(13.0%)
US
(22.5%)
GB
(8.5%)
PA
(13.0%) HK US
(26.0%) (85.72%)
Figure10. Breakdown of countries that host Figure 11. Breakdown of countries that host
thephishingdomains. themalware distributingdomains.
ent set of IP addresses each time. In Figure 8 we can eachmomentin time. TheIPaddressthathostedthree
see thatduringthe first daysof the experiment,all 101 malware-distributing domains also hosted one of the
top-leveldomainstranslatedtoonly14differentIPad- phishingdomainsandwaslocatedintheUnitedStates.
dresses. The TLDs that belongedto fast-flux networks Noneof the otherIPaddresseshosted botha malware-
are excluded from the graphs. This behaviour is con- distributingandaphishingdomain. Thenslookupoper-
sistentthroughoutthedurationoftheexperimentandas ationforallthetopleveldomainsreturnedonlyoneIP
new domains were added only a small number of new address,andonlyoneofthedomainsbelongedtoafast-
uniqueIPaddressesappeared. flux network pointing to a differentaddress each time.
Nextwewantedtotrackdownthecountrywherethe Since the IP addresses that host phishing domains are
domainswerehosted.WeusedtheMaxMind4database. more likely to be blacklisted, this result is not surpris-
In Figure 10we can see the breakdownof the percent- ing.Anotherinterestingfactisthatnoneofthetoplevel
agesof thecountriesthathostedthetopleveldomains. domainsisinbothofthesets,meaningthatnoneofthe
Honk Kong ranks first hosting 26% of the domains, domainshosteda phishingsite andsimultaneouslydis-
while the United states follow with 22%. A surprising tributedmalware.
result is that only 13% of the domains were hosted in Similarlytothephishingdomains,wewantedtotrace
China,whichisquitelowerthanwhatwewouldexpect the country where the malware-distributing domains
basedonreports[21]. were hosted. In Figure 11 we can see the breakdown
Next we present the results from the experimentre- of the percentages of the countries. The United States
garding domains that distribute malware. Our initial wereresponsibleforhostingthemajorityofthedomains
goalwastoinvestigatewhetherthetopleveldomainsof that distribute malware throughIM traffic, reachingal-
themalware-distributingwebsitesalsotranslateto only most86%. Theremainingthreecountries,CanadaGer-
asmallnumberofIPaddresses. many and the Netherlands, hosted an equal amount of
domains. Onceagain,itissurprisingthatChinadidnot
In Figure 9 we present the results from this exper-
hostanyofthedomainscaughtbyourinfrastructure.
iment. We can see that in the case of the URLs that
containmalware,thetopleveldomainstranslatedtodif-
7 Attacker profile
ferentIPaddresses. Unlike the phishingdomains,here
each top level domain translated to a different IP ad-
dress, andonlyoneto threeIPaddressesoverlappedat Inthissectionwepresentstatistics andobservations
inanefforttooutlinethebehaviourofIMattackersand
4http://www.maxmind.com/app/geolitecity recognizedifferentstrategypatterns.Mar−01−2009Apr−01−2009May−01−2009Jun−01−2009Jul−01−2009
Date
stnuocca
desimorpmoc
fo
#
600
500
400
300
200
100
0
Number of URLs sent
Figure12.Numberofcompromisedaccounts
thatcontactedourdecoyaccountsovertime.
stnuocca
desimorpmoc
fo
%
100
90
80
70
60
50
40
30
20
10
0
1 2 4 5 10 20 50 100 200 300 1000
Figure 13. CDF of the number of URLs sent
by compromised accounts to our decoy ac
counts.
First of all, in Figure 12 we present the number of alowrateofwormpropagationwouldbeusedsoasnot
unique compromised accounts that had sent URLs to totriggerantivirusorintrusiondetectionsystems.
ourdecoyaccountsovertime. We cansee thattheplot Furthermore, approximately 12% of the attackers
linefollowsasub-linearcurve,withalmost100newac- sent at least 100 URLs to our decoy accounts. This
counts contacting us each month. This indicates that aggressivestrategyofmassivelydispatchingspammes-
over time legitimate users still follow malicious URLs sages, indicatesacategoryofattackersthatdon’ttryto
sentbycompromised“buddies”andinturngetinfected remainbeneathacertainthreshold. Thiscanalsobeat-
too. tributed to technicalreasons. Specifically, amongstthe
top ten compromised accounts that sent us the largest
InFigure13wecanseetheCDFplotofthenumber
number of URLs, we found all the victim accounts
of URLs sent by each compromisedaccountto our in-
whose credentials we had entered in phishing sites.
frastructure throughoutthe duration of the experiment.
Therefore,theattackersusetoolstosendmessagesfrom
One should note that approximatelly 25% of the com-
thesecompromisedaccountswithoutrelyingonworms
promised accounts sent only one URL and 40% up to
thatinfectthe IMclientsoftware. Thus, we canrecog-
two URLS. Based on the numberswe can identifyone
nize a second more aggressive strategy, where it is not
possiblestrategythatattackerschoosetofollow.
necessary for attackers to adopt a stealthy propagation
Eventhoughsome of these accounts/hostsmay have rate. Finally,itisinterestingtonotethatattackerssend
been dis-infected before sending us another URL, it is URLs from all the categories, as well as malware, and
improbable to assume that all of them were “cleaned donotfocusononespecifictype.
up”.Therefore,thismightindicateacautiousbehaviour
on behalf of the attackers. With 55% of the compro-
8 Real-caseEvaluation
misedaccountssendingupto4URLsand75%sending
less than 20, it is evident that one strategy that attack-
ers follow is to avoid aggressive spamming behaviours We were interested in investigatingthe potential ef-
so as not to raise suspicions among the compromised fectivenessofanIMattackcampaign. Todoso,wede-
accounts’ contacts. Such aggressive behaviours could cidedtolaunchourownbenigncampaigntargetingthe
alert the user and lead to the dis-infection of the ac- contactsofoneofourhoneypots.Thereweretwofactors
count/machine. However,thiscautiousbehaviourcould to betaken intoconsideration. The firstonewas local-
also be attributed to technical reasons. If the attack is ization. Several users would get suspecious if we sent
propagatedthrougha wormthatinfectsthe client, then them messages that were not in their native language.Wequeriedtheprofilepagesofmostofthecontactswe
had at our disposal but unfortunately we could not re-
trieve countryinformationfor mostof them, so we de-
cidednottolocalizethemessagessent. Thesecondone
waswhetheraconversationwouldtakeplacebeforeac-
tually sending the URL. A message containing a URL
withoutanypriorconversationmightgetflaggedassus-
piciousimmediately.
Nonetheless, we decided to launch a simple spam
campaign that imitated the ones caught by Honey-
Buddy, that would not provide biased results. We
logged in one of our honeypot accounts and sent
the following message to the online contacts: “Hey!
Check this out: http://mygallery.webhop.
net/gallery1/photo1.jpg”. The URL pointed
toawebservercontrolledbyusandredirectedtheuser
toawebpagethataskedtheusertodownloada(benign)
executable.Theexecutablewasaharmlessprogramthat
just requested another URL, again from our own web
server. That way, we were able to track if and when
a user actually executed the file she downloaded. We
contacted each online contact only once for the whole
durationoftheexperiment.
Time
sutats
kcattA
9 MyIMhoneypot, adetection service
Inthissectionwepresentanoverviewofexistingde-
fensemeasures, andproposeaservice forthe earlyde-
tectionofattackstargetinginstantmessagingnetworks.
The existing defense mechanisms deployed by instant
messaging service providersand other vendors, are in-
sufficientforprotectingusersfromthethreatspresented
inSection3. Anti-virusproductsthatscanfilesreceived
from instant messaging file-transfers fail to identify all
malware used by IM attackers, as shown by our find-
ings. Anti-virusvendorscouldprovidemoreup-to-date
signatures for IM malware by deploying HoneyBuddy
for the early collection of such malware. Furthermore,
asshowninSection5.5,anti-virusproductsdesignedto
protectusersfromphishingattacksfailtodetect87%of
themaliciousURLscollectedbyourinfrastructure.Pop
upmessagesfromIMclientsoftwarethatalertusersof
phishing, that are triggered by all messages that con-
tain a URL even if it is benign, are ineffective since
userstendtoignorewarningsthatarepresentedevenfor
well-knownbenignURLs. We proposethat IM clients
shouldcorrelatereceivedURLswithblacklistsandalert
usersonlywhentheybelongtomaliciousdomains. We
presentourclient-sidemechanismthatisorthogonalto
4 existingdefensemechanisms;myIMhoneypot,anearly
3 detectionservicethatcaninformusersiftheiraccounts
or IM clients have been compromised. IM attacks try
2
tospreadthroughthevictim’scontactlistbysendingei-
1
therURLsorfilestothevictim’sfriends. Anyuserthat
0
wantsto checkif heraccountis compromisedregisters
7PM 9PM 11PM 1AM
May18 May19 withthemyIMhoneypotservice. Uponregistration,the
service creates a unique IM honeypot account (for ex-
Message sent File downloaded File executed
ample,anewMSNaccountthatwillbeusedasadecoy
account)and informsthe user to add that honeypotac-
Figure 14. Time series of events that oc
countto her contact list. As the user will never start a
curredduringourbenigncampaign.
conversation with the honeypot account but an IM at-
tacker will (with great probability), the user can check
ifsomethingiswrongbyvisitingthewebsiteoftheser-
The resultsof the campaignare summarizedin Fig- viceandcheckingtheconversationlogswithherunique
ure 14. The bottom series plots the timestamps when honeypotaccount. If there are entries in the conversa-
themessagewassenttoanonlineuser. Themiddlese- tionlogofherdecoyaccountliketheexampleinFigure
riesplotsthetimestampswhenacontactvisitedtheURL 15,thenthereisastrongindicationthatherIMclientor
containedinthesentmessageanddownloadedtheexe- credentialshavebeencompromised.
cutable. Thetopseriesdisplaysthetimestampswhena ThereasonthatauniqueIMaccountmustbecreated
contactactuallyranthedownloadedexecutable. During peruseristwofold. First,iftheservicehasonlyoneor
our campaign we sent 231 messages. 27 unique users afewhoneypotaccountsthentheycanbeeasily black-
(11.6%)visitedtheURLanddownloadedthefile,while listed (recall that anyone can subscribe to the service,
9 of them (4%) executed the downloaded file. We re- including attackers). The attacker should not be able
peatedthesameexperimentwithtwootheraccountsand to distinguish whether a contact is a decoy account or
theresultswerealmostthesame. not.Theservicecreatesaccountswithhuman-likenick-www.honeyathome.org/imhoneypot.
We also providea service thatdoes notrequireuser
registration. UserscansubmitURLstheyreceiveinin-
stantmessagestocorrelatethemwithourdatabase. As
mentionedbefore,suspiciousURLsusuallycontainthe
target’s username and, thus, searching for an identical
URL in our database would rarely result in a match.
Therefore, the service searches our database for any
URLthathasthesametopleveldomainwiththatofthe
submitted URL, which is an indication that they might
belong to the same campaign. If a match is found the
userispresentedwithasmallreportcontainingthedate
the URL was first caughtby HoneyBuddyand the cat-
egory it was assigned by our classifier. Based on our
findingsin Section 5 concerningthe uptime of each of
collected TLDs, we assign the submitted URLs with a
Figure 15. A screenshot of the log pre valueofhowlikelytheyaretostillposeathreattousers
sented to a user whose IM account has dependingonthetimewindowbetweenbeingcollected
beencompromised. byHoneyBuddyandbeingsubmittedbytheuser.
10 Conclusions
names. Second,theattackercantrytohackintotheser-
vice’saccountsoncesheknowstheuserisasubscriber. InthispaperweproposeHoneyBuddy,anactivehon-
Using a unique honeypotper user makes the attacker’s eypotinfrastructuredesignedto detect maliciousactiv-
lifealotharder. Theattackercannotcorrelatecommon ities in instant messaging services. HoneyBuddyauto-
friendsacrossaccountsandhastotrytocompromiseall maticallyfindsuseraccountsthatbelongtoasupported
theaccountsin theuser’scontactlist. Evenif shedoes IMserviceandaddsthemtoitscontactlist. Oursystem
that, mostIM services (atleast MSN and AIM) do not monitorsdecoyaccountsforincomingmessagesandfile
keep conversationlogs at the server side so she cannot transfers,andextractssuspiciousexecutablesandURLs.
findherspammessagesinthelogsofdecoyaccounts. The suspicious data gathered by HoneyBuddy is cor-
The attacker could guess the decoy accounts by relatedwith existingblacklists, and malware collection
checkingthelocallystoredconversationlogs.Normally, centerdatabases. Despite the simplicity of our system,
a user will have conversationswith all membersof her deployment for the MSN service showed that 93% of
contactlistexceptthehoneypotaccount. Therefore,the theidentifiedphishingdomainswerenotlistedbypopu-
attacker could avoid sending messages to accounts for larblacklistmechanismsand87%ofallmaliciousURLs
whichnoconversationlogswerefound. Thisattackcan were incorrectlyflaged as safe by a commercial“web-
be easily circumventedby plantinga fake conversation safety”product.Furthermore,21%ofcollectedmalware
logontheuser’sside. samples were also not listed by other infrastructures.
The myIMhoneypot service has a limitation. For These findings confirm that existing security measures
each registered user, a new IM account must be cre- of instant messaging services are insufficient, and also
ated in order to be used as a decoy. This process in- indicate the effectiveness of our system as a comple-
volves the solution of CAPTCHAs [5] which prevents mentary detection infrastructure. We further inspected
us frommaking it completelyautomatic. Althoughwe the top level domainsthat host the phishing URLs and
couldclaimthatMyIMhoneypotisalegalcaseforlaun- found that they translate to a very small number of IP
dering CAPTCHAs, we did not implement it for obvi- addresses suggesting the existence of a large network
ous reasons. For the time being, we have to manually of collaboratingattackers. On the otherhand, domains
create decoy accounts. However, we propose that this that distribute malware do not follow the same tactics
serviceshouldbe implementedby eachIM provideras and translate to a differentset of IP addresses. We lo-
a means of protection for its users. We implemented cateddomainsthatbelongtofastflux-networksinboth
a prototype of myIMhoneypot for the MSN platform. cases,howevertheyaremorecommoninthecaseofthe
We call it myMSNhoneypot and it can be found at phishing domains, which have a higher probability ofbeingblacklisted. Based onthe resultsfromthe analy- [9] H1N1ShortcutMalware. http://www.f-secure.
sis of the IM attacks we caught, we provided a profile com/weblog/archives/00001738.html.
oftheattackersandtheirspammingstrategies.Aninter- [10] MessengerFinder, Find people online. http://
messengerfinder.com/.
esting aspect of IM attacks that could notbe measured
[11] Msnmessenger. http://messenger.live.com/.
byourinfrastructurewashowsuccessfulanMSNphish-
[12] MSN Polygamy. http://www.softpedia.com/
ingcampaigncanbe. Togetanestimation,wedeployed get/Internet/Chat/Instant-Messaging/
ourownbenigncampaignandfoundthatalmost12%of MSN-Messenger-7-8-Polygamy.shtml/.
theusersfollowedtheURLand4%rantheexecutableit [13] Nortonsafewebfromsymantec. http://safeweb.
redirectedto. norton.com/.
[14] nslookup. http://en.wikipedia.org/wiki/
WealsodeployedmyMSNhoneypot,aprototypeim-
Nslookup.
plementationofa servicethatisopentothepublicand
[15] Pidgin, the universal chat client. http://www.
createsdedicatedIM honeypotsfor users. Thisservice
pidgin.im/.
provides an early alerting mechanism for users whose [16] Planetlab, an open platform for developing, deploying
IMaccountsorclientsarecompromised.Itprovidesde- andaccessingplanetary-scaleservices. http://www.
coy accounts for users that register with the service to planet-lab.org.
add to their contact list. A message from the user to a [17] Scraping facebook email addresses. http:
//kudanai.blogspot.com/2008/10/
decoyaccountisanindicationthattheuser’scredentials
scraping-facebook-email-addresses.
or IM clientare compromised,asthe user wouldnever
html.
initiate a conversationwiththe decoycontact. We pro-
[18] SkypeFastFacts,Q42008.
posethistypeofservicetobeadoptedanddeployedby
http://ebayinkblog.com/
instant messaging vendors. Finally, we offer a service wp-content/uploads/2009/01/
whereuserscan submita URL andreceivea reportin- skype-fast-facts-q4-08.pdf.
dicating if the top level domain has been classified as [19] SpamArchive.http://untroubled.org/spam/.
dangerous. [20] The state of spam a monthly report august 2007.
http://www.symantec.com/avcenter/
reference/Symantec_Spam_Report_-_
Acknowledgments
August_2007.pdf.
[21] StopBadware Blog : China Hosts Ma-
ThisworkwassupportedinpartbytheprojectCyber- jority of Badware Sites. http://
Scope,fundedbytheGreekSecretariatforResearchand blog.stopbadware.org/2008/06/24/
Technology under contract number PENED 03ED440.
china-hosts-majority-of-badware-sites.
[22] Surbl. http://www.surbl.org.
We thank the anonymous reviewers for their valuable
[23] Symantec. http://www.symantec.com/index.
comments. IasonasPolakis, ThanasisPetsas andEvan-
jsp.
gelosP.MarkatosarealsowiththeUniversityofCrete. [24] Urlblacklist.com. http://www.urlblacklist.
com/.
[25] Virustotal, online virus and malware scan. http://
References
www.virustotal.com/.
[26] Vulnerability in PNG Processing Could Allow Remote
[1] Anubis: Analyzing unknown binaries. http:// Code Execution. http://www.microsoft.com/
anubis.iseclab.org/. technet/security/bulletin/MS05-009.
[2] AQABA Search Engine Demographics. http:
mspx.
//http://www.aqaba-sem.com/search_ed. [27] W32.Bropia. http://www.symantec.com/
htm/.
security_response/writeup.jsp?docid=
[3] AutoIt. http://www.autoitscript.com/
2005-012013-2855-99&tabid=2.
autoit3/index.shtml/.
[28] N. Hindocha. Threats to instant messaging. Symantec
[4] BuddyFetch. http://buddyfetch.com/.
[5] CAPTCHA:TellingHumans and Computers Apart Au- SecurityResponse,2003.
[29] J. Leskovec and E. Horvitz. Planetary-Scale Views on
tomatically. https://captcha.net/.
[6] Crowbar. http://simile.mit.edu/wiki/ a LargeInstant-Messaging Network. InProceedings of
Crowbar. WWW2008,April2008.
[7] Europe surpasses north america in instant mes- [30] Z.LiuandD.Lee.Copingwithinstantmessagingworms
senger users, comscore study reveals. http: -statisticalmodelingandanalysis. pages194–199,June
//www.comscore.com/press/release.asp? 2007.
press=800. [31] Z.Liu,W.Lin,N.Li,andD.Lee. Detectingandfilter-
[8] Google safe browsing api. http://code.google. ing instant messaging spam - a global and personalized
com/apis/safebrowsing/. approach. pages19–24,Nov.2005.[32] Z. Liu, G. Shu, N. Li, and D. Lee. Defending against
instant messaging worms. In In Proceedings of IEEE
GLOBECOM2006,pages1–6,2006.
[33] M.MannanandP.VanOorschot. Securepublicinstant
messaging: A survey. In Proceedings of the 2nd An-
nualConferenceonPrivacy,SecurityandTrust(PST04),
pages69–77.
[34] G. Portokalidis, A. Slowinska, and H. Bos. Argos: an
Emulator for Fingerprinting Zero-DayAttacks. In Pro-
ceedingsofACMSIGOPSEurosys2006,April2006.
[35] H.Project. Knowyourenemy: LearningaboutSecurity
Threats. PearsonEducation,Inc.,2004.
[36] N.Provos, P.Mavrommatis, M. A. Rajab, andF.Mon-
rose. Allyouriframespointtous. InSS’08:Proceedings
ofthe17thconferenceonSecuritysymposium,pages1–
15,Berkeley,CA,USA,2008.USENIXAssociation.
[37] A.Trivedi,P.Judge,andS.Krasser. Analyzingnetwork
and content characteristicsof spimusing honeypots. In
Proceedingsofthe3rdUSENIXSRUTI,2007.
[38] M. Williamson, A. Parry, and A. Byde. Virus throt-
tlingforinstantmessaging. InVirusBulletinConference,
pages38–4,2004.
[39] M. Xie, Z. Wu, and H. Wang. HoneyIM: Fast detec-
tion and suppression of instant messaging malware in
enterprise-likenetworks. InProceedingsofthe2007An-
nual Computer Security Applications Conference (AC-
SAC07).