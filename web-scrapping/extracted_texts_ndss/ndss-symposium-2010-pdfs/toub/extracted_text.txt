Adnostic: Privacy Preserving Targeted Advertising∗
VincentToubiana ArvindNarayanan DanBoneh
vincent.toubiana@nyu.edu relax@stanford.edu dabo@cs.stanford.edu
HelenNissenbaum SolonBarocas
hfn1@nyu.edu solon@nyu.edu
Abstract ads based on the user’s browsing behavior [4]. In the next
sectionwesurveysomeofthekeyplayersinthisspace.
Onlinebehavioraladvertising(OBA)referstotheprac- Although behavioral advertising promises an improve-
ticeoftrackingusersacrosswebsitesinordertoinferuser mentovermorescatter-shotapproaches,ithasevokedgreat
interests and preferences. These interests and preferences concern and protest, particularly among privacy and con-
arethenusedforselectingadstopresenttotheuser. There sumer advocacy groups. Some are concerned that OBA is
is great concern that behavioral advertising in its present manipulativeanddiscriminatory,butthedominantconcern
form infringes on user privacy. The resulting public de- is its implications for privacy. As early as February 2000,
bate — which includes consumer advocacy organizations, theElectronicPrivacyInformationCenterfiledacomplaint
professional associations, and government agencies — is onthispracticewiththeFederalTradeCommission(FTC)
premisedonthenotionthatOBAandprivacyareinherently andin2002asettlementwasreachedinwhichDoubleClick
inconflict. agreedtoexpireitscookiesafter5yearsandtopostaclear
In this paper we propose a practical architecture that noticeonsiteswhereitcollectsuserinformation[14].
enables targeting without compromising user privacy. Be- More recently, in 2007 the FTC undertook an ongoing
havioralprofilingandtargetinginoursystemtakesplacein examinationofOBAandinFebruary2009issuedarevised
theuser’sbrowser. Wediscusstheeffectivenessofthesys- report and recommendations [11]. Viewing online adver-
temaswellaspotentialsocialengineeringandweb-based tisingasakeyreasonforfreecontentontheweb,theFTC
attacksonthearchitecture.Onecomplicationisbilling;ad- allowsthecontinuedpracticeofOBA,butwithvarioussafe-
networks must bill the correct advertiser without knowing guardsbuiltintoit, suchasgreatertransparency, provision
whichadwasdisplayedtotheuser. Weproposeanefficient forconsumeropt-out,andspecialhandlingofso-calledsen-
cryptographic billing system that directly solves the prob- sitiveinformationsuchashealthandfinancialinformation.
lem. WeimplementedthecoretargetingsystemasaFirefox Last year, out of similar concerns, Congress began
extensionandreportonitseffectiveness. a study of deep packet inspection at Internet Service
Providers(ISPs). Deeppacketinspectionisarelatedprac-
tice developed by companies such as Nebuad and Phorm,
1 Introduction enabling ISPs to track user behavior and sell the informa-
tion. In April 2009 a house subcommittee began looking
intowhetherthepracticeneedstobeoutlawed[33].
Onlinebehavioraladvertising(OBA),alsocalledonline
behavioral ad targeting, is not a new practice. In the late
1990s, DoubleClick used 3rd party cookies to track users Ourwork. WhilethepolicydebateonOBAisheatingup,
acrosssitesandpresentedadsbasedontheuser’sbrowsing thediscussionisframedaroundthepremisethatbehavioral
patterns.TodayOBAisalargeandcomplexindustrywhere targeting is inherently in conflict with privacy. That is, if
entireexchangestradeuserinformationspecificallyforthe privacy is to be preserved then OBA is impossible. Simi-
purpose of better ad placement. Even Google announced1 larly,ifbehavioraltargetingtakesplacethenuserprivacyis
inMarch2009thatitsAdSenseservicewillbegintargeting atrisk. Inthispaperwepresentawayaroundthedilemma,
arguing that other alternatives exist. We argue, in particu-
∗This work was supported by the NSF PORTIA and MURI PRESIDIO lar,thatitispossibletosupporttargetedadvertisingwithout
projects.
1Thefollowingquotefrom[4]isillustrative: “ifusersvisitanumber compromising user privacy and propose an architecture to
ofsportspages,we’lladdthemtothesportsenthusiastinterestcategory.” doso.At a high level, our system called Adnostic is imple- theformofaniframe,animage,a“webbug,”oraonepixel
mentedasabrowserextensionthatrunsthebehavioraltar- transparent image whose sole purpose is user tracking).
geting algorithm on the user’s browser by processing the Whenauserviewsthepage,theuser’sbrowsercontactsthe
browser’s history database. The results are kept in the ad-network’sservers,whichenablesthead-networktotrack
browser and are used to select ads to display on the page. theuseracrossallpublishersthatpartnerwiththem.Google
If the user does not click on the ad the selection is never AdSense,forexample,cantrackusersacross91,000unique
communicatedoutsidethebrowserandconsequentlynoin- domains [6]. The ad-network then uses its targeting algo-
formation about the user’s behavior is leaked. Users see rithmtodecidewhichadtopresentonthepublisher’spage.
ads relevant to their interests, but user information is not Adtargetingtakesmanyvariablesintoaccount: theadver-
leaked to the outside world (i.e. outside the browser). We tiser’sbidandbudgetforpresentingads,thecontentofthe
usecryptographictechniquestoensureaccurateaccounting pageonwhichtheadistobeplaced(calledcontent-based
between advertisers, publishers, and ad-networks without orcontextualtargeting),andtheuserviewingthead(called
compromisinguserprivacy. behavioraltargeting).
The motivation behind Adnostic is not to replace the
existing behavioral advertising infrastructure, but rather to
Tracking. Tracking requires the ability to associate an
complement it. Ad-networks can continue to provide a
identifier with a user across publishers and across differ-
user-trackingbasedadvertisingservicealongsideaprivacy-
entvisits. Therearemanywaystoachievethis: third-party
preservingservicebasedonAdnostic. Websiteswhowish
HTTP cookies are the most common approach. Cookies
to display ads can choose which advertising service they
can be cleared from browser memory, and indeed, accord-
wishtouse. WediscussthisinmoredetailinSection2.3.
ingtoonestudy,52%ofusersdeletedtheircookiesatleast
Our architecture is described in Sections 3, 4 and 5. In
oncein2004[26]. Inresponse,avarietyofharder-to-detect
Section 6 we discuss a preliminary prototype implement-
methodsarebeingused[38], withFlashcookiesbeingthe
ingthearchitecture. Whileourproposedarchitectureisde-
most popular, since most users lack awareness and tools
signedtominimizedisruptiontotheWebecosystem,many
to manage them. IP address is another tracking technique,
other designs are possible. We survey a few alternatives
albeit somewhat coarser-grained than cookies. User-agent
inSection7. Weseethisasafascinatingresearchareawith
strings are also used, especially in conjunction with other
manyopportunitiesforfuturework.Wesurveyrelatedwork
identifiers such as IP address. Browsers generally include
inSection8.
many types of information in the user-agent string, such
as browser name and version, OS name and version, any
2 Abriefoverviewofonlineadvertising browser extensions installed, etc. The UA tracker project
lists over 24,000 unique user-agent strings [30]. For more
The online advertising world has become incredibly informationontracking,wereferthereadertoacasestudy
complex with many involved parties playing different ofusertrackingtechniquesusedonlevis.com[15].
roles[3]. Wegiveabriefoverviewtohelpexplainourpro-
posedarchitecture. Westartwiththebasicterminology: 2.1 Existingbehavioraltargetingsystems
• Advertiser: a party that has an online ad it wants to
Inrecentyearsmanyplayershaveenteredthebehavioral
embedinwebpagesacrosstheweb. Theadvertiseris
targetingspace. Asmentionedabove,GoogleAdSensebe-
willingtopayforthisservice.
gan using behavioral targeting in March 2009. Following
• Publisher: apartywhoownsawebpage(orwebsite) theFTCrecommendationsfortransparency,Googlealerted
and is willing to place ads from others on its pages. all their publishers to update their privacy policy to reflect
Thepublisherexpectstobepayedforthisservice. We this fact. Google and Yahoo! provide a user-profile page
will use the NY-Times as our canonical publisher ex- whereInternetuserscansettheirinterestsoropt-outofbe-
ample. havioral targeting altogether [20, 45], consistent with the
FTCrecommendations.
• Ad-network: a party who collects ads (and pay-
Manyotherplayershelpadvertiserswithbehavioralad-
ment) from advertisers and places them on publisher
vertising [7, 18, 9, 16, 32, 34] and all provide an opt-out
pages(alongwithpayingthepublisher). Examplead-
mechanismbywhichInternetuserscanasktoberemoved
networks include Google, Yahoo!, MSN, AOL, and
from their database. Users, however, have to actively opt-
AdBrite (listed in order of number of ads served in
outfromeachproviderseparately.Thisgreatlylimitstheef-
2008[6]).
fectivenessoftheopt-outmechanismsinceconcernedusers
Publishers who wish to work with a particular ad- cannot be expected to manually opt-out of every tracking
network embedon theirpages alink to thead-network (in service on the web. A centralized opt-out service (similartotheFTC’sdonotcalllist)wouldbehelpful,butdoesnot • Clickstream: a list of all URLs visited by the user
currentlyexist. (across all publishers who partner with a given ad-
SeveralOBAproviders[9,16,32,34]specializeinuser network).
trackingandsimplyselltheinformationtoadvertisersand
ad-networks. Some [9, 16] do so by paying publishers to • Behavioralprofile:ashortdescriptionoftheuser’sin-
linktotheirsite. Others[32,34]trackusersbycontracting terestsinferredfromtheclickstream. Behavioralpro-
withInternetServiceProviders(ISPs). filing in Adnostic which happens in the browser, will
Some OBA providers [7, 18] specialize in retargeting: be explained in detail in Section 6.1. In current prac-
when a user visits an online merchant A the information tice, the ad-network computes the user’s behavioral
is recorded and ads for A are presented to the user when profilefromtheclickstreaminordertotargetads.
visitingotherpublishers.
• Adimpressionhistory: alistofalladsthathavebeen
Mostbehavioraltargetingsystemsworkbycategorizing
displayedtotheuser.
usersintooneormoreaudiencesegmentsusuallybasedon
thedatacollectedabouttheirbrowsingbehaviorbutpossi-
• Ad click history: a list of all ads that the user has
blyonsearchterms[45]orevenplacementinasocialnet-
clickedon.
work [35] . The advertiser specifies the segments(s) that
theywouldliketheiradtotarget, andthead-networkcon-
Our goal is to enable ad-networks to provide the most
siders this factor inaddition to the advertiser’s bid and the
relevant ads without collecting information that the user
contentofthepage. TheAOLadvertisingplatformuses70
maywishtokeepprivate. InAdnosticthead-networkpro-
audiencesegmentslistedat[5]. AudienceSciencepresents
vides targeted ads with no knowledge of the user’s click-
their list of 98 audience segments at [8]. The Google Ad
stream,behavioralprofile,oradimpressionhistory.
Networkusesahierarchicalcategorizationwith27top-level
Adnosticdoesnothidetheadclickhistoryfromthead-
categories[20],listedintheappendix.
network for two reasons. First, ad-networks need the ad
clickhistorytodefendagainstclickfraudscams[13]. Sec-
2.2 Privacyandthreatmodel
ond, advertisers see all clicks on their ads and they have
a strong incentive to share that information with the ad-
Privacy in behavioral targeting is a complex issue be-
network to provide better placement for their ads. Hence,
cause there are many parties involved and many types of
evenifwehideadclicksfromthead-network,itwilllikely
userdatatobeprotected. Letusnowexaminetheminde-
obtain the information anyhow from the advertisers. For
tailandmotivatethechoicesmadebyAdnostic.
thesereasonscurrentsystemsredirectclicksonadsthrough
Recallthatthereare3mainpartiesinvolvedinonlinead-
the ad-network’s systems. Adnostic does not change this
vertising: theadvertiser,thepublisher,andthead-network.
practice.
Inaddition,therearetwootherpartiesthatarerelevantfrom
Otherprivatetargetingarchitecturemaychoosetokeep
aprivacyperspective.
moreorkeeplessinformationhiddenfromthead-network.
• Content Distribution Network or CDN: an entity We discuss a number of alternatives and tradeoffs in Sec-
such as Limelight or Akamai which provides a host- tion7.
ingservicethatthelargerad-networksusetoactually
serve the ads. If we assume that the CDN may “col- 2.3 IncentivesfordeployingAdnostic
lude” with the ad-network, we may as well consider
the two to be the same party. This assumption is ex-
BehavioraltargetingwithAdnosticismorelimitedthan
aminedinmoredetailinSection7.
behavioral advertising when user privacy is not a concern.
• Trustedthirdparty2: aproviderofa(typicallycryp- WhileAdnosticrequiresnoextraeffortfrompublishersand
tographic) service trusted not to collude with the ad- advertisers, ad-networks will need to modify the way they
network or any of the other parties. Note, however, serve ads in order to support Adnostic. The success of Ad-
that it is not acceptable to leak any of the user’s data nostic is therefore crucially dependent on the incentives
tothisentity. Ideally,thisserviceshouldonlybecon- for ad-networks to implement and support for it. We dis-
tactedinfrequently. cuss numerous reasons why the interests of ad-networks
andotherpartiesarewellservedbydeployinganAdnostic-
Next,letusconsiderthetypesofdatathattheusermay
likesystemalongsideotherservices(possiblynon-private)
wishtokeepprivate.
itmayoffer.
2Althoughinthisinstanceitmaybemoreappropriatelybetermeda
Privacy-conscious publishers. First, ad-networks will
trusted sixth party, counting the user and the four parties already intro-
duced. most likely offer Adnostic as a service that complementsratherthanreplacestheexistingOBAmechanism. Publish- behavioral profile. Thus Adnostic can extend the reach of
ers can then decide whether they want to link to the ad- behavioraltargetingtoprivatebrowsingmodes.
network’s user-tracking system or privacy-preserving sys-
Usercontrolviacentralizedinterface. Thereisonemajor
tem. Ad-networks could reward publishers for linking to
benefit of Adnostic for users in addition to privacy: users
tracking-basedsystemsbypayingmorefortheselinks. But
havetheabilitytocontroltheselectionofadsthattheyare
theprivacy-preservingoptionmightbringtothetablesites
served, and furthermore, they have a centralized interface
who, out of concern for user privacy might otherwise not
fordoingso,byeditingthebehavioralprofilecomputedby
choosetoserveadsatall.
Adnostic. Currently, users need to modify their behavioral
Providingaprivacy-preservingoptionwouldenablesites
profile separately on each ad-network, of which there are
whocareaboutuserprivacytoserveads.Forexample,sites
over90[39].
like Alcoholics Anonymous (aa.org) currently serve no
ads. IfAdnosticisavailable, theycoulduseittoserveads Standardized audience segmentation. Different ad-
withoutviolatingtheirprivacypolicy. networks use different sets of audience segments or cate-
gories. This creates confusion for advertisers, limiting the
Lower barrier to entry. Second, with Adnostic, user be-
abilitytomigratetoadifferentad-network, hurtingthein-
haviorisanalyzedatthebrowserwhichhascompletevisi-
dustry as a whole. A standardization initiative by Tacoda
bilityintotheuser’sbrowsingpattern. Asmallad-network,
a few years ago to did not succeed [28]. With Adnostic, a
incontrast,onlyseestheuser’svisitedpageswhentheuser
singlecategorizationsystemisbuiltintotheclient,andany
visitsasitethatpartnerswiththead-network. WithAdnos-
ad-networkadoptingitwouldbeabletopresentauniform
ticasmallad-networkwilllikelydomuchbetteratplacing
interfacetotheadvertisers.
relevantadsfortheuser.
Regulatorycompliance. Third,theFTCrecommendsthat
3 Adnostic architecture: Targeting with pri-
all ad-networks provide the user with an opt-out mecha-
vacy
nism that disables user tracking. For users who opt out,
thead-networkcoulduseAdnostic. Thisstillallowsthead-
networktotargetadswithouttrackinguseractions. Asdiscussedabove,OBAholdsthepromiseofmoreef-
fectiveadvertisingwhilepresentinguserswithadsthatare
Potentiallyimprovedusertracking. CookieandIP-based
morerelevanttotheirinterests(ratherthan,say,anendless
systems are unable to track users across different comput-
streamofadsforcheapmortgages.)Acceptingthesepropo-
ers. Manyusersfrequentlychangecomputersorterminals,
sitions, we suggest that OBA would be more broadly ac-
re-install their operating system, clear their cookies, etc.
ceptedifitcouldbeconductedwithoutcompromisinguser
A browser-based system has the potential to enable near-
privacy. Accordingly, we propose a privacy-preserving ar-
perfectusertracking,sincemanybrowservendors(includ-
chitecture for OBA. Currently implemented as a browser
ingMozillaFirefoxandOpera)offertoolstokeepprofiles
extension,thesystemconsistsofthefollowingcomponents.
acrossmultipleinstallationssynchronized[29].Third-party
pluginsofferingsuchfunctionalityareavailableforallma-
3.1 Behavioralprofiling
jor browsers [41]. The ad-network might even choose to
bundle a browser synchronizer with an Adnostic-like sys-
tem. 3.1.1 Interestcategorization
Theconverseproblemistodisambiguatedifferentindi-
Our proposed system relies on the browser to locally pro-
viduals who might use the same browser session. In Sec-
cessthehistorydatabasetodetermineuserinterests. Asthe
tion3.1.3,wediscusshowAdnosticmightbeabletosolve
user browses more web pages, the interest categorization
thisproblembetterthancurrentOBAsystems.
iscontinuallyupdatedandrefined. Onemethodofaccom-
Targeting in private browsing mode. All modern plishingthisisfortheextensiontoclassifythetopicofeach
browsers support a mode in which no information about viewed page by using natural language processing heuris-
browsing activity (including cookies) is stored beyond the ticsrunninginthebrowser.
session. This is called Private Browsing in Firefox, In- Another method is to rely on an external list of URLs,
PrivateBrowsinginInternetExplorer,andIncognitomode butwithoutcompromisinguserprivacy.Thebrowserdown-
in Google Chrome. When this mode is enabled, the user loads from the ad-network (or another third party) a fixed
session cannot be tied to their previous activity, and there- listofURLsandtheirclassification.Thelistcanbeupdated
forebehavioraltargetinginitscurrentformisdifficult. On periodically, but it is the same list for all users. For every
the other hand, Adnostic continues to operate even while record in the history database the browser consults the list
browsing privately. This is acceptable because while Ad- todeterminetherecord’sclassification.Pagesnotonthelist
nosticservesadsinthismode,itdoesnotupdatetheuser’s areprocessedlocallyusingnaturallanguageheuristics. Foraquantitativeanalysisofthefeasibilityofthetwomethods, sendsbackapagethatpointstothead-network,asusual.
seeSection6.3. The content served by the ad-network first uses
In principle web sites can categorize their own content JavascripttocheckiftheuserhasAdnosticinstalled(details
and provide the categorization to browsers in an HTTP ofourproposedimplementationareinSection6.4). IfAd-
headeraspartoftheresponsetoanHTTPrequest.Thiswill nosticisnotdetected, thenthead-networkloadsaspecific
help the browser build a more accurate user profile. How- adtobeplacedonthepage. Ontheotherhand,ifAdnostic
ever, since there is little incentive for web sites to provide is detected, the ad-network instead sends back a list of n
thisservicewedonotrelyonthisapproach. ads(sayn=20)thatitsexistingpricingandcontent-based
algorithms decide are most appropriate for the page. Each
3.1.2 Otheraspectsofbehavior adistaggedwithaclassificationindicatingitstopic.
Our browser extension now uses the information ob-
IncurrentOBAsystems,behaviordenotesmorethaninter-
tained from processing the browser’s history database to
est. Specifically, the “audience segments” used by current
choose one of the n ads for the page, namely the ad that
OBA systems measure attributes such as intent and influ-
ismostrelevanttotheuser’sinterest. Thatadisdisplayed
ence.
aspartofthepage. InSection6.4wediscussourproposed
Intent refers to intent to purchase, and distinguishes
implementationoftheadspecificationAPIandadselection
“auto enthusiasts” from “auto shoppers,” which are sepa-
algorithm.
rate audience segments targeted by AudienceScience [8].
The choice of n is configurable. A larger value allows
One possible way to measure intent is to observe user ac-
more precise targeting, but increases network bandwidth.
tions such as requesting an auto quote or adding an item
Asmallervalueimpliesmorecoarsetargeting,butreduces
to a shopping cart. Influence refers to influence over the
network bandwidth. In the next section we discuss what a
purchasinghabitsofothers;onepossiblewaytomeasureit
reasonablevaluefornmightbe.
is to detect users who spend a disproportionate amount of
Notethatadsareoftenservedfromacontentdistribution
timeconsumingthelatestnewsandtrendsintheircategory
network(CDN)whichhasserversclosetotheuser. Conse-
ofinterest.
quently, adloadsaretypicallyfasterthanloadingdynamic
These nuanced attributes can certainly be measured by
contentfromtheenclosingpage. Moreover,loadingtheads
observing the user’s browsing activity locally. In addi-
neednotslowdowntherenderingoftheenclosingpage.By
tion,abrowser-basedsystemhasthepotentialabilitytotie
loading ads after the enclosing page is rendered we mini-
into other streams of user activity such as social network-
mizetheimpactontheuserexperience. Adswillappeara
ing services. However, it is not clear if the level of profil-
fewmillisecondsaftertheenclosingpageisdisplayed.
ing/targetingaccuracycanbeashighasthecurrentserver-
sidetrackingapproach.
3.3 Accounting
3.1.3 UserSessions
Finally, there is the issue of session disambiguation: what The final component is accounting. Accounting in the
happenswhenmorethanonepersonusesthecomputer(us- “chargeperclick”modelremainsunchanged:itisnotapri-
ingasingleaccount)? CurrentOBAsystemshavedifficul- vacyviolationforthead-networktoinferthatauserclicked
tieswiththis;consequently,childrenwhousetheirparents’ onanad,andthereforethestandardaccountingprocedures
computermaybepresentedwithmortgagerefinancingads canbeapplied.
basedontheirparents’profile(s). Inthe“chargeperimpression”model,thecorrectadver-
Since our system runs in the browser, it can do a better tisermustbebilledwithoutthead-networklearningwhich
jobofidentifyingthecurrentuserinteractingwiththesys- adwasdisplayedtotheuser. InSection5weproposeaso-
tem. Oneoptionistousekeystrokedynamics, whichvary lution to this problem based on homomorphic encryption.
from user to user [31]. Another option is to identify the Thekeyideaisthatthead-networkcanmaintainencrypted
currentuserbasedontheimmediatelastfewpagesviewed. impressioncountersthroughoutabillingcycle,andrelyon
Thatis,iftheuservisitsanumberofchild-relatedwebsites atrustedthirdpartytodecryptthesecountersattheendof
withinashortperiodoftime,itislikelythatthecurrentuser thecycle.
isachildratherthananadult.
4 Possibleobjections
3.2 Adinsertion
Theprocessconsistsofanumberofsteps.Whentheuser Anumberofquestionscometomindwhenfirstconsid-
visits a publisher page (e.g. the NY-Times), the publisher eringthisproposal.Network latency and bandwidth. We already argued treatsbehaviorassynonymouswithinterest,andfurtherre-
that loading multiple ads can happen after the enclosing search is necessary to establish that browser-based behav-
page is rendered, thus minimizing the impact on the user ioralprofilingcanbesufficientlyaccurate.
experience. AnotheroptionisfortheAdnosticextensionto
prefetchadsbeforetheuservisitsthepublisher’spage. Ad
Enforcement of non-tracking. In principle, an ad-
prefetching, however, does not fit well with current real-
network could offer an Adnostic-like service, but continue
time ad auction systems and we do not include it in our
totrackusersasitdoestoday.Thereisnofool-prooftechni-
system. Nevertheless, anarbitrarynumberofadscouldbe
calwaytopreventtracking,shortofrelyingoninconvenient
prefetched in the browser and stored locally. When a user
anonymity services like Tor. In reality, we expect that en-
visitsawebpage,thebrowserreceivesthelistofnadsand
forcementofnon-trackingwillbedonecontractually,since
compares it to the list of prefetched ads. If the ad that it
trackingiseasytodetectbymanualinspection. Potentially,
chooses to display is already prefetched, it displays it im-
the Adnostic browser extension can include a user setting
mediately,thusspeedinguppagedisplay. But,whetherthe
thatusesheuristics(suchasthoseusedbyAdBlockPlus[1]
selectedadhasbeenprefetchedornot,theextensiondown-
and RequestPolicy [36]) to disable tracking to the extent
loadsthelistedadsthatarenotalreadyprefetchedtoavoid
possible.
informationleakagetothead-network.
Another issue is network bandwidth. While the big ad-
Ad blocking. While add-ons that block online ads – pri-
networksserveadsfromtheirowncontentdistributionnet-
marily Adblock Plus – have vocal users and advocates,
works(CDNs),thesmalleronesbuyservicesfromexisting
theseusersareatinyminority: under10millionasofthis
CDNs. Consequently,theextratrafficgeneratedbyAdnos-
writing[2],outofaround300millionusersofFirefox,ac-
ticcouldhaveanon-trivialfinancialimpactonthesmaller
cordingtoMozilla[43]. Perhapsonereasonthatadblock-
ad-networks. Onewaytoremedythisistoassumethatthe
ingisnotmorewidelyusedisthatusersfindbenefitinview-
CDN is not colluding with the ad-network. The browser
ingads. Adnosticcancatertothispragmaticmajoritywith-
could then receive the list of ads from the ad-network, but
outcompromisingprivacy.
only request from the CDN the ad that will be displayed
to the user. This will greatly reduce the network band-
widthandlatencyofrunningAdnosticwhilekeepingthead- Click fraud. In our architecture the initial interaction
networkinthedarkastowhatadwasdisplayed. TheCDN with the ad-network is unchanged. Hence, online click-
could be contractually obligated to not share the choice of fraud detection mechanisms should continue to work un-
ad with the ad-network. Note that the CDN itself can de- changed. Thisiscriticaltoourdesign. WeexplaininSec-
termine the ads served to the user, but it has no financial tion 5 that offline methods (i.e. methods that credit an ad-
incentivefordoingso,giventhatitisprohibitedfromsell- vertiserincaseaclickislaterdeemedfraudulent)alsowork.
ing this data back to the ad-network. This mechanism is
optional, but it may serve as a reasonable compromise be- 4.1 Malice
tweenprivacyandoperationalconstraints.
Can Adnostic be used by malicious parties to infer user
interests? Weconsidertwoattacksandexplainhowwead-
Effectiveness of this form of behavioral advertising.
dressthem.
Since the ad-network only sends a small number of ads
to the browser, there is a risk that none of the transmitted
ads match the precise user interest. For a given interest- Fraudulent clicks with active content. A malicious ad-
segmentation system, the ad-network needs to send only network who wishes to learn user interests could provide
oneadpersegmenttocoverthespectrumofinterests. Our adstothebrowserandthenuseJavascriptintheenclosing
survey of existing OBA systems (Section 2.1) shows that pagetoclickonwhicheveradwaspresentedtotheuser.The
current systems use between 25 and 100 segments, which resultingHTTPrequestsenttothead-networkwouldreveal
givesanupperboundonthenumberofadssent. Ifwefur- informationabouttheuser’sinterests. Thisisnotlimitedto
therassumethatmostusershavetwoormoreinterests,the ad-networks;anysitetheuservisitscouldtrythis.
numbercanbebroughtdownfurtherwhilestillretaininga Thisattackismitigatedbystandardclick-frauddefenses.
highprobabilityofmatchingauserinterest. Thebrowserrenderstheselectedadinaniframewithadis-
Another possible drawback in terms of effectiveness is tinctorigin. Bythesameoriginpolicy, theenclosingpage
theaccuracyofclassifyinguserbehaviorinabrowser-based hasnovisibilityintotheinnerstructureoftheiframeandis
model. In Section 3.1.2 we discussed how browser-based prevented from clicking on elements in the iframe. While
behavioral profiling can capture most of the nuances that thisworkswellfortextandimageads,adsthatcontainac-
areemployedtoday. However, ourcurrentimplementation tivecontent(suchasFlashads)areaproblemsincetheadcould click on itself. As a result, Adnostic may need to for any scalar c. Many additively homomorphic encryp-
block ads containing active content. Similarly, clickjack- tion systems exist; we will use a system based on ElGa-
ing[22]isaconcern;itwillneedtobeaddressedbywhat- malencryptiononellipticcurves,asitisconceptuallysim-
ever browser mechanism is eventually adopted to prevent plest. InthisversionofElGamal,toencryptasmallinteger
clickjacking. m ∈ {0,...,b}weencodemasagroupelementbycom-
Despite the same origin policy, the enclosing page has puting mˆ ← mP for some generator P and then encrypt
accesstotheheightandwidthoftheiframe. Therefore,itis mˆ withtheElGamalsystem. Theresultingsystemisaddi-
essentialthattheiframedimensionsareindependentofthe tivelyhomomorphic. Sincemessagesaresmall,decryption
adbeingpresentedintheiframe. isdonebyfirstdoingElGamaldecryptiontoobtainmˆ and
thencomputingdiscrete-logofmˆ toobtainm.
Social engineering attacks. A malicious advertiser who We assume that each ad at the ad-network is identified
wishes to learn user interests could provide an ad whose byanadID.Alongwitheachad,thead-networkwillstore
topictagis“wristwatches,”buttheaditselfsays“clickhere in its database an encrypted counter, denoted by C ID. The
to get five dollars.” A user who is fooled into clicking on encryptedcounterismanagedasfollows.
theadrevealstotheadvertiserthatheisinterestedinwrist
watches. Ofcoursetheuserdoesnotgetthefivedollars. Initialization. At the beginning of the billing period —
There are a number of defenses against this. One op- sayatthebeginningofthemonthorwhentheadisfirstup-
tion is to rely on ad filtering at the ad-network. Mali- loadedtothead-network—theencryptedcounterisinitial-
cious ads are quickly becoming a significant concern for ized to zero. That is, the ad-network sets C ← E(pk,0)
ID
ad-networks [40]. Microsoft, for example, recently filed forsomepublickeypkwhichwillbediscussedlater.
suiteagainstfivead-networkswhoseadinventoryhappened
to include malicious ads. To combat malicious ads, many Ad insertion. When the Adnostic protocol runs, the ad-
ad-networks apply a filtering process before accepting an network chooses n ads to send to the browser. It remem-
ad. The social engineering ads discussed in the previous berstheIDsoftheadschosenandsendsthesenadstothe
paragrapharelikelytobeidentifiedbythisprocessandre- browserasanorderedset. Italsosendsthepublickeypkto
moved. Similarly, theseadscanbequicklyremovedinre- thebrowser. Hence,thedatasenttothebrowserconsistsof
sponsetousercomplaints.
(cid:0) (cid:1)
pk, ad , ad , ...,ad
Anotherpotentialdefenseistoaddrandomnoise. With 1 2 n
somelowprobability,Adnosticcouldpresenttotheuserads
Thebrowserchoosesanadtodisplaytotheuser. Itthen
thatareunrelatedtohisinterests. Asaresult,themalicious creates a binary vector v¯ = (v ,...,v ) ∈ {0,1}n that
1 n
advertiser cannot be certain that the victim is interested in
representswhichadwaspresentedtotheuser. Thatis, the
wristwatches.
vector v¯ has n components where all are 0 except for the
onecomponentcorrespondingtothedisplayedadwhichis
5 Billingandaccounting setto1. Forexample,ifadnumber2waspresentedtothe
userthenthevectorwouldbe(0,1,0,0,...,0).
Accountinginthe“chargeperclick”modelremainsun- Next, the browser encrypts each component of v¯ using
changed: onceusersclickonanadtheyaredirectedtothe pktoobtainavectorofciphertexts
advertiser’ssite,possiblythroughthead-network,whereac- (cid:0) (cid:1)
E(pk,v ), ..., E(pk,v ) .
1 n
countingtakesplace.
Accounting in the “charge per impression” model is It sends to the ad-network this vector along with zero-
more challenging. Although n ads are pushed to the knowledge proofs of the following facts: first, for i =
browser, onlyoneadispresentedtotheuserandtherefore 1,...,nthequantityv iseither0or1,andsecond,thesum
i
onlyoneofthenadvertisersshouldbechargedforthead.
(cid:80)n
v is 1. More precisely, the zero-knowledge proofs
i=1 i
Weneedtoaddressthequestionofhowthead-networkcan showthatforalli=1,...,ntheciphertextE(pk,v )isan
i
chargethecorrectadvertiserwithoutknowingwhichadwas
encryptionof0or1andthattheciphertextE(pk,(cid:80)n
v )
i=1 i
displayed. isanencryptionof1. Notethatthead-networkcanusethe
We describe a cryptographic solution based on an
homomorphicpropertytobuildE(pk,(cid:80)n
v )itselffrom
i=1 i
additively homomorphic encryption and efficient zero- thegivenvectorofciphertexts.
knowledge proofs. Recall that in a homomorphic encryp- Theproofsconvincethead-networkthatthevectorv¯is
tion system, anyone given the public key pk and cipher- a zero vector with only one non-zero element equal to 1.
texts E(pk,x ) and E(pk,x ), can create the ciphertext Similar zero-knowledge proofs are needed for homomor-
1 2
E(pk,x + x ) without knowledge of x or x . Simi- phic voting schemes and an example zero-knowledge pro-
1 2 1 2
larly,givenpkandE(pk,x),anyonecancreateE(pk,c·x) tocol for this task is provided in Sections 2.6,3,4 of [12].Forastandardsecuritylevel(e.g. 256-bitellipticcurve)the be managed by the advertiser. As part of decrypting
totallengthoftheproofsis288·n+128bytes.Forn=30, thecounter,theadvertiserwillprovidethead-network
forexample,theproofsareabout9KBintotallength. withazero-knowledgeproofthatdecryptionwasdone
Once the ad-network receives the vector of n cipher- correctly.
(cid:0) (cid:1)
texts E(pk,v ), ...,E(pk,v ) along with the zero-
1 n We believe this solution is unworkable in practice
knowledge proofs, it checks the proofs and rejects the re-
since there is a strong incentive for the advertiser to
sponseiftheproofsareinvalid. Inthiscase,thebrowseris
colludewiththead-networkandfrequentlydecryptthe
not following the protocol and none of the advertisers are
countertolearnwhichadswereservedwhere.
chargedfortheadimpression.
Iftheproofscheckout, thenthead-networkknowsthat
Thedifficultywithultralow-ratecampaigns. Consider
thevectorcorrectlyrepresentsasinglead. Itmultipliesthe
anadthatisrarelysentout,sayitisonlysentouttooneuser
vector by the scalar c representing the cost of the impres-
duringanentirebillingcycle. Let’scallthatuserAlice. If
sion. Theresultisavector
attheendofthebillingcycletheencryptedcounterforthat
(cid:0) (cid:1) ad is 1, the ad-network learns that the ad was presented to
E(pk,c·v ),...,E(pk,c·v ) .
1 n
Alice and therefore Alice is interested in the topic of that
Allthesequantitiesareanencryptionofzeroexceptforone ad.
componentwhichisanencryptionofc. This extreme example shows that ultra low-rate cam-
The ad-network next uses the additive homomorphic paignscanrevealuserintereststothead-network. Asimple
property to add the encrypted values to the encrypted solutionistoensurethattheTTPdoesnotsendlowcounter
counter for each ad. That is, for i = 1,...,n the cipher- values back to the ad-network. For example, the TTP can
textE(pk,c·v )is“added”toC whereID istheIDof add low variance noise to the decrypted counter or it can
1 IDi i
thei-thad. roundthedecryptedvaluetoanacceptablegridpoint.
The end result of this process is that the quantity c is
added to the counter of the ad displayed to the user. The Advertisingbudgets. Whenlaunchingadcampaigns,ad-
value of all other counters is unchanged (although the ci- vertiserstypicallyspecifyamaximumbudgetforthecam-
phertext representing this value is changed for all coun- paign. Whenthebudgetisexceeded,nomoreadsfromthe
ters). Security of the public-key system ensures that the campaign are displayed. Our encrypted counter approach
ad-networkdoesnotknowwhichcounterwaschanged. appears to prevent the ad-network from telling when the
campaignbudgetisexhausted.
Settlement. Finally, at the end of the billing period the This issue can be addressed by estimation. If the cam-
ad-network needs to charge the advertiser for all the im- paignbudgetisB thead-networkcanestimatehowlongit
pressionstheadgenerated. Todosoitwillneedtodecrypt will take until the budget runs out. At the end of that pe-
the encrypted counter associated with all ads belonging to riod it would ask the TTP to decrypt the counter to obtain
thisadvertiser. Therearetwo options, ofwhich thefirstis theaccuratebillingstatement(subjecttothelownoisedis-
ourpreferredapproach. cussed in the previous paragraph). The ad-network credits
theremainingbudgettotheadvertiser,oracceptsthelossif
• Have a trusted third party (TTP) decrypt the counters itunderestimatedtherateatwhichthebudgetwillbeused
forallads. HeretheTTPismostlyofflineandisonly up.
contactedonceperbillingcycle. Thesecretkeycorre-
spondingtothepublickeypkisheldattheTTP.The 6 Implementation
ad-networkwillneedtosendtheencryptedcountersto
theTTPattheendofeachbillingcycle. TheTTPde-
ThecurrentimplementationofAdnosticconsistsoftwo
cryptsandsendstheresponsetothead-network, pos-
modules. Theuserprofilingmodulemonitorsbrowsingac-
siblyalongwithazero-knowledgeproofshowingthat
tivitytobuildalistofuserinterests. Theadrenderingmod-
decryptionwasdonecorrectly. Playingtheroleofthe
uleselectsadsbasedontheuserprofileandinsertstheminto
TTPwouldfitinwiththebusinessmodeloforganiza-
Adnostic compliant web pages. It can be downloaded as a
tions such as Verisign. To avoid over-reliance on any
Firefoxextensionathttp://crypto.stanford.edu/adnostic/
oneparty,theroleoftheTTPcanbesplitintoak-out-
of-nsystemusingthresholdcryptography.
6.1 UserProfiling
• Have the advertiser decrypt counters belonging to its
ads. In this case we would need a separate public Each time the user visits a web page, Adnostic extracts
key pk for each advertiser and the secret key will keywordsfromthepagemeta-data(keywords,description,title) and URL. This list of keywords is then used to re- “interests,” “interested,” and “interesting” all result in the
trieve interest categories related to the page content. Once stem“interest.” Thus,weconverteachentryintoa“bagof
thelistofcategoriesrelatedtoapageisestablished,thelist words”derivedfromthetitleandthetags.
is stored via the Firefox tagging system. Therefore, when Similarly, we convert each Google Ads Preferences
a user re-visits a page, interest categories are directly re- (sub)-category into a bag of words; we include all of the
trievedfromtheFirefoxTagdatabase. parent categories in deriving the bag of words for a cate-
Thecategoriesderivedfromallthepagesvisitedareag- gory. For example, Beauty & Personal Care → Spas &
gregatedintoacontinuallyupdatedoverallinterestprofile. Beauty Services → Massage Therapy is converted into the
Pagesareweightedunequally;threeparametersareusedto set {beauty, care, massage, personal, services, spas, ther-
deriveaweight: numberofvisits,numberofclicksandthe apy}. Stemming is applied here as well. In the following
pageviewingduration. discussion,tagsandcategory-wordsareimplicitlyassumed
Inthecurrentversionoftheextension, thecategorylist tohavealreadybeenstemmed.
weuseisderivedfromGoogleAdPreferences. Therefore, The next step is the key to the algorithm: we create a
the profile established by Adnostic could be exported to matrixofcosine-similarityvaluesbetweeneachofthemost
serve ads on the Google Ad Network. We now describe common 20,000 tags on delicious.com and each word that
ourcategorizationalgorithm. appears in any of the Google Ads Preferences categories
(there are around 700 distinct category-words).3 Cosine
6.2 Webpagecategorization: precomputation similarity is a simple and robust measure of similarity be-
tween two multi-dimensional vectors [42]. We derive bi-
naryvectorsfortags/category-words, witha1correspond-
Google Ad Preferences uses a 3-level hierarchical cate-
ingtoeachentrycontainingthattagorwordand0foreach
gorizationschemewitharound600categoriesoverall. Ap-
entrythatdoesnot. Wethenusecosinesimilaritytoquan-
pendixAliststhetop-levelcategoriesaswellasthesubcat-
tifytheco-occurenceoftwoconcepts(tags/words)ondeli-
egoriesofoneofthetop-levelcategories.
cious.com.
Recall that our goal is to map keywords extracted from
Given this pre-computed matrix of cosines, computing
webpagesintooneormoreofthesecategories. Toaccom-
the categories for a list of keywords (obtained from a web
plishthis, weusea“folksonomy,” specifically, acorpusof
page) is straightforward. Let us define the similarity be-
tagsderivedfromdelicious.com,asocial-bookmarkingsite.
tweenthekeyword-listKandacategoryCasthemeanco-
Delicious.comexportsafeedofsite-widebookmarkingac-
sinesimilaritybetweeneachkeywordinKandeachwordin
tivity and tags in the form of a real-time RSS feed. We
C.ThesimilarityscoresbetweenKandeachoftheroughly
retrieved this feed continuously for a period of around 10
600categoriesarecomputed,andthetop5categoriesalong
days, yielding 1.25 million entries. Each entry consists of
with their scores are returned. If only top-level categories
theidentityoftheuserwhocreatedthebookmark,thecre-
areneeded,thenscoresofthedescendantcategoriesofeach
ationtimestamp,theURLandtitleofthebookmarkedpage,
top-levelcategoryareaggregated.
andthetagsassignedbytheuser. Folksonomiesareanac-
Amanualexaminationoftheresultsshowsthatthecat-
tive area of research in the semantic web, information re-
egorizationisalmostalwaysaccurate; weareinvestigating
trievalanddata-miningcommunities[37,23],andtherefore
waystoassessingtheaccuracymoreformally.
wearemakingourdatasetavailabletootherresearchersat
http://crypto.stanford.edu/adnostic/.
6.3 In-browsercategorization
Folksonomies are well-suited as corpora in information
retrieval:theyallowharnessingmanualeffortwithoutmon-
etary expense, and they stay up-to-date, quickly evolving When Adnostic is downloaded, it comes built-in with
theabilitytocategorizenewwordsintroducedintothepop- the list of categories and the cosine-similarity matrix de-
ularlexicon. Theusefulnessoffolksonomiesinonlinead- scribed above, but not the folksonomy database. As long
vertisinghasbeenexploredbyauthorsatYahooResearch, asthecosine-similaritymatrixisavailable,theoriginaltag
who propose using co-occurrences of tags to map search databaseisnotrequiredinordertocarryoutthecomputa-
keywords to advertisements [10]. Our solution is similar, tions. An update to the folksonomy results in an updated
andisdescribedbelow. matrix, and is distributed to users as an update to the ex-
Fromeachentry(i.e.,delicious.combookmark),weex- tension itself. The key bottleneck, then, in terms of the
tractthetitleofthebookmarkedpageandthesetoftagsas- download/on-disksizeis thespacerequirementofthe ma-
signedbytheuserondelicious.com. Next,weapplystem- trix.
mingtoeachtagandeachwordinthetitle. Stemmingisa
3Recallthatthereareabout600categories.Mostcategorieshavemul-
naturallanguageprocessingtechniquethatturnseachword
tiplewords, andeachwordoccursinmultiplecategories, sothereisno
intoitswordstem[44]. Forinstance, thewords“interest,” relationshipbetweenthetwonumbers.Recall that the matrix consists of 20,000 rows and 700 toavoid“saturation.”
columns. However, the matrix is sparse; therefore it can
Thelevelofexpressivenesstoallowisatrickytrade-off.
be compressed to less than 1 megabyte. We consider this Atoneextreme,onemightimaginesupportingaquerylan-
anacceptableoverheadtotheAdnosticdownloadsize;fur-
guage that allows essentially arbitrary computations over
ther, the small size allows the matrix to be stored entirely
theuser’sbehavioralprofileandhistoryofadimpressions.
in memory when Adnostic is active, making accesses very
Thisisriskyforanumberofreasons,includingthefactthat
fast.
it makes privacy breaches resulting from the user clicking
Finally, there is another approach that we have not yet onadspotentiallymuchmoreserious.
investigatedthatcanbeusedtoaugmentourcategorization
Another extreme is to allow each ad to belong to a
algorithm: download a list of pre-categorized URLs, and
category, and allow no other customization: the browser
use it to simply look up the categories. The folksonomy-
pickstheadmostcloselymatchingtheuser’sprofile(possi-
basedcategorizationalgorithmisappliedonlyasafall-back
bly with some randomization), and all other heuristics are
iftheURLlookupfails.
implemented by the browser with no input from the ad-
At first glance, it might appear that such an approach
network. Thisapproachobviouslyleadstoapooraccuracy
wouldresultinahugedownloadsize,butwemustkeepin
oftargeting.
mind that a small fraction of all the URLs account for the
Weproposeamiddleground. Thead-networksendsthe
majority of visits. This can be quantified using the deli-
followingparametersalongwitheachad1)alistofbehav-
cious.com database: the top 30,000 most frequently book-
ioralcategories,2)ascorerepresentinghowrelevantthead
markedURLsaccountfor630,000entries,orabouthalfof
is to the page, and 3) for each extension (see below), any
thetotalof1.25million.AssumingthattheURLsarebook-
numericalparametersthattheextensionaccepts.
marked on delicious.com with the same relative frequency
with which they are visited, roughly half of page views Thebrowserderivesacombinedscoreforeachadbased
would result in a hit. A pre-computed category lookup is thescoresentbythead-networkandonhowwellthelistof
potentiallymoreaccurateandalsosavescomputationonthe categoriesmatchtheuser’sprofile. Sincetherearemultiple
client,andisthereforeworthinvestigating. categories per ad, the number of categories can be signifi-
cantlygreaterthanthenumberofads,whilestillachieving
6.4 Adrendering afullcoverageoftheinterestspace. Extensionsaremodifi-
cationstothebasictargetingalgorithm,andneedtobeex-
plicitlyencodedintoAdnostic.Currentlytheonlyextension
We now describe the protocol by which a list of ads
wehaveidentifiedisfrequencycapping,andthead-network
is sent to the browser, and also the process by which the
isallowedtospecifythefrequency.
browserselectsanddisplaysanad.
Adnostic exposes an object adnostic in the global Wearenowreadytodescribetheinputsandimplemen-
Javascript namespace. To test if the user has Adnostic in- tationofadnostic.render(). Foreachad,theassoci-
stalled, the web page checks for the existence of the vari- ated attributes are an id, the URL, and the targeting inputs
able. Thisissimilartothecurrentpracticeforcheckingfor described above. There are also the height and width pa-
thepresenceofJavascriptlibrariessuchasjQuery. rameters,whichneedtobethesameforallads,forreasons
TheAPIthatAdnosticexposesconsistsofonefunction, explained in Section 4. Finally, there is the cryptographic
adnostic.render. Before we describe the arguments keymaterialrequiredifthebillingprotocolofSection5is
tothisfunction,letusbrieflydiscusshowwecanmapcur- used.
renttargetingalgorithmstoabrowser-basedsystem. ThebrowsercreatesnDOMelements,oneforeachad,
The inputs to the ad targeting algorithm in current sys- withthecorrespondingURL,heightandwidthparameters.
tems consists of inputs from the advertiser, the publisher, An ad is then selected as described above and all the ad
andtheuser. Thus,inanAdnostic-likesystem,weneedto DOM elements except the selected one are hidden. Thus,
encapsulatethefirsttwoinputsinaformthatcanbesentto alltheadsaredownloaded,butonlyoneisdisplayedtothe
thebrowser. Theremustalsobesomewaytospecifyhow user. As discussed in Section 4.1, a malicious ad-network
tocombinethesewiththeuser’sinputs. couldattachascripttoreportthevisibilitystateofeachen-
Letusexaminetheuser-sideinputsinmoredetail. This closedelementandfindoutwhichadwasdisplayed. Such
ofcourseconsistsofthebehavioralprofile,butinaddition, script could be embedded either in one of the ads sent to
itmightalsobeusefultoincorporateinformationaboutthe AdnosticorinanyotherDOMelementthatthead-network
history of ads shown to the user. The reason for this is to couldplaceontheenclosingpage. Topreventthis,ourex-
enable heuristics that are used in current systems such as tensionplacestheseDOMelementsintheirownoriginand
frequency capping, which refers to limiting the number of blocksexecutionofallactivecontentinthencreatedDOM
impressionsofthesameadinagiventime-periodinorder elements[19].6.5 Evaluation opens twice more connections and is thus more impacted
byRoundTripTime(RTT)andbrowserconnectionlimits.
We first evaluate the cost of Adnostic in term of adver-
tisementrenderingdelayandthenobserveitsimpactonthe 6.5.2 Pageloadingtime
pageloadingtime. Somewebsitespublishmanyads,make
Figure2providesacomparisonofthepageloadingtimeon
intensiveuseofscriptsandincludemanyexternalelements
the four different websites. As we expected, Adnostic im-
thattaketimetoload. AlthoughAdnosticincreasesloading
pactonpageloadingdelayisrelativelylowcomparedtothe
delay, its relative cost might be negligible on heavy web-
impactonadrenderingdelay. Onmostwebsite, usingAd-
sites and more significant on lightweight websites. To re-
nostictodisplaytextadswillnotnotablydegradebrowsing
flectthisheterogeneity,fourwebsiteswithdifferenttypeof
experienceif n isset to10 orless. Furthermore, forWeb-
adsareconsideredinthisevaluation:
sites1,3and4,Adnosticconfigurationhasalsolittleimpact
• Website1(SlashDot),isalightweightwebsitepublish- onthepageloadingdelay.
ingonaveragethreebanners. The noticeable exception is Website 2 which includes a
lotofexternalcontentandpublishesmanyads. Inorderto
• Website 2 (ReadWriteWeb), is a heavy website pub-
loadthepage,thebrowseropensmanyconnectionsthusin-
lishingonaveragethirteenbannersandincludingcon-
creasing the delay. In fact, to download the content of the
tentfromexternalwebsites.
thirteen ads, Firefox should open one hundred and thirty
connectionsifn=10andtwohundredandsixtywhenn=20.
• Website3(SecretSoftwareClub),isaverylightweight
Recall that the standard configuration of Firefox 3.5 lim-
websitepublishingonlythreetextads.
itsthenumberofopenedconnectionsto30withalimitof
• Website 4 (TheRegister), is a website publishing text 15connectionperserver,manyconnectionshavetobede-
adsandbanners. layeduntilapreviousconnectioncloses. Theselimitshave
a greater impact on Adnostic configurations with high val-
ThreedifferentconfigurationsofAdnostic,varyingprivacy uesofn.
and ads, are compared to the current targeting model. To Increasingthelimitonthenumberofsimultaneouscon-
carry out this experimentation, we replace each link to an nectionswouldimproveAdnosticperformancebutalsode-
ad-network by n iframes, each iframe downloading an ad grade the general browsing experience. To provide a sig-
fromanexternalserver. WhenapageisloadedbyAdnostic nificantperformanceimprovement,thenumberofsimulta-
thecontentofthead-networkscriptisreplacedbytheAd- neous connections would have to be very high. A better
nostic rendering script which injects n iframes in place of alternativewouldbetomodifybothAdnosticclientandad
thead-networkad. Thenumberofiframesandtheircontent server to fetch the n ads via a single HTTP request. Such
vary in the evaluated configurations. In the first evaluated anapproachwouldalsoreducetheimpactofround-triptime
configuration,eachadisreplacedbytenbannersof50kB. onpageloadingandresourceconsumptionontheclientand
Thetwootherconfigurationsdownloadrespectively10and server. Themaindrawbackofthisapproachistheneedto
20 Text Ads. Each evaluation is the result of at least 100 modifytheadserver.
experimentations; results are illustrated with a 95 percent
confidenceinterval.
7 Alternativeprivacyarchitectures
6.5.1 Adrenderingtime
Adnosticisdesignedtoprovidespecificprivacyguaran-
Figure 1 depicts the average ad rendering time on the four tees. Herewebrieflydiscussaspectrumofotherarchitec-
websites. As one might expect, Website 3 achieves the turesforbehavioraltargetingdependingonwhatcategories
fastest rendering timesince it publishes onlytext ads. Ad- of user data are revealed, and to which parties. These are
nosticimpactonaverageadrenderingtimeissignificantin arrangedinthedecreasingorderofprivacyviolation,andin
everyconfigurationandoneverywebsite. Unsurprisingely, theincreasingorderofcomplexityofthesystemrequiredto
ads are rendered faster if Adnostic just downloads 10 text implementthem.
ads and increasing n from 10 to 20 significantly increases
• Revealtheclickstream. Thisisthecurrentparadigm.
the average delay. When banners are displayed instead of
Thead-networkaggregatestheuser’sclickstreamand
textads,averagerenderingtimealsoincreasessincethesize
usesittocomputethebehavioralprofile.
of the content to be downloaded is multiplied by at least
ten. Infact,adrenderingdelaysaresimilarwhenAdnostic None of the following architectures prevents the ad-
downloadstenbannersinsteadoftwentytextads.Although networkfromlearningtheclickstream;theymerelyre-
the former configuration downloads more bytes, the latter movetheneedtodoso.AswediscussinSection4,en-Figure1.Averageadrenderingtime
“Cookiebasedtargeting”referstothecurrentdeployedtrackingparadigm.
Percentagesareshownincomparisontocookiebasedtargeting.
Figure2.Averagepageloadingtimeforcementofnon-trackingbythead-networkcanonly Juels [25] proposed a personalized advertising delivery
bedonecontractually. protocol based on Private Information Retrieval (PIR) and
mix networks. With this scheme, advertisers furnish a ne-
• Revealthebehavioralprofile.Thebrowsercomputes gotiantfunctionf that,foreachtypeofprofile,assignsthe
thebehavioralprofile, asdoesAdnostic(Section6.1).
best corresponding ads in the advertiser database. In the
However,witheveryadrequestthebrowsersendsthe
most sophisticated version of the scheme, every customer
profile to the ad-network in an HTTP header (similar
has a public/ private key pair and publishes its ad request
tosendingacookie.) Thebandwidthrequirementsare
onabulletinboard. Advertiserserversapplyamixnetwork
minimal: evenwith1,000categories,itisonlyabouta based on m servers, that is used to retrieve each ad with
kilobyteofdata. Furtheroptimizationispossible: the (m/2,m)-group-privacy. Since the scheme makes exten-
profileneedonlybesentoncetoeachad-networkper
siveuseofcomputationallyintensivecryptographicopera-
timeperiod(sayaweek).
tions, it cannot be used to retrieve ads on-the-fly. Instead,
theauthorproposestoprefetchanadvertisementandtowait
• RevealadimpressionstotheCDN.Thead-network
untiltheuservisitsthepageagaintodisplayit.
offersaselectionofadstodisplay,butisnottoldwhich
AdRosa [27] is an advertisement system that displays
adwasselected. ThebrowsertellstheCDNwhichad
personalized ads on web portals. Personalization is based
wasselectedanddownloadsthatadfromtheCDN.If
on user’s behavior during an active session. Because it is
the CDN and the ad-network are non-colluding enti-
based on active session, the AdRosa system does not re-
ties then the privacy guarantee is as strong as the fol-
quire cookie based tracking. However, this session man-
lowing item (i.e., Adnostic), but is considerably more
agementisonlydesignedforwebportalsandcannotbeex-
efficient. Careisneededintheimplementationtoen-
tendedtosupportad-networks. Theoccurrenceoftermsin
surethatnothingmorethanadimpressionsareleaked
titles, body and description field of a page are counted to
totheCDN–specifically,therefererheadermustnot
infer the content of the page. Similarly, the content of an
betransmitted.
advertisement is retrieved by analyzing the content adver-
• Revealadclickstothead-network(andadvertiser). tiser’swebsite. Basedonthecontentofthepagevisitedby
ThisistheAdnosticapproach. Adimpressionsarenot a user, AdRosa establishes the profile of the current active
revealedbecausethebrowserchoosestodownloadall user. When a user visits a page, the portal provides a list
the ads that the ad-network offers, but only displays ofadsrankedaccordingtouser’sprofile, pagecontentand
oneofthem. ad content. Hence, the system implements behavior and
content-basedtargeting,butdoesnotprotectuserprivacy.
• Revealnothing.ThisistheapproachtakenbyPrivad, TrackMeNot [24] is a tool used to hide user queries to
whichwediscussinSection8. searchenginesbyissuingmanyfakequeries. Inprinciple,a
similarapproachcanbeusedtodefeatbehavioraltracking:
8 Relatedwork duringausersessionabrowserextensioncanvisitrandom
pages unrelated to the user’s interests. On the other side
of the spectrum, IE8’s InPrivate blocking can also defeat
An independent project called Privad [21] has similar
tracking, but potentially at the expense of breaking many
goals as Adnostic but is designed quite differently. Privad
web pages: publishers have no incentive to provide their
introducesfourentities: client, monitor, dealerandbroker
contentunlesstheycanchargeforanadimpression.
(that we called the ad-network). The client builds a user
Faraht [17] describes a method for limiting the number
profile and, according to this profile, requests relevant ads
ofadspresentedtotheuserinausersessionwithoutrelying
from the broker. The dealer anonymizes the client to pre-
on cross-domain cookies. Instead, the approach uses page
vent the broker from identifying the client. Communica-
transition probabilities to limit the total number of viewed
tions between the client and the broker are also encrypted
adsinexpectation.
with the broker’s public key and the dealer cannot see ads
thataredownloaded,viewedorclickedonbytheuser. The
9 Conclusions
monitorisinstalledonuser’scomputerandverifiesthatno
information is sent by the client through a covert channel.
WhereasAdnosticcombinestechnologicalandpolicybased Our work exposes many of the issues that must be ad-
solutions,Privadisapurelytechnologicalapproachprivacy dressedinanyattempttoreconcilethetensionbetweenbe-
preserving targeted advertising. Consequently, Privad can havioral targeting and user privacy. Our primary design
nottrustad-networksandanonymizeseverypieceofinfor- goal is to support the wildly successful economic model
mationsentbytheclient. Thisanonymizationimpactsper- currently used by ad-networks. In doing so we had to ad-
formanceandmakesclick-fraudhardertodetect. dressissuesofbilling,advertisingbudgets,networklatency,targetingefficacy,maliciousbehavior,andmanyothers.We Entertainment→ComicsandAnimation
proposedacryptographicbillingsystemthatislikelytoplay Entertainment → Comics and Animation → Anime
aroleinanyproposalforprivacy-preservingbehavioralad- andManga
vertising. Entertainment→ComicsandAnimation→Cartoons
TheAdnosticsystemneednotreplacetheexistingadin-
Entertainment→ComicsandAnimation→Comics
Entertainment→Dancing
frastructure. Instead, we envision that Adnostic will com-
Entertainment→EntertainmentIndustry
plement it and offer more options for publishers and users
Entertainment→FashionandModeling
in ad targeting. We hope to see further work on this topic
Entertainment→FunandTrivia
exploringotherdesignswithdifferenttrade-offs. Targeting
Entertainment→HumorandBizarre
withprivacyisanimportantproblemthatneedsmoreatten- Entertainment→HumorandBizarre→Bizarre
tionfromtheresearchcommunity. Entertainment→HumorandBizarre→Humor
Entertainment→HumorandBizarre→Paranormal
Acknowledgments. The authors would like to thank Entertainment→Movies
Entertainment → Movies → Bollywood and Lolly-
AdamBarth,ElieBursztein,CollinJackson,FosterProvost,
wood
Lynn Tao and anonymous reviewers for useful discussions
Entertainment→Movies→HorrorFilms
andsuggestions.
Entertainment→Movies→MovieMemorabilia
Entertainment→Movies→MovieRentalsandSales
A GoogleAdsPreferencescategories Entertainment → Movies → Science Fiction and
FantasyFilms
Entertainment→MultimediaContent
Top-levelcategories
Entertainment → Multimedia Content → Flash
Content
Animals
Entertainment→MultimediaContent→Podcasting
ArtsandHumanities
Entertainment→MultimediaContent→VideoClips
Automotive
andMovieDownloads
BeautyandPersonalCare
Business
ComputersandElectronics
References
Entertainment
FinanceandInsurance
FoodandDrink [1] Adblock plus: Save your time and traffic.
Games adblockplus.org/en/.
HomeandGarden
[2] Adblock plus statistics. https://addons.
Industries
mozilla.org/en-US/statistics/addon/
Internet
1865.
Lifestyles
Local [3] Online advertising. en.wikipedia.org/wiki/
NewsandCurrentEvents Online_advertising.
PhotoandVideo
RealEstate [4] Google adsense. adsense.blogspot.com/
Recreation 2009/03/ driving-monetization-
Reference with-ads-that.html.
Science
[5] AOL Advertising. Audience be-
Shopping
havior. advertising.aol.
SocialNetworksandOnlineCommunities
com/advertiser-solutions/
Society
targeting/behavioral-targeting/
Sports
audience-behaviors,2009.
Telecommunications
Travel
[6] Attributor. Get your fair share of the ad net-
work pie, 2008. www.attributor.com/
blog/get-your-fair-share-
SubcategoriesofEntertainment
of-the-ad-network-pie.
Entertainment→Celebrities
Entertainment→ClubsandNightlife [7] Audiencescience.www.audiencescience.com.[8] Inc. AudienceScience. audiencetargeting. [23] Andreas Hotho, Robert Ja¨schke, Christoph Schmitz,
com,2009. and Gerd Stumme. Information retrieval in folk-
sonomies:Searchandranking.InProc.ofTheSeman-
[9] Bluekai. www.bluekai.com.
tic Web: Research and Applications, volume 4011 of
[10] Andrei Broder, Peter Ciccolo, Evgeniy Gabrilovich, LNCS,pages411–426.Springer,2006.
and Bo Pang. Domain-specific query augmentation
[24] Daniel Howe and Helen Nissenbaum. TrackMeNot:
using folksonomy tags: the case of contextual adver-
resisting surveillance in web search, 2006. mrl.
tising. In Proceedings of the 1st Workshop on Infor-
nyu.edu/˜dhowe/trackmenot/.
mationRetrievalforAdvertising,2008.
[11] Federal Trade Commission. FTC staff report: Self- [25] A. Juels. Targeted advertising ... and privacy too. In
regulatory principles for online behavioral adver-
ProceedingsofCT-RSA2001,volume2020ofLNCS,
tising, 2009. www.ftc.gov/opa/2009/02/ pages408–424.Springer-Verlag,2001.
behavad.shtm.
[26] JupiterResearch. Measuring unique visi-
[12] RonaldCramer,RosarioGennaro,andBerrySchoen- tors: Addressing the dramatic decline in
makers. A secure and optimally efficient multi- accuracy of cookie-based measurement.
authority election scheme. In Proceedings of Euro- www.tvb.org/pdf/multiplatform/
crypt’97,pages103–118,1997. Jupiter-Research-Measuring-Unique/
Visitors.pdf,2004.
[13] Neil Daswani, Michael Stoppelman, and the Google
Click Quality and Security Teams. The anatomy of [27] P.KazienkoandM.Adamski. AdROSAadaptiveper-
clickbot.a. In Proceedings of Usenix HotBots’07, sonalizationofwebadvertising.InformationSciences,
2007. 177(11):2269–2295,2007.
[14] Doubleclick nearing privacy settlements, 2002.
[28] ClickZKevinNewcomb. Tacodaproposesbehavioral
news.cnet.com/2102-1023-871654.html.
targetingstandards. www.clickz.com/3406921,
2004.
[15] CatherineDwyer. Behavioraltargeting: Acasestudy
ofconsumertrackingonlevis.com. In15thAmericas
[29] Mozilla Labs. Weave. labs.mozilla.com/
ConferenceonInformationSystems,2009.
weave/.
[16] Exelatetargetingexchange. exelate.com.
[30] ScottJ.LeCompte. Uatracker: Trackinguser-agents
[17] Ayman Farahat. Privacy preserving frequency cap- acrosstheweb. www.ua-tracker.com/.
ping in internet banner advertising. In Proceedings
ofWWW’09,2009. [31] F. Monrose and A. Rubin. Authentication via
keystroke dynamics. In ACM Conference on Com-
[18] Fetchback. www.fetchback.com. puterandCommunicationsSecurity,1997.
[19] Displaying web content in an extension without se-
[32] Nebuad. www.nebuad.com.
curity issues. https://developer.mozilla.
org/En/Displaying_web_content_
[33] Congress begins deep packet inspection of in-
in_an_extension_without_security_ ternet providers. bits.blogs.nytimes.com/
issues. 2009/04/24/congress-begins-deep-packet
-inspection-of-internet-providers,
[20] Google. Ads preferences. www.google.com/
2009.
ads/preferences,2009.
[21] Saikat Guha, Alexey Reznichenko, Kevin Tang, [34] Phorm. www.phorm.com.
HamedHaddadi,andPaulFrancis. Servingadsfrom
[35] Foster Provost, Brian Dalessandro, Rod Hook, Xi-
localhostforperformance,privacy,andprofit. InPro-
aohan Zhang, and Alan Murray. Audience selec-
ceedingsofHotTopicsinNetworking(HotNets),New
tionforon-linebrandadvertising:Privacy-friendlyso-
York,NY,Oct2009.
cial network targeting. In Proceedings of the 15Th
[22] RobertHansenandJeremiahGrossman.Clickjacking, ACM SIGKDD International Conference on Knowl-
2008. www.sectheory.com/clickjacking. edge Discovery and Data Mining. Association for
htm. ComputingMachinery,2009.[36] Justin Samuel. Requestpolicy. www.
requestpolicy.com/. A Firefox extension
thatgivestheusercontrolovercross-siterequests.
[37] Christoph Schmitz, Andreas Hotho, Robert Ja¨schke,
and Gerd Stumme. Mining association rules in folk-
sonomies. In Data Science and Classification, pages
261–270.Springer,2006.
[38] Seth Schoen. New cookie technologies: Harder
to see and remove, widely used to track you.
www.eff.org/deeplinks/2009/09/new-cookie-
technologies-harder-see-and-remove-wide,
2009.
[39] Christopher Soghoian, Sid Stamm, and Daniel Witte.
Targeted advertising cookie opt-out (taco). taco.
dubfire.net/.
[40] Ashlee Vance. Times web ads show security
breach, 2009. www.nytimes.com/2009/09/
15/technology/internet/15adco.html.
[41] Wikipedia. Comparison of browser syn-
chronizers — wikipedia, the free encyclo-
pedia. en.wikipedia.org/w/index.
php?title=Comparison_of_browser_
synchronizers&oldid=311634379, 2009.
[Online;accessed3-September-2009].
[42] Wikipedia. Cosine similarity — wikipedia, the free
encyclopedia,2009. [Online;accessed18-December-
2009].
[43] Wikipedia. Market adoption of mozilla firefox —
wikipedia, the free encyclopedia, 2009. [Online; ac-
cessed14-December-2009].
[44] Wikipedia. Stemming — wikipedia, the free ency-
clopedia. en.wikipedia.org/w/index.php?
title=Stemming&oldid=314022163, 2009.
[Online;accessed15-September-2009].
[45] Yahoo! Ad interest manager. info.yahoo.com/
privacy/us/yahoo/opt_out/targeting,
2009.