P2P Mixing and Unlinkable Bitcoin Transactions
Tim Ruffing Pedro Moreno-Sanchez Aniket Kate
@real_or_random @pedrorechez @aniketpkateP2P Mixing
A
B
C
D
2 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomP2P Mixing
A B
B D
Mix
C C
D A
2222222 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomP2P Mixing
Confirmation
● Peers agree on the
A B
output and confirm it
B D
Mix
C C
D A
2222222 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomP2P Mixing
Confirmation
● Peers agree on the
A B
output and confirm it
P2P Trust model
B D ● No mutual trust,
no third-party routers
Mix
C C
D A
2 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomP2P Mixing
Confirmation
● Peers agree on the
A B
output and confirm it
P2P Trust model
B D ● No mutual trust,
no third-party routers
Mix
C C
D A
2 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomP2P Mixing
Confirmation
● Peers agree on the
A B
output and confirm it
P2P Trust model
B D ● No mutual trust,
no third-party routers
Mix
● Anoymity set is the
C C
set of honest users
D A
2 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomP2P Mixing
Confirmation
● Peers agree on the
A B
output and confirm it
P2P Trust model
B D ● No mutual trust,
no third-party routers
Mix
● Anoymity set is the
C C
set of honest users
D A
2 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomP2P Mixing
Confirmation
● Peers agree on the
A B
output and confirm it
P2P Trust model
B D ● No mutual trust,
no third-party routers
Mix
● Anoymity set is the
C C
set of honest users
● Protocol must
terminate in the
D A
presence of f < n - 1
malicious users
2 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomState of the Art (I)
3 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomState of the Art (I)
Traditional mixnet run by all peers
3 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomState of the Art (I)
Traditional mixnet run by all peers
● Dissent (shuffle protocol) [CCS 2010],
CoinShuffle [ESORICS 2014]
3 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomState of the Art (I)
Traditional mixnet run by all peers
● Dissent (shuffle protocol) [CCS 2010],
CoinShuffle [ESORICS 2014]
3 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomState of the Art (I)
Traditional mixnet run by all peers
● Dissent (shuffle protocol) [CCS 2010],
CoinShuffle [ESORICS 2014]
● O(n) rounds in optimistic case
3 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomState of the Art (I)
Traditional mixnet run by all peers
● Dissent (shuffle protocol) [CCS 2010],
CoinShuffle [ESORICS 2014]
● O(n) rounds in optimistic case
● O(nf) rounds for f malicious peers
3 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomState of the Art (I)
Traditional mixnet run by all peers
● Dissent (shuffle protocol) [CCS 2010],
CoinShuffle [ESORICS 2014]
● O(n) rounds in optimistic case
● O(nf) rounds for f malicious peers
Traditional mixnet solution does not scale!
3 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomState of the Art (II)
4 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomState of the Art (II)
Dining cryptographers’ networks (DC-nets)
4 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomState of the Art (II)
Dining cryptographers’ networks (DC-nets)
4 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomState of the Art (II)
Dining cryptographers’ networks (DC-nets)
● Hope for O(1) rounds in the optimistic case
4 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomState of the Art (II)
Dining cryptographers’ networks (DC-nets)
● Hope for O(1) rounds in the optimistic case
● Easy to disrupt
4 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomState of the Art (II)
Dining cryptographers’ networks (DC-nets)
● Hope for O(1) rounds in the optimistic case
● Easy to disrupt
● All approaches to solve disruption problem
suffer from drawbacks
4 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomState of the Art (II)
Dining cryptographers’ networks (DC-nets)
● Hope for O(1) rounds in the optimistic case
● Easy to disrupt
● All approaches to solve disruption problem
suffer from drawbacks
● Golle and Juels [EUROCRYPT 2004]:
Honest majority
4 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomState of the Art (II)
Dining cryptographers’ networks (DC-nets)
● Hope for O(1) rounds in the optimistic case
● Easy to disrupt
● All approaches to solve disruption problem
suffer from drawbacks
● Golle and Juels [EUROCRYPT 2004]:
Honest majority
No practical P2P mixing protocol based on DC-nets!
4 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomDiceMix
A Practical P2P Mixing Protocol based on DC-nets
25
P2P Mixing and Unlinkable Bitc Tim Ruffing – @real_
oin Transactions or_randomDC-net
[Chaum 1988]
6 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomDC-net
[Chaum 1988]
1 1
0
6 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomDC-net
[Chaum 1988]
1 + (1 + 1) = 1
1 1
0
6 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomDC-net
[Chaum 1988]
1 + (1 + 1) = 1
1 1
0
0 + (1 + 0) = 1 1 + (0 + 1) = 0
6 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomDC-net
[Chaum 1988]
1 + (1 + 1) = 1
1 1
0
0 + (1 + 0) = 1 1 + (0 + 1) = 0
1 + 1 + 0 = 0
6 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomSending Several Messages
[Bos, Boer 1989]
2 3 n
m m m ⋯ m
User 1:
1 1 1 1
2 3 n
m m m ⋯ m
User 2:
2 2 2 2
2 3 n
m m m ⋯ m
User 3: 3 3 3 3
⋮ ⋮ ⋮ ⋱ ⋮
2 3 n
m m m ⋯ m
User n: n n n n
n n n n
∑ ∑ 2 ∑ 3 ∑ n
m m m ⋯ m
i i i i
i=1 i=1 i=1 i=1
7 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomSending Several Messages
[Bos, Boer 1989]
2 3 n
m m m ⋯ m
User 1:
1 1 1 1
2 3 n
m m m ⋯ m
User 2:
2 2 2 2
2 3 n
m m m ⋯ m
User 3: 3 3 3 3
⋮ ⋮ ⋮ ⋱ ⋮
2 3 n
m m m ⋯ m
User n: n n n n
n n n n
∑ ∑ 2 ∑ 3 ∑ n
m m m ⋯ m
i i i i
i=1 i=1 i=1 i=1
7 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomSending Several Messages
[Bos, Boer 1989]
2 3 n
m m m ⋯ m
User 1:
1 1 1 1
2 3 n
m m m ⋯ m
User 2:
2 2 2 2
2 3 n
m m m ⋯ m
User 3: 3 3 3 3
⋮ ⋮ ⋮ ⋱ ⋮
2 3 n
m m m ⋯ m
User n: n n n n
n n n n
∑ ∑ 2 ∑ 3 ∑ n
m m m ⋯ m
i i i i
i=1 i=1 i=1 i=1
n
∏
(x−m ).
Newton's identities tell us the coefficients of the polynomial
i
i=1
7 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomSending Several Messages
[Bos, Boer 1989]
2 3 n
m m m ⋯ m
User 1:
1 1 1 1
2 3 n
m m m ⋯ m
User 2:
2 2 2 2
2 3 n
m m m ⋯ m
User 3: 3 3 3 3
⋮ ⋮ ⋮ ⋱ ⋮
2 3 n
m m m ⋯ m
User n: n n n n
n n n n
∑ ∑ 2 ∑ 3 ∑ n
m m m ⋯ m
i i i i
i=1 i=1 i=1 i=1
n
∏
(x−m ).
Newton's identities tell us the coefficients of the polynomial
i
i=1
→ Polynomial factorization recovers the messages.
7 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomDisruption
2 3 n
m m m ⋯ m
User 1:
1 1 1 1
2 3 n
m m m ⋯ m
User 2:
1 2 2 2
2 3 n
m m m ⋯ m
User 3: 3 3 3 3
⋮ ⋮ ⋮ ⋱ ⋮
2 3 n
m m m ⋯ m
User n: n n n n
⋯
8 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomDisruption
2 3 n
m m m ⋯ m
User 1:
1 1 1 1
2 3 n
m m m ⋯ m
User 2:
1 2 2 2
2 3 n
m m m ⋯ m
User 3: 3 3 3 3
⋮ ⋮ ⋮ ⋱ ⋮
2 3 n
m m m ⋯ m
User n: n n n n
⋯
8 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomDisruption
2 3 n
m m m ⋯ m
User 1:
1 1 1 1
2 3 n
m m m ⋯ m
User 2:
1 2 2 2
2 3 n
m m m ⋯ m
User 3: 3 3 3 3
⋮ ⋮ ⋮ ⋱ ⋮
2 3 n
m m m ⋯ m
User n: n n n n
⋯
Malicious user stays anonymous!
8 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomHandling Disruptions
9 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomHandling Disruptions
IN CASE OF
DISRUPTION
BREAK ANONYMITY
9 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomMEME
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomFlowchart of DiceMix
Generate
fresh
message
11 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomFlowchart of DiceMix
Generate
Key
fresh
exchange
message
11 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomFlowchart of DiceMix
Generate
Key
fresh DC-net
exchange
message
11 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomFlowchart of DiceMix
Generate
Key
fresh DC-net Disrupted?
exchange
message
11 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomFlowchart of DiceMix
Generate N
Key Confirm
fresh DC-net Disrupted?
exchange output
message
11 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomFlowchart of DiceMix
Generate N
Key Confirm
fresh DC-net Disrupted?
exchange output
message
Y
Reveal
secrets
11 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomFlowchart of DiceMix
Generate N
Key Confirm
fresh DC-net Disrupted?
exchange output
message
Y
Discard Reveal
messages secrets
11 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomFlowchart of DiceMix
Generate N
Key Confirm
fresh DC-net Disrupted?
exchange output
message
Y
Find and
Discard Reveal
exclude
messages secrets
disruptors
11 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomFlowchart of DiceMix
Generate N
Key Confirm
fresh DC-net Disrupted?
exchange output
message
Y
Find and
Discard Reveal
exclude
messages secrets
disruptors
11 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomFlowchart of DiceMix
Generate N
Key Confirm Missing
fresh DC-net Disrupted?
exchange output conf?
message
Y
Find and
Discard Reveal
exclude
messages secrets
disruptors
11 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomFlowchart of DiceMix
Generate N N
Key Confirm Missing
fresh DC-net Disrupted?
exchange output conf?
message
Y
Find and
Discard Reveal
exclude
messages secrets
disruptors
Success!
11 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomFlowchart of DiceMix
Generate N N
Key Confirm Missing
fresh DC-net Disrupted?
exchange output conf?
message
Y Y
Find and
Discard Reveal
exclude
messages secrets
disruptors
Success!
11 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomFreshness Is Necessary
Anonymity
Termination with Support for
dishonest majority fixed messages
12 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomFreshness Is Necessary
Anonymity
∅
Termination with Support for
dishonest majority fixed messages
12 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomFlowchart of DiceMix
Generate N N
Key Confirm Missing
fresh DC-net Disrupted?
exchange output conf?
message
Y Y
Find and
Discard Reveal
exclude
messages secrets
disruptors
Success!
14 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomFlowchart of DiceMix
Generate N N
Key Confirm Missing
fresh DC-net Disrupted?
exchange output conf?
message
Y Y
Find and
Discard Reveal
exclude
messages secrets
disruptors
Success!
14 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomCommunication Rounds (naive)
Run 1
Run 2
Run 3
15 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomCommunication Rounds (naive)
Run 1
Run 2
Run 3
4 + 4f rounds
15 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomCommunication Rounds (DiceMix)
Run 1
Run 2
Run 3
(Run 4)
16 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomCommunication Rounds (DiceMix)
Run 1
Run 2
Run 3
(Run 4)
4 + 2f rounds
16 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomPerformance
25
20
15
10
5
0
0 20 40 50 60 80 100
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_random
]ces[
emiT
Wall-clock
Computation (total)
Computation (factorization)
Number of nodes
17CoinShuffle++
A P2P Coin Mixing Protocol based on DiceMix
62
P2P Mixing and Unlinkable Bitc Tim Ruffing – @real_
oin Transactions or_randomMixing without a Third Party (CoinJoin)
Input Output
A: 1 BTC C′: 1 BTC
B: 1 BTC A′: 1 BTC
C: 1 BTC B′: 1 BTC
sig
A
sig
B
sig
C
[CoinJoin, Maxwell 2013]
19 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomMixing without a Third Party (CoinJoin)
Input Output
A: 1 BTC C′: 1 BTC
B: 1 BTC A′: 1 BTC
C: 1 BTC B′: 1 BTC
sig
A
sig
B
sig
C
[CoinJoin, Maxwell 2013]
19 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomMixing without a Third Party (CoinJoin)
Mixed list of
fresh addresses
Input Output
A: 1 BTC C′: 1 BTC
B: 1 BTC A′: 1 BTC
C: 1 BTC B′: 1 BTC
sig
A
sig
B
sig
C
[CoinJoin, Maxwell 2013]
19 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomFlowchart of CoinShuffle++
Generate
N Sign N
fresh Key Missing
DC-net Disrupted? CoinJoin
Bitcoin exchange sigs?
transaction
address
Y Y
Find and
Discard Reveal
exclude
messages secrets
disruptors
Success!
20 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomComparison of CoinShuffle++ vs. TumbleBit
TumbleBit
CoinShuffle++
(classic tumbler)
Anonymity set / payment >> 100 ~ 100
Bandwidth / payment ~ 420 bytes ~ 2250 bytes
off-chain
Total running time / payment < 5 s < 20 s
Coordination required no yes
Sequential blocks / payment 2 + 1 1 + 1
Input-output pairs / payment 4 + 1 1 + 1 on-chain
Centralization dedicated tumbler P2P with bulletin board
Collateral required yes no
performance penalty /
DoS / Sybil protection fees
fees
Confidential Transactions no yes
21 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_random
https://openclipart.org/collection/collection-detail/E/12858Comparison of CoinShuffle++ vs. TumbleBit
TumbleBit
CoinShuffle++
(classic tumbler)
Anonymity set / payment >> 100 ~ 100
Bandwidth / payment ~ 420 bytes ~ 2250 bytes
off-chain
Total running time / payment < 5 s < 20 s
Coordination required no yes
Sequential blocks / payment 2 + 1 1 + 1
Input-output pairs / payment 4 + 1 1 + 1 on-chain
Centralization dedicated tumbler P2P with bulletin board
Collateral required yes no
performance penalty /
DoS / Sybil protection fees
fees
Confidential Transactions no yes
21 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_random
https://openclipart.org/collection/collection-detail/E/12858Comparison of CoinShuffle++ vs. TumbleBit
TumbleBit
CoinShuffle++
(classic tumbler)
Anonymity set / payment >> 100 ~ 100
Bandwidth / payment ~ 420 bytes ~ 2250 bytes
off-chain
Total running time / payment < 5 s < 20 s
Coordination required no yes
Sequential blocks / payment 2 + 1 1 + 1
Input-output pairs / payment 4 + 1 1 + 1 on-chain
Centralization dedicated tumbler P2P with bulletin board
Collateral required yes no
performance penalty /
DoS / Sybil protection fees
fees
Confidential Transactions no yes
21 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_random
https://openclipart.org/collection/collection-detail/E/12858More Shuffling
Shameless Plugs
70
P2P Mixing and Unlinkable Bitc Tim Ruffing – @real_
oin Transactions or_randomValueShuffle
Confidential
ValueShuffle CoinShuffle++
Transactions
23 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomValueShuffle
Confidential
ValueShuffle CoinShuffle++
Transactions
Hides amounts in transactions and provides anonymity
●
23 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomValueShuffle
Confidential
ValueShuffle CoinShuffle++
Transactions
Hides amounts in transactions and provides anonymity
●
Users with different amounts of money can mix!
●
23 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomValueShuffle
Confidential
ValueShuffle CoinShuffle++
Transactions
Hides amounts in transactions and provides anonymity
●
Users with different amounts of money can mix!
●
User can mix and pay simultaenously in one transaction
●
23 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomValueShuffle
Confidential
ValueShuffle CoinShuffle++
Transactions
Hides amounts in transactions and provides anonymity
●
Users with different amounts of money can mix!
●
User can mix and pay simultaenously in one transaction
●
Accepted at Bitcoin Workshop 2017
●
23 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomValueShuffle
Confidential
ValueShuffle CoinShuffle++
Transactions
Hides amounts in transactions and provides anonymity
●
Users with different amounts of money can mix!
●
User can mix and pay simultaenously in one transaction
●
Accepted at Bitcoin Workshop 2017
●
See our poster tonight!
●
23 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomPathShuffle
Money Mixing in Credit Networks
● Idea similar to CoinJoin, but there is no CoinJoin transaction
● Challenge: Simulate the CoinJoin via a shared account
24 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomPathShuffle
Money Mixing in Credit Networks
● Idea similar to CoinJoin, but there is no CoinJoin transaction
● Challenge: Simulate the CoinJoin via a shared account
1 € 1 €
1 € 1 €
Shared
Account
1 € 1 €
24 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomPathShuffle
Money Mixing in Credit Networks
● Idea similar to CoinJoin, but there is no CoinJoin transaction
● Challenge: Simulate the CoinJoin via a shared account
1 € 1 €
1 € 1 €
Shared
Account
1 € 1 €
Accepted by PoPETs 2017
24 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomTake-Home Message
DC-nets are practical
●
● No honest majority necessary
● Only simple crypto, simple protocol
● Only 4 + 2f rounds
P2P coin mixing is practical
●
● No central party necessary
● CoinShuffle++ is an efficient solution
Work in progress:
https://github.com/real-or-random/python-dicemix
25 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomBackup Slides
81
P2P Mixing and Unlinkable Bitc Tim Ruffing – @real_
oin Transactions or_randomFreshness Is Necessary
Anonymity
Termination with Support for
dishonest majority fixed messages
12 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomIdea of Attack on Anonymity
m m
1 2
m m
2 4
m m
3 3
m m
4 1
13 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomIdea of Attack on Anonymity
m m
1 2
m m
2 4
m m
3 3
m m
4 1
13 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomIdea of Attack on Anonymity
m m
1 2
m m
2 4
m m
3 3
m m
4 1
13 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomIdea of Attack on Anonymity
m m
1 2
m m
2 4
m m
3 3
m m
4 1
13 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomIdea of Attack on Anonymity
m m
1 2
m m
2 4
m m
3 3
m m
4 1
13 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomIdea of Attack on Anonymity
m m
1 2
m m
2 4
m m
3 3
m m
4 1
13 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomIdea of Attack on Anonymity
m m
1 2
m m
2 4
m m
3 3
m m
4 1
13 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomIdea of Attack on Anonymity
m m
1 2
m m
2 4
m m
3 3
m m
4 1
13 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomIdea of Attack on Anonymity
m m
1 2
m m
2 4
m m
3 3
m m
4 1
13 P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomCommunication Rounds (DiceMix)
Run 1 KE DC ? SK
?
Run 2 KE DC
RV
Run 3
(Run 4)
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomCommunication Rounds (DiceMix)
Run 1 KE DC ? SK
?
Run 2 KE DC
RV
Run 3
(Run 4)
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomCommunication Rounds (DiceMix)
Run 1 KE DC ? SK
?
Run 2 KE DC
RV
Run 3
(Run 4)
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomCommunication Rounds (DiceMix)
Run 1 KE DC ? SK
?
Run 2 KE DC
RV
Run 3
(Run 4)
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomCommunication Rounds (DiceMix)
Run 1 KE DC ? SK
?
Run 2 KE DC
RV
Run 3
(Run 4)
4 + 2f rounds
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomCommunication Rounds (DiceMix)
Run 1 KE CM DC SK
DC
Run 2 KE CM
RV
Run 3
(Run 4)
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomCommunication Rounds (DiceMix)
Run 1 KE CM DC SK
DC
Run 2 KE CM
RV
Run 3
(Run 4)
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomCommunication Rounds (DiceMix)
Run 1 KE CM DC SK
DC
Run 2 KE CM
RV
Run 3
(Run 4)
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomCommunication Rounds (DiceMix)
Run 1 KE CM DC SK
DC
Run 2 KE CM
RV
Run 3
(Run 4)
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomCommunication Rounds (DiceMix)
Run 1 KE CM DC SK
DC
Run 2 KE CM
RV
Run 3
(Run 4)
4 + 2f rounds
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomTransaction Linkability
A Threat to Privacy
102
P2P Mixing and Unlinkable Bitc Tim Ruffing – @real_
oin Transactions or_randomLinkability and Deanonymization Attacks
[Meiklejohn et al. 2013]
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomLinkability and Deanonymization Attacks
[Meiklejohn et al. 2013]
[Nick 2016]
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomLinkability and Deanonymization Attacks
[Meiklejohn et al. 2013]
[Nick 2016]
BitIodine [Spagnuolo, Maggi, Zanero 2013]
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomLinkability and Deanonymization Attacks
[Meiklejohn et al. 2013]
[Nick 2016]
BitIodine [Spagnuolo, Maggi, Zanero 2013]
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomLinkability and Deanonymization Attacks
[Meiklejohn et al. 2013]
[Nick 2016]
BitIodine [Spagnuolo, Maggi, Zanero 2013]
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomPerformance
We use an untrusted bulletin board, e.g., IRC server, but just for
●
communication.
CoinShuffle++ terminates in 4 + 2f rounds with f disruptive users
●
● < 10 seconds to create CoinJoin transaction with 50 honest users
(unoptimized)
● old CoinShuffle: about 3 min
Work in progress:
●
https://github.com/real-or-random/python-dicemix
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomDC-nets in Practice
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomDC-nets in Practice
Key exchange to establish shared keys
●
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomDC-nets in Practice
Key exchange to establish shared keys
●
Send bitstrings instead of single bits
●
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomDC-nets in Practice
Key exchange to establish shared keys
●
Send bitstrings instead of single bits
●
DC-nets computes sum, but should compute set of messages
●
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_randomDC-nets in Practice
Key exchange to establish shared keys
●
Send bitstrings instead of single bits
●
DC-nets computes sum, but should compute set of messages
●
● Often: Use „slots“ and perform slot reservation
00000 10110 00000
00110 00000 00000
00000 00000 11001
P2P Mixing and Unlinkable Bitcoin Transactions Tim Ruffing – @real_or_random