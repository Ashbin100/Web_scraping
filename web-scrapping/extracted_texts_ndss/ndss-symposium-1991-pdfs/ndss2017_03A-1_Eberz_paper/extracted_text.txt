Broken Hearted: How To Attack ECG Biometrics
Simon Eberz Nicola Paoletti Marc Roeschlin
University of Oxford University of Oxford University of Oxford
simon.eberz@cs.ox.ac.uk nicola.paoletti@cs.ox.ac.uk marc.roeschlin@cs.ox.ac.uk
Andrea Patane´ Marta Kwiatkowska Ivan Martinovic
University of Catania University of Oxford University of Oxford
andrea.patane@eng.ox.ac.uk marta.kwiatkowska@cs.ox.ac.uk ivan.martinovic@cs.ox.ac.uk
Abstract—In this work we present a systematic presentation these limitations. Unlike passwords, which rely on the user
attack against ECG biometrics. We demonstrate the attack’s knowing something, biometrics make use of either distinctive
effectiveness using the Nymi Band, a wrist band that uses elec- physiological properties or behavior. The former includes
trocardiography(ECG)asabiometrictoauthenticatethewearer. fingerprints, iris patterns and DNA, while keystroke dynamics,
We instantiate the attack using a hardware-based Arbitrary
touchscreen input, mouse movements and eye movements have
WaveformGenerator(AWG),anAWGsoftwareusingacomputer
beenproposedforthelatter.Electrocardiography(ECG)records
sound card, and the playback of ECG signals encoded as .wav
the electrical activity of the heart over time. While ECG is
filesusinganoff-the-shelfaudioplayer.Intwosetsofexperiments
typically recorded in a hospital using 10 electrodes placed on
we collect data from a total of 41 participants using a variety of
ECGmonitors,includingamedicalmonitor,asmartphone-based the patient’s skin, it can also be measured using two electrodes,
mobile monitor and the Nymi Band itself. thus making it feasible to record with wearable devices. Due
Weusethefirstdatasettounderstandthestatisticaldifferencesin to its distinctiveness and universality (every living human has
biometric features that arise from using different measurement a heartbeat that can be measured), ECG as a biometric has
devices and modes. Such differences are addressed through attracted considerable attention in recent years. Unlike most
the automated derivation of so-called mapping functions, whose behavioral biometric systems, which exist mostly as research
purposeistotransformECGsignalsfromanydeviceinorderto
projects, ECG-based biometrics have resulted in a successful
resemble the morphology of the signals recorded with the Nymi commercial product, the Nymi Band1.
Band.
Aspartofourseconddataset,weenrollusersintotheNymiBand In this paper, we provide a systematic attack against ECG
andtestwhetherdatafromanyofoursourcescanbeusedfora biometrics and demonstrate its effectiveness by applying it to
signalinjectionattack.UsingdatacollecteddirectlyontheNymi theNymiBand.Tothisend,wefirstdemonstrateourcapability
Band we achieve a success rate of 81%. When only using data
of spoofing arbitrary ECG signals. To present the spoofed
gatheredonotherdevices,thisratedecreasesto43%whenusing
signals we use three different devices, two Arbitrary Waveform
raw data, and 62% after applying the mapping function. While
Generators (AWG), one software- and one hardware-based,
we demonstrate the attack on the Nymi Band, we expect other
as well as the audio playback of ECG signals encoded as
ECG-basedauthenticationsystemstomostlikelysufferfromthe
same, fundamental weaknesses. .wav files using an off-the-shelf audio player. As such, the
technological barriers for the attacker are extremely low. We
collect ECG data from a total of 41 users and 5 devices. The
I. INTRODUCTION
data shows that the morphology of the ECG signal depends
Passwords are the most prevalent mode of authentication greatly on the device that was used. This difference constitutes
in many environments, including local workstations and on a major challenge, as a signal collected on one device can not
the web. Despite their widespread use, they suffer from a easily be used to carry out an attack on another. We tackle
number of weaknesses [12], [13], [3]. Most notably, these this challenge by using the first half of our dataset to devise
include users choosing weak passwords [15] and frequent and train a so-called mapping function. The purpose of this
password-reuse [23]. Besides these weaknesses, the increasing function is to transform an ECG signal collected on one device
popularity of mobile and wearable devices gives rise to another such that its morphology matches that of another. The method
challenge: the lack of input devices to enter passwords (e.g., to generate these functions is general and can even be used for
smart watches might only provide few buttons for user input). other biometrics. After enrolling users in the Nymi Band we
Biometric recognition has become a popular approach to tackle usethemappingfunctiontoimpersonatetheuserbypresenting
the (transformed) ECG signals collected on different devices.
The rest of the paper is organized as follows: Section II
Permission to freely reproduce all or part of this paper for noncommercial
purposes is granted provided that copies bear this notice and the full citation gives background information about ECG and ECG biometrics.
on the first page. Reproduction for commercial purposes is strictly prohibited Section III describes our hardware setup and the approach used
without the prior written consent of the Internet Society, the first-named author to spoof arbitrary ECGs. We outline our experimental design
(for reproduction of an entire paper only), and the author’s employer if the
and data collection in Section IV. In Section V we describe the
paper was prepared within the scope of employment.
generation and training of the mapping function and outline
NDSS ’17, 26 February - 1 March 2017, San Diego, CA, USA
Copyright 2017 Internet Society, ISBN 1-891562-46-0
http://dx.doi.org/10.14722/ndss.2017.23408 1http://www.nymi.comthe results of carrying out the attack in Section VI. Section VII
presents related work, we discuss possible countermeasures to
ourattackinSectionVIIIandconcludethepaperinSectionIX.
II. BACKGROUND
A. Electrocardiography
The electrocardiogram (ECG) is a measurement of the
electrical activity of the heart. It is acquired through electrodes
placed on the patient’s skin, which are used to capture voltage
changes due to depolarization and repolarization of cardiac
cells, respectively provoking contraction and relaxation of the
cardiacmuscle.TheECGiscommonlyusedinclinicalpractice
for its crucial diagnostic capabilities [14]. In addition, the
present availability of low-cost ECG sensors has opened to
numerous applications in the area of wearable devices and
fitness monitoring [18], leading to pervasive acquisition of
ECG data.
Time
Figure 1 shows an example ECG for one cardiac cycle,
together with the duration and amplitude features typically
extracted for authentication purposes (detailed in Section II-B).
It comprises five main waves, P, Q, R, S and T, which map
to specific heart events: the P wave indicates activation of the
atria (the upper heart chambers); the QRS complex corresponds
to the activation of the ventricles (the lower chambers); and
the T wave indicates ventricular repolarization.
Most of ECG recording systems are based on the so-called
Einthoven’sleadsystem,whereeachleadrecordsthedifference
of potential between two electrodes. Einthoven’s leads consist
of:
Lead I: Lead II: Lead III:
V =Φ −Φ V =Φ −Φ V =Φ −Φ
I LA RA II LF RA III LF LA
where V is the voltage of lead i and Φ , with j
i j
∈ LA,RA,LF , is the potential at the left arm (LA), right
{ } arm (RA) and left foot (LF), respectively. In particular, the
standard12-leadECGusedinclinicalsettingsisanextensionof
the Einthoven’s 3-lead system based on using seven additional
electrodes placed on the chest. Nevertheless, simpler 1-lead
ECG recording systems are increasingly being used in the
context of personal ECG monitoring and wearables.
B. ECG Biometrics
Driven by the distinctiveness and universality of ECG, the
body of work in this field has been steadily growing over the
pastfewyears.RecentsurveysofsystemsbasedonECG-based
biometrics can be found in [24], [8], [1]. The most striking
difference between approaches lies in the biometric features
used.Thefirstclassofmethodsisbasedontimedomainfeature
extraction, and work by detecting the so-called fiducial points,
i.e., location, amplitude and width of the main ECG waves,
as shown in Figure 1. Some biometric systems also consider
the ST segment, that is, the length of the isoeletric segment
between the S and T waves, as well as the slope of waves. In
Figure1,thewaveslopeisaccountedforthroughtheextraction
of left and right components of its width. In addition to the
aboveintra-beatmorphologicalfeatures,inter-beatfeaturessuch
as Heart Rate Variability and beat patterns (represented by the
RR intervals) can well reflect the specific characteristics of the
subject.
egatloV
QT Interval
QS Interval
QR Interval
PQ Interval
0
edutilpmA
R
edutilpmA
T
edutilpmA
P
edutilpmA
Q
edutilpmA
S
L R
L R
Fig. 1: Example electrocardiogram and corresponding time-
domain features for ECG-based biometrics. Top: duration
featuresgivenbyinter-peakdistances.Right:amplitudefeatures.
For each wave, we also consider its width at half amplitude
(grey solid lines). To account for asymmetric curves, the width
of each wave is split into left and right components (L and R
segments shown in P and T waves), i.e., before and after the
wave peak.
The second class of methods use frequency domain feature
extraction, meaning that features are obtained after converting
the ECG signal in the frequency domain. Examples include
application of wavelet decomposition and Fourier Transform.
In alternative to time and frequency domain methods, some
biometric systems employ statistical approaches for computing
the distance between enrolment ECG and recognition ECG
directly at the signal level, or analysis of the ECG’s trajectory
in the phase space.
Despite the numerous advantages of ECG-based biometrics,
they also suffer from some limitations, mostly addressed
through the use of multimodal biometrics. These are related
to the time-variant nature of the ECG, which is affected
by physical activity, emotional stress and minor random
disturbances like ectopic beats.
C. The Nymi Band
Inthissubsectionwewilloutlinethecapabilitiesandsystem
design of the Nymi Band.
The Nymi Band (see Figure 2) is a wristband that in-
corporates an ECG sensor with two electrodes. The bottom
electrode constantly touches the user’s wrist while the band is
worn. In order to allow ECG measurements (most commonly
for enrollment and authentication) the user touches the top
electrode with the index finger of their other hand. As such,
the signal morphology can be expected to be similar to Lead
I of a medical ECG (which measures the potential difference
between the left and right arm). Besides the actual band, the
Nymi ecosystem consists of the Nymi Companion App (NCA)
and Nymi Enabled Applications (NEAs). The NCA is provided
2a shared key, which is stored directly on the band. After
pairing, the possession of the shared key (i.e., the presence of
the unlocked band) can then be confirmed using a standard
challenge-response protocol.
There is one additional capability of NEAs that is relevant
to the remainder of the paper: The Nymi SDK grants NEAs
direct access to the band’s ECG sensor. Once the band and
an NEA are paired, the NEA can request the collection of an
arbitrary amount of raw ECG data. While this data collection
does not have to be explicitly approved by the user, the sensor
design requires the user to touch the top electrode with their
finger, thus making covert data collection virtually impossible.
It is noteworthy that this functionality has been removed from
Fig. 2: The Nymi Band the official SDK from version 2.0 onwards.
The Nymi Band’s threat model is described in the Nymi
Whitepaper. The band is designed as a three-factor authen-
as an app that runs on the user’s smartphone or tablet. The tication system. In order to communicate with NEAs, an
NCA performs two main functions, enrollment and activation. attacker has to be in possession of the Nymi Band and the
NCA (typically the user’s phone) and be able to bypass the
During enrollment, the Nymi Band is paired to an NCA. biometric authentication. It is noteworthy that the latter, while
The correct pairing is confirmed by displaying a pattern on the not explicitly stated in the Whitepaper, can also be achieved
NymiBandwhichtheuserhastoverifyagainstapatternshown by using the user’s backup password (e.g., through guessing
by the NCA (similar to the numerical codes used in Bluetooth a weak password or social engineering). This is particularly
device pairing). The Nymi Band and NCA then agree on a dangerous, as the presence of a second authentication factor
shared key that binds the Nymi Band to this NCA. Following often leads to users choosing weaker passwords [26]. In terms
pairing, the user is prompted to touch the band’s top electrode ofbypassingECGauthentication(ratherthanusingapassword),
with his index finger, after which their ECG is measured until the Nymi Whitepaper claims that
a specific amount of ECG data of sufficient quality is captured.
The resulting biometric template is then encrypted and stored ”There is currently no known means of falsifying
by the NCA on the phone or tablet. Besides the shared secret, an ECG waveform and presenting it to a biometric
no information is stored on the band at this time. recognition system.”
Activation is performed when the Nymi Band is taken off In the following sections we will investigate the validity of
and put back on again. Specifically, this event is detected by this claim.
the contact between two pins on the inside of the buckle being
interrupted (see Figure 2). As such, the Nymi Band does not III. SPOOFINGECGSIGNALS
truly perform continuous authentication in the biometric sense, In this section, we show that fake ECG signals can be
but authenticates the user once and then detects a possible injected into ECG enabled recognition systems. We start out
change in user identity through the band being taken off. The with the hypothesis that captured ECG measurements can be
activationprocessisstartedbytheuserselectingtheappropriate reproduced at the biometric sensors without the benign user
actionintheNCA,afterwhichtheycanchoosetoperformECG having to be present.
authentication, or to use their backup password. If they choose
ECG, they are again prompted to touch the top electrode to A. Motivation
begin ECG measurement. Unlike enrollment, which runs until
Like any other physiological trait, ECG signals can be
a certain number of seconds of valid ECG data is collected,
captured and (digitally) stored for an indefinite amount of time
activation runs until the NCA is sufficiently convinced of the
asthesignalsarerelativelyimmutable.Biometricsamplesfrom
wearer’s identity. Once one or several heartbeats are observed
physiological traits do not lose validity and, if the fidelity of
that match the owner’s template, the Nymi Band is put into
the stored signal is sufficiently high, it is possible to physically
activated mode by the NCA. If no matching heartbeats are
reproduce the actual biometric signal at a later time. This
observed after 60 seconds, the user is automatically rejected.
processdoesnotrequiretheindividualfromwhomthebiometric
Once the Nymi Band is activated, it can be paired with measurements originate to be present.
NEAs. Examples of NEAs include desktop computers (that
InECGrecognition,biometricreadingsareusuallyacquired
can then be unlocked without using a password), wearable
with the help of an electrocardiograph, which works by
devices like smart watches and even more complex systems
measuring the minute voltage differences of the human heart
like cars. At the time of writing, the Nymi Band is being
over time. With today’s technologies in signal synthesis and
trialled for contactless payments. Initially, the band is paired
digital to analog conversion, artificially creating electrical
with the NEA through a process similar to regular Bluetooth
signals that exactly represent stored ECG signals is feasible.
pairing. The Nymi Band displays a pattern using the five LEDs
(leading to only 32 possible combinations), which the user is While forging ECG signals is not a concern in the medical
meant to confirm before proceeding. The Nymi Band and the domain, it is potentially problematic for ECG-based authentica-
NEA then use a Diffie-Hellman key exchange to negotiate tionsystems.Ifabiometricsystemdoesnotfeatureanagentor
3overseer — or other provisions against someone not using the
biometric sensors as intended — it is susceptible to so-called Shorted-out pins Exposed measurement
presentation attacks. In a presentation attack the attacker tries electrode
to spoof the biometric sensors with an artefact or contraption.
In case of ECG based recognition, the attacker would have
to fake the (time-dependent) voltage levels at the electrodes
interfacing the user with the help of an electrical device that
outputs an ECG signal.
In the remainder of this section, we show that it is indeed
possible to replay previously captured ECG signals. To that
end,webuiltthreehardwarecontraptionsofvaryingdegreesof
sophistication that successfully create and inject ECG signals
into the sensing electrodes of a biometric system based on
ECG. We test our contraptions using the example of the Fig. 3: Modified charger lead. The two pins on the left are
Nymi Band. In order to estimate difficulty and likelihood of shorted out to put the Nymi Band into “closed” state as soon
a presentation attack on ECG recognition, we additionally as the modified charging lead is attached to the band.
evaluate our injection methods along the following non-
technical dimensions:
Cost: What is the overall cost for building the contrap- charging lead that interfaces with the band has two shorted-out
•
tion and executing the injection? Although high cost pins to let the band think it is closed and conveniently exposes
does not deter every attacker, it can discourage less one of the sensing electrodes in a separate wire.
determined ones.
1)Hardware Waveform Generator: Our first and the most
Knowledge:Isexpertknowledgerequiredtobuildand
• obvious approach to artificially create an ECG trace is to use
use the contraption or can it be put together following
an arbitrary waveform generator. The purpose of waveform
simple instructions?
generators is to generate electrical waveforms for testing and
Size: Physical size is a very important factor. If the analyzing electronic devices. The generated signal is injected
•
contraption used for signal injection is sufficiently intothedeviceundertestwhilethedevice’s(electrical)behavior
small, an attacker can covertly spoof the biometric is observed and analyzed. The waveform itself is defined as
sensorsandmightevencircumventaguardedbiometric a time series of voltage levels, based on which the waveform
system. generator produces the corresponding signal. The resulting
signalexactlymatchesthepredefinedvoltagelevelsatthegiven
Signalquality:Wequantizeandcomparetheresulting
• points on the time axis and interpolates values in between.
signal quality of each approach when applied to
injecting ECG signals into the Nymi Band. Obviously,
WeuseaRigolDG4062ArbitraryWaveformGeneratorthat
signalqualitydirectlycorrelateswiththeprobabilityof
is capable of generating signals of up to 60MHz at a sampling
success for a presentation attack. The conversion from
rate of 500 Mega-Samples per second. These specifications
the (stored) biometric data to the physical biometric
enable us to transform stored ECG signals to their physical
signal should introduce as little noise as possible.
counterpart with high accuracy. Electrocardiographs commonly
operate at a sampling rate of less than 500 samples per second
B. Hardware Considerations
whenacquiringanECGtrace.Thismeansthathigherfrequency
WebuildthreecontraptionsthatallowustoforgefakeECG components, i.e., more than 250Hz, can not be registered and
signals. Since all approaches inject the resulting signal at the hence are not part of the measured signal. Such a frequency
sensing electrodes of the Nymi Band, we design a contrivance limited signal can easily be synthesized by most of today’s
that allows us to interface those electrodes in a convenient way. off-the-shelf hardware waveform generators.
As described in the previous section, the Nymi Band has a
Our signal generator’s two output leads are directly con-
locking mechanism, which deauthenticates the wearer of the
nectedtotheelectrodesoftheNymiBand.Inordertooptimally
band immediately if the band is taken off. When the band is
match electrical impedances between signal generator and the
closed, one of the two sensing electrodes is located on the
electrodes of the band, we inject the signal through a 75Ω
inside of the band and faces the wearer’s wrist whereas the
coaxial cable (see Figure 4). Electrocardiographs most often
other electrode is accommodated at the outside of the band,
feature an instrumentation amplifier with high input impedance
available to be touched with a finger of the other hand. This
as the first step in the signal acquisition pipeline. The Nymi
way, the electrical circuit is closed and the ECG measurement
Band does not differ in that regard and requires a relatively
canstart.Ifthewearerofthebandisrecognized,thebandgoes
low impedance input.
to and remains in “authenticated” state as long as the band is
worn.
We wrote a software library that loads stored ECG signals
For ease of use and to allow many successive injection directly into the memory of the Rigol DG4062 Arbitrary Wave-
attempts without opening and closing the Nymi Band, we form Generator, sets the necessary parameters and starts/stops
modified a genuine charging cable that is included in the the signal generation. The program code is available upon
deliveryoftheband.AscanbeseeninFigure3,thepartofthe request.
4Fig. 4: Arbitrary waveform generator connected to the Nymi Fig.5:AlaptopisconnectedtotheNymiBandviathemodified
Band via the modified charging lead. The negative output of charginglead.Setupisanalogoustotheconfigurationinvolving
the waveform generator is clamped to the electrode facing the the hardware waveform generator, apart from the coaxial cable
wristandthepositiveoutputisattachedtothesecondelectrode beingpluggedintotheaudiooutputportofalaptop.Thelaptop
of the band using the modified charging lead. either runs a software waveform generator or is used to play
backanECGsignalthatisencodedinanaudiofile.Thelaptop
might be replaced through any electronic device with audio
playback capability.
2)Software Waveform Generator: Nowadays, almost every
personal electronic device, be it mobile or stationary, possesses
a dedicated sound card or integrated sound functionality to
Reference signal Hardware waveform generator
facilitate analog audio output. Audio signals are an electrical
75
representationofsound,i.e.,amechanicalwavethatpropagates MSE = 0.015
50
through a medium. Thus, sound cards need to be able to
25
output relatively high-frequency signals. This capability can
be harnessed and lets a sound card be utilized as a low- 0
frequency waveform generator. In most cases, no hardware −25
modifications are needed and arbitrary electrical signals can Software waveform generator Audio playback
be readily generated, provided that the sound card is driven 75
MSE = 0.035 MSE = 0.017
with the right software components. Naturally, a sound card 50
based waveform generator is not as capable as a dedicated 25
hardware solution and has many limitations such as a narrow
0
range for the generated voltage. However, the nature of ECG
−25
signals, which are inherently low-frequency and on the order 0 1 2 3 0 1 2 3
of a few hundred microvolts, can be generated by a sound Time [s]
card without any problems The majority of dedicated sound
cards as well as devices with integrated sound support have
outputfrequenciesofupto20kHz,whichiswellthanenough.A
softwarewaveformgeneratorbasedonasoundcardistherefore
a viable option for signal injection. It not only drastically
reduces cost, but also simplifies the injection method. Figure 5
depicts a possible setup where a software waveform generator
is run on a laptop that injects the generated signal though its
audio output port.
3)Audio Playback: Instead of using a software waveform
generator and changing the function of the sound card, we
explore the possibility of playing back stored ECG signals
on the sound card as actual sound. Such an approach does
not require specialized software, i.e., a software waveform
generator, and might be executed on any device capable of
outputting analog audio signals. This could reduce effort and
complexity of a presentation attack to a great extent.
ThechallengeofreplicatinganECGsignaldirectlyasaudio
output consists of transforming the digital representation of
an ECG signal into an audio file that can be played back on
the sound card. We wrote software that filters the ECG signal,
applies the correct scaling of voltage levels, sets the sampling
rate and finally stores the signal as an audio file (WAV format).
]V
m[
level
egatloV
Fig. 6: Reference ECG signal compared to the ECG traces
measured when the reference signal is injected using three
different injection methods. The traces are captured by the
Nymi Band and read out with the Nymi software development
kit.
Theresultingfilecanthenbeplayedbackonalmostanydevice
and potentially injected into the sensors of a biometric system
based on ECG recognition.
Thecontraptionweusedfortheevaluationoftheaudioplayback
asinjectionmethodisidenticaltothehardwaresetupinFigure5.
Nevertheless, the attack can be carried out with any device
capable of analog audio output.
C. Injection Quality
In order to validate the presented signal injection methods
and assess their quality, we select a stored reference signal,
reproduce and inject it using each of the three approaches.
We then compare the reference signal to the traces the
electrocardiograph measures while injection takes place. In
case of the Nymi Band, the captured traces can be accessed
5Approximate Required Physical Signal
cost knowledge size quality
–Hardwarewaveformgenerator
$240 high large veryhigh
–Softwarewaveformgenerator
$50 moderate small high
–Audioplayback
$10 moderate verysmall veryhigh
TABLE I: Comparison of injection methods
and read out with the Nymi software development kit (SDK).
In addition to a visual comparison between the stored
signal and the extracted ECG traces, we verify their similarity Fig. 7: The ECG monitor data is extracted through image
numerically. The distance metric for comparison is the (per analysis of this plot shown by the software. This models the
sample)meansquarederror(MSE).Wemakesurethereference threat of an attacker obtaining a photo of the victim’s ECG.
signal’s sampling rate matches that of the Nymi Band. Also,
the measured traces might be linearly translated and require
alignment before the calculation of the distance metric. We
determinetheconstantshiftbetweenthestoredreferencesignal
and captured traces by aligning the peaks of the R waves. that of the victim. There are multiple conceivable approaches
to obtain this data:
Results are show in Figure 6. All three proposed injection
methods manage to reproduce the reference signal remarkably
well and we conclude that the contraptions are effective. It is Medical records often contain printouts of a patient’s ECG.
evident that signal quality is proportional to sophistication and A conventional hospital ECG uses 10 adhesive electrodes to
cost of the contraption used for signal injection: The hardware simultaneously record 12 leads (see Section II for details).
waveform generator and audio playback achieve the smallest An attacker could obtain these records either electronically
error (mean squared error of 0.015 and 0.017, respectively), (e.g., through social engineering or a compromised medical
outperforming the software signal generator with an MSE of database) or on paper (e.g., by taking a photo of the plots). In
0.035. addition, mobile devices that allow patients to monitor their
health at home are becoming more widespread. Besides ECG
D. Comparison of Injection Methods monitors for medical use, a number of devices are marketed
for fitness, for example in the form of heart rate monitors
In Table I, we present a comparison between our three
used during cardiovascular exercise. In these cases, the data
injection methods along the criteria outlined above (see Sec-
could be intercepted during transmission (e.g., to the victim’s
tion III-A). Not surprisingly, the hardware waveform generator
smartphone) or leaked through an insecure or malicious mobile
achieves the highest signal quality, but at the same time entails
app.
the highest cost. Entry-level arbitrary waveform generators
retail at around $250. They are, however, fairly bulky and only
designed for stationary use. The Nymi SDK allows NEAs to collect arbitrary amounts
of raw ECG data (see Section II). There are two conceivable
Software waveform generators are not only available for
ways in which this might pose a security risk: NEAs have to
personal computers, but even smart phones. A low-end smart
be actively paired with the NCA by the owner of the band.
phone equipped with an analog audio output costs around $50
However, this only means they are trusted by the user, not that
as of spring 2016. An ECG signal encoded as an audio file can
they are inherently trustworthy. A rogue NEA could trick the
even be played back on a cheap portable audio player which
user into providing (a sample of) his ECG, which would then
can cost less than $10 and has a tiny form factor.
allow the owner or developer of the NEA to later use this data
to carry out a presentation attack. A second, probably more
IV. EXPERIMENTALDESIGN
severe, way of abusing the SDK data collection is through a
In this Section we will outline a number of approaches that social engineering attack. Given the novelty of the Nymi Band
can be used by an attacker to obtain data for a presentation an attacker might ask the victim to wear the attacker’s Nymi
attack. Based on these attack vectors, we will then discuss our Band to test whether it is possible for the victim to unlock
data collection methodology. it. Instead of performing regular activation, the attacker could
insteadactivatethebandthroughthebackuppasswordandthen
collect the victim’s ECG data through a previously paired NEA
A. Obtaining Data for a Presentation Attack
(e.g., on a laptop or the attacker’s smartphone). This attack
In Section III we have demonstrated our capability to inject is particularly dangerous, as the data is collected directly on
arbitrary signals into the Nymi Band. However, the attacker a Nymi Band, rather than a different device that requires the
still requires an input ECG signal that is sufficiently close to application of the mapping function (see Section V).
6B. Data Collection
The previous subsection has outlined several scenarios that
might allow an attacker to obtain a victim’s ECG data. We
collect data using a variety of devices to reflect them:
The first device we use is a lightweight medical ECG
monitor,theHealForcePrince180B(seeFigure8).Thedevice
has two main measurement modes which use either the built-in
electrodes on the sides of the device or an external 3-lead ECG
cable with disposable electrodes. The first measurement (which
wewillrefertoasthePalmmeasurementthroughoutthepaper)
uses the built-in electrodes. Participants were asked to hold
the device as pictured in Figure 8 and to remain still during
the measurement as the ECG recording is highly sensitive to
Fig. 8: ECG monitor in palm measurement mode
device movements. When using the built-in electrodes, the
device always records data for a fixed duration of 30 seconds.
Following the palm measurement, we use the 3-lead cable to
record Lead I and Lead II (see Section II for details), which
involves attaching the disposable electrodes to both arms and
the left leg. Unlike hospital ECGs, which capture all 12 leads
simultaneously, this monitor is limited to recording a single
lead. However, by switching the position of the electrodes, all
standardleadscanberecordedinsequence.Wechosetorecord
Lead I, which has measurement points similar to the Nymi
Band, and Lead II, which measures the potential difference
between the right arm and left leg. Due to practical reasons
we choose not to collect a full 12-lead ECG. Both leads are
recorded during a medical ECG, as such an attacker could
obtain them by taking a photo of the patient’s medical files. In
order to reflect this, we don’t extract raw data from the device,
Fig. 9: Mobile ECG monitor
but instead obtain it by performing image analysis on the plots
displayed by the software (see Figure 7).
The second device, pictured in Figure 9, is a mobile ECG
monitor that can be attached to a smartphone and transmits capability to record raw ECG data. We can’t make any claims
the recorded data via Bluetooth. Following the measurement, on the success of our attack on this new version, although,
the device provides an instant assessment with regard to based on the published changes in the consumer version, we
a number of heart disorders. Participants were again asked can not see any structural obstacles to the attack still being
to remain still during the 30-second measurement period successful.
to avoid the introduction of additional noise. Following the
measurement, the device creates a pdf report which can be
C. Participant Recruitment and Ethical Considerations
automatically sent to an arbitrary e-mail address (such as
the patient’s physician). This report contains, aside from the This project has been reviewed by and received clearance
patient’s personal information, a plot of the recorded ECG data. from the Central University Research Ethics Committee of the
The report is sent via e-mail without any encryption or other University of Oxford, reference number R42894. The main
security features. Similar to the ECG monitor data, we use ethicalconcernwhengatheringECGdataisthesensitivenature
image analysis to extract the raw data from the pdf file. of the data itself. This sensitivity stems from the fact that
a variety of heart disorders can be diagnosed using ECG,
Lastly, we collect data using the Nymi Band itself. As
includingdisorderstheparticipantmaynothavepreviouslybeen
outlined in Section II, the Nymi SDK allows Nymi Enabled
aware of. The possibility of false positives (i.e., the incorrect
Applications (NEAs) to collect raw ECG data once the Nymi
diagnosis of a condition) in conjunction with the fact that none
Band is unlocked and paired with the NEA. As a result of
oftheresearchersaretrainedmedicalprofessionalsledustothe
the band’s hardware design, this requires the cooperation of
decision of disabling all diagnostic capabilities of the devices
the user as they have to touch the top electrode of the band
used and inform all participants accordingly. Since a future
to enable ECG recording. Following the user enrollment and
diagnosis based purely on the data is theoretically possible,
activationoftheNymiBandwecollect60secondsofrawECG
we store all datasets anonymized to erase any links between a
data using the SDK. We used three (identical) developer kits of
potential condition and a single participant. Given the above
the Nymi Band running the SDK version 1.03. It is important
concerns, we required participants to be at least 18 years old
to note that the capability of the band to report raw ECG data
as the only criteria for inclusion in the study.
toNEAshasbeendiscontinuedfromSDKversion2.0onwards.
However, it is still possible to collect data by using the legacy We recruited a total of 41 participants (21 female, 20 male)
SDKonthedeveloperbands.Thefinalconsumerversionofthe throughmailinglistadvertsandsocialmedia.Participantswere
band has been released in September 2016 and also lacks the madeawarethattheresearchinvolvesECGbiometrics,butwere
71
0
0
Phase (radians)
egatlov
desilamroN
Filtered mean ECG. Subject: 1256
Lead I
Lead II 1
Mobile
Palm
Nymi
0
−π π 0
Phase (radians)
(a)
egatlov
desilamroN
Filtered mean ECG. Subject: 1743
Lead I
Lead II
Mobile
Palm
Nymi
−π π
(b)
Fig. 10: Comparison of mean ECGs from same subjects and different leads/devices. Mean ECGs are computed after a linear phase
assignment [19], assigning a periodic phase value to each sample in the ECG, starting from one R-peak (phase 0) and ending
with the next R-peak (phase 2π). For each heart cycle, amplitudes are scaled by the amplitude of the corresponding R-peak.
SOURCE ECGs SOURCE FEATURES
{ECGS i}i 2I ECG DETECTION DISTRIBUTIONS { D iS }cci 2ccI OPTIMISATION
MAPPING
T {A ER CG GE
T
iT }E iC 2G Is
A EN XD
T
F RE AA CT TU IOR NES
DIST TA RR IBG UE TT
I
OFE NA ST
{
U
D
R iTE S
c }c ic 2cI
min
Xi
d  f( DiS), DiT
 
f
(a)
SOURCE ECG DETECTION TRANSFORMED SYNTHETIC
ECG AND FEATURES SOURCE FEATURES S FEATURES THROUGH SIGNAL ATTACK
ECGS i0 EXTRACTION DISTRIBUTIONSc Dccic 0 MAPPINGccfcc DcciS 0 GENERATION SIGNAL
   
(b)
Fig. 11: Methods for the derivation of optimal mappings (a) and generation of attack signals (b).
only told the specific purpose of the data collection afterwards. T wave peak. Similarly, in both cases the P waves obtained
Participants were paid in cash for their participation. from Lead I and the mobile ECG monitor stand above those
of the Nymi Band and Lead II, and the R wave of Lead II has
V. MAPPINGFUNCTION the least amplitude. These observations demonstrate that many
discrepancies in the ECGs are device-specific and thus can be
In this section, we show how to generate attack signals for
addressed by the application of mapping functions.
the Nymi Band using ECG data from different sources. The
method is based on the derivation of mapping functions, i.e., Figure 11 shows a summary of the methods for estimating
functions that transform signals recorded from one device, the mapping functions and for generating attack signals. Let S and
source, in order to resemble the morphology of the signals T be the source and target devices, respectively. Let J be the
from a target device. In our case, the target device corresponds set of ECG features described in Figure 1, and I be the set
to the Nymi Band. In other words, we aim to find a function of subjects we use for computing the mapping. The training
that, given in input an ECG signal from a source device, is dataset consists of the sets ECGS and ECGT of
able to produce the “same” signal as if it was recorded on the ECG signals recorded, for
eac{
h
subi je} ci t∈I
i I,
w{
ith
thi e}i s∈oI
urce
∈
target device. and target device, respectively. The method is based on the
following steps:
In this way, the mapping function can mitigate and even
eliminate the statistical differences in biometric features that 1) Feature extraction. From the input ECG data, we extract
arise from using different measurement devices and modes. In the relevant biometric features. The outputs of this step are,
Figure 10, we compare the mean ECG signals recorded for the for each subject i I, sets of discrete probability distributions
same individuals but from different devices, showing that the S = DS ∈ and T = DT , where DS (DT )
signals exhibit device-specific morphologies, especially as far
D isi
the
d{ isti r, ij b} uj t∈ioJ
n of
ED Ci
G
fe{ atui r, ej}j j∈J
for
subjecti, ij
in
ti h,j
e
as amplitude features are concerned. For instance, we observe source(target)signal.Specifically,weconsiderthetimedomain
that for both subjects the palm measurements yield a more features summarized in Figure 1 and apply the algorithm of
prominent T wave, while Lead II signals yields the lowest [2] for their detection.
8TAmplitude
0.8
0.6
0.4
0.2
0 0 0.5
laitinI
Source:LeadII Target:Nymi
SAmplitude PAmplitude QAmplitude
0.8 0.5 0.5
0.4 0.4 0.6
0.3 0.3
0.4
0.2 0.2
0.2 0.1 0.1
0 0 0 0 0.5 0 0.1 0.2 0 0.1 0.2
0.8
0.6
0.4
0.2
0
0 0.5
demrofsnarT
PDuration TDuration(L) TDuration(R)
0.8 0.4 0.4
0.6 0.3 0.3
0.4 0.2 0.2
0.2 0.1 0.1
0 0 0 0 0.1 0.2 0 0.1 0.2 0 0.1 0.2
0.5 0.5 0.8 0.4 0.4
0.6 0.4 0.4 0.6 0.3 0.3
0.4 0.3 0.3
0.4 0.2 0.2
0.2 0.2
0.2 0.2 0.1 0.1
0.1 0.1
0 0 0 0 0 0
0 0.5 0 0.1 0.2 0 0.1 0.2 0 0.1 0.2 0 0.1 0.2 0 0.1 0.2
Fig. 12: Feature distributions before (first row) and after (second row) the application of the mapping function. T width (L) and
(R) denote the left and right component of the T width (see Figure 1).
1
0
0
Phase (radians)
egatlov
desilamroN
Mean ECG. Subject: 1256
Mobile (attack)
Nymi 1
Mobile
0
−π π 0
Phase (radians)
(a)Mobile
egatlov
desilamroN
Mean ECG. Subject:9234
Palm (attack)
Nymi
Palm
−π π
(b)Palm
Fig. 13: Comparison of mean ECGs among source signal, corresponding attack signal and target Nymi signal.
2) Mapping estimation. This boils down to an optimisation are linearly related [14]. Moreover, unlike more complicated
problem (described in Section V-A) where we seek to find transformationfunctions(e.g.polynomialorlogarithmic),linear
an optimal mapping, i.e., a set of transformation functions mappings do not suffer from over-fitting problems when using
f = f with f : R R, such that, for each feature j small training datasets [11].
j j J j
ands{ ubj} ec∈ti,theyminimis→−
ethestatisticaldistancebetweenthe
transformed source distribution f j(D iS ,j) and the corresponding Figure 12 compares the distributions of a selection of ECG
target distribution DT 2. In other words, f transforms values features before and after applying the mapping function. In
i,j j
of feature j from device S in order to be as close as possible, this case, Lead II is the source device and the Nymi Band
statistically speaking, to the values of the same feature from is the target. Input data is obtained from a subject in our
device T. We restrict the search to linear functions, of the trainingset.Theplotsdemonstratethat,afterthetransformation,
form: the distributions of source features (blue bars) practically
f (x)=a x+b (1) overlap with the corresponding target distributions (red bars),
j j j
consistently reducing the statistical differences observed for
Note that linear mappings are adequate in this context because
the initial, non-transformed, source features.
the amplitudes of the ECG wave peaks along different leads
Once estimated, the mapping f between S and T is used to
2Technically,fordiscretedistributionD,fj(D)isthedistributionwhose
supportistheimageofsupp(D)underfj (supp(fj(D))=fj[supp(D)]) generate attack signals for device T starting from new signals
and with probability mass function defined, for x ∈ supp(fj(D)), by recordedwithS.Leti (cid:48) I beourvictim,forwhichwepossess
f fj j( ,D th) a( tx is) ,= all(cid:80) thx e(cid:48)∈ elf ej− m1 e[ nx t] sD x( (cid:48)x ∈(cid:48)) sw uph pe (re Df )j− su1 c[x h] this atth xe =pre fi jm (xag (cid:48))e .ofxunder a cn onS si- ss ti sgn oa fl tE heCG foS i l(cid:48)l. oT wh ine(cid:54)∈ gpr so tec pe sd :ure, illustrated in Figure 11 (b),
91) Extract the feature distributions S from the source signal and poorly for few of them (the outliers). This approach has
ECGS.
Di(cid:48)
the added advantage to bypass subjects with inaccurate input
i(cid:48)
ECG data, e.g., through noise introduced through excessive
2) Apply the estimated mapping function f to derive the
movement. These cases are indeed very likely to be identified
transformed features distributions: f( S)= f (DS ) .
Di(cid:48) { j i(cid:48),j }j ∈J as outliers.
3) Produce an attack signal by generating a synthetic ECG
Regarding the feasible region of the optimization problem,
signal out of the transformed features f( S), as explained in Equation 3 ensures that the linear coefficients are bounded in
Section V-B.
Di(cid:48)
some real-valued interval [k ,k ]. The purpose of Equations
j⊥ j(cid:62)
4 and 5 is to constrain the ranges of the transformed source
In Figure 13, we compare the original source signal, the
features,inawaythattheyaresimilartotherangesofthetarget
corresponding attack ECG generated from the transformed
features. Preliminary results showed that these constraints are
features and the target signal of a participant from the training
crucial to ensure that the corresponding attack signal resembles
set. We observe that the attack signal prominently improves on a biologically realistic ECG. For subject i and feature j, let
the original one, in some sections being virtually identical to DT,min and DT,max be the minimum and the maximum values
the target signal that we aim to reproduce. This demonstrates i,j i,j
of distribution DT , respectively3. We define the lower and the
the effectiveness of our synthetic ECG generation: as the i,j
upper bounds for the transformed features as:
transformed ECG features get closer to the target features,
the generated attack signal better emulates the target signal. DT,min∗ =(1−q)·minDT,min and DT,max∗ =(1+q)·maxDT,max
j i,j j i,j
Nevertheless,themappingfunctionisdesignedtobeasgeneral i∈I i∈I
as possible and to be effective for the whole training dataset, where q (0,1) is a factor for relaxing the range width. The
∈
which explains why not all subject-specific differences can be resulting range constraints are given, for all points x in the
eliminated, see for instance the higher P wave of the attack support of the source distribution DS by:
i,j
signal in plot (a), or the lower T wave in plot (b).
Wewouldliketostressthegeneralityofourmethod,which a j ·x+b j ∈ D jT,min ∗,D jT,max ∗ . (6)
mostly relies on estimating linear transformations between sets (cid:104) (cid:105)
Note that the number of such constraints quickly explodes with
ofbiometricfeatures.Indeed,themethodcanbeeasilyextended
the number of subjects, features and distinct data points per
to support other classes of biometrics, provided the availability
feature. However, by the monotonicity of the linear mappings,
of algorithms for feature extraction and generation of synthetic
it suffices to check Equation 6 only for the minimum and
signals. maximum values of DS , denoted respectively by DS,min and
i,j i,j
DS,max, thus yielding Equations 4 and 5. Importantly, this
A. Optimization Problem i,j
implies that our estimation method supports not just linear
We formulate the problem of finding the best mapping functions, but general monotonic functions.
function as a non-linear constrained single-objective optimiza-
Statistical distance. The distance function of Equation 2 is
tion problem that we solve using a genetic algorithm [9]. The
defined as the mean of the statistical distances between the
problem is defined as follows:
transformed and the target distributions over all the features:
1
d f( S), T = d f (DS ),DT .
minimize d f( S), T (2) Di Di J s j i,j i,j
(aj,bj)j ∈J i (cid:88)∈I∗
(cid:0)
Di Di
(cid:1) where d
(cid:0)
is a
generic(cid:1) stati| sti| ca(cid:88)j l∈J dista(cid:0)
nce. Among
th(cid:1)
e possible
subject to a ,b [k ,k ] (3) s
i I,j J
j j ∈ j⊥ j(cid:62) candidates for d s, we chose the L2 distance between distribu-
∈ ∈ tions. Let S and T be the piece-wise linear estimations
a j ·D iS ,, jmin+b j ∈ D iT ,j,min ∗,D jT,max ∗ (4) of the cumF ui l, aj tive diF sti r,j ibution functions of f(D iS ,j) and D iT ,j,
a
j
·D iS ,, jmax+b
j
∈(cid:104) D iT ,j,min ∗,D jT,max ∗(cid:105) (5) r fues np ce tic ot niv sely. STh ane dn, w Te d [2efi 2,ne Chd as pa tes rt 1h ]e :L2 distance between
(cid:104) (cid:105)
Fi,j Fi,j
coefT fih ce ied ne tc sis ai jon anv dar bia jb cle hs aa rare c, tef ro ir sie na gch thf eea trtu ar ne sfj or∈ mJ at, ioth ne fli jne wa er
d
s(cid:16)
f j(D iS ,j),D iT
,j(cid:17)
=w
j(cid:32) (cid:90) D jT,max ∗(cid:16)
F iS ,j(x)−F iT
,j(x)(cid:17)2 dx(cid:33)1 2
seek to estimate (see Equation 1). The objective function is D jT,min ∗
the sum over subjects i I I of the distance between
t ch oe rretr sa pn os nf do ir nm ged tars go eu trc de istd∈ rii bst ur∗ ti ib o⊆ u nt sions T.of Hi e, ref(
dD
iiS s), aa gn ed net rh ie
c
w isah te ir oe nw faj c= torD
.
IjT n,m ta hx e∗
i−
mpD lejT m,m ei nn t∗ ati is oni ,nt tr ho edu ac be od veas ina ten go rr am la il s-
Di approximated using a composite mid-point quadrature formula.
distancemeasure(discussedlater).Inparticular,I isasubsetof
∗
thetrainingsetI andisobtainedasfollows:1)wecomputethe
distances d f( S), T for all i I; 2) we apply the Grubbs’ B. Synthetic Signal Generation
Di Di ∈
test[10]todetectthesetofoutliersI I onthesedistances;3)
(cid:48) SyntheticECGsignalsaregeneratedasthesumofGaussian
weremove(cid:0)theidentified(cid:1)outliers:I =⊆ I I .Thesethreesteps
∗ (cid:48) functions, used to reproduce the typical bell-shaped curves of
\
arerepeateduntilamaximumnumberofoutliersisremovedor
the ECG waves and parametrised by sampling values from a
no further outliers are identified. The rationale for considering
I ∗ instead of I in the objective function is that we do not 3Withabuseofnotation,theminimumandmaximumofadiscretedistribution
want to penalise mappings that perform well for most subjects D aremeantastheminimumandmaximumofitssupport.
10given set of feature distributions. As previously explained, for Unfortunately, it remains unknown to what degree the
attack signals we consider ECG features after the application techniques and algorithms described in [6] have been included
of some mapping function. in the authentication library currently being used by the
Nymi Band’s companion app. As such, we do not have any
Themethodextends[16],[2]inordertosupportasymmetric
prior knowledge of the classifiers or features used in the
ECG waves, which are physiologically more accurate, thus
authentication process. Nevertheless, we can use the NCA
leading to attack signals that better emulate the Nymi Band’s
as an oracle by querying it with an ECG signal and recording
ECG, as discussed in Section V-C.
the response (i.e., an accept or a reject of the signal).
Let (PP 1,...,PP n 1) be the sequence of PP intervals de- The main obstacle to such an extensive analysis is the time
tectedfromthesources−ignal.Thesequenceisusedtodetermine
needed to inject attack signals using a waveform generator or a
the beginning of each heart cycle such that, for h=1,...,n,
sound player. To overcome this limitation we devised another
theh-thheartcyclestartsattimeT h =T 0+ k<hPP k,where kind of attack, called offline attack, which is instantiated by
T 0 is the offset of the first P wave. directly interfacing with HeartID through the API calls of
(cid:80)
For each ECG wave kind w P,Q,R,S,T and heart the NCA (Nymi Band’s companion app). We implemented a
cycleh=1,...,n,theconsidered∈fe{aturesare:wav}eamplitude, simple Android app that allows setting up previously stored
A ; wave peak location relative to the start of the h-th cycle, biometric templates and performing authentication for arbitrary
w,h
L ; and left and right components of the wave width at attack signals, at a rate of hundreds of signals per minute,
w,h
half amplitude, Wl and Wr . Note that peak locations are without requiring a waveform generator or Nymi Band. Our
w,h w,h
easily derived from the interval features shown in Figure 1. devised Android app does not require physical ECG input, but
The synthetic ECG at time t is defined as follows: accepts biometric template and biometric samples in digital
form via a command line interface and forwards them to the
s(t)=(cid:88)n (cid:88) G(cid:16) t,T +L ,A ,Wl ,Wr (cid:17) HeartID library. For every authentication attempt, the library’s
h w,h1 w,h2 w,h3 w,h4
authentication decision is stored in a database by our Android
h=1w∈{P,Q,R,S,T}
(7) app for later analysis.
whereG t,T +L ,A ,Wl ,Wr isthevalueat
h w,h1 w,h2 w,h3 w,h4 We remark, however, that the final results of Section VI
pointtof(cid:16)anasymmetricGaussiancurvecentred(cid:17)atT h+L w,h1, are obtained online, i.e., using the actual Nymi Band.
with amplitude A , and full width at half maximum made
of left
componenw t, Wh2
l and right component Wr . G is The experiments below were performed on a selection of 8
w,h3 w,h4 subjectsfromthetrainingset.Foreachexperiment,subjectand
given by:
device, we tested 20 randomly generated attack signals. We
2 recall that the synthetic ECG is generated by sampling features
(t L)
G t,L,A,Wl,Wr =A exp 4 log2 − from distributions, hence the reason of their randomness. The
· (cid:32)− · · W(t)2 (cid:33) reported success rate (SR) is the ratio between successful
(cid:0) (cid:1)
authentications and total attempts. As expected, the enrolment
where W(t)=Wl if t L and W(t)=Wr otherwise.
signals used to build the biometric templates yielded an SR of
≤
100%.
Note that in Equation 7 the features used to generate the
Gaussian curve are not necessarily drawn from the same heart
Filtering. We evaluate the adequacy of our ECG filtering
cycle h. Specifically, for each cycle h, we randomly sample
algorithm, which builds on a Savitzky-Golay (SG) smoothing
the heart cycles h ,...,h from which location, amplitude
1 4 filter [17]. We applied the SG filter to the enrolment signals,
and width features are extracted. Based on preliminary results,
obtaining for them an SR of 100%. Stronger SG smoothing
among the possible sampling strategies, we choose peak loca-
parametersresultedinSRsbelow63%.Wealsowantedtoassess
tion and widths from the same heart cycle, i.e., h =h =h .
1 3 4 how noise affects authentication chances. To this purpose, we
added to the filtered signal white Gaussian noise with standard
Importantly, such generated synthetic ECGs account for
deviation computed from the enrolment signal. These yielded
the specific inter-beat patterns of the subject (another common
an SR of 100%, demonstrating that the filtering method of
ECG biometric feature), since we use the same PP sequences
HeartID can equally support noisy and filtered ECG data. Note
detected from the source signal.
that the above experiments did not require the generation of
synthetic ECGs.
C. Evaluation
Synthetic signal generation. Here, we assess the fit of our
In this section, we perform an in-depth evaluation of the synthetic ECG signals. To this purpose, we generated signals
methods for estimating mapping functions and generating drawing on the features detected in the enrolment ECGs, and
synthetic signals. The aim of the following experiments is reproduced in the same order. These signals resulted in an
to obtain insight into HeartID, the Nymi Band’s authentication overallSRof75%,withanSRof100%for5outof8subjects.
and biometric recognition library, in order to devise the best To understand if HeartID is sensitive to all the ECG waves, we
design choices for our methods, such as the ECG features to furtherproducesignalswhereoneofthewavesissystematically
include in the mapping or the filtering algorithm to use in the suppressedbysettingitsamplitudeto0.Foreachwavekind,the
ECG detection procedure. There is only very little information obtained SR was 0%, suggesting that all ECG waves are used
available about the algorithms used in HeartID apart from [6] in the biometric template. In a variation of the first experiment,
which proposes a continuous biometric recognition system we test signals with symmetric waves, resulting in an SR drop
based on ECG called HeartID. from 75% to 15%. This motivates our claim that asymmetric
11User LeadI LeadII Mobile Palm Combined Nymi User LeadI LeadII Mobile Palm Combined
1 (cid:55) (cid:55) (cid:55) (cid:55) (cid:55) (cid:51) 1 (cid:55) (cid:55) (cid:55) (cid:51) (cid:51)
2 (cid:55) (cid:51) (cid:55) (cid:55) (cid:51) (cid:51) 2 (cid:55) (cid:51) (cid:55) (cid:55) (cid:51)
3 (cid:55) (cid:55) (cid:55) (cid:55) (cid:55) (cid:55) 3 (cid:55) (cid:55) (cid:55) (cid:55) (cid:55)
4 (cid:55) (cid:55) (cid:55) (cid:55) (cid:55) (cid:51) 4 (cid:55) (cid:55) (cid:55) (cid:55) (cid:55)
5 (cid:55) (cid:55) (cid:51) (cid:55) (cid:51) (cid:51) 5 (cid:51) (cid:55) (cid:51) (cid:51) (cid:51)
6 (cid:55) (cid:55) (cid:55) (cid:55) (cid:55) (cid:51) 6 (cid:55) (cid:55) (cid:55) (cid:55) (cid:55)
7 (cid:55) (cid:55) (cid:55) (cid:55) (cid:55) (cid:51) 7 (cid:55) (cid:55) (cid:55) (cid:55) (cid:55)
8 N/A N/A (cid:51) (cid:55) (cid:51) (cid:55) 8 N/A N/A (cid:51) (cid:55) (cid:51)
9 N/A N/A (cid:55) (cid:55) (cid:55) (cid:51) 9 N/A N/A (cid:55) (cid:55) (cid:55)
10 (cid:55) (cid:55) (cid:55) (cid:55) (cid:55) (cid:51) 10 (cid:55) (cid:55) (cid:51) (cid:55) (cid:51)
11 (cid:55) (cid:55) (cid:55) (cid:55) (cid:55) (cid:51) 11 (cid:55) (cid:55) (cid:55) (cid:55) (cid:55)
12 (cid:51) (cid:55) (cid:51) (cid:55) (cid:51) (cid:51) 12 (cid:51) (cid:55) (cid:51) (cid:55) (cid:51)
13 (cid:51) (cid:55) (cid:55) (cid:55) (cid:51) (cid:51) 13 (cid:51) (cid:55) (cid:55) (cid:55) (cid:51)
14 (cid:55) (cid:55) (cid:51) (cid:55) (cid:51) (cid:51) 14 (cid:51) (cid:55) (cid:55) (cid:55) (cid:51)
15 (cid:51) (cid:55) (cid:55) (cid:55) (cid:51) (cid:55) 15 (cid:51) (cid:55) (cid:51) (cid:51) (cid:51)
16 (cid:55) (cid:55) (cid:55) (cid:55) (cid:55) (cid:55) 16 (cid:55) (cid:55) (cid:55) (cid:55) (cid:55)
17 N/A N/A (cid:55) (cid:55) (cid:55) (cid:51) 17 N/A N/A (cid:55) (cid:55) (cid:55)
18 (cid:55) (cid:55) (cid:55) (cid:55) (cid:55) (cid:51) 18 (cid:51) (cid:55) (cid:55) (cid:55) (cid:51)
19 (cid:55) (cid:55) (cid:55) (cid:55) (cid:55) (cid:51) 19 (cid:51) (cid:55) (cid:55) (cid:51) (cid:51)
20 (cid:51) (cid:55) (cid:51) (cid:55) (cid:51) (cid:51) 20 (cid:51) (cid:55) (cid:51) (cid:55) (cid:51)
21 (cid:51) (cid:55) (cid:51) (cid:55) (cid:51) (cid:51) 21 (cid:51) (cid:55) (cid:51) (cid:51) (cid:51)
TABLE II: Results of injecting the unmodified raw data. TABLE III: Results of injecting the data generated by applying
”Combined” refers to the combination of all non-Nymi devices. the mapping function. The shaded cells show the results that
The tick marks signify users that were successfully attacked. differ from Table II. Due to source and target device being
identical, the mapping function is not applied to the Nymi
SDK data. The tick marks signify users that were successfully
attacked.
waves are needed in order to produce realistic and successful
attack signals. Finally, we report that subject-specific ECG
features are indeed central for authentication: signals generated
using default parameters from literature [4] produced an SR of thatperformedpoorly(SR=11.5%)isbuildingamappingfrom
0%. a single “super-individual”, obtained by merging the features
distributions across all subjects.
Statistical distance. Now that we have proved the adequacy
of the filtering and synthetic signal generation algorithms,
VI. RESULTS
the next step is evaluating the mapping function. In this
experimentwewanttoassess howdifferentstatistical distances
in the optimisation problem of Section V-A affect the success
rate. Here, we restrict to one-2-one mappings, i.e., mappings We conduct the signal injection attack by combining the
estimated over data from a single subject. In contrast to the building blocks described in the previous sections. After
default mappings, one-2-one mappings are tailored to the enrollingauserintotheNymiBand,wefirstinjecttherawdata
subject, meaning that the resulting attack signal better mimics that was collected using each of the devices (see Section IV).
the target ECG. However, these cannot be used to instantiate Followingthat,weapplythemappingfunction,whichhasbeen
an attack, since they require the victim’s enrolment signal. We trained on the initial set of users (i.e., not including the user
compare the previously introduced L2 distance with the χ2 that is being attacked) to obtain the transformed signals. As
index for empirical distributions and the Kolmogorov-Smirnov outlined in Section V, the mapping function employs random
statistic (KS) [5]. Using L2, we get an overall SR of 49.9%, sampling of features to generate the attack signal. We use
while for χ2 and KS, the SR is 29.5% and 39.6%, respectively. between2and4repetitionsofthissamplingprocessandreport
This supports our choice of L2. whether at least one of them was accepted by the Nymi Band.
As the Nymi Band does not limit the number of authentication
Mappingstrategies.Wefinallyevaluateanumberofalternatives
attempts a user can make, the only cost of repetitions lies in an
to the default mapping functions. Signals generated using the
increased time required to carry out the attack. Due to space
defaultsettings,wherethemappingisestimatedfromthewhole
constraints we report only the results of injecting the ECG
training dataset and considers the full set of ECG features,
signals by playing back .wav files using an off-the-shelf music
resulted in an SR of 26.2%. Slightly worse success rates are
player. As we have discussed in Section III, the performance
obtained when some of the features are not transformed, i.e.,
that can be expected is similar for all three devices, and the
left as detected in the source signal: the overall SR is 22.8%,
.wav playback poses the lowest technological barrier for the
21.1%and20%ifexcluding,respectively,widths,peakintervals
attacker,bothintermsofcostandcompactness.Therawresults
and both. As expected, the exclusion of amplitude features has
of our analysis are shown in Table II and III, a summary is
shown no significant success. We get comparable results when
shown in Figure 14. For 3 out of 21 users we were unable to
consideringsub-optimalmappingsinplaceofthebestmapping
collect high-quality signals using the external electrodes of the
function found by the optimisation algorithm: for the second
ECG monitor, leaving us with 18 attack attempts for the Lead
and third best mappings, we have SRs of 21.5% and 21.9%,
I and Lead II data sources.
respectively. We also learnt that one-2-one mappings estimated
from one single subject are mostly ineffective for attacking a Not surprisingly, the success rate of injecting data collected
different subject (SR = 4.4%), thus confirming the importance with the Nymi Band is the highest. With the exception of four
of gathering a substantial training dataset. Another alternative users,usingthisdataresultedinunlockingtheband,leadingtoa
120.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0.0
Lead I Lead II Palm Mobile combined Nymi SDK
sresu
dekcatta
yllufsseccus
fo
noitcarF
attacker to obtain a different source of ECG information. In
Results with raw and mapped data the medical domain it is necessary to measure multiple ECG
Unmapped 0.810.81 leads as they contain different kinds of information, so it is
Mapped not implausible that this is similar for identifying (biometric)
information.
0.62
Overall, the attacker’s chance of success is 81% assuming
0.50 they have obtained a measurement through the Nymi Band,
and 62% if they have only obtained data from the remaining
0.43
sources. The latter is computed as the fraction of users for
0.33 which at least one of the four data sources led to a successful
0.28 0.29 activation of the band (shown as the ”Combined” column in
0.24
Table II and III)
0.060.06 VII. RELATEDWORK
0.00
Theincreasingpopularityofbiometricsasanauthentication
mechanism has sparked research into a variety of attacks.
Multiple approaches to imitate users or forge measurements
Fig. 14: Fraction of users successfully attacked. Results are
have been proposed, including attackers modifying their own
shown for raw data and the data obtained by applying the
behavior and attacks being carried out automatically.
mapping function.
Sharif et al. demonstrate an attack on face recognition
systems that relies on the attacker wearing a pair of printed
eyeglass frames [21]. Their approach enables the attacker
successrateof81%.However,twooutofthefourunsuccessful
to both impersonate a victim and to evade face detection.
users (3 and 6) failed to authenticate themselves following
The attack treats the classifier as a whitebox (i.e., assumes
enrolment. This hints that the failure of the attack is most
knowledge of the internals) and highlights the danger of using
likely a consequence of erratic or noisy data being collected
machine learning in adversarial settings.
during the enrolment phase. Injecting the Lead II measurement
succeeded only for a single user. Intuitively, this makes sense Tey et al. propose an attack on keystroke dynamics (distinc-
since Lead II measures voltage between the left leg and right tive typing patterns), targeting systems using the biometric for
arm (rather than the left and right arm, which is approximately password hardening [25]. The attack assumes the password to
what the Nymi Band observes). Conversely, Lead I performs be known to the attacker, who then has to mimic the legitimate
relatively well in the attack, succeeding in five out of 21 users user’skeystrokedynamicswhiletypingit.Theauthorsdevisea
(24%), most likely being a result of the similar measurement system that gives positive and negative feedback to the attacker
points. Based on this intuition, one would expect the palm regarding their closeness to being accepted. This feedback
measurements to perform similarly well, as the measurement relates to individual features, such as character hold times and
points(palmofthelefthandandindexfingeroftherighthand) interkey times (i.e., the time between pressing two individual
are even closer to those used by the Nymi Band (wrist of left keys). Depending on the information given to the attackers,
hand and index finger of right hand). However, using these a false accept rate of up to 99% is achieved, suggesting
measurements caused the attack to fail for all users (and is the that it is possible for humans to adapt their own typing
only data source to do so). patterns enough to fool state-of-the-art systems. Nevertheless,
this approach assumes that both the password and the typing
Applyingthemappingfunctionconsiderablyimprovesthese
patterns are known, which requires either use of a keylogging
results,particularlyforthosedatasourcesthatperformedpoorly
device or a password database compromise. In addition, it is
initially. The success rate for using Lead I data improves from
doubtful whether this approach can be adapted to continuous
28% to 50%. The Palm measurements, which were initially
authenticationsystemsthatworkonfreetexts,ratherthanshort
unsuccessful for all users, could be used for successful attacks
passwords.
on 5 users, thus increasing the success rate from 0% to 24%.
The mobile ECG monitor data source is the only one where Touchscreen input biometrics have gained immense popu-
applying the mapping function causes the attack to fail for one larity over the past few years due to the rise of smartphones,
user.Thisismostreadilyexplainedbytheunmodifieddatajust tablets and other touchscreen devices. Zheng et al propose
being on the edge of being accepted. The only data source for an authentication system based on touchscreen input and also
which the mapping function had no effect (positive or negative) measure the advantage gained by attackers through observing
is the Lead II data obtained from the ECG monitor. This could the victim [27]. The results indicate that simple observation is
be either due to limitations of the mapping function (such not enough to trick the system, although their work assumes
as the precise feature set of the Nymi Band being unknown), that the attackers have no specific knowledge of the system’s
or due to important biometric information simply not being features. As such, the failed impersonation could be due to
presentinthislead.Theformercasecouldpossiblyberemedied insufficient information, or the fact that touchscreen inputs are
by obtaining a better understanding of the biometric features inherently difficult for humans to mimic. Serwadda et al. take
involved (which is difficult in a blackbox scenario as presented a different approach by building a Lego robot to carry out the
by the Nymi Band). In the latter case, it is not possible to find attack, rather than having a human modify their behavior [20].
a mapping between the feature distributions, thus requiring the Insteadofusingbiometricdatafromthetargetedlegitimateuser,
13they create a “catch-all” attack based on population statistics. biometric across different devices. For example, once a user
Using a subset of all users, they train the robot to perform is successfully enrolled for one device (e.g., a smartphone for
swipes and scrolls in a way that is sufficiently common for a the touchscreen input biometric), he could be authenticated on
high number of users. Carrying out the attack increases the any other device without the need for re-enrolment, provided
system’sEqualErrorRate(EER)bybetween339%and1004%. a mapping function between these devices has been trained
At present, authentication systems based on touchscreen inputs beforehand.
are not commercially available, causing the authors to create
their own. While they loosely base their features and system
IX. CONCLUSION
design on the popular work by Frank et al. [7], the initial (i.e.,
before the attack) EER (13%) of the system is much higher In this work we have presented a novel presentation
even after excluding users exhibiting poor error rates. Unlike attack against ECG biometrics and have demonstrated its
a regular single-target imitation attack, the proposed attack effectiveness in attacking the Nymi Band. The Nymi Band
targets multiple users at once and therefore requires an overlap is a commercially available wristband that is currently being
between users’ templates that would be unlikely to be found in trialledbyMasterCardtoauthenticatethewearerforcontactless
systems with lower error rates. As such it is doubtful whether payments. After collecting ECG data from 41 volunteers on
the described attack is as effective or applicable at all when differentdevices,weobservedthatthedistributionsofbiometric
using state-of-the-art systems. features vary between these devices as well as different ECG
measurement positions (Leads). This presents an attacker with
difficulties when performing a presentation attack with data
VIII. DISCUSSIONANDCOUNTERMEASURES
gathered on a different device. To address this challenge we
In the previous sections we have outlined an effective describe a so-called mapping function, which transforms ECG
presentation attack against ECG biometrics in general and signals measured on any device to change its morphology to
have shown its effectiveness when applied to the Nymi Band. match that of the Nymi Band. We use half of the subjects in
Most generally, there are two main approaches to mitigate the our dataset to train the mapping function while the remainder
attack: is set aside to evaluate the actual attack. We use a number of
signal injection methods, including a hardware signal generator
The first approach is liveness detection. Liveness detection and the playback of an ECG signal encoded as a .wav file.
attempts to detect an injected signal and distinguish it from As such, the technological barriers to carry out the attack are
a signal originating from a human. This technique has been extremelylowintermsofbothcostandhardwarerequirements.
applied with varying degrees of effectiveness for other biomet- Our results show that injecting ECG data collected with the
rics. The case of fingerprint readers in particular showcases Nymi Band shows the highest success rate (81%). When using
that this is most likely an arms race between system designers only the remaining signal sources we achieve a success rate
considering more indications of liveness (e.g., the presence of 43%, which increases to 62% after applying the mapping
of skin oils or moisture for fingerprint readers) and attackers function.
spoofing these indicators.
Ourresultsconfirmtheseriousnessoftheattack.Duetothe
The second approach would be to keep the biometric data universality of the mapping function and our signal injection
secret, thus attempting to prevent the attacker from obtaining devices, we expect the attack to show similar performance
any of the victim’s ECG data. One could make the case that against other ECG-based authentication systems. We intend to
the Nymi Band’s SDK should not allow for ECG data to further explore this once more systems become commercially
be recorded, either through NEAs or otherwise. Disabling available.
this functionality would make it at least significantly harder
for the attacker to directly obtain data with the correct ECG
ACKNOWLEDGEMENTS
morphology.Ascreatingthemappingfunctionrequirestraining
data from the target device, making this data hard to obtain This work was partially supported by the ERC AdG
would also raise the bar to carry out the attack. However, VERIWARE and the Engineering and Physical Sciences Re-
it might still be possible to determine the device-specific search Council [grant number EP/M50659X/1]. Andrea Patane´
effects on the signal by analysing the hardware, rather than contributed to the work during an internship funded by the
through empirical analysis of recorded signals. As we have ERC AdG VERIWARE .
demonstrated, the mapping function allows the attacker to
obtain data from an arbitrary device and use it to attack
REFERENCES
the authentication system. While the probability of success
somewhat depends on the device, we have demonstrated [1] F. Agrafioti, D. Hatzinakos, and J. Gao, Heart biometrics: Theory,
successful attacks using all of the devices we analyzed. Due methodsandapplications. INTECHOpenAccessPublisher,2011.
to the large variety of devices recording ECG (e.g., medical [2] B.Barbot,M.Kwiatkowska,A.Mereacre,andN.Paoletti,“Estimation
ECG monitors, fitness devices, e-health) for purposes other andverificationofhybridheartmodelsforpersonalisedmedicaland
wearable devices,” in Computational Methods in Systems Biology.
than authentication, we do not consider keeping the ECG data
Springer,2015,pp.3–7.
secret a viable strategy.
[3] J.Bonneau,“Thescienceofguessing:analyzingananonymizedcorpus
of70millionpasswords,”in2012IEEESymposiumonSecurityand
Inthisworkwehaveappliedthemappingfunctioninaway
Privacy(SP). IEEE,2012,pp.538–552.
that allows us to attack an ECG-based authentication system
[4] G.D.Clifford,F.Azuaje,andP.McSharry,“Ecgstatistics,noise,artifacts,
with data collected on a different device. However, the same
andmissingdata,”AdvancedMethodsandToolsforECGDataAnalysis,
approach can be used to improve the interoperability of a vol.6,p.18,2006.
14[5] G.W.CorderandD.I.Foreman,Nonparametricstatistics:Astep-by-step Biomedical Engineering, IEEE Transactions on, vol. 50, no. 3, pp.
approach. JohnWiley&Sons,2014. 289–294,2003.
[6] S. Z. Fatemian, F. Agrafioti, and D. Hatzinakos, “Heartid: Cardiac [17] S.J.Orfanidis,Introductiontosignalprocessing. Prentice-Hall,Inc.,
biometricrecognition,”inBiometrics:TheoryApplicationsandSystems 1995.
(BTAS),2010FourthIEEEInternationalConferenceon. IEEE,2010, [18] A.PantelopoulosandN.G.Bourbakis,“Asurveyonwearablesensor-
pp.1–5. basedsystemsforhealthmonitoringandprognosis,”IEEETransactions
[7] M.Frank,R.Biedert,E.Ma,I.Martinovic,andD.Song,“Touchalytics: onSystems,Man,andCybernetics,PartC(ApplicationsandReviews),
Ontheapplicabilityoftouchscreeninputasabehavioralbiometricfor vol.40,no.1,pp.1–12,2010.
continuousauthentication,”IEEEtransactionsoninformationforensics [19] R. Sameni, M. B. Shamsollahi, C. Jutten, and G. D. Clifford, “A
andsecurity,vol.8,no.1,pp.136–148,2013. nonlinearBayesianfilteringframeworkforECGdenoising,”Biomedical
[8] A. Fratini, M. Sansone, P. Bifulco, and M. Cesarelli, “Individual Engineering, IEEE Transactions on, vol. 54, no. 12, pp. 2172–2185,
identificationviaelectrocardiogramanalysis,”Biomedicalengineering 2007.
online,vol.14,no.1,p.1,2015. [20] A.SerwaddaandV.V.Phoha,“Whenkids’toysbreachmobilephone
[9] D.E.Goldberg,Geneticalgorithms. PearsonEducationIndia,2006. security,” in Proceedings of the 2013 ACM SIGSAC conference on
[10] F.E.Grubbs,“Samplecriteriafortestingoutlyingobservations,”The Computer&communicationssecurity. ACM,2013,pp.599–610.
AnnalsofMathematicalStatistics,pp.27–58,1950. [21] M.Sharif,S.Bhagavatula,L.Bauer,andM.K.Reiter,“Accessorizeto
[11] D. M. Hawkins, “The problem of overfitting,” Journal of chemical acrime:Realandstealthyattacksonstate-of-the-artfacerecognition,”
informationandcomputersciences,vol.44,no.1,pp.1–12,2004. inProceedingsofthe2016ACMSIGSACConferenceonComputerand
CommunicationsSecurity. ACM,2016,pp.1528–1540.
[12] Z.Li,W.Han,andW.Xu,“Alarge-scaleempiricalanalysisofchinese
webpasswords,”inProc.23rdUSENIXSecuritySymposium,USENIX [22] E. M. Stein and R. Shakarchi, Functional analysis: introduction to
Security(August2014),2014. furthertopicsinanalysis. PrincetonUniversityPress,2011,vol.4.
[13] J.Ma,W.Yang,M.Luo,andN.Li,“Astudyofprobabilisticpassword [23] E.StobertandR.Biddle,“Thepasswordlifecycle:userbehaviourin
models,”inSecurityandPrivacy(SP),2014IEEESymposiumon. IEEE, managingpasswords,”inProc.SOUPS,2014.
2014,pp.689–704. [24] F.Sufi,I.Khalil,andJ.Hu,“Ecg-basedauthentication,”inHandbookof
[14] J. Malmivuo and R. Plonsey, Bioelectromagnetism: principles and InformationandCommunicationSecurity. Springer,2010,pp.309–331.
applicationsofbioelectricandbiomagneticfields. OxfordUniversity [25] C.M.Tey,P.Gupta,andD.Gao,“Icanbeyou:Questioningtheuse
Press,USA,1995. ofkeystrokedynamicsasbiometrics,”2013.
[15] M.L.Mazurek,S.Komanduri,T.Vidas,L.Bauer,N.Christin,L.F. [26] H.WimberlyandL.M.Liebrock,“Usingfingerprintauthenticationto
Cranor, P. G. Kelley, R. Shay, and B. Ur, “Measuring password reducesystemsecurity:Anempiricalstudy,”in2011IEEESymposium
guessabilityforanentireuniversity,”inProceedingsofthe2013ACM onSecurityandPrivacy. IEEE,2011,pp.32–46.
SIGSACconferenceonComputer&communicationssecurity. ACM, [27] N.Zheng,K.Bai,H.Huang,andH.Wang,“Youarehowyoutouch:
2013,pp.173–186. Userverificationonsmartphonesviatappingbehaviors,”in2014IEEE
[16] P. E. McSharry, G. D. Clifford, L. Tarassenko, L. Smith et al., “A 22ndInternationalConferenceonNetworkProtocols. IEEE,2014,pp.
dynamical model for generating synthetic electrocardiogram signals,” 221–232.
15