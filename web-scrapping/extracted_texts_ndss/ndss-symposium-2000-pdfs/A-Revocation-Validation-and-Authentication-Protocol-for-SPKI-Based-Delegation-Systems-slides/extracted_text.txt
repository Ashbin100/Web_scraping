T
A Revocation, Validation and
e
Authentication Protocol for SPKI
S Based Delegation Systems
S
2
A
{Yki.Kortesniemi, Tero.Hasu}@hut.fi
Jonna.Sars@nixu.fi
ä
lik
k
ie
H
o
h
u
J
9
9
9
1
©
e
t
a
lp
m
e
TOutline
T
e
Certificates

Revocation
S 
Quota

S
Proposed changes to SPKI

2
A The revocation protocol

Conclusions

ä
lik
k
ie
H
o
h
u
J
9
9
9
1
©
e
t
a
lp
m
e
TCertificates
T
e
Certificates are fixed-form digitally signed

documents
S
• Self-contained
S
Two main types

2 • Name/Identification (e.g. X.509)
A
• Authorisation (e.g. SPKI)
SPKI - Simple Public Key Infrastructure

ä
lik
k
ie • Five-tuple: Issuer, Subject, Tag,
H
o
h
u
J Delegation, Validity
9
9
9
1
©
e
t
a
lp
m
e
TNeed for revocation
T
e
Certificates are good for granting rights

But how do you revoke them in case of
S 
• exposure of private key
S
• misuse of rights
2 Certificates can not be deleted
A 
• unlike ACL entries
Requirements for revocation

ä
lik
k
ie
H • deterministic
o
h
u
J
9
9 • revocation interval controlled by issuer
9
1
©
e
t
a
lp
m
e
TCurrent revocation solutions
T
e
CRL and variations (e.g. Delta-CRL)

• Support offline operation
S
• Can include unnecessary information 
S waste bandwidth
Revocation Trees

2
A
• maintaining the tree requires computation
Bill of health

ä
lik
k
ie
H
o
h
u
J
9
9
9
1
©
e
t
a
lp
m
e
TSPKI Validity
T
e
Several possibilities (all optional)

• not before
S
• not after
S
• CRL (Certificate Revocation List)
• Reval
2
A
– Bill of Health
• One-time
ä
lik – free-form online condition
k
ie
H
o
h
u
J
9
9
9
1
©
e
t
a
lp
m
e
TProblems with SPKI
T
e
Using CRLs offline is very difficult

• multiple issuers  multiple CRLs
S
• multiple uses  multiple CRLs
S
• asynchronous  need network connection
often
2
A
Consolidating the revocations into only a

few CRLs is not good because of
ä
lik
• different revocation intervals and uses
k
ie
H
o
h
u
J
9
9
9
1
©
e
t
a
lp
m
e
TNeed for quota 1/2
T
e
Certificates mainly limit usage to a time

interval
S
• Within that limit can use the resource at will
S
We want more fine grained limits, such

as
2
A
• 3 hours per day (e.g. a database)
• 5 times (e.g. a bus ticket)
ä
lik
k • up to $1000 per month (e.g. a credit card)
ie
H
o
h
u
J
9
9
9
1
©
e
t
a
lp
m
e
TNeed for quota 2/2
T
e
Requirements for quota

• Quota model is selectable by the certificate
S
issuer
S • Prevents unauthorised usage of quota
• Prevents unauthorised monitoring of quota
2
A
usage
ä
lik
k
ie
H
o
h
u
J
9
9
9
1
©
e
t
a
lp
m
e
TProposed changes to SPKI
T
e
Deprecate CRL

Introduce Renew
S 
Introduce Limit

S
2
A Define query format

Define negative replies

ä
lik
k
ie
H
o
h
u
J
9
9
9
1
©
e
t
a
lp
m
e
TThe revocation protocol 1/2
T
e
Supports all SPKI revocation methods

(CRL, D-CRL, bill of health)
S
Supports quota (new online check type)

S
Fulfils the requirements

2
• deterministic, interval chosen by issuer
A
• quota model chosen by issuer
• prevents unauthorised usage and monitoring
ä
lik
k of quota
ie
H
o
h
u
J
9
9
9
1
©
e
t
a
lp
m
e
TThe revocation protocol 2/2
T
e
Security based on ISAKMP

Operation
S 
• User establishes connection to verifier
S
(authentication)
• The chain is completed
2
A
• User authorises quota checks
• Simple checks are made (= all except quota)
ä
lik
• Quota checks are made
k
ie
H
o
h
u • Service is granted
J
9
9
9
1
©
e
t
a
lp
m
e
TCritique of protocol
T
e
Has overhead

• Can sometimes be distributed over several
S
uses
S Creates state data in the verifier

Requires online connection
2 
A
ä
lik
k
ie
H
o
h
u
J
9
9
9
1
©
e
t
a
lp
m
e
TConclusions
T
e
Offline revocation methods like CRL are

not practical for SPKI
S
SPKI specification should be completed

S
Introducing quota opens up new

2 possibilities
A
Protocol can be implemented on top of

ISAKMP or another similar protocol
ä
lik
k
ie
H
o
h
u
J
9
9
9
1
©
e
t
a
lp
m
e
T