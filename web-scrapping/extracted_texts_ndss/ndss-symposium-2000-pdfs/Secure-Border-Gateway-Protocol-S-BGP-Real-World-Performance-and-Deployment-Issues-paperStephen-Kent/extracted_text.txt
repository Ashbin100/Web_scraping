Secure Border Gateway Protocol (S-BGP) — Real World Performance and
Deployment Issues
Stephen Kent, Charles Lynn, Joanne Mikkelson, and Karen Seo
BBN Technologies
Abstract configuration information, or routing databases may be
The Border Gateway Protocol (BGP), which is used to modified or replaced illicitly via unauthorized access to
distribute routing information between autonomous a router, or to a server from which router software is
systems, is an important component of the Internet’s downloaded, or via a spoofed distribution channel, etc.
routing infrastructure. Secure BGP (S-BGP) addresses Such attacks could result in transmission of fictitious
critical BGP vulnerabilities by providing a scalable BGP messages, modification or replay of valid
means of verifying the authenticity and authorization of messages, or suppression of valid messages. If
BGP control traffic. To facilitate widespread adoption, cryptographic keying material is used to secure BGP
S-BGP must avoid introducing undue overhead control traffic, that too may be compromised. We have
(processing, bandwidth, storage) and must be developed security enhancements to BGP that address
incrementally deployable, i.e., interoperable with BGP. most of these vulnerabilities by providing a secure,
To provide a proof of concept demonstration, we scalable system: Secure-BGP (S-BGP) [1,3]. Better
developed a prototype implementation of S-BGP and physical, procedural and basic communication security
deployed it in DARPA’s CAIRN testbed. Real Internet for BGP routers could address some of these attacks.
BGP traffic was fed to the testbed routers via replay of a However, such measures would not counter any of the
recorded BGP peering session with an ISP’s BGP many forms of attacks that compromise routers
router. This document describes the results of these themselves. Experience with accidental mis-
experiments – examining interoperability, the efficacy of configurations, and the many vulnerabilities of
the S-BGP countermeasures in securing BGP control management system components, strongly argue in
traffic, and their impact on BGP performance, and thus favor of countering such Byzantine failures if we are to
evaluating the feasibility of deployment in the Internet. provide adequate protection for the Internet.
The BGP-4 protocol, including descriptions of the
1. Border Gateway Protocol (BGP)
UPDATE message and the route propagation algorithm,
is described in [2,3]. Briefly, the numbers that identify
IP networks are specified by a prefix, which consists of
Internet routing is implemented using a distributed
a count of significant bits in an IP address and the value
system composed of many routers, grouped into
of those bits. An UPDATE consists of three parts:
administrative domains called Autonomous Systems
“withdrawals” - a list of prefixes for destinations that
(ASes). Routing information is exchanged between
are no longer reachable via a previously specified route;
ASes using Border Gateway Protocol (BGP) [2,3]
“network layer reachability information (NLRI)” - a list
UPDATE messages. BGP has a number of
of IPv4 address prefixes that are reachable; and “path
vulnerabilities [1,3,5] which can be exploited to cause
attributes” - the characteristics of the cumulative path
problems such as misdelivery or non-delivery of user
that can be used to reach the NLRI in this UPDATE.
traffic, misuse of network resources, network
These path attributes include reachability information
congestion and packet delays, and violation of local
for IPv6 address prefixes in the “Multi-Protocol
routing policies.
Reachable NLRI” and “Multi-Protocol Unreachable
NLRI” path attributes. The attribute used to specify the
Communication between BGP peers is subject to active
path, the AS_PATH attribute, is basically a sequence of
and passive wiretapping attacks. BGP and the TCP/IP
the Autonomous Systems (ASes) along the path, each
protocol used by it can be attacked. A BGP speaker can
identified by its AS number. When propagating an
be compromised, e.g., a speaker’s BGP-related software,
Page 1 of 14UPDATE to a neighboring AS, the BGP speaker 7. Finally, both the BGP speaker that sent the
prepends its AS number to the sequence, and updates UPDATE, and the peer that received the UPDATE,
other path attributes as appropriate. Since an UPDATE correctly applied BGP processing rules and the
can specify only one path, only address prefixes that (local) routing policy specified by it's AS.
share that path may be combined into the UPDATE. The security measures developed for BGP address the
first six of these requirements, even if one or more BGP
We maintain that security for BGP should be defined as speakers have been subverted. The last requirement is
the correct operation of BGP speakers. This definition is not addressed by S-BGP, primarily because of the
based on the observation that any successful attack considerable latitude afforded BGP speakers by local
against BGP should result in other than correct routing policies, and because ASes generally do not
operation, presumably yielding degraded routing. publish details of the policies. Without knowledge of
Correct operation of BGP depends upon the integrity, these local policies, other ASes cannot determine if
authenticity, and timeliness of the routing information local routing policies are being correctly applied.
that BGP distributes (via UPDATEs). It also depends on Moreover, because UPDATEs do not carry sequence
each BGP speaker’s processing, storage, and numbers, a BGP speaker is free to generate an
distribution of this information in accordance with both UPDATE based on old information, e.g., it may
the BGP specification and the routing policies of the advertise a route that was formerly valid but which has
BGP speaker’s Autonomous System. The been withdrawn. Thus, in the face of Byzantine failures
countermeasures being developed address the following (vs. active wiretapping attacks against inter-speaker
points of correct (secure) operation of BGP: links), the timeliness of UPDATEs is enforced only on a
very coarse basis by these countermeasures.
1. Each UPDATE that a BGP speaker receives from a
peer was sent by that peer, was not modified en- 1.1 Deployment of S-BGP in the Internet
route from that peer, and contains routing
information no less recent than the routing In addition to the basic problem of how to secure BGP,
information previously received for the indicated there is the problem of how to deploy the solution in the
destinations from that peer. Internet. Deploying S-BGP will require the adoption of
this technology by ISPs and by router vendors, plus PKI
2. The UPDATE was intended for the BGP speaker or support by the registries that allocate autonomous
AS that received it. system numbers to ISPs and DSPs (down-stream
providers), and address prefixes to customers. Because
3. The peer sending the UPDATE was authorized to of the distributed management of the Internet
act on behalf of its AS to advertise the routing infrastructure, the anticipated growth in the size and
information in the UPDATE to BGP speakers in the inter-connectivity of the Internet, the large volume of
recipient AS. BGP UPDATE traffic, and resource limitations in the
Internet’s routers and circuits, it is crucial that S-BGP
4. The AS originating the route, i.e., that contains the be scalable and incrementally deployable.
BGP speaker that originally included the list of
reachable destinations within the UPDATE, was • Scalability – The impact of S-BGP on a router’s
authorized to represent those destinations by the CPU and storage utilization, and on network
organization(s) that owns them. bandwidth must be within acceptable limits.
5. The organization owning the IP address space • Deployability – In order to successfully deploy
advertised in the UPDATE was allocated that S-BGP, two major issues need to be addressed.
address space through a chain of delegations First, S-BGP countermeasure information must be
originating at the ICANN (formerly IANA). forwarded between S-BGP routers in the same AS.
Also, since S-BGP introduces a new BGP path
6. If the UPDATE indicates a withdrawn route, i.e., attribute, one must provide backward compatibility
one that is no longer feasible, then the peer between S-BGP and BGP-4 so that it is possible to
withdrawing the route was previously authorized to incrementally deploy these countermeasures.
advertise that route.
Page 2 of 142. S-BGP countermeasures certification tree. For example, some ISPs and
subscriber organizations hold addresses assigned
This section provides a high-level overview of the directly by IANA, the predecessor to the ICANN.) The
S-BGP architecture. For further details see [1,3]. next tier generally consists of ISPs. An additional tier
Document [1] also contains an appendix that describes a represents DSPs or subscribers, when these entities
number of alternative approaches that were studied but participate in BGP. Note that only those entities that
not chosen, e.g., “path” and “neighbor” attestations (vs. execute BGP need these certificates. Finally, if an
the selected “route” attestation), because of organization owns multiple ranges of addresses, this
vulnerabilities in these approaches or because of adverse design calls for assigning a single certificate containing
performance implications. a list of address blocks, so as to minimize the number of
certificates needed to validate an UPDATE. (If an
2.1 Design constraints and assumptions organization acquires additional address blocks, a new
certificate is issued to reflect the increased scope of
ownership.) Figure 1 illustrates this certification tree,
The design of S-BGP was based on several assumptions
showing the organizations that are represented at each
and constraints. First, the countermeasures must not
tier.
violate the BGP specifications, e.g., any additional data
carried in UPDATEs must make use of defined
extension mechanisms and the maximum (BGP) packet ICANN
size must not be exceeded. Thus, for example, the
certificates and CRLs needed to support S-BGP are
transmitted out-of-band and we have chosen to carry
S-BGP data in-band, as an optional, transitive, path
attribute. The countermeasures should be dynamic,
responding quickly to topology changes, including the
APNIC ARIN RIPE
addition of a new AS, network, or router. The
performance impact of the countermeasures must be
minimal. Finally, the countermeasures should scale, as
the Internet continues to grow at a well-documented,
MCI GTE-I DSP 1 AT&T
substantial pace.
2.2 Security mechanisms
The S-BGP architecture employs three primary security Sub 1 DSP 2 Sub 2 Sub 3
mechanisms: PKIs, attestations, and IPsec.
We make use of a Public Key Infrastructure (PKI),
based on the use of X.509 v3 certificates, that supports
Sub 4 Sub 5 Sub 6
the authentication of IP address block ownership, AS
Number ownership, AS identification, and BGP router
identification and authorization to represent an AS. This Figure 1: Address Space PKI Structure
involves three kinds of certificates. The first type of
certificate binds a public key to an organization and to a The second type of certificate binds a public key to an
set of IP address prefixes. These certificates are used organization and a set of AS numbers, and the third
either to verify that an originating AS "owns" a binds a public key to an AS number and to a BGP router
specified portion of the IP address space, or that the ID. Together, these two types of certificates allow BGP
owner has authorized the AS to advertise the address speakers to authenticate one another, and to verify that a
space. The certificates are arranged into a singly-rooted given speaker is authorized to represent a specified AS.
hierarchy that parallels the existing IP address allocation Here too, the ICANN is the root of the hierarchy, and
system. Thus the ICANN is the root, and the next tier the second tier consists of registries. (The certificates
generally will consist of registries such as ARIN and issued by the ICANN to registries are conventional in
RIPE. (Because of historic allocation of addresses, this format and are employed to permit use of a single root
characterization is a simplification of the actual for all classes of certificates.) The third tier consists of
Page 3 of 14ISPs, DSPs, and subscribers. The second type of been authorized by the preceding AS along the path to
certificate is issued at the second tier, and the third type advertise the route, and that the originating AS has been
at the third tier. Lower tiers generally represent ASes authorized by the owner of each IP address prefix
and routers associated with higher tier organizations. contained in the UPDATE to advertise these prefixes.
Figure 2 illustrates a simple example of the tree The attestations are carried in a new, optional, BGP
structure for these two types of certificates, noting the transitive path attribute that contains digital signatures
organizations involved at the top three tiers, and the covering the routing information. Conceptually, there
ASes and routers that populate the lower tiers. are two types of attestations:
• Route attestations (RAs) — where the issuer is an
AS (or a router authorized to represent the AS) and
ICANN
the subject is a transit AS or another AS providing
third party advertisements for an AS that is not
running BGP.
• Address attestations (AAs) — where the issuer is
the organization that owns the address prefixes
contained in the attestation and the subject is one or
APNIC ARIN RIPE more ASes that are authorized to advertise these
prefixes, e.g., the organization’s Internet service
provider(s).
GTE-I DSP AT&T Figure 3 illustrates the layout of the Attestation Path
Attribute in an S-BGP UPDATE, and shows the
structure of an RA and how it relates to the BGP
UPDATE structure. Within an RA, there is a header,
the name of the entity that signed the RA (the issuer), a
GTE-I AS GTE-I Rtr DSP
back pointer to the certificate needed to validate the RA
(the certificate ID), and an indication of the algorithm
used to sign the RA. Finally, there is the data that is
protected by the RA, i.e., covered by the digital
signature. This includes a validity interval, the BGP
DSP AS DSP Rtr
speaker to which the RA applies (the subject), the AS
path and NLRI, and any other path attributes that must
Figure 2: AS Ownership and Router ID PKI be protected. Note that there is one RA for each AS in
the path.
There already exist procedures and personnel to manage
the assignment of IP address prefixes and AS numbers. IPsec [4], specifically the encapsulating security
We propose to take advantage of this existing payload (ESP) is used to provide data and partial
infrastructure to manage these certificates. The PKIs sequence integrity, and peer entity authentication for
that must be created to support S-BGP will overlay the BGP control traffic. Because it is implemented at the IP
existing administrative framework, based on the layer, IPsec protects the integrity of the TCP
ICANN, regional registries, ISPs, etc. connections used between BGP speakers. Its anti-replay
mechanisms detect and reject replayed packets more
“Attestations” constitute the second major component of quickly than TCP, helping to reduce the effect of a
the architecture. They form the heart of S-BGP, and denial of service attack. The IPsec anti-replay
represent a conceptually straightforward means of mechanisms plus TCP sequence numbers ensure the "no
achieving the critical security guarantees described less recent" requirement for correct operation of BGP,
above. It is the use of attestations, protected by digital relative to attacks mounted against inter-router links. If
signatures, that permits S-BGP to counter Byzantine confidentiality of BGP control traffic becomes an issue,
attacks. Attestations are signed and validated using the it will be easy to later enable the IPsec confidentiality
keys and certificates from the PKI described above. mechanisms where needed, without any changes to
They enable each BGP speaker that receives a route BGP.
advertisement to verify that each AS along the route has
Page 4 of 14BGP Addr Blks of Rtes BGP Path Dest Addr
UPDATE Message
Header Being Withdrawn Attributes Blks (NLRI)
Path Attribute Attribute
Route Attestations
for Attestations Header
Attestation Certificate Algorithm ID Signed
Route Attestation Issuer
Header ID & Signature Info
Validity AS Path Other Protected NLRI
Signed Information Subject
Dates Info Path Attributes Info
Figure 3: An S-BGP UPDATE Message
Route Attestations are distributed with BGP UPDATEs
2.3 Distribution of S-BGP countermeasures in the newly defined optional, transitive “attestation”
information path attribute (see Section 2.1). The BGP speaker
receiving an UPDATE caches the associated attestations
with the route in its routing information database (RIB).
BGP UPDATEs are limited in length to 4096 bytes.
These attestations, plus an RA for the local AS, are
Certificates are relatively large (approx. 440 bytes using
included in any UPDATEs that are subsequently sent to
DSA keys). Also, the combined length of the Address
the speaker’s peers.
Attestations needed to validate the NLRI in an
UPDATE that contains many (e.g., hundreds of) address
2.4 Processing of S-BGP countermeasure
prefixes can be large, relative to the size limit of an
UPDATE. Sending certificates and AAs with each information
UPDATE would often be redundant and wasteful of
bandwidth. Since certificates and AAs are relatively Processing of S-BGP countermeasures data occurs as
stable (e.g., unchanging for months or maybe a year), follows (see [1,3] for more detail):
this architecture uses out-of-band distribution of • Generation and signing of certificates and CRLs are
certificates and AAs to all S-BGP speakers. The S-BGP handled by the issuing Certification Authority, e.g.,
architecture makes use of two tiers of repositories from the ICANN, a registry, an ISP/DSP or a subscriber.
which an AS’s management (first tier) or a router These certificates and CRLs are posted to
(second tier) can download the entire certificate and AA directories for retrieval by ISPs and DSPs.
database. The first tier consists of several replicated, • The validation of certificates and CRLs, and the
easy to access storage sites, e.g., the NAP route servers. generation/signing of AAs, is handled by the
The second tier of repositories is operated by ISPs/DSPs and subscriber organizations, e.g., by a
ISPs/DSPs, to provide local access to certificates and NOC for an AS. The second tier of the distribution
AAs for the S-BGP speakers within their respective system described in Section 2.2 produces pre-
ASes. processed (validated, “extracted”, etc.) certificates,
CRLs and AAs thus saving the routers from having
to do this work. Note: The option also exists to
Page 5 of 14distribute AAs in UPDATEs, if there is space in the • The second certification hierarchy described above
UPDATE and if there is a reason not to wait for the binds a BGP ID to one or more AS numbers, to
standard out-of-band distribution mechanism. In ensure that a BGP speaker sending an UPDATE
this case, the router must validate the AA. was authorized to act on behalf of its AS to
• The validation of RAs, and their use in validating advertise the routing information in the UPDATE.
the routing information in an UPDATE is handled
by the S-BGP router that receives the UPDATE. To • The authentication and integrity offered by IPsec,
minimize the load during router initialization, plus simple matching by a receiver, ensures that an
verification of an UPDATE is done only after an UPDATE indicating a withdrawn route will be
UPDATE is selected for use in the routing table. In accepted only from the peer that was previously
this fashion, the task of validating the very large authorized to advertise that route.
number of UPDATEs that may be received during
initialization is spread out over time, lessening the 2.6 Deployability
performance impact. S-BGP routers also effect the
generation and signing of RAs needed for any We anticipate using internal BGP (iBGP) sessions to
UPDATEs being sent to peers. distribute the external routing information among the
• S-BGP peers implement IPsec in order to secure S-BGP speakers within a single AS. In these scenarios,
each TCP/IP session carrying the BGP control the S-BGP attestation path attribute information would
traffic. be forwarded along with the other UPDATE
information, without modification.
2.5 Effectiveness
S-BGP introduces a new attribute, the attestation path
The countermeasures described above satisfy the first attribute. To enable backwards compatibility with
six security requirements described in Section 1.1. The BGP-4, this new transitive attribute will be defined as
following maps countermeasures to requirements, discretionary (optional) for both external and internal
though not in exact correspondence with the list in 1.1: BGP exchanges. Interoperatibility between BGP-4 and
• Each route attestation is signed by the AS that sends S-BGP will then be possible because the BGP protocol
it, so a BGP speaker can verify that each UPDATE specifies that implementations should accept
it receives from a peer was sent by that peer and unrecognized optional transitive attributes and retain
was not modified en-route from that peer. The use them for propagation to other BGP/S-BGP speakers.
of IPsec ensures the timeliness of UPDATEs, on a This backwards compatibility will remove the need to
point-to-point basis. require that all BGP implementations to support S-BGP
from day one and make it possible to incrementally
• Because a route attestation specifies the next AS in deploy these countermeasures — a necessity given the
a path, as part of the signed data, a receiver can distributed nature of Internet ownership and operation.
detect if an UPDATE is received by other than the In an S-BGP AS that receives UPDATEs which have
AS for which it was intended. gone through BGP-4 ASes, it will be up to the local
administrators to set the security policy as to how the
• The first certification hierarchy described above AS’s S-BGP speakers should handle UPDATEs that are
binds one or more address spaces to an missing route attestations (or for which address
organization, thus ensuring that the organization attestations or certificates are not available).
owning the IP address space advertised in the
UPDATE was allocated that address space through S-BGP imposes significant demands on routers,
a chain of delegations originating at the ICANN. primarily in terms of memory requirements, and, to a
lesser extent, in terms of CPU utilization. In the near
• The first route attestation, plus the address term, this overhead can be ameliorated by co-locating a
attestation, enables a receiver to verify that the BGP separate S-BGP speaker with each border router. The
speaker that originated the list of reachable S-BGP speaker will perform all the typical BGP
destinations within the UPDATE, was authorized to functions plus the new S-BGP functions such as
represent those destinations by the organization(s) signing/verifying attestations; fetching/storing extracted
that owns them. certificates/CRLs and AAs, and verifying routes. The
border routers will be responsible only for forwarding
data packets and for participating in intra-domain
Page 6 of 14routing. As a local policy, the attestations could be can be used to test the effectiveness and robustness of
filtered out of the BGP UPDATEs sent to the border the S-BGP countermeasures. This can be done, for
router. This would eliminate the requirement for storage example, by injecting bad routes, making the link appear
to hold these attestations. In the longer term, the to go up and down, etc. We also developed a tool that
additional CPU and memory resources will be more accepts a recording of multiple sessions of BGP traffic
conveniently handled by adding hardware cryptographic and replays it to simulate the original order and arrival
support and memory to the router itself. This will intervals for the BGP traffic. This latter tool allowed us
eliminate the need for co-located boxes and make to conduct tests with deterministic data, to facilitate
network management simpler. comparison of results, e.g., for BGP-4 vs., S-BGP and
for various optimizations of S-BGP.
3. Experimental background
3.3 Experiments
3.1 Testbed setting Several sets of experiments were run to measure the
impact of S-BGP countermeasures. The questions of
The results described in this document were collected interest were:
from experiments run in DARPA’s Collaborative • Do these countermeasures ensure the aspects of
Advanced Interagency Research Network (CAIRN) correct operation of BGP described in Section 1.1?
testbed. This testbed is used for research on and • How much overhead (bandwidth, CPU, storage) do
development of advanced computer network protocols. they add to BGP-4? Are there optimizations that
It is composed of programmable routers (mostly PCs) can reduce these costs?
and multimedia hosts. The routers are interconnected by • Is S-BGP readily deployable in the Internet? Does
OC-3 and DS-3 ATM backbone links (configurable it interoperate with BGP-4 so that it can be
ATM virtual circuits) and T1 (and faster) tail circuits. deployed incrementally? Can iBGP be used to
The CAIRN testbed is connected to the Internet at exchange S-BGP information between S-BGP
several points. Experimenters can download software to routers in the same AS?
routers and configure the topology as required. In this
case, we downloaded S-BGP software to a number of The scenario in which tests were conducted reflects a
routers and configured them into several interconnected router in stable (steady state) operation. This is the case
ASes. We then established BGP peering sessions that reflects operation with S-BGP deployed. The
between these routers and between some of them and S-BGP router processes UPDATEs sent/received due to
BGP routers in the external Internet. changes in routing, but has (extracted) certificates,
CRLs and AAs on hand. The frequency of UPDATE
The CAIRN routers were configured with FreeBSD messages is dependent on the stability of the Internet.
2.2.x as the OS and GateD as the BGP implementation. Routes fluctuate (“flap”) for several reasons, e.g., link
The hardware platform consisted of Pentium Pro (200- failure and re-establishment, router mis-configurations,
MHz 686-class CPU) with 64 to 256 Mbytes of software bugs, etc. Also, new network prefixes, ASes,
memory. and BGP speakers are added constantly to the network.
In S-BGP, the resources consumed to transmit/send and
3.2 Software generate/validate BGP UPDATE messages are a
function of both the size and number of route
attestations and the rate of routing changes in the
Our S-BGP countermeasures were added to GateD’s
Internet. The tables below show traffic characteristics
BGP implementation. This software was instrumented
observed during the month of May 1999.
to collect the performance statistics described below. In
addition, we developed a man-in-the-middle (MITM)
We did not measure the effect of router initialization.
tool that was placed between a CAIRN BGP speaker
The start up transient was not included in our tests
and a BGP peer in the Internet. The MITM was used to
because the results are completely predictable [1,3].
intercept BGP control traffic coming from the BGP peer
Also, the resources (bandwidth, CPU, memory) needed
in the Internet, augment it with S-BGP countermeasure
for establishing a BGP session (including IPsec costs)
data, and then pass it to the S-BGP peer in the CAIRN
are negligible compared to those needed for other
testbed. In this fashion, we simulated the effect of
S-BGP traffic.
having deployed S-BGP in the Internet. This tool also
Page 7 of 14Experiments were performed with different values for background for this analysis. They describe the statistics
several parameters. Tests were run with BGP-4 and with that underlie these test results, summarize current BGP
S-BGP, and several optimizations were compared for traffic characteristics, and discuss the factors that
S-BGP. The optimizations examined included caching determine the overhead added to an UPDATE by an
routes and attestations after verification (receiver) and Attestation Path attribute. The last four sections discuss
after signing (transmitter). Cryptographic hardware was the results of the performance analysis. They analyze
not employed, although the use of appropriate hardware the volume of certificates and address attestations
would probably improve performance in many contexts. needed to support S-BGP, and discus the impact on
The tests made use of real Internet traffic, recorded and BGP of implementing these countermeasures with and
played back using the tool described above. In addition without optimizations.
to normal operation, several attack scenarios were
examined, e.g., injection of various forms of bad routes. 5.1 Underlying statistics
The following sections describe these experiments in
more detail. The results in the later sections are driven by a variety
of aspects of the Internet and its administration. Some of
4. Security the key numbers are shown below. These were obtained
via analysis of 1999 data from Merit BGP statistics and
To test whether or not S-BGP delivers the desired from other open sources.
improvement in BGP security, we tested S-BGP in the • number of ASes - Of 6,262 AS numbers issued as
face of several types of attacks. We injected bad routes of June 1999, only 5,275 were observed in dumps
(NLRI and/or path attributes) that are not verifiable of actual BGP traffic.
against the corresponding route and address attestations. • number of organizations assigned address prefixes -
These attacks were performed when the router was in The 194,501 address blocks that have been issued
stable operational mode and using playback of recorded as of February 1999, are assembled into contiguous
traffic. The results showed that use of S-BGP detected ranges that are assigned to 43,931 organizations.
and rejected spurious UPDATE messages, as expected. Note: Each organization will be assigned one
certificate attesting to its ownership of address
5. Performance blocks, not one certificate per address block. (This
count overstates the number of certificates
required, as an organization that has acquired
We examined the impact of the S-BGP countermeasures
multiple prefixes over time is counted more than
on BGP performance. Bandwidth, storage, and CPU
once.)
utilization in BGP speakers is driven by several factors.
The rate of change in connectivity and routing policies • number of address prefixes in an Internet routing
determines the frequency of BGP UPDATEs. The table - Of the 194,501 address blocks which have
length of an UPDATE is a function of the number of been issued as of February 1999, only 74,191 were
paths being withdrawn per UPDATE, the number of visible in dumps of actual BGP traffic.
address prefixes being advertised per UPDATE and the • number of BGP speakers for all ASes - This was
path attributes included in the UPDATEs. The sizes of estimated to be 7,455 by examining the routing
the routing tables (ADJ-RIB-IN, LOC-RIB, ADJ-RIB- registry databases and estimating that one could
OUT) are a function of the number of separately divide the 5,275 ASes into 3 groups: approximately
advertised destinations (address prefixes) and routes. 20 large ISPs with 50 speakers plus 300 ISPs with
Although aggregation of routes helps reduce the volume 5 speakers plus the remaining 4,955 ASes with 1
of UPDATEs and the number of entries in the routing speaker.
tables, BGP speakers often experience heavy loads
because of the large number of link flaps in the Internet, 4 Number of Internet address registries
and because of the growth in the number of networks.
1,781 Number of organizations with one or
Therefore it is crucial to understand the impact of
more ASes
S-BGP on the performance of these speakers.
5,275 Number of ASes
The following sections discuss the overhead imposed by
43,931 Number of organizations assigned
S-BGP countermeasures in terms of bandwidth, storage,
address prefixes
and CPU utilization. The first three sections provide the
Page 8 of 1474,191 Number of address prefixes in an RAs in the UPDATE(s). (If route aggregation has
Internet routing table (LOC-RIB) occurred, then multiple ASes and UPDATEs will
be involved.) For each RA in an UPDATE, the
7,455 Estimated number of BGP speakers
protected fields are listed explicitly only as
necessary.
• Address Attestations (AAs) (if included in an
Table 1: Administrative and routing statistics
UPDATE)
• the number of Address Attestations (zero to a
5.2 BGP traffic characteristics
small number) – Typically, AAs are distributed
to S-BGP speakers out of band rather than in
In order to assess the impact of S-BGP
UPDATEs. But an AA may be sent in an
countermeasures, it is essential to understand the nature
UPDATE if an AS wants to flood an AA through
of current BGP traffic, e.g., the number and kinds of
the Internet more quickly than would happen
BGP control messages that have to be protected. This
with the usual distribution mechanism, e.g., an
section provides a summary of some current BGP traffic
organization has changed ISPs and the new ISP
characteristics as received by a BGP router during a
wants to quickly send out an AA to advertise that
realtime peering session.
its AS now has the right to advertise the
organization’s address prefix and that the old AA
3,571 Number of KEEPALIVEs per day
is no longer valid.
68 Kbytes of KEEPALIVEs per day • the length of the Address Attestation – This is a
function of some fixed length fields plus how
1,426 Number of UPDATEs per day many address prefixes are covered (one to a
small number).
89 Mbytes of UPDATEs per day (not
including attestations)
5.4 Certificates
Table 2: BGP daily traffic statistics A key component of the overhead of S-BGP is the
certificates that are used to verify the binding between
5.3 Attestations an organization and an AS, between an AS and a router,
and between an organization and a set of IP address
Several factors determine the number of bytes of prefixes. This section lists the estimated number and
overhead added to an UPDATE by an Attestation path kind of certificates that are required to support S-BGP.
attribute. The length (bytes) of an Attestation path Note that because of the size limitation on a BGP
attribute is a function of the three components shown UPDATE message, it generally would not be possible to
below. In the later sections, to be conservative, we fit all of the certificates (and attestations) needed to
examined the case that results in adding the most validate an UPDATE into the UPDATE message itself.
overhead, where all protected fields are assumed to have Accordingly, subsequent sections assume that each
to be explicitly listed in the Route Attestations. S-BGP speaker validating UPDATEs will have access
• Path attribute header (3 or 4 bytes) to pre-validated certificates at a repository for its AS.
• Route Attestations (RAs) The speaker’s AS, e.g., its NOC, will have already
• the number of Route Attestations (the number of fetched the complete set of certificates (and AAs) from
a higher level repository, e.g., at an Internet registry,
ASes in the AS_PATH) – One route attestation is
validated them, extracted the needed fields, and signed
needed for each AS in the path.
• the length of each Route Attestation – This is a the resulting digested data. This data is then uploaded to
the S-BGP speakers. Although the certificates vary
function of some fixed length fields (header,
somewhat in length because they contain different
issuer, signature, validity fields, subject, etc.)
extensions, etc., they are approximately the same size.
plus any UPDATE fields that are “explicitly”
.
listed in the RA, as opposed to being “implicitly”
listed (assumed to be the values in the body of the
4 1 per Internet registry
UPDATE). Which of the UPDATE fields are
protected by the RA, is determined by the 43,931 1 per organization that has been
security policy of the AS(es) that generated the assigned an address prefix
Page 9 of 141,781 1 per organization that has been make several assumptions: every UPDATE with route
assigned an AS number advertisements has to be validated; all validation of
UPDATEs must be performed upon receipt of the
5,275 1 per AS (on the assumption that each
UPDATE; all cryptographic operations are implemented
AS has BGP routers)
in software, and no validation results are cached for
7,455 1 per AS/BGP speaker later re-use.
58,446 total certificates at present
The results are presented on a per peering session basis.
550 average # bytes/certificate (using 1024- This allows one to estimate the overhead seen by a
bit DSA keys) router with N peers by simply multiplying the
processing time and RA storage requirements by N.
32.2 total Mbytes
Also, this provides a good approximation of how a
multi-peer speaker behaves, since verification is done
175 total number/day new certificates
only for the “best” route. Under typical conditions, a
96.3 total Kbytes for new certificates BGP speaker receives one copy of a given UPDATE
from every one of its external peers, plus one from
every other BGP router in the same AS. In the absence
Table 3: Certificate Statistics
of “best route only” validation, every one of the
UPDATEs received via eBGP must be validated,
5.5 Address Attestations
whereas those received via iBGP are assumed to have
been validated by the sender. For example, at a NAP, a
Another component of the overhead of S-BGP is the
router might have approximately 30 eBGP peers. So one
address attestations (AAs) that are used to verify the
would multiply the storage and CPU numbers for one
authorization of the originating AS to advertise the
peer by 30 plus the number of BGP peers in the router’s
NLRI in an UPDATE. As noted above, because of the
own AS to obtain the total RA storage and CPU needed.
size limitation on a BGP UPDATE message, it is not
Additional bandwidth would be on a per link basis, so
possible to fit all of the certificates and attestations
the bandwidth numbers shown below would not have to
needed to validate an UPDATE into the UPDATE
be multiplied by the number of peers. Since validation
message itself. This analysis assumes that each S-BGP
of a route is done only for the route that is selected, the
speaker will have access to pre-validated AAs at a
CPU costs approach those of the single peer case. (The
repository for its AS, using the same distribution
router may not receive the "best" route first and hence
approach described for certificates. Although the AAs
may have to verify more than one UPDATE, depending
vary somewhat in length because they contain different
on the order of arrival of different paths to the same
address prefixes, etc., they are approximately the same
destination, when the best one arrives, how long one
size. Table 4 summarizes the computation of the AA
waits before deciding one has the "best" route, etc.)
storage requirements, exclusive of the overhead
imposed by data structure formats for storage in GateD.
For these tests, we compared BGP-4 to S-BGP, in stable
.
operation, using playback of a realtime peering session
43,931 1 per organization which has been with a BGP router in an ISP. We verified all UPDATEs
assigned an address prefix immediately upon receipt (for one peer). Given the size
of the routing table (LOC-RIB) and the daily volume of
96 bytes per AA
UPDATEs, these experiments showed a significant
4.2 Mbytes total impact on CPU and storage. A number of optimizations
(see Section 5.7) can be implemented that reduce the
S-BGP overhead.
Table 4: Address Attestation Storage
5.6.1 Bandwidth utilization: S-BGP consumes link
5.6 Performance without optimizations
bandwidth at three different stages: 1) during the initial
routing exchange when starting up a BGP peering
We first tested the performance impact of the S-BGP
session (including use of IPsec), 2) whenever there are
countermeasures without employing any optimizations.
changes in routing information, and 3) at steady state
In addition to the features of the basic architecture such
with the exchange of KEEPALIVE messages to
as local caching of certificates, CRLs and AAs, we
maintain the BGP peering session. Assuming that
Page 10 of 14certificates and AAs are already present during stable
operations, the bandwidth utilization for the S-BGP 5.7.1 Handling peak loads: Three optimizations
overhead needed for a sample peering session was 1.4 address the problem of S-BGP costs by adding resources
Kbs. During steady state operations, the S-BGP or deferring the work involved in S-BGP
overhead is dwarfed by the user traffic and thus does not countermeasures. Although these approaches do not
represent a significant adverse impact on router traffic. reduce the total amount of work that has to be
performed, they address the problem of “peak loads”
5.6.2 CPU utilization: In the unoptimized case, a BGP that the router might otherwise be unable to handle in a
speaker validates every route advertisement that it timely manner. They include:
receives from an external peer. This requires validation • use of an auxiliary or upgraded processor to enable
of one route attestation for each unique AS in the routers to handle processing of BGP
AS_PATH attribute, and possibly (though with low countermeasures data
frequency) a small number of address attestations. Each • prioritization of verification tasks to reduce the
validation requires hashing the covered data and impact of topology changes due to
validation of the signature. In addition, the BGP speaker hardware/software component failure and recovery,
must sign one route attestation for every UPDATE it congestion, etc. This technique can also reduce the
sends. The numbers below are based on the use of amount of work done, e.g., by deferring validation
SHA-1 for hashing and DSA with a 1024 bit key for of a route until the route is needed and therefore
signing and verification. avoiding validation of never-used routes. The router
verifies only the “best” route chosen for LOC-RIB.
Steady state • background verification of alternate routes – In this
minutes/day case, the router spends idle processing time
processing RAs (sending) 16.2 verifying any alternate routes so that if they are
processing RAs (receiving) 123.7 needed (e.g., the current best route is withdrawn),
total 139.9 they have already been verified and are ready for
use.
5.6.3 Storage/Memory utilization: With regard to
storage/memory utilization, the space needed for 5.7.2 Caching routes and attestations: Examination of
certificates (Section 5.4), AAs (Section 5.5), and RAs to BGP traffic shows that most of the UPDATEs
support validation of UPDATEs during a sample (withdrawals and advertisements) in the Internet appear
peering session is shown below. Note that only the to be caused by temporary changes in link status (link
certificate and AA figures are per-router, whereas the “flapping”) rather than by actual changes to the
RA figures are per-peer. (The AA storage figure here is topology (new networks, ASes, or links; genuine
considerably greater than that provided in Section 5.5, decommissioning of a link or network). Accordingly,
because of data structure format overhead.) when an UPDATE containing a “withdrawal” appears,
an S-BGP speaker can keep the old already validated
Storage (Mbytes) (but now “withdrawn”) route and associated attestations
certificates 32.2 in its cache and mark the route “withdrawn” rather than
deleting it. The S-BGP speaker can then simply
AAs 10.1
compare each newly received route to previously
RAs 16.7
received routes for the same NLRI and validate only
total S-BGP overhead 60.0
those routes that are not in its cache. Similarly, locally
total BGP w/o S-BGP 19.9
generated RAs can be cached for use in sending
UPDATEs.
5.7 Performance with optimizations
• Bandwidth – The proposed caching does not affect
bandwidth, i.e., the same UPDATEs are received
Our initial set of experiments (Section 5.6) indicated
and transmitted.
that the S-BGP countermeasures impose significant
• CPU – Analysis of BGP data from NAPs (from
overhead on an ongoing basis (CPU, storage). However,
Merit) suggests that the proposed caching should
we have identified a number of optimizations that
result in significant savings in the steady state case.
greatly reduce the overhead costs of the BGP
That analysis showed that caching one route per
countermeasures. These are described in the following
destination would enable a router to avoid re-
sections along with the savings that resulted.
validating about 53% of UPDATEs during a real
Page 11 of 14world BGP peering session. However, the BGP chip specifically designed to do cryptographic
data used in the experiments was provided by an operations, though this is not necessarily true in all
ISP, with our testbed acting like a DSP, not a peer cases. For example, at present, there is no cryptographic
ISP. As a result, most route flaps seem to have hardware designed to speed up hashing. Therefore, use
been removed and thus there was only a very small of general purpose processors may produce the same or
performance gain resulting from use of a cache. better performance as use of cryptographic hardware for
• Storage – This caching affects storage requirements hashing. The speed of this operation depends heavily on
for routes and route attestations. The more distinct the quality of the implementation and can vary by an
routes per destination per peer that are kept, the order of magnitude.
fewer routes that need to be re-validated, but the
more storage that is required. The storage required With regard to signing and verification, the amount of
for handling certificates and AAs is not affected by savings will vary widely depending on the hardware
this optimization. Note: BGP already requires the approach chosen. PC cards such as the Spyrus LYNKS
router to keep one route per destination/peer (ADJ- provide lower performance but may be easier to add to a
RIB-IN). (The additional storage needed for a depth router, i.e., just plug it in to the system. Specialized
one cache arises for outbound RAs only.) chips such as the HiFn can provide greater performance
but require upgrading an existing router board or
Without With a cache creating a new board. In this round of tests, we were
caching of depth 1 unable to introduce cryptographic hardware to provide a
comparison with the software used in the unoptimized
S-BGP 16.7 Mbytes 25.8 Mbytes
tests, due to time limitations.
storage
CPU 139.9 137.3 5.7.5 Where is S-BGP needed?: It should be observed
minutes/day minutes/day that S-BGP does not need to be deployed in most of the
routers in the Internet. It will achieve the desired results
if deployed in just the BGP routers of the half a dozen
5.7.3 Using certificate and AA extracts: Instead of
or so major ISPs.
storing the entire certificate or AA, the S-BGP speakers • If a router receives only one route to an address
and certificate/AA repositories can keep only the needed
prefix, then if it has traffic to send to that
fields (e.g., issuer, public key, validity period,
destination, it has no choice but to use this route to
extensions) and discard unneeded fields (e.g., signature
reach that destination. So there is no need to
and ASN encoding). This does not affect CPU usage,
validate the route. The two most likely scenarios
but significantly reduces the amount of bandwidth
where this will happen are when destinations have
needed to transmit certificates and AAs (both at
only one path to the router in question, e.g., singly
initialization and on an ongoing basis) and reduces the
homed "leaf" organizations and DSPs, or when a
space needed to store them. A typical certificate for this
multi-homed DSP advertises one path to an address
application would be about 550 bytes long; the average
block.
extract is 160 bytes. The average AA is about 96 bytes • Today, most organizations obtain their address
long; the average extract is 40 bytes long.
blocks from their ISP rather than from an Internet
registry. In many cases, the ISP will handle
At router
advertisements of routes to its customer
initialization
organizations and consequently will handle the
using full certificates and AAs 36.4 Mbytes certificates and route/address attestations associated
with any address prefixes which it assigns to its
using extracts 11.2 Mbytes customer organizations. These organizations do not
generate or verify address attestations or need
certificates for their address prefixes.
5.7.4 Use of cryptographic hardware: The use of
• Most DSPs and subscribers use default routing, not
cryptographic hardware provides better protection for
BGP and consequently they do not need to validate
keys and may provide better performance depending on
(or receive) attestations.
the hardware selected and the software that it replaces.
Significant CPU savings can be realized by the addition
of cryptographic hardware, e.g., a PC card or special
Page 12 of 146. Deployability algorithm software, e.g., the OpenSSL distribution,
provides very good performance. CPU
In addition to performance that supports scalability, in requirements for processing certificates and AAs
order to be deployable, S-BGP must interoperate with are addressed by having organizations/ASes handle
BGP. To verify that S-BGP meets these requirements, this processing and using an out-of-band
we tested a critical feature that would affect distribution of certificates and AAs to all S-BGP
deployment. Using a playback of recorded traffic (with speakers.
a BGP router in the Internet), we verified that S-BGP • Bandwidth — The increased transmission
speakers could distribute attestations between S-BGP bandwidth required by S-BGP on a steady-state
speakers in the same AS. These tests were performed basis represents a small amount of data relative to
when the router was in stable operational mode. No subscriber traffic. In addition, a number of
problems were observed. UPDATEs were successfully optimizations have been adopted to minimize
processed. overhead – the encoding scheme used for
attestations, the choice of signature algorithm, and
the use of certificate and AA extracts. Even at
7. Future Work initialization, the time required to transmit
certificates and AAs for the full Internet routing
table is minimal.
The next step toward deployment of S-BGP calls for
• Storage — Analysis of the storage capacity and
working with the registries and ISPs to put prototype
utilization of the routers currently used by ISPs
certification authorities in place and gain experience
indicates that many would not be able to cache
with the relevant policies and procedures. We also plan
S-BGP route and route attestation data. Either
to work with router vendors to integrate S-BGP
router upgrades or auxiliary boxes are needed to
countermeasures into their products.
provide this space.
• Operational issues — This architecture supports
8. Conclusions
straight forward solutions for incremental
deployment, i.e., maintains interoperability
In addition to the security-related benefits to be gained,
between S-BGP and BGP-4 and between eBGP and
performance considerations are crucial in convincing
iBGP.
users and vendors to adopt the S-BGP countermeasures
and deploy them into the Internet. Our experiments with
a prototype implementation and real-world BGP traffic In the near term, S-BGP’s resource requirements can be
supported prior analysis results which indicated that the met by the addition of an auxiliary device, essentially a
overhead added by the S-BGP countermeasures needed PC, to each router. By migrating BGP processing to this
the CPU/memory equivalent of a desktop PC. device, the storage problems cited above are averted.
These devices can easily be provisioned with sufficient
• A number of techniques can be used to enable the RAM to support the larger routing table size implied by
BGP speakers to handle spikes in the UPDATE the addition of the S-BGP countermeasures data. The
traffic. This includes use of auxiliary processors, space required for the certificate and AA databases is
deferral of route validation until a route is needed, minor compared to typical disk drive capacities.
and offloading of certificate and AA processing. Moreover, low cost cryptographic support for signature
• CPU — Although caching of recent route data generation and validation can be provided through the
should enable a speaker to avoid the need to use of cryptographic hardware, e.g., adding a fast
validate approximately 53% of UPDATEs, our modular arithmetic chip to a router, or plugging in a
testing showed that a DSP might see little benefit PCMCIA crypto-processor card. Use of hardware also
from caching. However, the UPDATE arrival rate offers improved security for the private keys employed
in such circumstances is sufficiently low to mitigate by the routers to sign RAs and for IPsec (IKE) key
CPU utilization concerns anyway. In contrast, we management. In the longer term, the routers themselves
anticipate that an S-BGP speaker at a NAP would could be upgraded with additional CPU power and
benefit considerably from caching, based on memory.
analysis of Merit data. Cryptographic hardware
could be added to handle the signature and
verification tasks, but high speed signature
Page 13 of 149. Acknowledgements 10. References
Many individuals contributed to the design and
[1] BBN Report 8217, “An Architecture for BGP
development of S-BGP. Initial funding was provided by
Countermeasures,” November, 1997.
NSA, in April of 1997, yielding a first cut design.
DARPA and NSA provided later support, enabling us to
[2] Y. Rekhter, T. Li, “A Border Gateway Protocol 4
refine the design, implement it, and conduct the tests
(BGP-4),” RFC 1771, March, 1995.
reported in this paper. S-BGP benefited significantly
from the insight and efforts of Martha Steenstrup and [3] S. Kent, C. Lynn, and K. Seo, “Secure Border Gateway
Luis Sanchez. As members of the architecture team, Protocol (S-BGP),” to appear in IEEE JSAC.
their contributions were critical to the design of the
attestation and PKI schemes, as well as the evaluation of [4] S. Kent, R. Atkinson, “Security Architecture for the
other approaches and of performance and operational Internet Protocol,” RFC 2401, November 1998.
issues. The authors also would like to thank Michelle
Casagni, for her work during the initial performance [5] S. Murphy, “BGP Security Analysis,” draft-murphy-bgp-
analysis phase, and Dennis Rockwell and Nicholas secr-02.txt, November 1998.
Shectman for their efforts during the implementation
and experimentation phase.
Page 14 of 14