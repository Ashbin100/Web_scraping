Toward A Practical Data Privacy Scheme for A Distributed Implementation of
the Smith-Waterman Genome Sequence Comparison Algorithm
∗
DougSzajda MichaelPohl JasonOwen BarryLawson
UniversityofRichmond
Richmond, Virginia
dszajda,mike.pohl,wowen,blawson @richmond.edu
{ }
Abstract
enablecomputationsoncefeasibleonlyviaexpensiveclus-
ters or supercomputers. The computing power harnessed
Volunteerdistributedcomputationsutilizespareproces-
by these systems can top several petaflops, making them
sorcyclesofpersonalcomputersthatareconnectedtothe
wellsuitedforsolvingsomeSIMD-styleparallelcomputa-
Internet. The resulting platforms provide computational
tions. Applicationdomainsbenefitingfromthistechnique
power previously available only through the use of ex-
includeDNAgenesequencecomparisonsandproteinfold-
pensive clusters or supercomputers. However, distributed
ing in the biotechnology industry, advanced graphics ren-
computationsrunninginuntrustworthyenvironmentsraise
deringintheentertainmentindustry,exhaustiveregression
a number of security concerns, including computation in-
and other statistical applications in the financial industry,
tegrityanddataprivacy.
someformsofdatamining,andMonteCarlosimulations.
Thispaperintroducesastrategyforenhancingdatapri-
The typical computation in this setting is easily divisible
vacyinsomedistributedvolunteercomputations,providing
intoindependenttaskssmallenoughtobehandledinafew
an important first step toward a general data privacy so-
hoursbyatypicalpersonalcomputer.
lution for these computations. The strategy is used to
In the common scenario, the supervisor of a volunteer
provide enhanced data privacy for the Smith-Waterman
distributed computing platform recruits participants who
local nucleotide sequence comparison algorithm. Our
agreetoallowthesupervisortoexecutecodeontheirper-
modified Smith-Waterman algorithm provides reasonable
sonal computers, either in exchange for some form of re-
performance, identifying most, and in many cases all, se-
muneration(inacommercialsetting)oronavoluntaryba-
quencepairsthatexhibitstatisticallysignificantsimilarity
sis.Participantsthendownloadcodethatservesasthelocal
according to the unmodified algorithm, with reasonable
execution environment for assigned computational tasks.
levels of false positives. Moreover the modified algorithm
Foragivencomputation,participantsarechosen,tasksare
achievesanetdecreaseinexecutiontime,withnoincrease
assignedandtransmitted,and,astasksarecompleted,sig-
in memory requirements. Most importantly, our scheme
nificantresultsarereturnedtothesupervisor. Thoughtask
represents an important first step toward providing data
results may be related, the tasks themselves are indepen-
privacyforapracticalandimportantreal-worldalgorithm.
dent, so no communication is necessary between partici-
pants.
Because code is executed in untrustworthy environ-
Keywords: distributed computation, data privacy,
ments, several security concerns are raised. Among the
Smith-Watermanalgorithm
majorissuesisdataprivacy. Firmsmayhaveobtaineddata
atgreatexpenseandareoftenreluctanttoexposethispro-
prietaryinformationtounknownindividuals. Thisisespe-
1.Introduction ciallyrelevantinthebiotechnologyindustry,wheregenetic
datagleanedfromyearsofexperimentationisoftenclosely
guarded.
Distributed volunteer computing platforms, in which
While there is a small but growing body of literature
personalcomputersconnectedtotheInternetvolunteeridle
dealingwithprovidinggreaterassuranceofthevalidityof
processor cycles to a large-scale distributed computation,
resultsofvolunteercomputations([21,22,25,32,34,35]),
∗ThisworkwaspartiallysupportedbytheNationalScienceFounda- toourknowledgenoresearchhasaddressedtheassociated
tionundergrantIIS-0524239. issue of data privacy. There is a long history of researchconcerning computing with encrypted data ([2, 3, 5, 12, gorithm. The importance of this algorithm is under-
15, 17, 29, 31]) that has resulted in many interesting and scoredbythefactthatSmith-Watermanhasbeenim-
elegantresults. Unfortunately,therearefewreal-worldap- plemented in commercial distributed computing set-
plicationsforwhichthesemethodsarepractical. tings.
Our approach to providing data privacy is similar in
spirit to computing with encrypted data. In that scenario,
Alice has a function f and an input x. She wants Bob to Present a practical and important real-world applica-
•
compute f(x) for her, but she does not wish to reveal x. tion that requires data privacy and is efficiently par-
So she encrypts x (creating E(x)), and asks Bob to com- allelizable. Suchapplicationshavesofarprovenelu-
pute f0(E(x)), where f0 is such that Alice can easily de- sive. The present example thus represents a possible
terminef(x)fromf0(E(x)), butBobcannotdeterminex first entry for a benchmark suite of applications for
fromE(x)and/orf0(E(x)).Ifthiscanbeaccomplished,f privacystudy.
issaidtobeencryptable,andthetransformationsinvolved
compriseanencryptionschemeforf.
Thestrategydescribedhereisnotapplicabletoallvol-
For a volunteer distributed computation that seeks to
unteer distributed optimization computations — there are
identifyessential(insomesense)inputstheconstraintsare
cases in which the information required to determine the
significantlyrelaxed. Inthiscase,Alicehasseveralxval-
importance of data cannot be preserved without revealing
uesandseekstodeterminewhichareimportantinhercon-
the data itself. Nor do we claim that our scheme repre-
text. Because Alice does not necessarily require the spe-
sentsthefinal(oronly)solutiontotheproblemofdatapri-
cific function values to make this determination, there is
vacy for the Smith-Waterman algorithm. In many ways,
far greater flexibility in the definition of f0. We call this
our solution for this example is less than ideal. In the
looselydefinednotionsufficientaccuracy.
bestpossiblesituation,formalprivacyandadversarymod-
Alice enjoys another advantage in the present context:
els would be developed, and the efficacy of our solutions
she has several (possibly millions of) potential suitors of-
proved within that framework. Unfortunately, such mod-
feringcomputingservices. Thus,thepossibilityexiststhat
elstendtobefartoorestrictiveforreal-worldapplications.
for each x, Alice can distribute the work of computing
Our approach, on the other hand, is more heuristic in na-
f0(E(x)) over several parties. Provided this can be done
ture. Heuristic solutions are problematic because they are
inamannerthatensuresthatnoparticipantpossessessuf-
notformallyverified,andarethusoftenvulnerabletounan-
ficient information to determine x, then Alice can, in the
ticipated attack strategies. Regardless, our solution repre-
absenceofcollusion,keepxconfidential.
sents a first step: for many configurations, our modified
The notion of sufficient accuracy is particularly rele- algorithm identifies all statistically significant sequences
vant for distributed optimization computations, i.e., those without a single false positive. Moreover its security can
computations intended to locate optimum (or sufficiently be reasonably estimated, though not rigorously measured,
closetooptimum)valuesofsomefunctionf. Thesecom- via entropy calculations. The second shortcoming of our
putations act as filters because identification of the distin- strategy is that in no case, and for no specific configura-
guished input(s) is sufficient to determine the associated tion,doweachievethesensitivityoftheunmodifiedSmith-
extreme value(s). Many important applications deployed Waterman algorithm, which is theoretically guaranteed to
on volunteer distributed computing platforms, including findthebestmatchingsubstringsfromapairofsequences.
exhaustive regression, genetic sequence comparisons, and Our methods do, however, in many cases exhibit sensitiv-
protein folding, are optimizing computations. In practice, ity comparable to Smith-Waterman. Finally, the methods
thedataidentifiedasmeaningfulbyparticipantsaresubse- here apply only to nucleotide sequence comparisons, not
quentlysubjectedtofarmoreextensive,andtypicallymore to amino acid sequence comparisons (for reasons that are
expensive,postprocessinganalysisbythesupervisor. This discussedinSection4).
furtherrelaxesproblemconstraints: datacansometimesbe
The remainder of the paper is organized as follows. In
(mis)identifiedasimportant,providedthenumberofthese
Section2wepresentourmodelforthedistributedcompu-
falsepositivesissufficientlysmall,aslongastrulyimpor-
tations and platforms under consideration. Section 3 dis-
tantdataisrarely,ifever,missed.
cusses the general technique as applied to optimizing dis-
Thespecificcontributionsofthispaperareto:
tributed volunteer computations. We provide brief intro-
Introducetheconceptofsufficientaccuracy. ductiontobiologicalsequenceanalysisinSection4. Sec-
• tions 5 and 6 present the details of our privacy scheme
Presentastrategyforenhancingdataprivacyinaprac- forSmith-Watermanandpresentrelatedsimulationresults.
•
ticalandimportantreal-worldapplication: theSmith- Related work is discussed in Section 7. We present our
Waterman local nucleotide sequence comparison al- conclusionsinSection8.
22.Themodel in D are identified. Presumably the intrinsic value of in-
i
putx D willdepend(atleastinpart)onthevaluef(x).
i
∈
Weconsiderparallelcomputationsinwhichtheprimary But determination of the importance of x, rather than re-
computation, the job, is easily divided into tasks small turning the value f(x), can sometimes be achieved using
enough to be solved by a PC in a reasonable amount of inputs x0 and functions f0 that differ significantly from x
time(typicallyontheorderofseveralhoursofCPUtime). andf. Ineffect,considerableflexibilityisintroducedinto
Individualtasksareindependentofoneanother. theprecisedefinitionsofinputsandfunctions.
The computing platform consists of a trusted central Ourstrategyforachievingdataconfidentialitywithtask
control server or server hierarchy (which we denote using T(D i)involvestransformingthesetD i,functionf,andfil-
the term supervisor) coordinating typically between 104 terfunctionGintoasetD0,functionf0 andfilterfunction
i
and107 personalcomputersinamaster-slaverelationship. G0 such that T(D i) can be replaced with the task T(D i0)
These slave nodes, or participants, are assigned tasks by consistingoftheevaluationoff0 onD0. Ideally,thetrans-
i
thesupervisor.Participantsdownloadcode,typicallyinthe formation achieves the following transformation proper-
formofascreensaverorapplet,thatservesasthelocalex- ties.
ecutionenvironmentfortasks. Becausetasksareindepen-
1. ThetaskT(D0)shouldnotleakanyadditionalinfor-
dent, communication between participants is unnecessary i
mationaboutthevaluesinD otherthanwhatcanbe
and,assuredly,notpermitted. i
learned from public sources and the values, f(D ),
Formally,ajobconsistsoftheevaluationofafunctionor i
outputbytheuntransformedfunction.
algorithmf : D Rforeveryinputvaluex D. Tasks
→ ∈
are created by partitioning D into (possibly overlapping) 2. ThesetofidentifiersG0(T(D0))returnedfromT(D0)
i i
subsets D , with the understanding that task T(D ) will
i i containsthesetofidentifiersG(T(D )).
i
evaluate f(x) for every input x D . Each task T(D )
i i
is assigned a filter function G :∈ P(R) P(Z+ 0 ), 3. ThedifferenceG0(T(D0)) G(T(D ))isreasonably
i → ∪{ } i − i
where P(R) is the power set of R. Each x D is as- small,wherethedefinitionofreasonableisapplication
∈
sumed to have a unique (nonnegative integer) identifier, dependent.
id(x). The element x D is considered significant
i
∈ Inpracticethereisflexibilityintheserequirements. Some
(equivalently f(x) is a significant result) if and only if
applications may tolerate a few missed important results
id(x) G (f(D )),wheref(D ) f(x)x D . That
i i i i
∈ ≡{ | ∈ } provided that a certain proportion of identified important
is, the filter function returns the indices of significant el-
results are generated. Others may accept some flexibility
ements x D . The filter functions have domain P(R),
i
∈ onthenumberoffalsepositives,providedthatnoimportant
rather than R itself, because the significance of an input
resultsaremissed1.
may depend on its function value relative to the function
Note that the transformations here differ from tradi-
valuesofotherelementsofD .
i
tional encryption algorithms and hash functions in impor-
We assume the existence of a global intelligent adver-
tantways. Goodencryptionalgorithmsmustbereversible,
sary. Theadversarypossessessufficienttechnicalskillsto
and should exhibit a strong avalanche effect. A strong
efficiently decompile, analyze, and/or modify executable
avalancheeffectinthecurrentcontext,however,willlikely
code as necessary. Inparticular, the adversary has knowl-
obscure information to a degree that similar inputs will
edgebothofthealgorithmusedforthecomputationandof
not be identified as such. Furthermore, our transforma-
themeasuresusedtopreventdatadisclosure.
tion, like hash functions, should not be reversible. How-
Attacksthatresultfromacompromiseofdataintransit
everhashfunctionsshouldalsoexhibitastrongavalanche
are beyond the scope of this paper — we assume the in-
effect. Theymustalsoberepeatable,whilethetransforma-
tegrityofsuchdataisverifiedbyothermeans. Inaddition,
tionshereneednotbe.
wedonotconsiderattacksthatresultfromthecompromise
ofthecentralserverorothertrustedmanagementnodes.Fi-
nally, wedonotconsiderattacksresultingfrommalicious 4.Smith-WatermanSequenceComparison
participants returning incorrect results or through the col-
lusionofsuchadversaries.
A thorough treatment of sequence comparison tech-
niques would (and does) fill several texts. This section
3.LeveragingSufficientAccuracy givesabriefdescriptionofadynamicprogrammingalign-
ment technique developed by Smith and Waterman [33].
The theory behind the sufficient accuracy method is
1The notion that encryption/decryption schemes can have less than
straightforward. ThesuccessofataskT(D )inafiltering
i 100%accuracyisnotunprecedentedinthecryptographicliterature(see
computation is based solely on whether important values e.g.,[4],[6],[16])
3The sequences that biologists study consist of either nu- sequencesoflength1000haveapproximately7.03 10763
×
cleotide bases (occurring in DNA fragments) or amino distinctalignments.
acids (the building blocks of proteins). We consider only Goodness of an alignment is measured using a scoring
DNA sequences, for which the underlying alphabet, Σ, functionsdefinedonpairsofsymbolsinΣ, andtypically
consists of the set A,C,T,G representing the nucleic havingtheform
{ }
acidsadenine,cytosine,thymine,andguanine.
LetU =u1u2...u nbeasequence2overΣ. Sequences s(u,v)= c ifu=v (1)
evolveprimarilyinthreeways. Eitheranelementofase- (cid:26) d ifu=v,
− 6
quence isremoved (adeletion), an element isinserted(an
fornonnegativeintegerscanddwithcequaltoorslightly
insertion),oranexistingelementistransformedintoadif-
larger than d. This function can also be described using a
ferentelement(asubstitution). Biologiststrackevolution-
matrix,calledtheweightmatrix. Theformofscoringfunc-
arychangesbywritingtheoriginalsequencealongsidethe
tiondescribedby(1)isuniquetonucleotidecomparisons.
new sequence with appropriate positions aligned. For ex-
Aminoacidcomparisons,incontrast,usescoringfunctions
ample, if U =CTGTTA, and u2 undergoes a transforma- that do not exhibit this binary property (one score when
tionfromTtoA,thiswouldbewritten
symbolsmatch,andonewhentheydonot,regardlessofthe
literal).BecauseourstrategyforSmith-Watermanrelieson
U: CTGTTA
thisproperty,ourmethodsarenotapplicabletoaminoacid
V: CAGTTA
comparisons.
Ifinsteadu4isdeletedfromU,thisiswritten Gapsarescoredusingagapfunction(orgappenalty)g.
Gapfunctionsforlocalalignmentstypicallyhaveanaffine
U: CTGTTA
form,with
V: CTG–TA
g(k)=α+β(k 1),
−
where the ‘–’ symbol acts as a placeholder, allowing the where k is the length of the gap3, α > 0 is the penalty of
other symbols to remain aligned. Positions in a sequence theinitialindelinamultiplecolumngap,andβ >0isthe
with the ‘–’ symbol are called gaps. If U is modified by penaltyforeachsubsequentindelinthegap. Thescoreof
insertingthenucleotideGinposition2,thisisrepresented an alignment is defined as the sum of the scores of each
by individual column, minus the gap penalties. By carefully
choosingthescoringfunctionandgappenalty,goodnessof
U: C–TGTTA
fit can be made to correspond to intuitive notions such as
V: CGTGTTA
theprobabilitythatthesequencesevolvedfromacommon
Afterseveralsuchmutations,U mayhaveevolvedsignifi- ancestor.
cantly. We can represent this evolution with an alignment The similarity S(U,V) of sequences U and V is de-
suchasthefollowing. finedtobethemaximumscoreoverallalignmentsbetween
the two sequences. Although the number of alignments
U: C–TGT––TA–– is huge, a dynamic programming algorithm developed by
V: CTA–TGCT–CG Needleman and Wunsch [26] allows the similarity of se-
quencesoflengthntobedeterminedinO(n2)time.
In the example above, we assume that V evolves from U.
Thealignmentsdiscussedthusfarareglobalalignments
In general, however, when given an alignment of two se-
because they include every element of both sequences. In
quences, there is no implied origin — it is impossible to
practice, local alignments, in which one seeks the best
tell whether a particular gap is caused by a deletion or an
matching substrings of the two sequences, is much more
insertion. Because of this symmetry, insertions and dele-
useful. Thelocalalignmentproblemseekstofind
tionsareconsideredthesameevent,anindel.
Notethattwosequencescanbealignedinseveralways,
H(U,V)=
andthatalignedsequencesneednothavethesamelength.
Waterman [37] asserts that the number of alignments of max S(u iu i+1...u j−1u j,v kv k+1...v l−1v l):
{
two sequences of length n is asymptotically equal to 0 i j n 1, 0 k l m 1 .
(25/4/√π)(1+√2)2n+1(1/√n). Thus, for example, two ≤ ≤ ≤ − ≤ ≤ ≤ − }
Waterman [37] notes that even using Needleman-Wunsch
2Thoughcomputerscientiststypicallybeginsequenceswithindexzero (see Appendix A for details) for global alignments, the
ratherthanone,biologistsprefertobegintheirsequenceswithindex1.We
adheretothebiologistspracticeinthispaper,sothattheSmith-Waterman 3The length of a gap is determined by the number of consecutive
descriptionherematchesthatinthebiologyliterature. Inaddition,this “dashes”inasinglesequence. Thus, say, acolumnwithadashinse-
conventioneliminatestheneedfornegativeindicesintheresultingdy- quenceU,followedimmediatelybyacolumnwithadashinsequenceV
namicprogrammingmatrices. isconsideredtwolength-onegaps,asopposedtoasinglelength-twogap.
4naiveapproachofcomputingthe n 2 globalalignments 4.1 SequenceComparisonAssumptions
2
required for a single local alignm(cid:0)(cid:0)en(cid:1)t(cid:1)of two length-n se-
quences requires O(n6) time. Fortunately, the Smith-
There is no uniform set of assumptions under which
Waterman local alignment dynamic programming algo-
biologists run sequence comparisons. We consider here
rithm[33]reducesthistoO(n3)time. Specifically,define
Smith-Watermancomputationsofanexploratorynature,in
foreach(i,j)pairthefunctionH by
which the supervisor compares the proprietary sequences
against sequences from a variety of species, in order to
H =max 0;
i,j { inform further small scale investigations. Chargaff [13]
S(u xu x+1...u i−1u i,v yv y+1...v j−1v j): showed in 1951 that nucleotide frequencies are not uni-
1 x i, 1 y j . form, but instead vary in known ways between species,
≤ ≤ ≤ ≤ }
and often vary among different evolutionary branches of
ThenH canbecomputedusingthefollowingtworesults.
the same species. Thus the total population of public se-
Theorem. Assumethatthegapfunctiongisafunctionof quences exhibits a wide range of nucleotide frequencies.
gap length. Set H0,0 = 0, and set H i,0 = H0,j = 0 for Becausewecannotknowtheexactdistributionofthepub-
1 i nand1 j m. Then lic database sequence population, we assume, both in our
≤ ≤ ≤ ≤ analysis and simulations, the worst case (in terms of de-
terminingsequencesimilarity)thatallsequencesin
H =max 0, max H g(k) , A∪B
i,j (cid:20) 1≤k≤i{ i−k,j − } sharethesamerelativenucleotidefrequencies. Weassume
also, that nucleotide frequency distributions are reason-
H i−1,j−1+s(u i,v j), max H i,j−l g(l) . able,with,forexample,allnucleotidefrequenciesbetween
1≤l≤j{ − }(cid:21)
0.15and0.35. Withtheseassumptions,ouralgorithmper-
Corollary. formsinpracticenoworse(forthecomparisonconfigura-
tionsconsideredinthispaper)thantheresultspresented. It
H(U,V)=max H :1 k n, 1 l m .
k,l should be noted, however, that the security of our scheme
{ ≤ ≤ ≤ ≤ }
doesdependinpartonthespecificfrequencydistributions
Significance of a Smith-Waterman score is based on
ofthenucleotidesbeingcompared,andthattherearepatho-
probabilisticconsiderations. Specifically,similarityscores
logicalcases,suchasasequenceconsistingentirelyofonly
for random sequences compared using gapless (i.e., gaps
oneortwonucleotideliterals,inwhichourproposedmech-
are not allowed) Smith-Waterman were shown by Karlin
anismsprovidelittle,ifany,dataprivacy.
andAltschultofollowanapproximateextremevaluedistri-
bution[23,24]. Thoughtheirprooftechniquebreaksdown An actual large-scale distributed implementation of
when gaps are allowed, empirical evidence ([7, 27]) has Smith-Watermanhastasksforwhichthesets and each
A B
demonstrated that scores using gapped Smith-Waterman containapproximately100sequences. Weassume,without
areapproximatelyextremevalueaswell. Thesignificance lossofgeneralityandforrelativesimplicityofanalysis,that
threshold value p is chosen so that a match will be con- consistsofasinglesequence.
A
sidered significant provided the probability that a random
comparison generates a score greater than or equal to p is 5.TheTransformation
small, typically less than 0.003. Note that p depends in
part on the length of the sequences being compared, and
thusvariesbetweenSmith-Watermanexecutions. In applying the strategy outlined in Section 3 to the
Tasks in a large-scale distributed implementation of specifics of sequence comparison, our method for achiev-
Smith-Waterman consist of the comparison of two task- ing data privacy requires transforming the sets and ,
A B
specific sets of sequences and , with each sequence scoring and gap functions s and g, and filter parameter p
inonesetcomparedtoallsA equenceB sintheother. Inmost into sets 0, 0, scoring functions s0 and g0 and filter pa-
A B
cases, one set consists of proprietary sequences, and the rameter p0. We then assign the task T( 0, 0,s0,g0,p0) in
A B
otherconsistsofsequencescontainedinapublicdatabase placeofT( , ,s,g,p).
A B
suchastheNationalInstitutesofHealthGenBankdatabase Our transformation involves computing the offsets be-
[18]. In other cases, both sets consist of proprietary data. tween occurrences of individual nucleotide literals. The
Thiswouldbethecase,forexample,ifacompanywished resultingsequencesofoffsetsarethendistributed,andcan
touseexternalparticipantstocomparesomenewlyidenti- becomparedusingtheSmith-Watermanalgorithmwiththe
fiedsequencesagainstthecompany’sownlargeproprietary originalscoringfunctionandgappenaltyinformation.
database.Unlessotherwisespecified,weassumeforthere- Specifically,forasequenceU overthealphabetΣ,and
mainder of this paper that sequences in are proprietary δ Σ,letuδ betheindex(position)oftheithoccurrence
A ∈ i
andsequencesin arepubliclyavailable. of δ in U. Define the offset sequence, F(U,δ) to be the
B
5sequence tobedescribednext,forcreatingandusingthesemultiple
tasksperformedwell. Inbothmethods,asingletaskfrom
F(U,δ)= {uδ 1,uδ 2 −uδ 1,uδ 3 −uδ 2,...,...uδ k−uδ k−1 }, theunmodifiedcomputationbecomesmultipletasksinthe
modifiedcomputation.
where the literal δ occurs in U exactly k times. Though
Maximum method: In the first method, all four offset
weareassumingthatallsequencesbeginatindex1,iffor
sequencesarecomputedforeverysequenceintheoriginal
notationalconvenienceweletuδ =0,thenwehave
0 task. Then four tasks are created, one for each nucleotide
F(U,δ) =uδ uδ literal;eachtaskcontainsthecorrespondingnucleotideoff-
i i − i−1 set sequence for each sequence in the original task. The
fori=1,2,...,k.Forexample,ifU isthesequence four tasks measure significance against a single common
threshold value, returning any matches that exceed the
U: GCACTTACGCCCTTACGACG
threshold. A pair of sequences is deemed well-matched
thentheoffsetsequencesforeachδ Σare (i.e.,exhibitstatisticallysignificantsimilarity)providedthe
∈ maximum ofthefoursimilarityscoresexceeds thethresh-
F(U,A) = 3,4,8,3 old. Thisapproachcanbeaugmentedbyrequiringthattwo
{ }
ormoreofthefoursimilarityscoresexceedthethreshold,
F(U,C) = 2,2,4,2,1,1,4,3
{ } thusdecreasingtherateoffalsepositives.
F(U,G) = 1,8,8,3
{ } Addingmethod:Inthesecondmethod,theparticipants
F(U,T) = 5,1,7,1
assignedeachofthefourtasksdonotmeasuresignificance,
{ }
butinsteadreturnallscorestoafifthparticipant,whoadds
For a set of nucleotide sequences, let F( ,δ) de-
E E the scores. Twp sequences aredeemed well-matched pro-
note the set F( ,δ) F(U,δ)U . The ba-
E ≡ { | ∈ E} videdthesumofthesimilarityscoresforallfouroffsetse-
sic scheme for transforming a sequence comparison task
quencesexceedsthesignificancethreshold. Thisapproach,
T( , ,s,g,p) is to randomly choose a nucleotide lit-
A B in which communication is required between participants
eral δ, compute F( ,δ) and F( ,δ) and send the task
A B and each participant generates significant network traffic,
T(F( ,δ),F( ,δ),s,g,p0), wherep0 isarevisedthresh-
A B isnotcurrentlypracticalduetoplatformlimitations. How-
old. We determine the value of p0 by applying statistical
ever,suchnetworktrafficwillbefarlessanimpedimentin
distributionfittingtechniquestotheresultsofsmallsimu-
futureplatformswithincreasedbandwidth. Moreover,vol-
lationruns. Adetaileddescriptionofthisisgivenbelow.
unteer computing platforms in the near future likely will
The intuition behind our method is that similar se-
allow communication among participants via hierarchical
quences shouldhavesimilaroffsets. Thussequences with
architectures (as opposed tothe flatmaster-slave architec-
offsetsthatdiffersignificantlyfromthesequencein can
A ture we have been considering). Such platforms have al-
be excluded. The security of the transformation, in con-
ready been proposed [28] as a means of dealing with the
trast, results from its many-to-one property. Thus in or-
inclusion of mobile wireless devices (such as cell phones
der to avoid a black-box analysis (in which the adversary
andPDAs)intothecomputationalgrid.
can reconstruct the sequence of nucleotides by identify-
Note that both schemes decrease net execution time as
ing the substrings of a public sequence that match well
compared to the unmodified Smith-Waterman algorithm
withthoseofaproprietarysequence),thepublicdatabases
because they operate on shorter sequences. A Smith-
should contain many sequences that could be the preim-
Watermancomparisonoftwolength-N sequenceshastime
age,underourtransformation,oftheproprietarysequence.
costO(n3). Reducingsequencelengthsbyafactoroffour
This,however,resultsinapotentiallylargenumberoffalse
(onaverage)decreasesruntimebyroughlyafactorof64.
positives. These can be reduced significantly by creating
Thus,eveniffivemodifiedtasksarerequiredtoperformthe
twotasks,onecorrespondingtoeachoftwonucleotidelit-
workofasingleunmodifiedtask,onecanexpectanorder
erals,andassigningthosetaskstodifferentparticipants. A
ofmagnitudedecreaseinnetexecutiontime.
sequence pair is then classified as significant only if both
tasksindicatesignificantsimilarity.
5.1 Analysis
We have found through experimentation that creating
a set of tasks, each of which corresponds to a different
nucleotide literal, greatly increases the accuracy of our We now consider the performance of our sequence
scheme when compared withusing only the offsets corre- transformationschemeasitrelatestotheidealtransforma-
sponding to a single nucleotide4. Two different methods, tionpropertiesdescribedinSection3.
Property 1 states that a transformed task
4ThisholdstrueaswellforNeedleman-Wunschglobalsequenceanal-
T(F( ,δ),F( ,δ),s,g,p0) should not leak any in-
ysis.Howeverintheglobalsequencealignment,usingevenasingleoffset
A B
provideshighaccuracy. formation about the original private sequences other
A
6Extreme Value Distribution for Well−matched 0.4
Extreme Value Distribution for Random
0.3
0.2
0
20 30 40 50 60 70
ytisneD
0.25
0.2
0.15
0.1
0.05
0.1
0 10
Similarity Score
Similarity Score
Figure 1. DistributionsofSmith-Watermanscoresus-
ing our transformation (with no mask) and the maxi-
mummethodfordeterminingsignificance. Curvesgen-
erated from 10,000 comparisons with base sequence
length between 600 and 800, matching portion length
300,andwithwell-matchedsequencessufferinganav-
erageof52.5substitutionsand52.5indels.
ytisneD
Extreme Value Distribution for Well−matched
Extreme Value Distribution for Random
0
0 50 100 150 200
Figure 2. DistributionsofSmith-Watermanscoresus-
ing our transformation (with no mask) and the adding
methodfordeterminingsignificance. Curvesgenerated
from10,000comparisonswithbasesequencelengthbe-
tween 600 and 800, matching portion length 300, and
with well-matched sequences suffering an average of
52.5substitutionsand52.5indels.
than what could possibly be gleaned from the scores re- terns(suchas“ATATATAT”)thatappearseveraltimes. Itis
turnedbyanunmodifiedSmith-Watermanimplementation. conceivablethatanadversarycouldexploitthispropertyto
Thiscorrespondstoassertingthattheadversarycannot,us- gaininformationaboutthepositionofmultiplenucleotide
ingourscheme,learnanymoreaboutaprivatesequenceU literals in parts of the sequence. Such patterns, however,
than what is revealed by the unmodified Smith-Waterman canbe(andoftenare)inpracticeremovedfromsequences
scores of alignments of U with the sequences in . This prior to analysis, because apart from possibly identifying
B
isclearlynotsatisfiedbyourtransformation,sinceitleaks boundaries of specific regions of the genome, the current
information: though the public databases are large (Gen- wisdom is that they reveal little useful information. An
Bank, for example, is estimated to contain more than 54 analogy in the context of English language text would be
billionbasesin50millionsequencesasofthiswriting),we insertingmultiplecopiesoftheword“the”betweenwords
must assume that an adversary can completely determine at random places in an unknown document: identifying
the contents of , and will thus know the locations of all copiesofthepattern“the”wouldprovidelittleusefulinfor-
B
instancesofasinglenucleotideliteralinU. mationaboutthecontentsofthedocument.Forthisreason,
manypublicgenomedatabasesoffera“scrubbed”version
Entropy calculations give a rough estimate of the
withsuchpatternsremoved.
amount of information leaked. Assuming that C is the
δ
number of instances of literal δ in the length-N sequence
Regardless of whether nucleotides are randomly dis-
U, then the conditional entropy of U given F(U,δ) is
tributed,entropycalculationsinthepresentcontextdonot
(N C )log3 (justification in Appendix B). Since the
δ provideprovablesecuritybecauseofthepossibility(which
−
entropyofU is2N, approximately2N (N C )log3
δ isdifficulttoquantifyinanymeaningfulway)thatamolec-
− −
bitsofinformationareleaked. Thus,forexample,givena
ularbiologistmightbeabletoinferthevaluesofsomenu-
sequenceof600nucleotidesinwhich1/4areδ,theentropy
cleotidesbasedonthelocationsoftheknownnucleotides.
is1200andtheconditionalentropyis450log3 713.23.
For this reason we do not claim that our transformation
≈
That is, approximately 1200 713 = 487 bits of infor-
providesprovablesecurity. Thebiologists[30]withwhom
−
mationareleakedbythescheme,withroughly713bitsof
wehaveconsulted,however,believethatinpractice,given
uncertaintyremaining.
only the positions of a single nucleotide literal, no addi-
Implicit in our use of entropy in this context is the as- tional elements can be inferred. Moreover, they believe
sumption that nucleotides in a string are randomly dis- thatthereisnobiologicallyusefulinformation(givenbiol-
tributed according to some predetermined relative fre- ogists’currentunderstandingofthestructureandfunction
quency. This is not accurate in general. Many genomes of the genome) that can be gleaned from a nucleotide se-
have multiple “repeat regions” as well as individual pat- quence in which only the positions of a single nucleotide
7literalarerevealed. 2 and 3 by ensuring that scores for appropriate sequences
They are, however, quick to point out that given all of (i.e.,well-matched)areclearlyseparatedfrominappropri-
thepositionsoftwoormorenucleotideliterals,theprivate atesequences.
sequencecouldlikelybealmostcompletelyreconstructed.
Forthisreason,variantsofourschemethatrequirethecre- 6.SimulationResults
ationofmultipletasks(correspondingtodistinctnucleotide
literals),arevulnerabletocollusion. Specifically,underthe
We tested our scheme using several parameter set-
assumptionthatthepublicsequencesinataskcanbecom-
tings, and for each setting generated four scoring distri-
pletely known, it is trivial for an adversary to determine
butions: random unmodified sequences, random modified
whether two tasks represent the same sets of sequences
sequences, well-matched untransformed sequences, and
transformed under different nucleotides. The adversary
well-matchedtransformedsequences. Inthiscontext,“ran-
thenknowsthepositionsofmorethanonenucleotide. This
dom” refers to a sequence whose nucleotides are gener-
isasignificantconcern,sincecurrentvolunteercomputing
atedatrandom,whereasingleprobabilitydistributionde-
platformslackaneffectivemethodforpreventingasingle
termines, for all positions, the likelihood that a given nu-
individual (as opposed to user name) from obtaining sev-
cleotideliteraloccurs;“well-matched”referstoasequence
eraldistincttasks. Fortunately, undersomeconfigurations
that is derived from a given random sequence via a finite
(e.g.,globalsequencealignmentandlocalalignmentofrel-
numberofmutations(i.e.,randomindelsorsubstitutions),
atively long sequences) multiple tasks are not necessary.
andshouldmatchtheoriginalsequencebetterthanadiffer-
Regardless,thoughthepresentpaperassumesnocollusion,
ent, completelyrandom, sequence; “unmodified”refersto
collusionresistanceisanimportantconsiderationthatmust
usingtheoriginalSmith-Watermanalgorithm; and“modi-
be addressed before any scheme designed for these plat-
fied”referstousingourmodifiedSmith-Watermanscheme.
formscanbeconsideredsecure.
“Goodness” of a score is relative to an a priori thresh-
Theconditionalentropyofourtransformationcanbein-
old that quantifies statistical significance. Hence the best
creasedbyaugmentingthebasicschemesothatsomeele-
matched pair in a specific task is not necessarily statisti-
mentsoftheoffsetsequencesaremasked. Thatis,wepick,
cally significant overall. The efficacy of an algorithm in
foreachtask,asequenceovertheset 0,1 .Eachoffsetse-
thepresentcontextthusdependsontheabilitytogenerate
{ }
quenceinthetaskismultiplied,elementbyelement,bythe
statistically significant scores for sequences that descend
task specific mask. Zero entries in the resulting sequence
fromacommonancestor.
are removed. The increase in entropy resulting from this
Simulation results use data generated from samples of
is based on the proportion ρ of “1” elements in the mask.
size10,000. Morespecifically,10,000pairsofrandomse-
Wehavefoundthatforsomecommonapplicationconfigu-
quences were generated and scored (compared) using the
rations,ρ=0.9workswell.
Smith-Waterman algorithm. These same sequence pairs
Notethatinthecaseinwhichbothofsets and con- were then modified according to our various transforma-
A B
sistofproprietarydata,thentheadversarycannotascertain tions and scored again. A similar process was used with
theidentityofthenucleotideusedtogenerateagivenoffset 10,000artificiallygeneratedwell-matchedsequencepairs.
sequence.Moreover,thepotentialforthetypeofblack-box We use the scoring function s(a,b) = 1 if a = b and
analysismentionedintheprevioussectionisremoved. s(a,b) = 1 if a = b, and affine gap penalty g(k) =
− 6
Properties2and3giveninSection3stateroughlythat 2+1(k 1),wherekrepresentsgaplength. Thesevalues
−
underthetransformation,significantresultsremainsignif- areusedinpractice,andarethesameasthoseusedbyWa-
icant (i.e., they are returned as significant results), while terman[37]. Theviabilityofourstrategydependsonlyon
the number of false positives (results returned as signifi- thebinarynatureofthescoringfunction(anymatchingpair
cant that would not have been significant in the unmodi- ofliteralsreceivesthesamescore,asdoesanypairofmis-
fied computation) remains reasonably small. Using stan- matchedliterals),andnotonthespecificvaluesassignedas
dardstatisticalinferencetechniques,extremevaluedensity scores.
functions can be fit to the simulated score data. Then, by Figures 1 and 2 depict score distributions for random
choosingathresholdthatcorrespondstoalowerpercentile andwell-matchedsequencepairstransformedaccordingto
of the distribution of well-matched scores, the false posi- our basic scheme. Parameters for these experiments were
tiveerrorratecanbecontrolled. Infact,asseeninFigures sequence length of 600-800, and the relative frequency of
1, 2, 4, 5, and 6, the degree of overlap between the two eachsymbolwas0.25. Well-matchedsequencesweremu-
distributionsisoftensominusculethattheprobabilitythat tated over 15 “generations” using a 0.01 mutation proba-
a randomly generated sequence has a higher score than a bility per symbol per generation. With these parameters,
well-matchedoneisrarelymorethan10−4.
mutated sequences are expected to differ from the origi-
The benefit is clear: our scheme maintains Properties nal in approximately 15% of the symbols before our pri-
80.4
Extreme Value Distribution for Random
0.3
0.1
0
ytisneD
Extreme Value Distribution for Well−matched 0.25
Well−matched Extreme Value Distribution
0.2
0.2
0.1
0.05
0 20 40 60 80 100 120
0
Similarity Score
Figure 3. Distributions of Smith-Waterman similar-
ityscoresusingourtransformation(withnomask)and
the maximum method for measuring significance and
long sequences. Curves generated from 1000 compar-
isonswithbasesequencelength2000,matchingportion
length 1000, and with well-matched sequences suffer-
inganaverageof150substitutionsand150indels.
ytisneD
Random Extreme Value Distribution
0.15
0 50 100 150 200 250 300 350 400
Similarity Score
Figure4.DistributionsofSmith-Watermanscoresusing
our transformation (with no mask) and the add method
formeasuringsignificance. Curvesgeneratedfrom1000
comparisons with base sequence length 2000, matching
portion length 1000, and with well-matched sequences
sufferinganaverageof150substitutionsand150indels.
vacy scheme is applied. Figure 1 represents the “maxi- both of these cases, the probability that a well-matched
mum” scoring scheme, in which a single unmodified task sequence pair scores less than a random sequence pair is
is divided into four tasks (each containing the offsets cor- infinitesimally small. The expected number of trials one
responding to a single nucleotide literal), and a result is wouldneedtorunbeforeseeingarandompairscorebetter
deemedsignificantprovidedthemaximumscoreofthefour thanawell-matchedpairismorethan1.8 1061.
×
tasksexhibitsastatisticallysignificantmatch.Figure2rep- Figure5depictsscoredistributionsforthebasicscheme
resents the “adding” scoring scheme, in which the scores augmentedwithmasking(ρ=0.9)asappliedtosequences
fromeachofthefourmodifiedtasksareaddedtodetermine oflength1000-1300.Well-matchedsequenceshavematch-
significance. The separation between the curves in these ing portion length 500. Here, there is a small probabil-
figuresisameasureoftheefficacyoftheSmith-Waterman ity that a pair of random sequences can score better than
algorithm as applied to transformed sequences. Specifi- a well-matched pair (the overlap of the dashed and solid
cally, the greater the separation between curves, the more curves). This can be eliminated entirely if the supervisor
likeSmith-Watermanourtransformedalgorithmperforms. iswillingtoincursomefalsepositives. Thisisreasonable,
sincethematchesthataremissedareatthelowendofthe
Theseparticularexperimentsrepresentaworstcase:rel-
spectrum, indicating that a higher proportion of them (if
ativelyshort(fromabiologicalperspective)sequences.De-
found)wouldbeculledinthepostprocessing.
spite this, our statistical analysis indicates that the prob-
These figures demonstrate that our strategy preserves
ability of a transformed well-matched sequence scoring
sufficient information such that similarity between se-
higher than a transformed random sequence is approxi-
mately1.3 10−9. Statedanotherway,theexpectednum- quencescanbeaccuratelymeasured. Moreimportant,they
× validate the concept of sufficient accuracy: that suitable
beroftrialsonewouldneedtorunbeforeseeingarandom
modificationoftaskprocedurescanpreservefunctionality
sequence pair score better than a well-matched sequence
pairisgreaterthan7.5 108. whilesimultaneouslyenhancingdataprivacy.
×
Scores generated from longer sequences exhibit far
7.Relatedwork
greaterseparation. Figure3depictsSmith-Watermansim-
ilarityscoresusingthebasictransformationwiththemax-
imum method for measuring significance. These curves There are a number of recent studies that focus on the
were generated using length 2000 sequences with match- general issue of securing volunteer distributed computa-
ing portions of length 1000. The well-matched sequences tions. GolleandMironov[21]studycomputationsinvolv-
experiencedanaverageof150substitutionsand150indels. inginversionofaone-wayfunction(IOWF).Theseappli-
Figure 4inAppendix??depictsasimilarexperimentbut cations seek the pre-image x0 of a distinguished value y0
with the adding method of determining significance. In underaone-wayfunctionf :D R. GolleandMironov
→
9Extreme Value Distribution for Well−matched
0.4
Extreme Value Distribution for Random
0.3
0.2
0
10 20 30 40 50 60
ytisneD
There has been a considerable amount of work in the-
oretical computer science concerning computing with en-
crypteddata. Feigenbaum[17]examinesplausibleformal
definitionsofencryptability,andshowsthatunderonesuch
definition,allNP-completeproblemsthatarepolynomially
isomorphic to CNF-SAT are encryptable. Abadi, Feigen-
baum,andKillian[2,3]developaframeworkfordescrib-
inginaninformation-theoreticsensewhatdatainformation
0.1
ishiddenandwhatisleakedinagivenencryptionscheme.
Their main encryptability result is that if f can be com-
puted in expected polynomial time with zero error proba-
0
bility,thenf isencryptablesuchthatnoinformationabout
Similarity Score
xisleaked. Theirprotocol,however,requiresmroundsof
Figure 5. Distributions of Smith-Waterman similar- communication, where m is constrained to be polynomial
ity scores using our transformation and the maximum in x. Interactiveconfidentialityprotocolsareimpractical
| |
method for determining significance and augmented inourcontextbecausetheyscalepoorly.
with a ρ = 0.9 mask. Curves generated from 1000 Abadi and Feigenbaum [1] describe a two-party proto-
comparisons with base sequence length between 1000 col for secure circuit evaluation on a general boolean cir-
and1300, matchingportionlength500,andwithwell- cuit. Secure circuit evaluation protocols provide greater
matched sequences suffering an average of 86.25 sub- security than what is necessary in our context because
stitutionsand86.25indels. they assume that the details of f remain hidden from the
owner of the data. Regardless, their method (and others
requiringinteraction[8,9,36])requiresmuchmoreserver-
participant interaction than is practical for a volunteer
present several variations of a basic ringer scheme de-
distributed computation. Sander, Young, and Yung [31]
signedtodetectparticipantswhoattempttoclaimcreditfor
develop a non-interactive protocol called Symmetrically-
worknotcompleted. Theirstrategyinvolvesprecomputing
secureCryptoComputing(SYC),whichprovidesavariant
values of f and planting those results in task data spaces.
ofsecurecircuitevaluation,hidingtheinputxandreveal-
Since participants are not able to distinguish ringers from
ingonlyaboundonthedepthofthecircuitf. Theirsolu-
truedata,theprobabilityofdetectingcheatingisincreased.
tion, however, is limited to log-depth circuits, and is thus
Szajda,Lawson,andOwen[34]extendtheringersmethod
impracticalinourcontext.
tohandlemoregeneralfunctions, andalsopresentatech-
niqueforhandlingsequentialcomputations,inwhichatask Rivest, Adleman, and Dertouzos [29] formally intro-
consists of the repeated application of f to a single in- duced the notion of privacy homomorphism, whose exis-
put. GolleandStubblebine[22]andSarmenta[32]discuss tenceintheoryallowscomputingwithencryptedfunctions.
strategies for the intelligent application of redundancy to They conclude that these homomorphisms are inherently
volunteer distributed computations. The former discusses limited in their capabilities since comparisons cannot be
asecuritybasedadministrativeframeworkforcommercial includedinthepossiblesetofoperationswithoutcreating
distributedcomputations. Thisprovidesincreasedflexibil- a vulnerability to ciphertext-only attacks. They also raise
ity and protection by varying the distributions that dictate the (still open) question of the existence of highly secure
theapplicationofredundancy.Sarmentainsteadproposesa privacy homomorphisms that use large sets of operations.
credibility-basedsysteminwhichmultiplelevelsofredun- Ahituv,Lapid,andNeumann[5]showthatifaprivacyho-
dancyareused,withparametersdeterminedbyacombina- momorphismallowstheadditionoperation,thenitisinse-
tionofsecurityneedsandparticipantreputations.Monrose, cure under chosen plaintext attacks. Brickell and Yacobi
Wyckoff,andRubin[25]dealwiththeproblemofguaran- [12]introduce R-additive privacy homomorphisms, which
teeingthataparticipantassistsinacomputation,assuming aresecureunderaddition,butplaceconstraintsonthenum-
thattheparticipant’sgoalistomaximizeprofitbyminimiz- ber of ciphertexts that can be added. In general, secure
ingcost. Theirmethodinvolvesinstrumentingtaskcodeat privacyhomomorphismsthatpreservemorethanoneoper-
compile-timetoproducecheckablestatepointsthatconsti- ationaredifficulttofind.Anexceptionisahomomorphism
tuteaproofofexecution. Participantsreturnresultsalong developed by Ferrer [15] that preserves addition and mul-
withtheprooftoaverifier,whichthenrunsaportionofthe tiplicationwhileresistingknownplaintextattacks. Though
execution and checks it against the returned state check- elegant,thesehomomorphismshavefartoolimitedopera-
points. Noneofthesepapersconsidersthetopicofprovid- tionsetstobeofpracticaluseinvolunteerdistributedcom-
ingdataconfidentialityforthesecomputations. putations.
10The problem of multiparty function computation in- Acknowledgments
volves players P , 1 i n, with private inputs x who
i i
≤ ≤
wish to evaluate a function f(x1,...,x n) without reveal- We would like to thank biologists Rafael De Sa, Laura
ing any more information about the x i than is implicitly Runyen-Janecky,andJoeGindhart,allfromtheUniversity
contained in the output value. Yao [38] introduces this of Richmond, for their patient and thorough treatment of
problem and develops a protocol for the two player case. ourquestions. Wewouldalsoliketothanktheanonymous
Goldreich, Micali, and Wigderson [20] extend this result reviewers and Tadayoshi Kohno for many valuable com-
toseveralparties,developingaprotocolthatleaksnoinput mentsthathelpedmakethisabetterpaperthanitotherwise
information provided a majority of honest players. Both wouldhavebeen.
of these results are based on assumptions of intractability
ofcertainfunctions(thecryptographicapproach). Results
References
based on the information-theoretic approach, which does
notassumelimitsonprocessorcomputationpower,include
[1] M.AbadiandJ.Feigenbaum. Securecircuitevaluation: A
work of Ben-Or, Goldwasser, and Wigderson [10], who
protocolbasedonhidinginformationfromanoracle. Jour-
presentaprotocolthatachievesatightboundonthesizeof
nalofCryptology,2(1):1–12,1990.
thegroupofcolludingplayersthatcandisruptthecompu-
[2] M.Abadi, J.Feigenbaum, andJ.Kilian. Onhidinginfor-
tation,andChaum,Cre´peau,andDamgard[14],whoshow
mation from an oracle. In Proceedings of the 19th ACM
thatany“reasonable”multipartyprotocolcanbeachieved Symposium on the Theory of Computing, pages 195–203,
ifatleast2/3oftheplayersarehonest. Goldreich[19]pro- 1987.
videsasurveyofresultsinthisarea.Aswiththesecurecir- [3] M.Abadi, J.Feigenbaum, andJ.Kilian. Onhidinginfor-
cuitevaluationworkabove,theseprotocolshavecommuni- mation from an oracle. Journal of Computer and System
cationandcomputationcomplexitythatprecludestheiruse Sciences,39(1):21–50,August1989.
[4] M. Abdalla, M. Bellare, D. Catalano, E. Kiltz, T. Kohno,
inthecurrentcontext.
T.Lange,J.Malone-Lee,G.Neven,P.Paillier,andH.Shi.
Searchableencryptionrevisited:Consistencyproperties,re-
8.Conclusions lationtoanonymousibe,andextensions.CryptologyePrint
Archive, Report 2005/254, 2005. http://eprint.
iacr.org/.
Viaaspecificapplication,wehaveintroducedastrategy [5] N.Ahituv,Y.Lapid,andS.Neumann.Processingencrypted
data. Commun.ACM,30(9):777–780,1987.
for enhancing data privacy in some distributed volunteer
[6] M. Ajtai and C. Dwork. A public-key cryptosystem with
computations. Thestrategyisbasedontheobservationthat
worst-case/average-caseequivalence.InProceedingsofthe
therequirementsforcomputingwithobscureddatacanbe
29th Annual ACM Symposium on Theory of Computing,
muchlessrestrictiveinsomeofthesecomputationsthanin
pages284–293,ElPaso,Texas,May1997.
traditionalexecutionmodelsbecauseofthefilteringnature [7] S.AltschulandW.Gish. Localalignmentstatistics. Meth-
of certain volunteer computations. In particular, because odsEnzymol,266:460–480,1996.
the identification of important data, rather than the output [8] J.Bar-IlanandD.Beaver.Non-cryptographicfault-tolerant
associatedwiththisdata,isthegoalofthesecomputations, computinginaconstantnumberofroundsofinteraction.In
therecanbeconsiderableflexibilityintaskproceduredef- Proceedings of 8th ACM SIGACT-SIGOPS Symposium on
initions. This flexibility can be leveraged to provide data PrinciplesofDistributedComputing,pages201–209,1989.
[9] D. Beaver, S. Micali, and P. Rogaway. The round com-
privacybyallowingtransformationstodataandprocedures
plexityofsecureprotocols. InProceedingsoftheTwenty-
thatretainsufficientinformationforfiltering,whilesimul-
secondAnnualACMSymposiumonTheoryofComputing,
taneouslyobscuringdatadetailssothatidentificationisdif-
pages503–513.ACMPress,1990.
ficult,ifnotimpossible.
[10] M. Ben-Or and A. Wigderson. Completeness theorems
We illustrated the potential of this strategy by describ- for non-cryptographic fault-tolerant distributed computa-
ing a scheme for enhancing data privacy in the Smith- tion. In Proceedings of the Twentieth Annual ACM Sym-
Watermanlocalsequencecomparisonalgorithm.Ourmod- posiumonTheoryofComputing,pages1–10,1988.
ificationsareapromisingfirststep,inthattheyproviderea- [11] M.Bishop. ComputerSecurity:ArtandScience. Addison-
Wesley,2003.
sonable,thoughnotrigorouslyprovable,dataprivacywhile
[12] E.BrickellandY.Yacobi.Onprivacyhomomorphisms(ex-
preserving sufficient information for distinguishing well-
tended abstract). In D. Chaum and W. Price, editors, Ad-
matching sequences. In addition, by presenting a practi-
vances in Cryptology—EUROCRYPT ‘87, volume 304 of
cal, important, and non-trivial real-world application that
LectureNotesinComputerScience,pages117–126,Berlin,
requires privacy and is efficiently parallelizable, we have
1987.Springer-Verlag.
begun to populate a potential benchmark suite of applica- [13] E.Chargaff. Structureandfunctionofnucleicacidsascell
tionsforprivacystudy. constituents. Fed.Proc,10:654–659,1951.
11[14] D.Chaum,C.Cre´peau,andI.Damgard. Multipartyuncon- A. Jones, and R. Lipton, editors, Foundations of Secure
ditionallysecureprotocols.InProceedingsoftheTwentieth Computation,pages169–179.AcademicPress,NewYork,
Annual ACM Symposium on Theory of Computing, pages 1978.
11–19,1988. [30] R.D.Sa, L.Runyen-Janecky, andJ.Gindhart, July2005.
[15] J.Domingo-Ferrer. Anewprivacyhomomorphismandap- Personalconversations.
plications. InformationProcessingLetters,60(5):277–282, [31] T.Sander,A.Young,andM.Yung. Non-interactivecrypto-
December1996. computingforNC1. InIEEESymposiumonFoundations
[16] C. Dwork, M. Naor, and O. Reingold. Immunizing en- ofComputerScience,pages554–567,1999.
cryption schemes from decryption errors. In C. Cachin [32] L.Sarmenta.Sabotage-tolerancemechanismsforvolunteer
andJ.Camenisch, editors, AdvancesinCryptology–EU- computingsystems. FutureGenerationComputerSystems,
ROCRYPT 2004, volume 3027 of Lecture Notes in Com- 18(4):561–572,March2002.
puter Science, pages 342–360, Interlaken, Switzerland, [33] T. Smith and M. Waterman. Identification of common
May2004.Springer-Verlag. molecular subsequences. Journal of Molecular Biology,
[17] J.Feigenbaum. Encryptedprobleminstances,or...Canyou 147:195–197,1981.
take advantage of someone without having to trust him? [34] D.Szajda,B.Lawson,andJ.Owen. Hardeningfunctions
In Proceedings of Crypto’ 85, pages 477–488. Springer- forlarge-scaledistributedcomputations. InProceedingsof
Verlag,1986. the2003IEEESymposiumonSecurityandPrivacy,pages
[18] Genbank. http://www.ncbi.nlm.nih.gov/ 216–224,Berkeley,CA,May2003.
GenBank/GenBankOverview.html. [35] D. Szajda, B. Lawson, and J. Owen. Toward an optimal
[19] O. Goldreich. Secure multi-party computation. Working redundancystrategyfordistributedcomputations. InPro-
Draft,2000. ceedings of the 2005 IEEE International Conference on
[20] O. Goldreich, S. Micali, and A. Wigderson. How to play Cluster Computing (Cluster 2005), Boston, MA, Septem-
anymentalgame. InProceedingsoftheNineteenthAnnual ber2005.
ACMConferenceonTheoryofComputing,pages218–229, [36] S.TateandK.Xu. Ongarbledcircuitsandconstantround
1987. securefunctionevaluation. TechnicalReportTR2003-02,
[21] P. Golle and I. Mironov. Uncheatable distributed com- UniversityofNorthTexas,ComputerPrivacyandSecurity
putations. In Proceedings of the RSA Conference 2001, (CoPS)Lab,2003.
Cryptographers’Track,pages425–441,SanFrancisco,CA, [37] M. Waterman. Introduction to Computational Biology:
2001.Springer. Maps, Sequences, and Genomes. Interdisciplinary Statis-
[22] P.GolleandS.Stubblebine. Securedistributedcomputing tics.Chapman&Hall,1995.
[38] A. Yao. How to generate and exchange secrets. In Pro-
inacommercialenvironment. InP.Syverson,editor,Proc.
ceedingsofthe27thAnnualSymposiumonFoundationsof
ofFinancialCrypto2001,volume2339ofLectureNotesin
ComputerScience,pages162–167,Toronto,Canada,Octo-
ComputerScience,pages289–304.Springer-Verlag,2001.
[23] S. Karlin and S. Altschul. Methods for assessing the sta- ber1986.
tistical significance of molecular sequence features by us-
inggeneralscoringschemes. ProceedingsoftheNational A.SequenceComparisonAlgorithmDetails
AcademyofSciences(USA),87:2264–2268,March1990.
[24] S. Karlin and S. Altschul. Applications and statistics for
The details of the Smith-Waterman global sequence
multiple high-scoring segments in molecular sequences.
alignmentalgorithmfollow. Weassumehere,forsimplic-
Proceedings of the National Academy of Sciences (USA),
90:5873–5877,June1993. ity of notation, that length n sequences begin at index 1
[25] F. Monrose, P. Wyckoff, and A. Rubin. Distributed ex- and end at index n. Recall that S denotes the similarity
ecution with remote audit. In Proceedings of the 1999 score of a sequence pair, s denotes the similarity function
ISOCNetworkandDistributedSystemSecuritySymposium, forsymbols,andgdenotesthegappenalty.
pages103–113,1999.
[26] S.NeedlemanandC.Wunsch.Ageneralmethodapplicable Theorem. [37]. IfU =u1u2...u nandV =v1v2...v m,
tothesearchforsimilaritiesintheaminoacidsequenceof define
twoproteins. Journal ofMolecular Biology, 48:443–453, S
i,j
=S(u1u2...u i,v1v2...v j).
1970.
Also,set
[27] W. Pearson. Empirical statistical estimates for sequence
similariysearches. JournalofMolecularBiology,276:71–
j i
84,1998.
S0,0 =0, S0,j = g(v k), andS i,0 = g(u k).
[28] T.Phan, L.Huang, andC.Dulan. Challenge: Integrating
kX=1 kX=1
mobilewirelessdevicesintothecomputationalgrid.InPro-
ceedings ofthe EightInternationalConference on Mobile Then
ComputingandNetworking(MobiCom2002),pages271–
278,Atlanta,GA,September2002. S i,j =max S i−1,j +g(u i),S i−1,j−1+s(u i,v j),
[29] R.Rivest,L.Adleman,andM.Dertouzos. Ondatabanks {
andprivacyhomomorphisms. InR.D.Millo, D.Dobkin,
S i,j−1+g(v j) .
}
12Proving the validity of the dynamic programming ap- set of integers between 1 and 4N inclusive.) The entropy
proach in this context is straightforward. One need only [11],H(X),ofX iseasilyshowntobe2N,whichistobe
observethatanalignmentendingwithindicesiandjmust expected, sinceineffecteachnucleotidecontainstwobits
endwithoneofthechoicesbelow. ofuncertainty. Nowletusconsidertheconditionalentropy
H(X Y) of X given that the adversary has received off-
···u i ··· vu i ··· v− set se| quence Y = F(U,δ). Let C δ denote the number of
···− ··· j ··· j occurrencesofliteralδinU. Then
Thusthebestalignmentendingwithindicesiandjmust
bethebestalignmentendingwithindicesiandj 1plus H(X Y)=
− |
thegappenalty, orthebestalignmentendingwithindices 4N
i w− ith1 ia nn dd icj es− i1 −p 1lu as ns d(u ji p, lv uj s), tho ert gh ae pb pe es nt aa ll ti yg .nmentending − Xi=1P(X =S i |Y =F(U,δ)) ×
Forlocalsequencecomparison,definefor(i,j)pairthe
log(P(X =S Y =F(U,δ))).
i
functionH by |
Since, however, the positions of literal δ are revealed by
H =max 0; F(U,δ), and δ is known to the adversary, thus there are
i,j
{
S(u xu x+1...u i−1u i,v yv y+1...v j−1v j): 3N−Cδ sequences in
S
that could be the preimage of U.
1 x i, 1 y j . Let k1,k2,...,k 3N−Cδ be the indices (over the set S of
≤ ≤ ≤ ≤ } thesepossiblepreimages). Thus,
Then H can be computed using the following two re-
sultsfrom[37]. H(X Y)=
|
3N−CA
Theorem. Assumethatthegapfunctiongisafunctionof
P(X =S Y =F(U,δ))
gap length. Set H0,0 = 0, and set H i,0 = H0,j = 0 for − Xi=1
ki|
×
1 i nand1 j m. Then
≤ ≤ ≤ ≤ log(P(X =S ki|Y =F(U,δ)))
1 1
H i,j =max (cid:20)0, 1m ≤ka ≤x i{H i−k,j −g(k) }, = −3N−CA 3N−CA log (cid:18)3N−CA(cid:19)
=(N C )log3.
A
H i−1,j−1+s(u i,v j), max H
i,j−l
g(l) . −
1≤l≤j{ − }(cid:21)
The proof is similar to that of the global alignment algo-
rithm.
Finally,wehavethefollowing
Corollary.
H(U,V)=max H :1 k n, 1 l m .
k,l
{ ≤ ≤ ≤ ≤ }
B.EntropyCalculation
Giventhattheadversaryhasdeterminedthelocationof
all instances of a single nucleotide, we can measure con-
ditionalentropy. AssumethatouroriginalsequenceU has
length N, and that the adversary has been provided with
F(U,δ)forsomefixedliteralδ Σ. Thereare4N possi-
∈
ble length N sequences over Σ, and we may assume that
these are enumerated such that each has a unique integer
index in the range 1 to 4N inclusive. That is, all possible
lengthN sequencesoverΣoccurexactlyonceamongthe
set = S1,S2,...,S 4N . LetX betherandomvariable
S { }
that has a uniform distribution over . (Technically, X is
S
therandomvariablethathasauniformdistributionoverthe
13