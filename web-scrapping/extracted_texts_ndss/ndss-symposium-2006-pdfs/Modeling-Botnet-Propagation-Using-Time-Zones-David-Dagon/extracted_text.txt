Modeling Botnet Propagation Using Time Zones
1 2 1
DavidDagon CliffZou WenkeLee
1
CollegeofComputing,GeorgiaInstituteofTechnology,
801AtlanticDr.,Atlanta,Georgia,USA30332-0280
fdagon, wenkeg@cc.gatech.edu
http://www.cc.gatech.edu/
2
SchoolofComputerScience, UniversityofCentral Florida,
4000Central FloridaBlvd. Orlando,FL32816-2362
czou@cs.ucf.edu
Abstract time [ZGT02]. Follow-up work signi(cid:2)cantly expanded
this analysis to include patching behavior (resistance)
Time zones play an important and unexplored role in in susceptible-infected-recovered (SIR) models [KRD04].
malware epidemics. To understand how time and loca- Despite these many improvements, much of our under-
tion affect malware spread dynamics, we studied botnets, standing of computer worm epidemiology still relies on
or large coordinatedcollections of victim machines (zom- models created by the public health community in the
bies) controlled by attackers. Over a six month period 1920s[DG99].
weobserveddozensofbotnetsrepresentingmillionsofvic- Continued improvements in worm models will come
tims. We noteddiurnalpropertiesinbotnetactivity,which from two areas: an improved understanding of the prob-
wesuspectoccursbecausevictimsturntheircomputersoff lemdomain,andimprovedabilitytorespond,whichmakes
at night. Throughbinary analysis, we also con(cid:2)rmedthat new factors relevant to a model. Improvements belong-
somebotnetsdemonstratedabiasininfectingregionalpop- ingto the (cid:2)rst categorycan be foundin morerecent anal-
ulations. ysis such as [SM04], which traced signi(cid:2)cant worm out-
Clearly,computersthatareof(cid:3)inearenotinfectious,and breaks,and [ZTGC05,WPSC03,WSP04],whichexamined
anyregionalbiasininfectionswillaffecttheoverallgrowth a speci(cid:2)c type of routed worm, and [ZTG04], which ex-
of the botnet. We therefore created a diurnal propagation aminesspeci(cid:2)ctypesofpropagation(e.g.,e-mail). Model
model.Themodelusesdiurnalshapingfunctionstocapture enhancements belonging to the second category are far
regionalvariationsinonlinevulnerablepopulations. fewer. So far, quarantine-basedanalysis has been the pri-
The diurnal model also lets one compare propagation maryresponse-orientedimprovementtomalwarepropaga-
ratesfordifferentbotnets,andprioritizeresponse.Because tionmodels[ZGT03,PBS+04,MSVS03].
ofvariationsinreleasetimesanddiurnalshapingfunctions Ourworkbelongstothissecondcategory,andbuildson
particulartoaninfection,botnetsreleasedlaterintimemay recent improvements in response technologies. Over the
actuallysurpassotherbotnetsthathaveanadvancedstart. previous years, efforts at creating Internet-wide monitor-
Since response times for malware outbreaks is now mea- ing networkshave yieldedsome results. Distributed sens-
suredinhours,beingabletopredictshort-termpropagation ingprojects[Ull05,YBJ04,Par04]cantakesomecreditfor
dynamicslets us allocate resources more intelligently. We helping reduce the response time for worms to hours in-
usedempiricaldatafrombotnetstoevaluatetheanalytical stead of days. Anti-virus companies similarly respond to
model. outbreaksoftenwithinhours[Mar04].
Thisimprovedresponsemakestimeamorerelevantfac-
torforwormmodels. InSection3wenotehowtimezones
1 Introduction play a critical role in malware propagation. Now that re-
sponsetimestakeonlyhours[Mar04],andareoftenlocal-
Epidemiological models of malware propagation are ized,modelsofmalwarespreadingdynamicsmustsimilarly
maturing. Earlier work used simple susceptible-infected improve.
(SI) models to measure the total infected population over In addition to time, we also note that location plays acritical role in malware spreading. Some malware tends thevictimpopulationinaparticularlocation.(Wespeculate
tofocusonparticulargeographicregions,correspondingto that this may explain why most e-mail virus propagations
different market segments for vulnerable software (e.g., a usesimpleEnglish,tomaximizeitsappeal.)Theseregional
languageeditionofanoperatingsystem).Wecombineboth variationsininfectedpopulationsplayanimportantrolein
of these factors in models that consider the importanceof malwarespreaddynamics.
time zones (literally, time and zone location) in propaga-
tion. 2.1 DataCollection
Our researchlooks at propagationdynamicsin botnets.
Westudieddozensofbotnets,comprisedofmillionsofindi-
Tocontrolor(cid:147)rally(cid:148)theirbotnets,botmastersforcetheir
vidualvictimsoverasixmonthperiod.Ourstudyofbotnets
victims to contact command-and-control (C&C) servers
revealsanintriguingdiurnalpatterntobotnetactivity. Our
(e.g.,anIRCserver,awebpage,ore-mail).Onceconnected
model explains this behavior, and has two principal bene-
totheservers,thebotsaregiveninstructions,puttowork,
(cid:2)ts:(a)theabilitytopredictfuturebotnetpropagationchar-
ormadetodownloadadditionalprograms. Ifsuchcentral-
acteristics, for those botnets using similar vulnerabilities,
ized servers are recovered, botmasters can merely update
and(b)theabilitytopriorityrankmalwarebasedontime-
DNSentriestopointtoanewcentralserver. Thispractice
of-releaseandregionalfocus,sothatresourcesaredevoted
is known as (cid:147)herding(cid:148) a botnet to a new location. While
tofasterspreadingbotnets.
suchcentralizedcontrolmaynotbethefavoredtopologyfor
Section 2providesabackgrounddiscussionofbotnets,
much longer [Dag05,CJ05], we can manipulatethis com-
anddetailsourdatacollectionefforts.InSection3,wepro-
monfeatureofbotnetstoperformsimpledatacollection.
vide a model of botnet propagation. After noting related
Togatherbotnetsforstudy,weidenti(cid:2)edbotnetsthrough
workinSection4,theconclusioninSection5suggestsfur-
varioustraditionalmeans(e.g.,honeypots),andthenmanip-
therareasofstudy.
ulatedtheDNSservicefortheC&Cserver,sothatalltraf(cid:2)c
wassenttooursinkholeforstudy.Thesinkholeswereused
2 Background toruntarpits[Har02,Lis01],honeypots[Spi03,Pro05],and
light-weightresponders,e.g.,[Pro03,Kre03].Formoredis-
Using automated scanners and tools, attackers have cussionofnetworkresponseoptionssee[YBP05].
carved out a large portion of the Internet as continuously Our sinkhole redirection was accomplished by several
infectednetworks.Thevictimsarebotsorzombiesinlarge steps.First,usingcapturedmalware(e.g.,fromahoneypot,
networks,orbotnets,controlledbyhackers. Therearetens spam(cid:2)lter,honeyd,andothercommonlyavailablesources),
(if not hundreds)of millions of such victims on the Inter- we identify the command and control server used by the
net [Dag05]. Some estimates hold that over 170,000new botnet.Thiscanbedonebyunpackingthebinary(e.g.,with
victims are compromised each day [Cip05]. Indeed it is thehelpoftoolssuchasIDAPro,orPEiD[JQsx05]anda
hardly possible for home users to purchase a new com- hexeditor)andscanningthebinaryforDNSresolutionop-
puter and successfully update before becoming attacked. erations, (e.g.,gethostbyname(3)). Thisis alsodone
The (cid:147)vulnerability window(cid:148), or the time before a random less precisely by observing the malware’s rallying behav-
infection strikes a new computer, is often less than 20 ior in an emulator (e.g., a virtual honeypot). The latter is
minutes. As a result, others have observed that a (cid:147)bot- less reliable because malware may selectively resolve one
net is comparableto compulsorymilitary service for win- of many encoded C&C domains, or behave differently in
dowsboxes(cid:148)[The05a].Forageneraldiscussionofbotnets, the emulator [Hol05]. Hand-driven binary analysis, how-
see[CJ05,SS03,The05a]. ever,canusuallyrevealthemalware’srallyingbehavior.
Forpurposesofmodeling,wecanthinkofbotnetsashet- Second, we then identify the DNS Start of Authority
erogeneous collections of infections. They are composed (SOA)forthecommandandcontrolboxusingwell-known
of the victims reaped from different viruses, worms and techniques [RIP05]. We then contact the registrar for the
trojans. Thus, botnets are correctly referred to as either domain and the DNS authority, and instruct them to ei-
viruses, worms or trojans, dependingon the context. The ther (cid:147)park(cid:148) the DNS (so that, for example, an RFC 1918
originalinfectionscompelthevictimstorunbotprograms, non-routable address is returned), or to supply an A-Rec
whichallowforremoteadministration. forasinkhole,orasimilarsuitableRecordResponse(RR).
Victims are usually spread over diverse parts of the Wefollowedastrictone-ip-per-botnetrule,tofacilitatethe
world, but can be concentrated in particular regions, de- studyofsinglebotnets.Formostbots,wealsousedlayer-7
pending on how the underlying infections propagate. For sinkholes(i.e.,honeyd,orsimilarscripts)insteadoflayer-4
example, some attacks target a particularlanguageedition sinkholes(e.g.,routingblackholes)topreventrandomscans
ofanoperatingsystem,orusearegionallanguageaspartof frombeingconfusedwithactualbotnetparticipation.
asocialengineeringploy. Suchfactorstendtoconcentrate Conceptually, one might think of this capturing tech-nique as a form of DNS self-poisoning, except that alter- notusuallycapturethecoordinatingmessagesbetweenbots
ingtheDNSentryforthebotdomainisdonelegitimately, andbotmasters(i.e.,DNSresolutionofthecommand-and-
in accordance with the DNS operator’s policies, and with controldomain).SinceDNSredirectiongivesustheoppor-
the permission and cooperation of all relevant authorities. tunitytowitnessonlythecommand-and-controltraf(cid:2)c,and
In our study, we worked with several DNS operatorswho notthepropagationattempts,ourtechniquemeasuresprop-
agreed to redirect bot victims to our sinkhole. The oper- ertiesofbotnets,regardlessofhowtheunderlyinginfection
ators would enter CNAME records in their DNS servers to spreads. Thus,themodelweproposeis forbotnets,albeit
pointvictimstooursinkhole. botnetscreatedbyworms.
Since all the botnets being studied used DNS to locate Thedatacollectiontechniqueisnotthefocusofthepa-
their C&C server, redirection captured most of the bot- per,anddeservesmorecarefulseparatestudy.Wewelcome
netmembers. Throughbinaryanalysis, wecon(cid:2)rmedthat input from the research community on what other factors
the bots did not use hard-codedIP addresses. We also re- (besidesouruseofcommand-and-controlmessages)permit
stricted our study to non-public servers, so no legitimate themeasurementofbotnets.Additionally,weacknowledge
traf(cid:2)cpollutedourdatacapture. Oursinkholescompleted thattherearecertaintypesofbotnetsthatwouldevadesuch
3-wayTCPhandshakeswithvictims,sothatrandomInter- measurementefforts. Wemerelyuseredirectiontoquickly
net SYN scans did not skew our population counts. Fur- performpopulationcountsonbotnets. Insection3wedis-
ther,bysettingazeroTCPwindow,oursinkholeprevented cuss particular botnets in detail used to derive our diurnal
mostbotsfromdisconnecting(e.g.,throughanapplication- propagationmodel.
layer idle timeout), and then reconnecting after changing
dynamicaddresses.Thisreducedthenumberofvictimsthat 3 ModelofBotnet Growth
weredouble-countedduetoDHCPchurn.
These techniques yield what we believe is a fairly ac-
Our goal is to use our observationsof previous botnets
curatepopulationcountforaninfection. Nonetheless, our
to predict the behavior of future botnets. Botnets are so
dataprobablydidhavecasual,non-maliciousconnectionat-
widespreadthatweneedatechniquetocomparativelyrank
tempts,andcertainlyhadsomeamountofDHCPchurn.
them,andhelpprioritizeresponses. Existingmodelsletus
Thus, while others models use trace (cid:2)les from large predict the total botnet populationover lengthyperiodsof
(cid:147)internet telescope(cid:148) structures to infer which machines time(e.g.,overdays).Butsincemostvirusesusedtospread
scanningthe internet share a commoninfection [Moo02b, infectionsareshortlived,weneedamodelthatcanpredict
YBP05], we believe our simple data collection technique short-termvariationsinpopulationgrowth.
yieldsaccuratetrace(cid:2)les foreachinfection. Moreimpor- Further,existingmodelstreatallvulnerablepopulations
tantly,thistechniquecanpotentiallydistinguishtwobotnets as the same. Our observations of botnets, however, show
thatuse thesame infection, while scan-basedsensorsmay thattheyuseaheterogenousmixofdifferentinfectionsex-
associate the traf(cid:2)c together based on port numbers. Sig- ploitingdifferentsetsofvulnerabilities,oftenindistinctnet-
ni(cid:2)cantly,we alsolearnwhichvictimsareassociatedwith works,withvariablebehavioracrosstimezones. Wethere-
whichbotnet,basedonthedomaintheyattempttoresolve. foreneedamodelthatcanexpressdifferencesinsusceptible
Thus,althoughourdatacollectiontechniquefocuseson populations,andgaugehowthisaffectspropagationspeed.
botnetsusingcentralizedDNS(currently,themostcommon Thereareavarietyofreasonswhyexistingmodelshave
rallyingtechniqueusedbybotnets),wedonothavetocor- notexaminedfactorssuchas timezones. First, converting
relate scans from diverse sources to infer the structure of a networkaddressintoa time zone(orgeographicregion)
the botnet. We were able to direct some 50 botnets to the isdif(cid:2)cult,asnotedin[Mic05],andtherearefewavailable
sinkhole over a six month period. Our sinkhole captured resources,e.g., [Coo03]. Second,sincetheearliermodels
botnetsrangingfromjustafewhundredvictimstotensof wereproposed,thestateoftheartforresponseandquaran-
thousandsofvictims.Onebotnetfeaturedover350,000vic- tinehasimproved.Mostantiviruscompaniescanissuesig-
tims,arecord[CJ05]. natureupdatesinunder12hours(orless),sounderstanding
One might wonder whether this redirection technique theshort-termgrowthofawormismorerelevant.
yieldsdataaboutwormsinsteadofbotnets.Afterall,many Forourmodel,wemakeanotherobservationaboutbot-
ofthebotnetsarecreatedbyworms. Thequestionis: How net behavior. We were (cid:2)rst struck by the stronglydiurnal
isredirectiondifferentfromtraditionalwormmeasurement nature of the botnets trapped in the sinkhole. Figure 1(a)
techniques? We believe redirection measures botnets (as showsatypicalplotofSYNratesovertime, brokendown
opposedtojustworms)becausethetraf(cid:2)cyieldisentirely by geographic regions, for a large 350K member botnet.
relatedtothecommand-and-controlofamaliciousnetwork. Thispatternrepeateditselfforbothemail-spreadingworms
Worm measurement techniques, by contrast, tend to col- and scanning worms observed in the sinkhole. A logical
lect scans by worms (i.e., propagation attempts), and do explanation is that many users turn their computers off atnight,creatingasortofnaturalquarantineperiod,andvary- Notallthecomputersareshutoffatnight,ofcourse. Soin
ing the number of victims available in a geographical re- modelingandexperiments,we can derive(cid:11)(t) foragiven
gion. timezonebasedonmonitoredmalicioustraf(cid:2)c.
Suchsigni(cid:2)cantchangesinpopulationsovertimesurely In the following, we (cid:2)rst derive the worm propagation
affectspropagationrates.Tomodelthestronglydiurnalbe- diurnalmodelforasingletime-zonebyassumingcomput-
haviorofbotnetsobservedinFigure1(a),weanalyzebots ersinthetimezoneformaclosednetworkingsystem. We
groupedintotimezones. Consideraverysimpli(cid:2)edmodel thenderivethediurnalmodelfortheentireInternetbycon-
representedinFigure1(b),whereonehostisshowninacol- sideringmultipletimezones.
umnoftimezones,TZ. Inthe(cid:2)rsthour,theinfectedhost
in TZ i infects TZ i(cid:0)1 and TZ i+1; however, since TZ i(cid:0)1 3.2 DiurnalModelforaSingleTimeZone
is experiencing a low diurnal phase at Hour (e.g., night
2
time, representedbydiagonalizedshadedboxes), themal- First,weconsideraclosednetworkwithinasingletime
ware does not spread further until several hours later (in- zone. Thus,allcomputersinthenetworkhavethesamedi-
dicated by a dashed line). By contrast, the infection sent urnaldynamics.De(cid:2)neI(t)asthenumberofinfectedhosts
toTZ i+1spreadsimmediately,onlylaterenteringadiurnal attimet;S(t)asthenumberofvulnerablehostsattimet;
phase. N(t) as thenumberofhosts that areoriginallyvulnerable
Thisconceptualmodelexaggeratesakeypropertyofthe tothewormunderconsideration.
diurnal model: different propagation rates, depending on We de(cid:2)ne thepopulationN(t) as a variablesince such
timezoneandtimeofday.TimeZonesnotonlyexpressrel- a model covers the case where vulnerable computerscon-
ativetime,butalsogeography.Iftherearevariablenumbers tinuously go online as a worm spreads out. For example,
of infected hosts in each region, then the (cid:147)natural quaran- thisoccurswhenawormpropagatesovermultipledays.To
tine(cid:148)effectcreatedbyarollingdiurnallowphasecanhave consider the online/of(cid:3)ine status of computers, we de(cid:2)ne
asigni(cid:2)cantimpactonmalwarepopulationsandgrowth. I0 (t) = (cid:11)(t)I(t) as the number of online infected hosts;
Below,wedescribeamodeltoexpressthevariablenum- S0 (t)=(cid:11)(t)S(t)asthenumberofonlinevulnerablehosts;
berofinfectedhosts, time zones, andregionsofthe Inter- N0 (t) = (cid:11)(t)N(t) as the number of online hosts among
net that we observed in the empirical data. We then test N(t).
this model against other observed botnets. The model in To capture the situation where infected hosts are re-
turn lets us estimate short-term population projections for moved, we extend the basic Kermack-McKendrick epi-
agivenworm,basedonits regionalfocus,andthetimeof demicmodel[DG99]. Weassumethatsomeinfectedhosts
day. Themodelalsotells uswhenbotsspreadfastest, and will be removed from the worm’s circulation due to (1)
allowsustocomparetheshort-term(cid:147)virulence(cid:148)oftwodif- computer crash; (2) patching or disconnectingwhen users
ferentbots.Thisinturncanbeusedtoimprovesurveillance discover the infection. De(cid:2)ne R(t) as the number of re-
andprioritizeresponse. moved infected hosts at time t. Just as in a Kermack-
McKendrick model, we de(cid:2)ne dR(t) = (cid:13)I0 (t), (where (cid:13)
dt
3.1 TimeZone›BasedPropagationModeling istheremovalparameter)becauseinmostcasesonlyonline
infectedcomputerscanberemoved.
Thenthewormpropagationdynamicsare:
Wemodelthecomputersineachtimezoneasa(cid:147)group(cid:148).
Thecomputersineachtimezonehavethesamediurnaldy-
dI(t) dR(t)
0 0
namics,nomatterwhethertheyareinfectedorstillvulner- =(cid:12)I (t)S (t)(cid:0) (1)
dt dt
able. In our model, the diurnal property of computers is
determinedbycomputeruserbehavior,notbytheinfection whereS(t)=N(t)(cid:0)I(t)(cid:0)R(t).(cid:12)isthepair-wiserate
statusofcomputers. Ifauserchangeshisdiurnalbehavior of infection in epidemiology study [DG99]. For Internet
becausehediscovershiscomputeris infected,thenweas- wormmodeling,(cid:12) = (cid:17)=(cid:10)[ZTG05]where(cid:17)istheworm’s
sumethecomputerwillquicklybepatchedorremovedby scanningrateand(cid:10) isthesize oftheIPspacescannedby
theuser. theworm.
The number of infected hosts in a region varies over FromEqn.(1),wederivethewormpropagationdiurnal
time. Sowede(cid:2)ne(cid:11)(t)asthe(cid:147)diurnalshapingfunction(cid:148), model:
orthefractionofcomputers(thathavethevulnerabilitybe-
ing exploited by the botnet under consideration)in a time
dI(t)
zonethatisstill on-lineattimet. Therefore,(cid:11)(t) is ape- =(cid:12)(cid:11)2(t)I(t)[N(t)(cid:0)I(t)(cid:0)R(t)](cid:0)(cid:13)(cid:11)(t)I(t) (2)
dt
riodicalfunctionwiththeperiodof24hours.Usually,(cid:11)(t)
reachesitspeaklevelatdaytimeanditslowestlevelatnight Thissimplediurnalmodelcanbeusedtomodeltheprop-
whenmanyusersgotosleepandshutdowntheircomputers. agation of regional viruses or worms. For example, it is(a) DiurnalProperties
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1)
(cid:0)(cid:2)
(cid:0)(cid:2)
(cid:0)(cid:2)
(cid:0)(cid:2)
(cid:0)(cid:2)
(cid:0)(cid:2)
(cid:0)(cid:2)
...
... ...
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)(cid:17)(cid:1)(cid:18)(cid:1)
(cid:17)(cid:1)(cid:18)(cid:1)
(cid:17)(cid:1)(cid:18)(cid:1)
(cid:17)(cid:1)(cid:18)(cid:1)
(cid:17)(cid:1)(cid:18)(cid:1)
(cid:17)(cid:1)(cid:18)(cid:1)
(cid:17)(cid:1)(cid:18)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)(cid:17)(cid:1)(cid:18)(cid:1)
(cid:17)(cid:1)(cid:18)(cid:1)
(cid:17)(cid:1)(cid:18)(cid:1)
(cid:17)(cid:1)(cid:18)(cid:1)
(cid:17)(cid:1)(cid:18)(cid:1)
(cid:17)(cid:1)(cid:18)(cid:1)
(cid:17)(cid:1)(cid:18)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)(cid:17)(cid:1)(cid:18)(cid:1)
(cid:17)(cid:1)(cid:18)(cid:1)
(cid:17)(cid:1)(cid:18)(cid:1)
(cid:17)(cid:1)(cid:18)(cid:1)
(cid:17)(cid:1)(cid:18)(cid:1)
(cid:17)(cid:1)(cid:18)(cid:1)
(cid:17)(cid:1)(cid:18)(cid:1)
(cid:3)(cid:4)
(cid:3)(cid:4)
(cid:3)(cid:4)
(cid:3)(cid:4)
(cid:3)(cid:4)
(cid:3)(cid:4)
(cid:3)(cid:4)(cid:17)(cid:18)
(cid:17)(cid:18)
(cid:17)(cid:18)
(cid:17)(cid:18)
(cid:17)(cid:18)
(cid:17)(cid:18)
(cid:17)(cid:18)(cid:7)(cid:1)(cid:8)(cid:1)
(cid:7)(cid:1)(cid:8)(cid:1)
(cid:7)(cid:1)(cid:8)(cid:1)
(cid:7)(cid:1)(cid:8)(cid:1)
(cid:7)(cid:1)(cid:8)(cid:1)
(cid:7)(cid:1)(cid:8)(cid:1)
(cid:7)(cid:1)(cid:8)(cid:1)
(cid:7)(cid:1)(cid:8)(cid:1)
(cid:7)(cid:1)(cid:8)(cid:1)
(cid:7)(cid:1)(cid:8)(cid:1)
(cid:7)(cid:1)(cid:8)(cid:1)
(cid:7)(cid:1)(cid:8)(cid:1)
(cid:7)(cid:1)(cid:8)(cid:1)
(cid:7)(cid:1)(cid:8)(cid:1)
(cid:7)(cid:1)(cid:8)(cid:1)
(cid:7)(cid:1)(cid:8)(cid:1)
(cid:7)(cid:1)(cid:8)(cid:1)
(cid:7)(cid:1)(cid:8)(cid:1)
(cid:7)(cid:1)(cid:8)(cid:1)
(cid:7)(cid:1)(cid:8)(cid:1)
(cid:7)(cid:1)(cid:8)(cid:1)
(cid:5)(cid:1)(cid:7)(cid:6)(cid:1)(cid:8)
(cid:5)(cid:1)(cid:7)(cid:6)(cid:1)(cid:8)
(cid:5)(cid:1)(cid:7)(cid:6)(cid:1)(cid:8)
(cid:5)(cid:1)(cid:7)(cid:6)(cid:1)(cid:8)
(cid:5)(cid:1)(cid:7)(cid:6)(cid:1)(cid:8)
(cid:5)(cid:1)(cid:7)(cid:6)(cid:1)(cid:8)(cid:9)(cid:1)(cid:10)(cid:1)
(cid:5)(cid:1)(cid:7)(cid:6)(cid:1)(cid:8)(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:5)(cid:1)(cid:6)(cid:1)
(cid:5)(cid:1)(cid:6)(cid:1)
(cid:5)(cid:1)(cid:6)(cid:1)
(cid:5)(cid:1)(cid:6)(cid:1)
(cid:5)(cid:1)(cid:6)(cid:1)
(cid:5)(cid:1)(cid:6)(cid:1)(cid:9)(cid:1)(cid:10)(cid:1)
(cid:5)(cid:1)(cid:6)(cid:1)(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:5)(cid:1)(cid:6)(cid:1)
(cid:5)(cid:1)(cid:6)(cid:1)
(cid:5)(cid:1)(cid:6)(cid:1)
(cid:5)(cid:1)(cid:6)(cid:1)
(cid:5)(cid:1)(cid:6)(cid:1)
(cid:5)(cid:1)(cid:6)(cid:1)(cid:9)(cid:1)(cid:10)(cid:1)
(cid:5)(cid:1)(cid:6)(cid:1)(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:5)(cid:6)
(cid:5)(cid:6)
(cid:5)(cid:6)
(cid:5)(cid:6)
(cid:5)(cid:6)
(cid:5)(cid:6)(cid:9)(cid:10)
(cid:5)(cid:6)(cid:9)(cid:10)
(cid:9)(cid:10)
(cid:9)(cid:10)
(cid:9)(cid:10)
(cid:9)(cid:10)
(cid:9)(cid:10)
(cid:9)(cid:10)
(cid:15)(cid:1)(cid:16)(cid:1)
(cid:15)(cid:1)(cid:16)(cid:1)
(cid:15)(cid:1)(cid:16)(cid:1)
(cid:15)(cid:1)(cid:16)(cid:1)
(cid:15)(cid:1)(cid:16)(cid:1)
(cid:15)(cid:1)(cid:16)(cid:1)
(cid:15)(cid:1)(cid:16)(cid:1)(cid:13)(cid:1)(cid:14)(cid:1)
(cid:15)(cid:1)(cid:16)(cid:1)(cid:13)(cid:1)(cid:14)(cid:1)
(cid:13)(cid:1)(cid:14)(cid:1) (cid:13)(cid:1)(cid:14)(cid:1)
(cid:13)(cid:1)(cid:14)(cid:1)
(cid:13)(cid:1)(cid:14)(cid:1)
(cid:13)(cid:1)(cid:14)(cid:1)
(cid:13)(cid:1)(cid:14)(cid:1)
(cid:15)(cid:1)(cid:16)(cid:1)
(cid:15)(cid:1)(cid:16)(cid:1)
(cid:15)(cid:1)(cid:16)(cid:1)
(cid:15)(cid:1)(cid:16)(cid:1)
(cid:15)(cid:1)(cid:16)(cid:1)
(cid:15)(cid:1)(cid:16)(cid:1)
(cid:15)(cid:1)(cid:16)(cid:1)(cid:13)(cid:1)(cid:14)(cid:1)
(cid:15)(cid:1)(cid:16)(cid:1)(cid:13)(cid:1)(cid:14)(cid:1)
(cid:13)(cid:1)(cid:14)(cid:1) (cid:13)(cid:1)(cid:14)(cid:1)
(cid:13)(cid:1)(cid:14)(cid:1)
(cid:13)(cid:1)(cid:14)(cid:1)
(cid:13)(cid:1)(cid:14)(cid:1)
(cid:13)(cid:1)(cid:14)(cid:1)
(cid:15)(cid:16)
(cid:15)(cid:16)
(cid:15)(cid:16)
(cid:15)(cid:16)
(cid:15)(cid:16)
(cid:15)(cid:16)
(cid:15)(cid:16)(cid:13)(cid:14)
(cid:15)(cid:16)(cid:13)(cid:14)
(cid:13)(cid:14) (cid:13)(cid:14)
(cid:13)(cid:14)
(cid:13)(cid:14)
(cid:13)(cid:14)
(cid:13)(cid:14)
(cid:11)(cid:1)(cid:12)(cid:1)
(cid:11)(cid:1)(cid:12)(cid:1)
(cid:11)(cid:1)(cid:12)(cid:1) (cid:11)(cid:1)(cid:12)(cid:1)
(cid:11)(cid:1)(cid:12)(cid:1)
(cid:11)(cid:1)(cid:12)(cid:1)
(cid:11)(cid:1)(cid:12)(cid:1)
(cid:11)(cid:1)(cid:12)(cid:1)
(cid:11)(cid:1)(cid:12)(cid:1)
(cid:11)(cid:1)(cid:12)(cid:1)
(cid:11)(cid:1)(cid:12)(cid:1) (cid:11)(cid:1)(cid:12)(cid:1)
(cid:11)(cid:1)(cid:12)(cid:1)
(cid:11)(cid:1)(cid:12)(cid:1)
(cid:11)(cid:1)(cid:12)(cid:1)
(cid:11)(cid:1)(cid:12)(cid:1)
(cid:11)(cid:12)
(cid:11)(cid:12)
(cid:11)(cid:12) (cid:11)(cid:12)
(cid:11)(cid:12)
(cid:11)(cid:12)
(cid:11)(cid:12)
(cid:11)(cid:12)
TZ TZ TZ ...
i-1 i i+1
Hour
1
Hour
2
Hour
3
...
(b) ConceptualModel
Figure 1. (a) Botnet activity by geographic region. (b) General conceptual model of diurnal botnet
propagation.
well known that viruses can focus on speci(cid:2)c geographic manyofthetimezoneshavenegligiblenumbersofcomput-
regions [Tre05], e.g., because of the language used in the ers(suchasthezonesspanningpartsofthePaci(cid:2)cOcean),
e-mailpropagationsystem. Similarly,wormscanusehard- weconsiderwormpropagationinKtimezoneswhereKis
coded exploits particular to a language-speci(cid:2)cversion of smallerthan24.
anOS(e.g.,awormthatonlysuccessfullyattacksWindows AssumeN (t),S (t),I (t),R (t)asthenumberofhosts
i i i i
XP Home Edition Polish.) For these regional worms, the inthetimezonei(i=1;2;(cid:1)(cid:1)(cid:1);K)thatcorrespondtoN(t),
infectionoutsideofasinglezoneisnegligibleandtheinfec- S(t), I(t), R(t) in the previous model Eqn. (2); (cid:11) (t) is
i
tionwithinthezonecanbeaccuratelymodeledbyEqn.(2). thediurnalshapingfunctionforthetimezonei; (cid:12) is the
ji
Ifwedonotconsiderdiurnaleffect,i.e.,(cid:11)(t)(cid:17)1atany pairwise rate of infection from time zone j to time zone
time,thenthediurnalmodelEqn.(2)issimpli(cid:2)edas: i; (cid:13) is the removal rate of time zone i. Considering the
i
worm infectionacross differenttime zones, we can derive
thewormpropagationfortimezonei:
dI(t)
=(cid:12)I(t)[N(t)(cid:0)I(t)(cid:0)R(t)](cid:0)(cid:13)I(t) (3)
dt K
dI (t) dR (t)
i 0 0 i
This is exactly the traditional Susceptible-Infectious-
dt
=X(cid:12) jiI j(t)S i(t)(cid:0)
dt
(4)
Removal(SIR)model[DG99]. j=1
whichyields:
3.3 DiurnalModelforMultipleTimeZones
dIi(t) = (cid:11) (t)[N (t)(cid:0)I (t)(cid:0)R (t)]
Wormsareoftennotlimitedtoageographicregion,how- dt (cid:1) i K (cid:12)i (cid:11) (t)i I (t) i (5)
ever. Some malware contain enormous lookup tables of Pj=1 ji j j
(cid:0)(cid:13) (cid:11) (t)I (t)
buffer-over(cid:3)ow offsets for each language edition of Win- i i i
dows[The05b]. Forauniform-scanworm,sinceitevenlyspreadsoutits
Accordingly,wemodelthewormpropagationintheen- scanningtraf(cid:2)ctotheIPspace,(cid:12) =(cid:17)=(cid:10);8i;j 2 K. For
ji
tire Internet across different time zones. Since computers wormsthatdonotuniformlyscantheIPspace,theauthors
in one time zone could exhibit different diurnal dynamics in [ZTG05] demonstrated that (cid:12) = (cid:17) =(cid:10) where (cid:17) is
ji ji i ji
fromtheonesin anothertimezone, we treatcomputersin thenumberofscanssenttogroupifromaninfectedhostin
eachzoneasa(cid:147)group(cid:148).TheInternetcanthenbemodeledas groupj ineachtimeunit;and(cid:10) isthesizeoftheIPspace
i
24interactivecomputergroupsfor(cid:25)24timezones.1 Since ingroupi.
1Therearemorethan24timezones,butwesimplifythingsforthesake ofdiscussion.When we discover a new worm propagating in the In- In thefollowingexperiments,we considerthreegroups
ternet, we can use the diurnalmodelEqn.(5)by inferring of computers because the infected population was mostly
the parameter (cid:12) based on monitored honeypot behavior distributed in these three groups: North America, Europe,
ji
of scanning traf(cid:2)c. As noted above, many honeypot sys- andAsia. TheNorthAmericangroupis composedofUS,
tems can observe all outgoing scans created by a trapped Canada, and Mexico; the Europeangroupis composedof
worm[Pro03].Wethereforeinfertheworm’sscanningtar- European countries; and the Asian group is composed of
getaddressdistributionbasedonreportsfrommultiplehon- China, South Korea, Japan and adjacent areas (e.g., Aus-
eypots. Thenwecanderive(cid:17) basedontheworm’sscan- tralia).Wenotethatantiviruscompaniessimilarlyorganize
ji
ningdistributionandrate. Internetmonitoringintomajorgroups:Asia,Europe,North
America,andsoon[Tre05,Ull05].
3.4 ModelLimitations Figure2showsthenumberofSYN connectionssentto
thesinkholeperminutebythebotnetsin eachgroup. The
timeshowninX-axisis the00:00UTCtime ofthelabeled
There are of course several limitations to our model.
date. Since each bot sends out a similar number of SYN
First,ourdiurnalmodelisnotwellsuitedtomodelworms
connectionrequeststoitsbotmasterperminute,thenumber
propagatingviaemail. Unlikescanningwormswherema-
ofinfectedhostsineachgroupisproportionaltothenumber
licious codes directly reach victim computers, malicious
of SYNs sent from each group. Therefore, the curves in
emailaresavedinemailserversbeforeusersretrievethem
Figure2representthenumberofonlineinfectedcomputers
ontotheirowncomputers. Whenacomputerisshutdown
astimegoeson.
anditsusergoestosleepatnight,themaliciousemailtar-
As showninthis (cid:2)gure,forthebotnetwearestudying,
getingtheuserisnotlostasinthecaseofscanningworms;
theAsiangrouphas abouteighttimes moreinfectedcom-
the infection effect of these malicious email will show up
putersthantheNorthAmericangrouphas(althoughthisis
once the user checks email later. Therefore, the propaga-
nottrue forotherbotnets). Inaddition, thenumberof on-
tiondynamicsI(t)attimetwillbenotonlydeterminedby
lineinfectedhostsoftheAsiangroupreachesitspeaklevel
currentinfectionasshowninEqn.(1),butalsodetermined
whenthisnumberoftheNorthAmericangroupreachesits
bypreviousinfectiondynamics.
lowest level since the time difference between these two
Second,fornon-uniformscanningworms, as explained
groupsisaround12hours.
after Eqn. (5), we need to know the worm scan rate and
In the following, we study the propagation of a worm
scanningspacesizeineachgroup(ortime-zone)inorderto
based on the diurnal model, Eqn.(5), and the above three
usethemultipletime-zonediurnalmodelEqn.(5). Forthis
groups. For simplicity, we assume the worm uniformly
reason, we need to have a sound worm scanningmonitor-
scans the Internet, thus (cid:12) = (cid:17)=(cid:10);8i;j 2 K. We also
ingsysteminordertousethediurnalmodelaccuratelyfor ji
assumethatallcomputersinthesegroupshavethesamere-
modelingofnon-uniformscanningworms.
movalrate(cid:13). Sincethenumberofinfectedhostsispropor-
tional to the number of SYN connections per minute, we
3.5 Experiments
choose populationsof N = 15;000 for the North Amer-
1
ican group, N = 45;000 for the European group, and
2
Wewishtovalidateourmodelusingempiricaldata.Fur-
N = 110;000fortheAsiangroup. ThenwedeployMat-
3
ther,wewishtoexplorewhetherthemodelcananalytically
labSimulink[Mat05]toderivethenumericalsolutionsfor
distinguish botnets, based on their short-term propagation
thediurnalmodelEqn.(5).
potential. Weselectedalarge(350Kmember)botnetfrom
Wewroteaprogramtoautomaticallyderivethedynam-
ourcollectionofobservedbotnets,sinceithadthemostdi-
ics(cid:11)(t)foreachgroup(andalsoeachcountry). Thebasic
verse geographical dispersion of victims. The binary for
stepsforderiving(cid:11)(t)include:
thebotnetwasobtainedfromAVcompanyhoneypots,and
analysiscon(cid:2)rmedthatthemalwareusedrandomscanning 1. First,observeallbotnettraf(cid:2)c,andbreakdownvictim
forpropagation,andasingledomainforrallyingvictims. membershipbygeographicregion.
Our experimentsimpli(cid:2)es the numberof time zones to
2. Second,processthedatafromaregiontoderive(cid:11)(t)
a manageablenumber. Usually, computersin neighboring
throughthefollowingsteps:
time zones have the similar diurnal property (cid:151) this phe-
nomenahasbeencon(cid:2)rmedbyourmonitoredbotnetactiv- (cid:15) Splitamonitoreddatasetintosegmentsforeach
ities. For example, Figure 1(a) shows Europeancountries day. Suppose a monitored dataset spans over n
withverysimilardiurnaldynamics. Therefore,itisconve- days. Split the dataset into n segments where
nient and accurate to model the Internetas several groups eachsegmentcorrespondingtoonedaycontain-
whereeachgroupcontainsseveralneighboringtimezones ingthedatafrom00:00:00UTCto24:00:00UTC
thathavethesimilardiurnaldynamics. inthatday.North America group 15000
10000
5000
0
12/31/04 01/01/05 01/02/05 01/03/05 01/04/05 01/05/05
Time
etunim/snoitcennoc
NYS
x 104 Europe group
5
4
3
2
1
0
12/31/04 01/01/05 01/02/05 01/03/05 01/04/05 01/05/05
Time
(a)NorthAmericagroup
etunim/snoitcennoc
NYS
x 104 Asia group 12
10
8
6
4
2
0
12/31/04 01/01/05 01/02/05 01/03/05 01/04/05 01/05/05
Time
(b)Europegroup
etunim/snoitcennoc
NYS
(c)Asiagroup
Figure2.NumberofSYNconnectionssenttothesinkholeperminutefromeachgroupbythebotnet
(cid:15) Normalize the data in each segment so that the x 104
maximum value of the data in each segment is Botnet data
3
one. Diurnal model
SIR model
(cid:15) Averagethedatainallsegmentstoderiveapri- 2.5
mary(cid:11)(t);
2
(cid:15) In order to remove the monitoring noise, (cid:2)nd a
polynomialto represent(cid:11)(t) by minimizingthe 1.5
cumulativesquareerrorbetweenthepolynomial
andtheprimary(cid:11)(t)derivedinthepreviousstep; 1
(cid:15) Normalizetheresultsothatthemaximumvalue
0.5
of(cid:11)(t)isone.
0 2000 4000 6000 8000
Thediurnalshapingfunction(cid:11)(t)isaperiodicalfunc-
Time t (minute)
tion, i.e., (cid:11)(0) = (cid:11)(T) where T = 24 hours. Af-
ter the (cid:2)rst one or two days, many worms’ infected Figure 4. Comparison of models with botnet
populationwilldropcontinuouslyduetopatchingand traf(cid:2)cintheEuropeangroup
cleaning of infected computers. For this reason, the
(cid:11)(t)derivedthroughtheaboveproceduresusuallyhas
(cid:11)(0)>(cid:11)(24).Ifthisisthecase,weneedanotherstep
toadjustthederived(cid:11)(t)sothat(cid:11)(0) = (cid:11)(24). Here
weuseaheuristicalgorithmsuchthattheshapeofthe groupsalsoshowsthatcombiningmultiplehour-sizedtime
(cid:11)(t)isnotdistortedmuch. zones into groups did not make the diurnalpatterns indis-
tinguishablefromeachother.
3. Third,placethe(cid:11)(t) tableandits correspondingvul-
nerabilityinadatabase,keyedbyvulnerability.
Havingderivedvaluesfor(cid:11)(t),wecantesthowwellthe
diurnal model in Eqn. (5) can capture a worm’s propaga-
Wefollowedthesestepstoderive(cid:11)(t)forNorthAmer- tion behavior in the Internet. Figure 4 shows the number
ica,EuropeandAsia,asshowninFigure3(a).Studyingthe ofonlinebotcomputersintheEuropeangroupobservedby
diurnaldynamicsof NorthAmericangroup, the time with oursinkholecomparedwith theanalyticalresultsfromthe
the fewest computers online is around 11:00 UTC, which model Eqn. (5), and the existing SIR model Eqn. (3). At
is 6:00am in US eastern coast and 3:00am in US western someinitialtimelabeledastime0inthe(cid:2)gure,thebotbe-
coast. Figure3(b)showsthecumulativeonlinevulnerable gan to spread. After a while, the bot was discovered and
populationacross all threegroupsbeforethe wormbegins entered our sinkhole, and our data collection begins. Fig-
tospread. ure 4 shows that, compared with the SIR model Eqn. (3),
Figure 3(a) clearly illustrates the diurnal properties of the diurnalmodelEqn.(5) is muchbetter in capturingthe
botnetsvisuallysuggestedbytheSYNactivityplotinFig- diurnalpropertyofaworm’spropagationandtheactivein-
ure1(a).Thedistinctdiurnalbehaviorofallthreetimezone fectivepopulationsintheInternet.5
x 10
1.6
1
1.4
0.8
1.2
0.6
1
0.4
0.8
North America
0.2 Europe
Asia 0.6
0
00:00 04:00 08:00 12:00 16:00 20:00 24:00 00:00 04:00 08:00 12:00 16:00 20:00 24:00
Time (UTC) Time (UTC)
(a)Diurnaldynamics
noitalupop
enilno
evitalumuC
(b)Cumulativeonlinepopulation
Figure3.Wormpropagationdynamicsandpopulationgrowth
3.6 PracticalUsesofDiurnalModels functions,basedonobservedbotnetdata,andkeythetable
basedonotherheuristicsabouttheworm(e.g., theexploit
The diurnal model Eqn. (5) tells us when releasing a used,theOS/patchlevelitaffects,countryoforigin).When
wormwillcausethemostsevereinfectiontoaregionorthe anewwormisdiscovered,theseheuristicsareoftenthe(cid:2)rst
entireInternet. Forwormsthatfocusonparticularregions, few pieces of information learned from a honeypot. One
themodelalsolets uspredictfuturepropagation,basedon can then consult the table for any prior (cid:11) i(t) derivations,
timeofrelease. Therolethattimezonesplayonpropaga- anduse themto forecasttheshort-termpopulationgrowth
tionisintuitivelyobvious,buthasnotbeenexpressedinany ofthebot,relativetoitsfavoredzoneandtimeofrelease.
previousmodel. To evaluate the forecasting capability of our diurnal
model, wecollectedmonitoredtraces ofthreebotnetsthat
exploited the same vulnerability [Mic04]. The agents for
3.6.1 ForecastingwithPatternTables
thesebotnetswerereleasedinsuccession,evidentlyas en-
The derived (cid:11) (t) is not limited to the botnet under ex- hancementstopriorversions. FromourdiscussioninSec-
i
amination,butinsteadre(cid:3)ectsthetypeofvulnerabilityex- tion 3, these botnets should have similar diurnal shaping
ploited by the botnet. That is, different botnets that both functions,(cid:11) i(t),forthesametimezoneorgroupofzones.
exploit the same vulnerability in Windows 2000 SP2 will Wethereforeusedthediurnalmodelderivedfromonebot-
likely have similar N (t) (and therefore (cid:11)(t)), assuming nettopredictthepropagationdynamicsofotherbotnets.
i
therearenootherregion-speci(cid:2)climitingfactors. Thatis, Fig.5(a)showsthepropagationdynamicsofthesethree
bothwormswilltargetthesameS (t),iftherearenodiffer- botnetsintheEuropeangroup. Eachdatapointrepresents
i
ences(e.g.,languagedifferencessuchasKoreanversusEn- the number of SYN connection requests observed by our
glish languageemail viruses)that wouldclearly favorone sinkholewithin everyhalf an hour. Because these botnets
timezone’spopulationoveranother. appearedindifferenttimeperiods,theirinfectedpopulation
Repeated sampling of botnets using DNS redirection weredifferentfromeachothersincethevulnerablepopula-
notedinSection2(andothertechniques)willconceivably tionintheInternetvariesovertime. Wethereforeshowthe
yieldanunderstandingofhowvulnerabilitiesaredistributed resultsbynormalizingtheirSYNconnections. Figure5(a)
in different zones. Since (cid:11) (t) correspondsto the type of clearly shows that botnets exploiting the same vulnerabil-
i
vulnerability being exploited, repeatedly seeing malware ityhavesimilardiurnaldynamics. TheresultsoftheNorth
targetthesameOS(cid:3)awmayassistforecasting.Researchers AmericanandAsiangroups,showninFigs.6(a), 7(a),were
can infer the growth of future outbreaks based on previ- alsosimilar.
ousattemptstoexploitthesamevulnerability. Thus,when To evaluate the predictive capability of our diurnal
a new bot appears targeting a familiar vulnerability, re- model,wederivetheparametersforthediurnalmodelbased
searcherscanusetimelypreviousexamplestoestimatehow on curve (cid:2)tting of data from Botnet 1 for the European
farandfastthebotwillspread. group.Thenweusethederiveddiurnalmodeltopredictthe
Accordingly,wecanbuildatableofthederivedshaping dynamics of the other two botnets for the same European7x 105 3.5x 105
Botnet 1 Model derived from Botnet1
6 Botnet 2 3 Botnet 2
Botnet 3 Botnet 3
5 2.5
4 2
3 1.5
2 1
1 0.5
0
00:0012:0000:0012:0000:0012:0000:0012:0000:00 12:0000:0012:00 00:0012:0000:0012:0000:00
Time (UTC hour) Time (UTC hour)
(a)Observedbotnettraf(cid:2)cinEuropean (b)Predictedandobservedbehaviorin
group Europeangroup
Figure5.Europeangroup
x 104 x 105
Botnet 1 3 Model derived from Botnet 1
Botnet 2 Botnet 2
Botnet 3 2.5 Botnet 3
15
2
10
1.5
1
5
0.5
0 0
12:0000:0012:0000:0012:0000:0012:0000:00 12:0000:0012:0000:0012:0000:0012:0000:00
Time (UTC hour) Time (UTC hour)
(a)Observedbotnettraf(cid:2)cintheNorth (b)Predictedandobservedbehaviorin
Americangroup NorthAmericangroup
Figure6.NorthAmericangroup
x 106 x 106
2
Botnet 1 Model derived from Botnet 1
Botnet 2 2.5 Botnet 2
Botnet 3 Botnet 3
1.5
2
1.5
1
1
0.5
0.5
0 0
12:0000:0012:0000:0012:0000:0012:0000:00 12:0000:0012:0000:0012:0000:0012:0000:00
Time (UTC hour) Time (UTC hour)
(a)ObservedbehaviorinAsiangroup (b)Predictedandobservedbehaviorin
Asiangroup
Figure7.Asiangroupgroup. The results are shownin Fig. 5(b). Again, the ab- 3.6.2 ReleaseTimes
solutevaluesofthethreecurvesarenormalizedtobecom-
The short-term spread of a worm will vary, depending on
parablewitheachother. This(cid:2)gureshowsthatwecanuse
thetimeofreleaseandthedistributionoftheaffectedpop-
thediurnalmodeltoforecastthepropagationofbotnetsus-
ulation across different time zones. Knowing the optimal
ingasimilarvulnerability.SimilarpredictionsfortheNorth
release time for a worm will help us improvesurveillance
AmericanandAsiangroupsappearinFigs.6(b),7(b). The
andresponse. Toidentifytheoptimalreleasetime,weper-
predictivefeatureofthediurnalmodelisnotasgoodasin
formthefollowingsteps:
the European group. Fig. 6(b) shows that the online in-
fectedhostsintheNorthAmericangroupisnotassmooth
(cid:15) Obtain the scan rate (cid:17) and scanningdistribution, and
as in the European group, and the Botnet 2 infections in-
vulnerablepopulationforeachzone;
creasedslightlyafterthe(cid:2)rsttwodaysinsteadofdropping.
For the Asian group, Fig. 7(b) clearly shows that the (cid:2)rst (cid:15) Obtainthe(cid:11)(t)valuesforeachzone;and
two-days have a different pattern than the third day. We
speculate that the North American and Asian groups have (cid:15) UsingthediurnalmodelEqn.(5)tocalculate(numer-
morenoise becausecountriesin thesegroupstendto span ical solution) the infected population six hours after
numeroustime zones with largenumbersofinfected indi- releasefordifferentreleasetimetoderivetheoptimal
viduals,andChinahasonetimezonefortheentirecountry. releasetime.
By comparison, the European countries tend to occupy a
Asanexample,weidentifyanoptimalreleasetimeina
single zone, and most victims are located in the western-
scenariowherethewormuniformlyscanstheInternetand
mosttimezones.
all three diurnal groups have the same number of vulner-
able population, i.e., N = N = N . The diurnal dy-
AsshowninFig.5(b),thediurnalmodelcanpredictthe 1 2 3
namicsofdifferentgroupswillnotmattermuchforavery
dynamicsofbotnets,butnottheirinfectedpopulation.(Re-
slowspreadingwormthatneedstospreadoutwithatleast
callthatthemodelderives(cid:11)(t)values,whichdescribethe
several days. It also does not matter much for a very fast
relativefractionofusersonline.)Therearesomeotherways
spreadingwormthatcan (cid:2)nishinfectingallonlinevulner-
to predict vulnerable or infected populations for an Inter-
able hosts within an hour (cid:151) its infection range is solely
netvirusorworm. Forexample,Zouetal.[ZGGT03]pre-
determined by the population of current online comput-
sentedamethodtopredictthevulnerablepopulationbased
ers. Therefore,westudythepropagationofamiddle-speed
onaworm’sinitialpropagationspeedanditsscanrate(cid:17).
worm that can spread out in several hours. For example,
We note that the derived diurnal dynamics of a botnet Code Red is one such worm, which (cid:2)nished its infection
have an unknown shelf life. If a model is derived from a in 14 hours [Moo02a]. For this reason, we study a Code
botnet, its predictive power decays over time, since users Red-like worm that has the total vulnerable population
migratetonewplatforms,cleanmachines,orreplaceequip- N 1 +N 2 +N 3 = 360;000,and(cid:17) = 358/min[ZGGT03].
ment. The botnets studied in the example above all took Forthepurposeofstudyingwormreleasetime,weassume
placewithinthesame3-weekperiod. Sincemalwareisof- (cid:13) =0.
tenreleasedinrapidsuccession(e.g.,version.A,version.B, Figure8(a)showsthepropagationofthewormwhenitis
etc. ofthesameexploit),long-termchangesinvictimpop- releasedat00:00,06:00and12:00UTCtime,respectively.
ulations might not affect short-term forecasting. Our data It clearly shows the impact of the diurnal phenomenonon
didnotpermitalongitudinalstudyofthepredictivepower aworm’spropagationspeed. Refertothediurnaldynamics
ofolderbotnets. Futureworkwill identifyfactorsthat af- showninFigure3,thewormreleasedat12:00UTCpropa-
fect the validity of derived (cid:11)(t) values over an extended gatesfasterthantheotherwormsattheinitialstage,because
timeperiod. it catches the largest portion of the vulnerable population
onlineinthefollowingseveralhours.Notethattheseresults
Anotherlimitingfactorinourmodelcomesfromthein- areparticulartothebotnetunderconsideration,andnotall
troduction of additional propagation mechanisms. Many bots.Otherbotnetswillofcoursehavedifferentgrowthpat-
instances of malware, e.g., phatbot [LUR04], spread us- terns,basedontheirunique(cid:11)(t)values.
ing many different infection vectors, such as e-mail, ran- Figure8(b)showsthesamephenomenonfromadiffer-
domscanning andlocal exploits. Our model does not ad- ent perspective. Here we consider the maximum infected
dress malware that combines additional types of propaga- population six hours after a worm is released. (We se-
tion techniques in subsequent releases. Future work will lectsixhoursasanestimatedtimerequiredforantivirusor
exploretechniquestoidentifydominantpropagationmech- wormmonitoringeffortsto generatea signaturefora new
anisms used in malware, and hybrid models derived from worm[Mar04].) Thewormpropagatesmostwidelywithin
differentbotnetswithdistinct(cid:11)(t)values. six hours when it is released around 12:00 UTC, whichx 105 x 104
4
2.5
3.5
3
2
2.5
1.5
2
1.5 1
00:00
1
06:00
0.5
12:00
0.5
0 0
4 6 8 10 12 14 16 00:00 04:00 08:00 12:00 16:00 20:00 24:00
Time after release (hours) Release time (UTC hours)
(a)Wormpropagationunderdifferentrelease
time
sruoh
6
retfa
detcefnI
(b)Numberofinfected6hoursafterrelease
Figure8.Wormpropagationwhenreleasedatdifferenttime
is 9:00pm in Tokyo and South Korea, 8:00pm in China, worm.B, where the malware author improves the code or
7:00am in US Eastern. When the botnet starts to grow, it adds features in each new release. The diurnal modellets
captures some of the evening users in Asia, the mid-day uscriticallyconsiderthesigni(cid:2)canceofcodechangesthat
populationinEurope,andtheearlymorningusersinNorth affect S(t) (the susceptible population). For example, if
America. Six hours later, the Asian population has de- worm.AlocallyaffectsAsia, andworm.Bthenaddsanew
creased,buthasbeensubstantiallyreplacedbytheevening featurethatalsoaffectsEuropeanusers,thereclearlyisan
Europeanandmid-dayNorthAmericanusers. Thus,byre- increase in its overall S(t), and worm.B might become a
leasing at 12:00 UTC, the worm captures signi(cid:2)cant por- higher priority. But when worm.B comes out, relative to
tionsofallthreepopulationgroupswithinsixhours. whenworm.Astarted, plays animportantrole. Forexam-
If we compare the propagation speed when a worm is ple, if the Europeanusers are in a diurnallow phase, then
releasedat00:00UTCand06:00UTC,wecanseethatthe thenewfeaturesinworm.Bdonotposeanimmediatenear-
worm released at 00:00 UTC propagatesfaster in the (cid:2)rst term threat. In such a case, worm.A could still pose the
several hours (as shown in Figure 8(a)). However, it will greaterthreat,sinceithasalreadyspreadforseveralhours.
slow down its infection speed and infects slower than the Ontheotherhand,ifworm.Bisreleasedatatimewhenthe
otheroneafter8hours. European countries are in an upward diurnal phase, then
worm.Bcouldpotentiallyovertakeworm.Awith the addi-
This interesting observation has important implications
tion of the new victims. The diurnal model exposes this
fornetworkadministrators. Supposetwowormsbreakout,
non-obviousresult.
withthesimilarinfectionabilityanddiurnalproperties,and
arereleasedat00:00and06:00UTC,respectively. Weno- Our model lets researchers calculate optimal release
ticethespreadofthe00:00wormseemsmorerapidat(cid:2)rst timesforwormsandthereforerankthembasedonpredicted
than the other one. (We might observe this by witnessing short-term growth rates. We note worm writers cannot
lotsofsensoralerts). Justusing(cid:17)oranalertrate,wemight similarlyusethemodeltomaximizetheshort-termspread
concludethatsomehowthiswormisspreadingrapidly,and of their malware. Being able to calculate the appropriate
is more urgent. So we might want to prioritize response timeofdaytomaximizeaninfectionrequiresthebotmas-
overthe06:00worm. But, ifweknowbothwormshavea tertoknowthediurnalshapingfunctionforeachtimezone.
similar diurnal property, we know that the 06:00 worm is Wormwritersmightknow(cid:17),andotherimportantvariables
a higher priority, even though it is spreading at a slightly inEqn.(5).But(cid:11)(t)isnecessaryto(cid:2)ndanoptimalrelease
slowerrateinthe(cid:2)rstfewhours. time, and is hard to know. In effect, worm writers would
Beingabletodistinguishwormsbasedontheiroptimal havetocreatetheirowndistributedmonitoringprojectslike
releasetimesisusefultosecurityresearchers.Forexample, [Ull05,YBJ04,Par04]toaccuratelyderivediurnalshaping
itcanbetter determinethedefensepriorityfortwoviruses functionsfor selected regions. In this respect, administra-
or worms released in sequence. As noted, malware of- tors potentially have one advantage over botmasters. Ap-
ten goes through generational releases, e.g., worm.A and propriatedetectionandresponsetechnologiescanleveragethisknowledge. and others [YBP05,DQG+04] have convincingly demon-
stratedtherequireddetectioncapability.
4 RelatedWork Biologicalmodelsofepidemicshaveofcoursenotedthe
importanceofdormancyinpropagation[DH00]. Thiscor-
respondstothediurnalfactorsinourmodel,whichmodels
Botnets are a fairly new topic for researchers, but have
night-time as a form of limited natural quarantine or dor-
been around for almost a decade [CJ05]. Some work fo-
mancy in the malware. Similarly, biological models have
cuses on the symptoms caused by botnets instead of the
noted the importance of spatial dispersion, demography,
networks themselves. In [KKJB05], the authors designed
andotherothercategoricalfactorsin propagation[DG99].
sets of Turing tests (puzzles) that users must solve to ac-
To a limited extent, this correspondsto the role playedby
cessover-taxedresources. Wefurtherdistinguishourwork
zones(geographiclocation)inourtimezonemodel. Com-
from the extensive literature on DDoS traceback and de-
putermodels of malware, and ourmodel in particular, are
tection,[MVS01],inthatourapproachattemptstopredict
different from these approaches, since contact is not re-
botnetdynamicsbeforetheylaunchattacks.
strictedinacomputernetwork,andtransmissionmayoccur
A few researchers have noted techniques for detecting
betweenanypeersontheInternet.
bots using basic misuse detection systems [Han04], and
IRC traces [Bru03]. These investigations focus on track-
ingindividualbots(e.g.,toobtainabinary),whileoursfo-
cusesoncapturingthenetworkcloudofcoordinatedattack- 5 Conclusion
ers. Theonlyotherresearchdirectlyoncounteringbotnets
(asopposedtoindividualbots)is[FHW05].Theauthorsin
[FHW05] use honeypots to in(cid:2)ltrate the C&C network of Botnets will continue to grow and evolve, and the re-
botnets. searchcommunityneedstokeeppace. Timezonesplayan
Our modeling work is part of a long line of com- importantroleinbotnetgrowthdynamics,andfactorssuch
puter virus propagation studies. In [TAC98], the au- astime-of-releaseareimportanttoshort-termspreadrates.
thors presented models for the spread of viruses and The data we observed in our sinkhole revealed the im-
trojans. Epidemic modeling of viruses was discussed portanceoftimezonesandtime ofday,andmotivatedthe
in [KW91], and later in [MSVS03, WW03]. Mod- creationofadiurnalmodel. Themodelwasmoreaccurate
els have also been proposed for a few famous worms, than the basic SIR models currently used, and accurately
including CodeRed [ZGT02,Moo02a,Sta01] and Slam- predictedbotnetpopulationgrowth. Further,knowledgeof
mer [MPS+03]. In [ZTG04], the authors noted the need thediurnalshapingfunctionsletsoneidentifyreleasetimes
to create new models that capture new transmission capa- that maximize malware. This allows one to compare two
bilities(e.g.,email)usedbyworms. given botnets, and priority rank them based on short-term
Our study of diurnal behavior in malware has implica- propagation potential. Since deriving the diurnal shaping
tions for research into worm epidemics. In [MVS05], function((cid:11)(t)) for each time zone requires extensivedata
the authors speculated about the ability of worms to halt collection,botmastersareunlikelytoaccuratelypredictop-
spreading (and thereby become more stealthy) after sens- timalreleasetimes.
ing that the vulnerable population had saturated. The
pronounced diurnal behavior we noted suggests that self-
stoppingwormsmaybecomemisleadabouttheabsenceof 5.1 FutureWork
victimsonline,particularlyiftheirspreadtimeislessthan
onediurnalphase(i.e.,than24hours).
A signi(cid:2)cant early work on botnets is [CJ05], which Our future work will also extend the diurnal model to
notes the centralized control structures used for data col- address email spreading viruses. By studying the rate of
lectioninSection2. Weagreewith[CJ05]centralizedbot- propagationand new victim recruitment observedin sink-
net C&C is not always guaranteed, and more research is hole studies, we hope to derive a more accurate model of
email virus propagation. We will also identify new tech-
needed.Ourmodeltrackspropagation,andisorthogonalto
thisview. niquestosamplebotnetpopulations,sothatwecanfurther
studybotnetsthatdonotusecentralizeC&Csystems.
Bots areoftenspecialpurposeworms,andsoourwork
relies onmuchoftheexistingwormliterature. Theutility Ourworksofarhasidenti(cid:2)edtimezoneandtimeofre-
ofourmodelassumesadministratorscandetectandanalyze leaseastwokeyfactorsinshort-termviruspropagation.We
wormsinasomewhatautomatedfashiontoderivethescan- plantoinvestigateotherpossiblevariables,suchasthemix
ningrateandidentifythetargetvulnerability. Wehavenot ofoperatingsystems,hotpatchlevels,andthemixofappli-
discussed this in detail, because tools like honeyd[Pro03] cationsusedoninfectedsystems.Acknowledgments [FHW05] Felix C. Freiling, Thorsten Holz, and Georg
Wicherski. Botnet tracking: Exploring a root-
causemethodologytopreventdistributeddenial-
This work is supported in part by NSF grant
of-serviceattacks. TechnicalReportISSN-0935-
CCR-0133629 and Of(cid:2)ce of Naval Research grant
3232,RWTHAachen,April2005.
N000140410735. Thecontentsofthis workare solelythe
responsibility of the authors and do not necessarily repre- [Han04] ChristopherHanna. Usingsnorttodetectrogue
sent the of(cid:2)cial views of NSF and the U.S. Navy. The IRC bot programs. Technical report, October
authors would like to thank the anonymous reviewers for 2004.
helpfulcommentsandtheshepherdofthispaperProfessor
FabianMonroseatTheJohnsHopkinsUniversityforvery [Har02] John D. Hardin. The scanner tarpit howto.
valuablesuggestions. http://www.impsec.org/linux/
security/scanner-tarpit.html,
2002.
References
[Hol05] Thorsten Holz. Anti-honeypot
technology. www.ccc.de/
[Bru03] David Brumley. Tracking hackers on IRC.
congress/2004/fahrplan/files/
http://www.doomdead.com/texts/
208-anti-honeypot-technology-sl%
ircmirc/TrackingHackersonIRC.htm,
ides.pdf,2005.
2003.
[JQsx05] Jibz, Qwerton, snaker, and xineohP. Peid.
[Cip05] CipherTrust. Ciphertrust’s zombiemeter. http://peid.has.it/,2005.
http://www.ciphertrust.com/
[KKJB05] SrikanthKandula,DinaKatabi,MatthiasJacob,
resources/statistics/zombie.php,
and Arthur W. Berger. Botz-4-sale: Surviving
2005.
organizedddosattacksthatmimic(cid:3)ashcrowds.
In2ndSymposiumonNetworkedSystemsDesign
[CJ05] EvanCookeandFarnamJahanian. Thezombie
andImplementation(NSDI),May2005.
roundup: Understanding,detecting,anddisrupt-
ingbotnets.InStepstoReducingUnwantedTraf- [KRD04] JonghyunKim,SridharRadhakrishnan,andSu-
(cid:2)contheInternetWorkshop(SRUTI ’05),2005. darshan K. Dhall. Measurement and analy-
sis of worm propagation on Internet network
[Coo03] CooperativeAssociationforInternetDataAnal- topology. In IEEE International Conference
ysis (CAIDA). Netgeo - the Internet ge- on Computer Communications and Networks
ographic database. http://www.caida. (ICCN’04),2004.
org/tools/utilities/netgeo/,2003.
[Kre03] Christian Kreibich. Honeycomb automated
ids signature creation using honeypots, 2003.
[Dag05] David Dagon. The network is the in-
http://www.cl.cam.ac.uk/(cid:152)cpk25/
fection. http://www.caida.org/
honeycomb/.
projects/oarc/200507/slides/
oarc0507-Dagon.pdf,2005.
[KW91] J.O. Kephart and S.R. White. Directed-graph
epidemiologicalmodelsofcomputerviruses. In
[DG99] D.J.DaleyandJ.Gani. EpidemicModeling: An ProceedingsofIEEESymposiumonSecurityand
Introduction.CambridgeUniversityPress,1999. Privacy,pages343(cid:150)359,1991.
[DH00] O. Diekmann and J.A. P. Heesterbeek. Math- [Lis01] T. Liston. Welcome to my tarpit -
ematical Epidemioloogy of Infection Diseases. the tactical and strategic use of labrea.
JohnWileyandSons,2000. http://www.hackbusters.net/
LaBrea/LaBrea.txt,2001.
[DQG+04] DavidDagon,XinzhouQin,GuofeiGu,Wenke
[LUR04] LURHQ. Phatbot trojan analysis.
Lee, Julian Grizzard, John Levine, and Henry
http://www.lurhq.com/phatbot.html,2004.
Owen. Honeystat: Local worm detection us-
ing honeypots. In International Symposium on [Mar04] AndreasMarx.Outbreakresponsetimes:Putting
RecentAdvancesinIntrusionDetection(RAID), avtothetest.VirusBulletin,pages4(cid:150)6,February
2004. 2004.[Mat05] Mathworks Inc. Simulink. http://www. [Pro03] Niels Provos. A virtual honeypot frame-
mathworks.com/products/simulink, work, 2003. http://www.citi.
2005. umich.edu/techreports/reports/
citi-tr-03-1.pdf.
[Mic04] Microsoft, Inc. Microsoft security bul-
letin ms04-011 security update for mi- [Pro05] Honeynet Project. Know your enemy: Hon-
crosoft windows (835732). http: eynets. http://project.honeynet.
//www.microsoft.com/technet/ org/papers/honeynet/,2005.
security/Bulletin/MS04-011.mspx,
[RIP05] RIPENCC.DISITools.http://www.ripe.
2004.
net/projects/disi/code.html,2005.
[Mic05] George Michaelson. Rir delegation reports and
[SM04] ColleenShannonandDavidMoore. Thespread
address-by-economymeasures. http://www.
ofthewittyworm.Security&PrivacyMagazine,
caida.org/projects/oarc/200507/
2(4):46(cid:150)50,2004.
slides/oarc0507-Michaelson.pdf,
2005. [Spi03] Lance Spitzner. Honeypots: Tracking Hackers.
AddisonWesley,2003.
[Moo02a] D. Moore. Code-red: A case study on the
spreadandvictimsofanInternetworm. http: [SS03] S.E. Schechter and M.D. Smith. Access for
//www.icir.org/vern/imw-2002/ sale. In2003ACMWorkshoponRapidMalcode
imw2002-papers/209.ps.gz,2002. (WORM’03).ACMSIGSAC,October2003.
[Moo02b] D. Moore. Network telescopes: Ob- [Sta01] S. Staniford. Code red analysis
serving small or distant security events. pages: July infestation analysis, 2001.
http://www.caida.org/outreach/ http://www.silicondefense.com/cr/july.html.
presentations/2002/usenix_sec/,
[TAC98] Harold Thimbleby, Stuart Anderson, and Paul
2002.
Cairns. A framework for modelling trojans
[MPS+03] D. Moore, V. Paxson, S. Savage, C. Shannon, and computer viruses. The Computer Journal,
S.Staniford,andN.Weaver. InsidetheSlammer 41(7):445(cid:150)458,1998.
worm. IEEEMagazineonSecurityandPrivacy,
[The05a] The Honeynet Project and Research Alliance.
1(4),July2003.
Know your enemy: Tracking botnets. http:
//www.honeynet.org/papers/bots/,
[MSVS03] D. Moore, C. Shannon, G. M. Voelker, and
2005.
S.Savage.Internetquarantine:Requirementsfor
containing self-propagating code. In Proceed-
[The05b] The Metasploit Project. Metasploit. http://
ingsoftheIEEEINFOCOM2003,March2003.
www.metasploit.com/,2005.
[MVS01] DavidMoore,GeoffreyVoelker,andStefanSav-
[Tre05] Trend Micro. Regional breakdown.
age. Inferring Internet denial-of-service activ-
http://wtc.trendmicro.com/wtc/
ity. InProceedingsofthe2001USENIXSecurity
report.asp,2005.
Symposium,2001.
[Ull05] JohannesUllrich. Distributedintrusiondetection
[MVS05] JustinMa,GeoffreyM.Voelker,andStefanSav- system (dshield). http://www.dshield.
age. Self-stoppingworms. In WORM’05: Pro- org/,2005.
ceedings of the 2005 ACM workshop on Rapid
Malcode,2005. [WPSC03] N. Weaver, V. Paxson, S. Staniford, and
R. Cunningham. A taxonomy of computer
[Par04] Janak J Parekh. Columbia ids wormina- worms. In 2003 ACM Workshop on Rapid
tor project. http://worminator.cs. Malcode (WORM’03). ACM SIGSAC, October
columbia.edu/,2004. 2003.
[PBS+04] PhillipPorras,LindaBriesemeister,KeithSkin- [WSP04] NicholasWeaver,StuartStaniford,andVernPax-
ner, Karl Levitt, Jeff Rowe, and Allen Ting. son. Veryfast containmentof scanning worms.
A hybrid quarantine defense. In Workshop on InProceedingsofthe13thUsenixSecurityCon-
RapidMalcode(WORM),2004. ference,2004.[WW03] YangWangandChenxiWang. Modelingtheef-
fectsoftimingparametersonviruspropagation.
InProceedingsofACMCCSWorkshoponRapid
Malcode(WORM’03),October2003.
[YBJ04] Vinod Yegneswaran, Paul Barford, and Somesh
Jha. Global intrusion detection in the domino
overlaysystem. InProceedingsofNDSS,2004.
[YBP05] Vinod Yegneswaran, Paul Barford, and Dave
Plonka.OnthedesignandutilityofInternetsinks
fornetworkabusemonitoring.InInProceedings
of Symposium on Recent Advances in Intrusion
Detection(RAID’04),2005.
[ZGGT03] C. C. Zou, L. Gao, W. Gong, andD. Towsley.
Monitoring and early warning for Internet
worms. In Proceedings of 10th ACM Confer-
enceonComputerandCommunicationsSecurity
(CCS’03),October2003.
[ZGT02] C. C. Zou, W. Gong, and D. Towsley. Code
redwormpropagationmodelingandanalysis. In
Proceedings of 9th ACM Conference on Com-
puter and Communications Security (CCS’02),
October2002.
[ZGT03] C. C. Zou, W. Gong, and D. Towsley. Worm
propagation modeling and analysis under dy-
namic quarantine defense. In Proceedings
of ACM CCS Workshop on Rapid Malcode
(WORM’03),October2003.
[ZTG04] Cliff C. Zou, Don Towsley, and Weibo Gong.
Emailwormmodelinganddefense.In13thInter-
national Conference on Computer Communica-
tionsandNetworks(ICCCN’04),October2004.
[ZTG05] C.C. Zou, D. Towsley, and W. Gong. On the
performance of Internet worm scanning strate-
gies. Elsevier Journal of Performance Evalua-
tion,2005. (toappear).
[ZTGC05] Cliff C. Zou, Don Towsley, Weibo Gong, and
SonglinCai. Routingworm: Afast,selectiveat-
tackwormbasedonipaddressinformation.June
2005.