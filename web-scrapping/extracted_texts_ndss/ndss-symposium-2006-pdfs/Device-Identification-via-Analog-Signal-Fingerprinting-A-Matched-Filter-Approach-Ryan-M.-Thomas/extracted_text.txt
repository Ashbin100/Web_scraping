Device Identification via Analog Signal Fingerprinting: A Matched Filter
Approach
RyanM.Gerdes,ThomasE.Daniels,ManiMina,SteveF.Russell
DepartmentofElectricalandComputerEngineering
IowaStateUniversity
Ames,IA50011
{rgerdes,daniels,mmina,sfr}@iastate.edu
Abstract sive network monitoring, and spoofed through the use of
aprogrammablenetworkcard. Incontrast,theanalogchar-
As part of the Detecting Intrusions at Layer ONe acteristics of a device are nearly impossible to obtain (a
(DILON) project, we show that Ethernet devices can be measurementcannotbedonewithoutphysicalaccesstothe
uniquelyidentifiedandtracked—usingasfewas25Ether- medium) and duplicate, which makes them well-suited for
net frames—by analyzing variations in their analog signal NACpurposes.
causedbyhardwareandmanufacturinginconsistencies.An Inthedigitalage,thephysicallayerisoftenregardedas
optimaldetector,thematchedfilter,isutilizedtocreatesig- a security impediment, or, at best, overlooked as a source
nal profiles, which aid in identifying the device the signal of solutions for today’s security needs, because of its non-
originatedfrom. Severalnon-traditionalapplicationsofthe digitalnature. Theinstinctivereactiontothephysicallayer
filter are presented in order to improve its ability to dis- has been to focus on securing the layers above it, through
criminatebetweensignalsfromseeminglyidenticaldevices the use of encryption, so that some level of authentication
ofthesamemanufacturinglot. Theexperimentalresultsof isnecessaryforaccesstoit. Thesemethodsoftenprovein-
applying these filters to three different models of Ethernet trusivetotheend-user; forcingthemtorememberforever-
cards,totaling16devices,arepresentedanddiscussed. changing and arcane keys, configure troublesome access
Importantapplicationsofthistechnologyincludeintru- clients, or keep track of yet another access token. Clearly,
sion detection (discovering node impersonation and net- anon-intrusivemethod,whichcomplimentsexistingaccess
work tampering), authentication (preventing unauthorized controlmethods,isneededtocontrolaccesstothenetwork
accesstothephysicalnetwork),forensicdatacollection(ty- infrastructure. WebelievethatDILONtechnologycanful-
ing a physical device to a specific network incident), and fillthisneed.
assurance monitoring (determining whether a device will
orisintheprocessoffailing). 1.2.TheDILONconcept
The DILON project investigates the use of analog and
digital characteristics of digital devices for such secu-
1.Introduction
rity purposes as intrusion detection, authentication, foren-
sic data collection, and assurance monitoring. DILON is
1.1.Networkaccesscontrol founded upon the belief that hardware and manufactur-
ing inconsistencies cause minute and unique variations in
Currentnetworkaccesscontrol(NAC)mechanismsrely thesignalingbehaviorofeverydigitaldevice;furthermore,
exclusively on the use of digital tokens or identifiers— thesevariationsaremanifestbyuseoftheappropriatesig-
usernames and passwords, MAC addresses, SSL certifi- nal processing technique(s). Central to the security of this
cates, WEP/WPA keys, etc—to prevent unauthorized ac- conceptisthebeliefthattheseslightvariationsaredifficult,
cess.Unfortunately,evenstrongtokensandidentifiers,such ifnotimpossible,tocontrolandduplicate. Thisassumption
asSSLcertificates,bytheirpurelydigitalnature,canbedis- isfoundeduponknowledgeofthevariabletolerancesofde-
cretelycopiedifimproperlysecured,andputtousebyma- vice components, which are introduced in the design and
licious users. Even worse, popular weak identifiers, such fabricationprocesses,usedintheconstructionofdigitalde-
as MAC addresses, may be easily obtained through pas- vices. These tolerances allow for unpredictable variationsintheoverallelectricaloperationofthedevice. Simplyput, To date, a robust, reliable, and adoptable system for
because of these variations, no two devices may be made transmitter characterization has yet to be devised to effec-
exactlythesame,andhencetheiranalogsignalcharacteris- tively handle multiple transmitters in interconnected sys-
tics cannot be made the same, without substantial reverse- tems. While frequency based classification models have
engineeringbeyondthereachofallbutthemostdetermined beensuggested[11,12,15,14,20],andothergeneralrules
attackers. for identification have been suggested [6, 24], each is lim-
Figure 1 presents a system-level diagram for an imple- itedtodiscriminatingbetweendifferentbrandsandsystems.
mentation of DILON technology. On the top of the dia- As traditional methods cannot adequately identify similar
gramaresubjectdevicesthatcommunicateoveraphysical devices,theywillnotbeabletoguaranteetheprivacy,secu-
medium—wired or unwired—to connect with a controlled rity,andintegrityofsensitiveinformationnecessarytomed-
device,aswitchoraccesspointforinstance. Atthecontrol ical,legal,governmental,andsecuritymanagementfirms.
deviceananalogtapisusedinconjunctionwithananalog-
Itshouldbenotedthatasimilarproblemwasaddressed
to-digital converter (ADC) to sample the electrical signals
bycellularphonecompaniestocombatcloning[23,19,18].
arrivingacrossthemedium,atamuchhigherrateandwith
However,duetoproprietynatureoftheirwork,thereisvery
greater resolution than is necessary to actually decode the
little published on their methodology. From what can be
signal. Storage will also be required for past and present
determinedfromthelimitedliteratureavailable,thesemeth-
fingerprints. A policy engine will make use of a compari-
odsdonothaveahighsuccessrateindiscriminatingsignals
son module to determine which devices have access to the
fromsimilarsources.
network,aswellasissuereportsconcerningthestateofthe
Recently,workinthedevelopmentofphysicalauthenti-
network.
cation schemes has led to the creation of a physical token
The present approach for DILON focuses on making
thatimplementsaphysicalone-wayfunction,whichisver-
use of a matched filter to create profiles of signals that are
ifiedusingastatisticalhashingalgorithm[22]. Ourworkis
useful in identifying the device the signal originated from.
differentfrom[22]inthatwerelyontheinherentphysical
We have found that a traditional matched filter is sensitive
variation introduced as part of the manufacturing process,
enoughtoeasilydiscriminatebetweensignalsproducedby
anddonotrequireextravariationtobeexplicitlyaddedto
differentmodelEthernetcards.Usingadvancedtechniques,
thedevicesforsuchpurposes.
a matched filter, applied in non-traditional ways, can be
made to discriminate between Ethernet cards of the same A more closely related physical authentication system
model—even when each component of these cards pos- was introduced in [8, 7]. Gassend et. al investigated the
sessesthesameserialnumbers,andappeartocomefromthe identification of integrated circuits based upon the indirect
same manufacturing lot. We have also developed adaptive measurementoftheirtimingcharacteristics.Incontrast,our
methodsthataccuratelytrackfluctuationsinsignalsdueto method focuses on examining the spectral characteristics
device aging, voltage variations, and temperature changes. acrosstheoperatingbandwidthofthedevice. Additionally,
Thesemethodsproviderealisticandconsistentfalse-accept ourworkshowsthatthesignalingcharacteristicsofnetwork
andfalse-rejectrates(FARandFRR). devices appear to be more amenable to identification than
integratedcircuits,aswehavebeenabletoidentifyagreater
numberofdevices.
1.3.Previouswork
Finally, recent work has investigated the possibility of
remotely fingerprinting devices over the Internet by mea-
Signal detection and identification was one of the ma-
suringtheirclockskew[16]. Thismethodshowspromise;
jorchallengesintheresearchanddevelopmentofradarand
however, accurate identification seems to require 36 hours
wireless communication systems for a greater part of the
ofobservation,wherepacketsarereceivedfromtheremote
20th century. In particular, identification of radar, radios,
host at a rate of 46 packets per hour. The efficacy of this
andvariouswirelesscommunicationsbecameaveryimpor-
methodisdifficulttomeasure,astheauthorsdonotreport
tantandpopulartopicaroundthetimeofWorldWarII[13].
theirresultsintermsoffalse-rejectandfalse-acceptrates.
Mostmethodsdevelopedforradaridentificationatthistime
were based upon transient analysis. As higher frequency
and faster responding circuits were introduced, more in-
depth transient analysis became necessary for transmitter 2.Background
identification.Tothisday,manyresearchersaremakinguse
oftransientmethodsfortheidentificationofmoderntrans-
mitters [3, 25, 1, 9, 10, 4, 17, 5]. However, these methods The concepts of systems, signals, filtering, and related
have only proven successful in situations when the trans- terminologyandtoolsarediscussed. Thematchedfilterop-
mittersunderconsiderationwereconsiderablydifferent. erationisdefined.Figure1.FunctionalviewofaNACsystemincorporatingDILONtechnology.
2.1.Signalsandsystems componentsofaninputsignalaremodified,oreliminated.
AsthefilterdiscussedinthispaperisLTI,wemaydescribe
Asystemisaprocessbywhichaninputsignalistrans- its response via a transfer function. In turn, this transfer
formedtoproduceanoutputsignal; furthermore, asystem functionmaybeusedinconjunctionwitheither(1or2)to
issaidtobelineartime-invariant(LTI)ifthesystemisboth determinetheresponseofthefiltertoaninputsignal.
additiveandmultiplicative,andatimeshiftoftheinputre-
sults in a corresponding time shift in the output. It can be 2.3.Thematchedfilter
shownthattheresponse,oroutput, ofanLTIsystemtoall
inputscanbecompletelydescribedbydeterminingthesys- Thematchedfilterissaidtobeanoptimaldetector,asit
temsunitimpulseresponse[21]. Forourpurposes,theunit can be shown that the filter maximizes the signal-to-noise
impulse response, or transfer function, of a system in the ratio of a known input signal in additive white Gaussian
timedomainwillbedenotedbyh(t).Theresponseofasys- noise (AWGN). [2]. The transfer function of the matched
tem, y(t), toaparticularinput, x(t), canbefoundbycon- filter,inthefrequencydomain,atsamplingtimet maybe
0
volving the transfer function of the system with the input statedas:
signal. The convolution operation, denoted by ?, between
H(ω)=κA∗(ω)
exp−jωt0 (3)
h(t)andx(t)isdefinedas: P(ω)
whereA∗(ω)isthecomplexconjugateoftheFourierTrans-
+∞
Z
form of a known time-domain signal α(t), P(ω) is the
y(t)=h(t)?x(t)= h(t−τ)x(τ)dτ (1)
power spectral density (PSD) of the noise associated with
−∞ an input signal, and κ is an arbitrary constant. By select-
inganappropriatevalueofκfortheoperatingenvironment,
BytakingtheFourierTransformoftheinputsignal,de-
notedbyF{x(t)} = X(ω), andthetransferfunction, de- andassumingAWGNforthePSD,P(ω)maybeeliminated
notedbyF{h(t)} = H(ω),theconvolutionoperationde- from (3). For a given input signal, β(t), the output of the
filter,M ,atsamplingtimet ,intheGaussiannoisecase
finedin(1)maybereplacedbymultiplication: t0 0
isthen:
Y(ω)=H(ω)X(ω) (2)
M =H(ω)B(ω)=A∗(ω)exp−jωt0B(ω) (4)
t0
Itshouldbenotedthat(2)givesthefrequencyresponse
where B(ω) is the Fourier Transform of the time-domain
of a system, whereas (1) gives its time-domain response.
inputsignalβ(t).
Ofcourse, theseresponsesarerelatedthroughtheinverse-
Taking the inverse Fourier Transform of (3) gives the
FourierandFourierTransforms,respectively.
transferfunctionofthefilter, h(t), inthetime-domain, for
theAWGNcase,as:
2.2.Filters
h(t)=α(t −t) (5)
0
A filter may be regarded as a special kind of system,
where the relative amplitudes and phases of the frequency It can be shown that the output of the filter is maximizedwhen: commontoalldeviceswasidentified. Atthebeginningof
each frame a 64-bit sequence of alternating ones and ze-
Zt0
ros,encodedusingdifferentialManchesterencodingwitha
µ(t )=h(t )?β(t )= α(τ)β(τ)dτ (6)
0 0 0 fundamentalfrequencyof5MHz,endingwiththesequence
t0−T 10101011aresenttosynchronizethereceiverofthedesti-
nationdevicetothetransmitterofthesourcedevice(Figure
where T is the period of the known time-domain signal
2).
α(t).
This synchronization signal consists of a transient, or
As can be seen from (6), the matched filter operation
turn-on, portion (denoted by ’- . - . -’ in Figure 2), which
may be interpreted as the inner-product of two signals, or
istheresultofthetransmittingcircuitryofthesendingde-
anintegrated-correlation.
vicepoweringon,aswellasasteadystateportion(denoted
by ’- - - - -’ in Figure 2) that serves as the actual synchro-
3.Signalidentification nizationsignal.
Asmentionedearlier,mostworkinsignalidentification
Wedescribehowthematchedfiltermaybeusedtocreate has traditionally focused on the transient portion of a sig-
a signal profile useful for identifying a signal’s device of nal. However,asthetransientsignalin10MbEthernetisso
origin. small, in terms of the number of wavelengths of the over-
allsignal,wedonotbelievethatthereisphysicallyenough
3.1.Signalselectionrationale information contained in it for the identification of similar
devices.Indeed,ithasbeenshownintheliteraturethattran-
sient analysis is sufficient only for distinguishing between
This work focuses on the profiling of 10Mb wired Eth-
devices of different models, but not devices of the same
ernetsignals. Wechosetostudy10MbEthernetbecauseof
model. Assuch,ourmethodologyreliesprimarilyuponthe
therelativesimplicityoftheelectronicdevicesandsignal-
steady-stateportionofthesignalforprofilingpurposes.
ing involved, and its operation at low speeds. As the elec-
ThefinalportionoftheEthernetframeshowninFigure
tronicsandsignalingarelesscomplicatedthanhigher-speed
2(denotedby’.....’) isthebeginningoftheMACaddress
systems,wewereabletounderstandthefunctioningofthe
ofthereceivingdevice. Preliminaryworkwiththisportion
devices,andidentifycommonbehaviorbetweendevicesof
of the signal has shown that it may be possible to use the
differentmakes,whichaidedusinhypothesiscreationand
MACsourceaddressforsignalprofiling.
testingwhileattemptingtoidentifydifferencesandsimilar-
ities in signals. In addition, capturing accurate samples of
10Mb Ethernet frames may be accomplished using lower 3.3.Matchedfiltercreation
resolution,slower,andthereforelessexpensiveADCs.
WiredEthernetwaschosenduetothelownoiseenviron- Havingidentifiedacommonandrepetitiveportionofthe
mentinherentinwiredsystems. Environmentalnoiseadds Ethernetsignalsuitableforidentificationpurposes,anexact
astochasticandnon-stationarycomponenttothesignalthat startingpositionandperiodoftheportionofthesignaltobe
must be minimized as much as possible to obtain consis- matchedtomustbechosen. Wecallthispartofthesignal
tentmeasurements. Ontheotherhand,noisecharacteristics the reference signal, and choose it to represent the known
of an individual device, or component from a device, may time-domain signal α(t). As per (5), the reference signal
exhibitdistinguishingcharacteristics. must be reversed in the time-domain, and shifted by t to
0
Finally,webelievedthatifweshouldfailindiscriminat- be used as the filter. In this respect t may be regarded as
0
ing10MbEthernetsignals, wewouldhavelittlechanceof thefinaltimepointofthereferencesignal.
succeeding in the high-speed wired and wireless domains. Initially, the period and position of the reference signal
However,weshouldalsonotethatinsomerespectsprofil- werechosenasanarbitrarynumberofpointsspanningthe
ing 10Mb Ethernet signals may be viewed as a more diffi- length of the synchronization signal. For 10Mb Ethernet,
cult problem than that of higher-speed systems: there are wehavefoundthisacceptabletodistinguishbetweenallbut
fewer components per device, and hence less opportunity the most similar of signals; however, we have also devel-
forsignalvariabilityduetoperturbationbydevicecompo- oped algorithms to determine the optimal reference signal
nents. forasetofknowndevices. Thistypeofreferenceselection
wouldbeusefulduringatrainingperiod,wheresampledata
3.2.Identifyingacommonsignal couldbetakenforanewdeviceintroducedonthenetwork,
andcomparedtopreviouslycollecteddataofotherdevices.
In order to create a profile of the signal characteristics Forageneralstudyofthematchedfilter,however,wehave
for an Ethernet device, a portion of the frame preamble selectedareferencesignalthatincludesthepreambletran-Figure2.ThePreambleofanEthernetframeusedforsignalprofiling.
sientandsteady-stateportionofthesynchronizationsignal, pacitance, and inductance—even the act of measuring the
which is the same, to within five sample points, for each signalonadifferentportionoftheEthernetcabling,orusing
device. Whileoptimallydeterminingareferencesignalfor adifferentcablealtogether,mayaffectthemeasuredsignal.
a device, in relation to other known devices, may increase Thisaffect,however,givesrisetotheinterestingpossibility
performance,ourexperimentshaveshownthatitisnotgen- ofdetectingpassivetapsontheline,whichoftenchangethe
erallynecessarytodoso. effectivematerialparametersofthemedium.
Totakeintoaccounttheinherentvariabilityofeveryde-
3.4.Signalprofile vice’soutput,aswellasexternalfactorssuchastemperature
andsystemloadvariations,asignalprofilemustbecreated
byusingacollectionofsignalstakenoveraperiodoftime.
The first step in creating a signal profile is to apply the
Thefiltercreatedbytheoriginalsignalisappliedtothiscol-
filter to the signal used to create it; i.e., convolve the filter
lectionofsignalsandtheresponsetoeachrecorded(Figure
with the portion of the signal used for the selection of the
3).Wehavefoundthatonly25sequentiallysampledsignals
referencesignal. Thefilterreturnsasinglevaluefromthis
arenecessarytoadequatelydeterminetheuniquesignaling
operationthatservesasabaseline.Thisvaluerepresentsthe
behaviorofadevice.
filter response when a perfect match is made between the
filterandtheoriginalsignal. Ifanothersignalisexactlythe
sameastheoriginal,thenweexpectthatapplyingthefilter
tothissignalwillproducethesamevalue. Ingeneralthen,
applyingthefiltertoasignalproducesameasurementofthe
closenessofthesignaltotheoriginal,andconsequentlythe
alikenessofthedevicesthesignalswereacquiredfrom. If
asignalfromadifferentdeviceapproachesthefilteroutput
valuefortheoriginalsignaltoocloselythenweareunable
todistinguishitfromthedevicethatproducedtheoriginal.
Due to the noise inherent in any system, we cannot as-
sume that even a properly functioning device will output Figure3.Filteroutputfor25framesofanEth-
exactly the same synchronization signal for each frame. ernetdevice.
Noise from surrounding devices, created by a hard disc or
CD-ROMbeingaccessedorvariationsinsystemload,and
thermal noise assuredly cause slight variations in the sig- Byexaminingthefilterresponseforadeviceoveranum-
nal from frame to frame. In fact, with the aid of temper- ber of hours, we have determined that a device’s synchro-
ature recording equipment we have been able to correlate nizationsignalisundercontinuouschange. Inmanycases,
aberrations in the filter output to variations in the ambient wehavediscoveredthatslightvariationsintheamplitudeof
temperature of the lab. Furthermore, due to the non-ideal thesignalsarethecauseofthisvariation. Asubtlechange
propertiesoftheEthernetcabling—parasiticresistance,ca- in signal shape, over a period of hours, also changes thefilter response. By using the average of several synchro- ence signal for each portion of the preamble identified in
nizationsignalsforthereferencesignalwehavebeenable Section 3.2. Matching filters to the transient, steady-state,
todecreasethevariationofthefilterresponse;however,this andsourceMACaddresssectionsoftheframegivesafull
oftenleadstoacorrespondingincreaseintheFAR. characterization of the broad traits of a signal. An ensem-
Inordertoaccountforthesechangesinsignalcharacter- ble of filters is utilized, instead of a single large filter, so
istics over time, we have introduced a tolerance, δ, for the thatstrongsimilaritiesincertainregionsofthesignalcan-
maximumamountofdeviationinfilterresponseacceptable notovershadowsmallerdifferencesinothers.
beforeasignalislabeledastoodifferentfromtheoriginal. Selecting multiple reference signals for each section of
Inordertotakeintoaccountpastbehavior,werequirethat the signal may also highlight slight differences; e.g., each
the next n-frames resemble the previous n-frames, ±δ. In transition,orpairoftransitions,ofthesynchronizationsig-
this way a device may be adaptively tracked as its signal nalcouldbematchedtodifferentfilters. Insuchawaythe
changesovertime. Mathematically,thisisstatedbydefin- granularityoffilteringcouldbearbitrarilyincreasedtotake
ing two thresholds for the maximum amount of positive, intoaccountthesmallestofdifferences.
th , and negative, th , deviation in filter output allowed
+ −
overthepreviousn-frames:
3.5.2. Bandpass filtering. By analyzing the spectrum of
signalsfromamultitudeofsimilardevices,wehavefound
th (µ ···µ )=max(µ ···µ )(1+δ)
+ i i+n−1 i−1 i−n (7) thatdistinguishabledifferencesexistinthefrequenciesbe-
th (µ ···µ )=min(µ ···µ )(1−δ)
− i i+n−1 i−1 i−n yondthefundamentalfrequencyofthesynchronizationsig-
where µ represents the filter output of the ith frame. We nal;however,asthefundamentalfrequencydominatesother
i
frequencycomponents,intermsofrelativepower,thesedif-
have found that setting n equal to the number of samples
ferences are often obscured. Applying a bandpass filter to
used to learn the behavior of a device proves adequate for
thereferencesignalandsignalsamplesminimizestheinflu-
trackingthesignalovertime.
enceofthefundamentalfrequencyonthefilterresponseby
During our experiments the filter output for the first 25
removingthatportionofthesignalaltogether.
frames of a device were used as training data, whereby an
appropriatevalueforδ wouldbedeterminedbystipulating Throughexperimentation,byuseofseveralbandpassfil-
thatzerofalse-rejectswouldoccurforthenext25filterout- ters with increments of 1MHz in bandwidth, we have de-
puts. Aminimumvalueof.001forδ wasimposed,andin- termined that, for some devices, the 13-17MHz frequency
cremented by .001 until the aforementioned condition was rangeexhibitsthegreatestvariation. Asthepowerlevelsof
met.Afterobservingadevice’sbehaviorovertimethevalue frequencycomponentsbeyond17MHzapproachthatofthe
ofδ canbeadjustedtobetterfittheuniquebehaviorofthe noiselevel,wehavefoundfrequencieshigherthan17MHz
card. We have also found that large, spurious, deviations ill-suitedfordiscriminatorypurposes.
do occur for all Ethernet devices, so a perfect acceptance
rate cannot be obtained—unless one is willing to allow a 3.5.3. Normalization. Normalizingboththereferencesig-
certainnumberofsignificantdeviationseveryn-frames,or nal and signal samples, according to the Euclidean norm,
setδunreasonablyhigh. Aswithanysystemwithstatistical desensitizes the matched filter to similarities in shape, and
variation, a balance must be found for δ that results in an increases its sensitivity to variations in amplitude. This
acceptablenumberoffalse-acceptsandfalse-rejects. proves advantageous for discriminating between signals
wherethedifferencesexistprimarilyintheirrelativeampli-
3.5.Variationsonthematchedfiltermethod tudes. However,iftheamplitudesoftwosignalsareclosely
matched, while their shapes are not, this form of normal-
Tofurtherimprovetheefficacyofourmethod, wehave izationwilldecreaseourabilitytodistinguishbetweenthe
devised several variations on the procedure outlined above two.
toimproveourabilitytodiscriminatebetweenhighlysim-
ilar devices. Each of these techniques works to amplify 3.5.4. Trimming. The concept of time-domain trimming
slight differences in signal characteristics that are too sub- was developed in order to minimize the affect of the sig-
tle to be distinguished by the original method. The impe- nalamplitudeonfilterresponse. Byeliminatingamplitude
tus of this work was based upon the observation that as dominance, variations in the shape of the signal are made
the matched filter operation is a sum of products, large- apparent. Analogous to the frequency domain trimming
scalesimilaritiesbetweensignalscanoftenovershadowthe used in bandpass filtering, time-domain trimming removes
small-scaledifferencesusefulforsignalprofiling. the portions of a signal that tend to overshadow all others
by zeroing the signal amplitude for values greater than a
3.5.1. An ensemble of filters. For a given device, mul- predeterminedupperbound. Byaddingalowerbound,and
tiple matched filters may be created by selecting a refer- varyingtheheightofeachboundaryaccordingly,awindowiscreatedthatallowsforanyportionofthesignaltobescru- valid record of a device’s dataset. Following this, the ref-
tinizedbyitsshapealone. erence signal is convolved with each record of its dataset
For example, by only setting an upper bound, the zero- usinganFFT-basedconvolutionalgorithm. Convolvingthe
crossings—wherethesignalcrossesthehorizontalaxis—of referencesignalwitheachrecordofitsdatasetperformsthe
asignalmaybeexaminedinordertoensurethatthewidth matchedfilteroperationforallpossibletime-shifts; conse-
of a signal matches that of the filter. We have found that quently,anoutputiscreatedthatisequalinlengthtothatof
time-domaintrimmingismosteffectivewhenonlythesig- thelengthoftherecord. Thisoperationisnecessarytode-
nalsamplesaretrimmed. terminethetimeofoptimalalignment,t ,betweenthefilter
0
andtherecord,whichresultsinthemaximumfilteroutput,
4.Experimentalresults asper(6).
Thus, the filter output at the point of maximum align-
ment corresponds to the maximum of the convolution op-
The equipment and methods used to acquire the Ether-
eration. Letting(cid:15) (t)representthereferencesignalforthe
net signals for analysis are given. Methods for calculating i
ith device,andηj(t)thejth recordofitsdataset,thefilter
theFARandFRRarediscussed. Finally, theresultsofthe i
output,µj(t ),isthen:
matchedfilterapproachtosignalprofilingaregiven. i 0
µj(t )=max((cid:15) (t)?ηj(t))forj =1···n (8)
4.1.Experimentalsetup i 0 i i
where n is the number of records in the device’s dataset
Our current testbed consists of two PCs running GNU (Figure 4). This procedure is followed for each device in
Linux; one to act as the Test PC (TPC), which houses the order to determine the filter response of each record in its
Ethernet card we wish to fingerprint, while the other, the dataset.
Data Acquisition PC (DAQPC), makes use of a Tektronix Havingdeterminedthefilteroutputforeachrecordofits
3052digitalsamplingoscilloscope,interfacedviaanIEEE own dataset, we then apply the filter to each record of the
488 card and Labview-6, connected to a passively tapped other device’s datasets in order to determine the alikeness
internalEthernetcard,tocaptureEthernetframessenttoit of their respective signals (Figure 5). Letting γj (t ) rep-
i,k 0
overacrossovercablebytheTPC. resentthefilteroutputusingtheithdevice’sfilterappliedto
InordertogeneratetrafficfortheDAQPCtocapture,the thekthdevice’sdataset:
TPCisinstructedtopingtheDAQPC.Duringatypicaldata
acquisition period the TPC will ping the DAQPC 10,000 γj (t )=max((cid:15) (t)?ηj(t))forj =1···n (9)
i,k 0 i k
times. ToensurethatonlytrafficfromtheTPCiscaptured,
onlythereceivingpinsoftheDAQPC’sEthernetcardhave
beenconnectedtotheoscilloscope. Inthiswayweareable As can be seen from Figure 5, the respective filter out-
to allow the DAQPC to respond to the TPC’s pings, and putsofDeviceiandDevicekdonotoverlap. Followingthe
ensure that the data acquisition process hasn’t caused any explanation set forth in Section 3.4., we are therefore able
packetloss. todiscriminatebetweenDeviceiandDevicek.
UpondetectionofanEthernetframetheoscilloscopebe-
gins to sample the signal at a rate of 1Gigasamples/s. The 4.3.Acceptancetesting
signal is sampled 10,000 times, for a total of 10 micro-
seconds,with8-bitsofresolution.Thedatacollectedduring FollowingtheproceduresetforthinSection3.4.,avalue
samplingissenttotheDAQPCviatheIEEE448interface, for δ can be determined that is expected to provide an ac-
where a custom Labview routine monitoring the interface ceptableFRR(lessthan.009inourexperiments).Usingthe
acceptsthedataandstoresthevaluesinavectorwecalla responseofthefilterfortheith devicetothe26ththrough
record,whichissubsequentlywrittentothedisc. Eachcap- 50threcordsofitsowndataset,µ i26···50(t 0),astrainingdata
turedframeisstoredinitsownrecord;alloftherecordscol- in conjunction with (7), thresholds can be established for
lectedforadeviceduringasessionencompassitsdataset. the next 25 filter outputs. If the filter response for one of
the next 25 records lies outside of the bounds set by these
4.2.Filterapplication thresholds then its corresponding record is marked as re-
jected,andisnotusedindeterminingthethresholdsforthe
Having acquired several thousand signal samples from next25outputs. Thisprocedureisfollowedfortheremain-
each device over a number of hours, we then create a fil- derofthefilterresponsesinthedevice’sdataset. TheFRR
ter for each of the devices using the procedure outlined in isthencalculatedusing:
Section3.3. Thereferencesignalforeachdevicehasape- n
riod of 4,176 sample points, and is selected from the first FRR= r (10)
n−25Figure4.Filteroutputfor10,000recordsofanEthernetdevice.
Figure5.Filteroutputfor10,000recordsoftwodifferentEthernetdevicesusingthesamefilter.
wheren isthenumberofrejectedrecordsandnisthenum- ingtheith device’sfilter,γ1···n(t ),wherenisthenumber
r i,k 0
beroftotalrecords. of records in a dataset, is equally likely. Based upon this
assumption,randomnumbersbetweenoneandnaregener-
4.4.Intrusiontesting atedtoserveasanindexusedindecidingthestartingvalue
ofj,forthefilterresponseγj (t ).
i,k 0
Using the first value of the index for j, the next 24 fil-
WhereasitispossibletodeterminetheFRRbysequen-
ter responses, γj···j+24(t ), are compared to the threshold
tiallyapplying(7)toeachofthenext25filteroutputs, the i,k 0
FAR may not be determined in such a sequential manner, values calculated for µ1 i···25(t 0) to check whether or not a
asitcannotbeknownwheretobegincomparingtheoutput record from γ ij ,· k··j+24(t 0) would be accepted as a record
oftheith device’sfilterappliedtothekth device’sdataset. from µ1···25(t ). This procedure is followed for each 25
i 0
Simply comparing the distributions of the filter output for recordsegmentofµ26···n(t ),whereevery25recordsanew
i 0
the two cases would also produce an inaccurate FAR, as value of j is chosen by taking the next value in the index.
the filter output for each device is changing in time, and Thetotalnumberofindexvaluesgeneratedshouldthenbe
itwouldnotbeunreasonabletoassumethatataparticular ndividedby25. TheFARisthencalculatedusing:
pointintimeonedevicewillhavethesamefilterresponse
n
asanotherdeviceatadifferentpointintime(Figure6). FAR= a (11)
n
Thus, tocalculateanaccurateFAR,weassumethatthe
filterresponseforeachrecordofthekthdevice’sdatasetus- where n is the number of accepted records and n is the
aFigure 6. Filter output for 10,000 records of two different Ethernet devices using the same filter,
whereatdifferenttimesthefilteroutputisthesame.
numberoftotalrecords. techniquesdiscussed inSection3.5., we havebeenable to
Thisprocedureisrepeated1,000times, withnewindex substantiallyreduceoreliminatemostcollisions. Inpartic-
valueschosenforeachiteration.TheFARforeachiteration ular, bandpassfilteringprovedparticularlyeffectiveindif-
arethenaveragedtoproducethetotalFAR.Repeatedtest- ferentiating m6c3 from m5c3/7. Through the use of both
ingusingthismethodhasprovidedconsistentvaluesforthe bandpass filters and an ensemble of filters, we were also
FAR. abletoeliminatealmostalloftheintra-modelcollisionsof
m5cY andm6cY,respectively. Time-domaintrimmingand
an ensemble of filters were also employed to dramatically
4.5.Results
reduce the number of collisions in m4cY, although perfect
discriminationwasnotpossible.
Theresultsofthematchedfiltermethodologyforsignal
profilingareshownfor16devices,consistingofacombina-
5.Futurework
tionofthreedifferentmodels,viaaconfusionmatrix(Table
1), which indicates the FRR and the FAR. The FRR may
bededucedbysubtractingthediagonalelementsfromone, Severalimportantissuesregardingthevariabilityofade-
while the FAR is simply the off-diagonal elements. Per- vice’s analog signal require additional consideration. For
fect detection/rejection would result in a matrix where the example, under what conditions does the signal vary, how
diagonal is one and off-diagonal elements are zero. The doesdeviceagingaffectsignalingcharacteristics,andhow
FRR and FAR are reported for 10,000 records per dataset. canasignalfromasystemthathaslostandre-establisheda
The naming convention mXcY is utilized to denote card Y connection with the network be tracked? These questions,
ofmodelX. amongstothers,providearichbackdropforfutureresearch.
As can be seen from the table, the FRR is sufficiently An immediate area of consideration is extending this
low(lessthan1%),fordifferentmodelcardswehavenear worktoincludedifferentnetworkingsystems. Initialwork
perfect detection, while some cards of the same model are has already begun on attempting to profile 100Mb Ether-
difficult to differentiate. By experimenting with different netsignals. Preliminaryresultsindicatethattheaforemen-
minimumandincrementalvaluesusedindeterminingδ,we tioned techniques will be adequate for discriminating be-
havefoundthatminimumandincrementalvaluesof.001al- tween different model devices; however, a deeper investi-
lowfortoomuchvariationinfilteroutput. Infact,aslightly gationintothesignalingcharacteristicsof100MbEthernet
lower value of δ for each card will result in a negligibly devices may be required in order to provide accurate re-
higherfalse-rejectrate;completelyeliminatenearlyallcol- sults for devices of the same model. Work will also con-
lisionswhichoccurwithfrequencylessthan20%;decrease tinueinthe10Mbrealm,aswetrytocreatesignalprofiles
collisionswhichoccurwithfrequencylessthan80%byup forasmanydevicesaspossible. Otherworkincludesana-
to 30%; but have no affect on collisions which occur with lyzingwirelesssignalsfrom802.11b,sensornetworks,and
frequency greater than 80%. In addition, by utilizing the RFID systems. Currently, we are attempting to optimizeTable1.Confusionmatrixof16deviceswith10,000recordsperdataset
TestedCard
m4 m5 m6
ExpectedCard c1 c2 c3 c1 c2 c3 c4 c5 c6 c7 c8 c9 c10 c1 c2 c3
m4c1 .9961 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
m4c2 0 .9965 .8470 0 0 0 0 0 0 0 0 0 0 0 0 0
m4c3 0 .8988 .9956 0 0 0 0 0 0 0 0 0 0 0 0 0
m5c1 0 0 0 .9969 .9729 .0003 0 0 .0012 .0002 .0342 0 0 0 0 0
m5c2 0 0 0 .9290 .9970 0 0 0 .0026 0 .0626 0 0 0 0 0
m5c3 0 0 0 .0032 0 1.000 0 0 0 .9982 0 0 0 0 0 0
m5c4 0 0 0 0 0 0 .9999 0 0 0 0 .0020 .0017 0 0 0
m5c5 0 0 0 0 0 0 0 .9928 0 0 0 0 0 0 0 0
m5c6 0 0 0 .0184 .0394 0 0 0 .9999 0 .9584 0 .7792 0 0 0
m5c7 0 0 0 .0003 0 .9751 0 0 0 .9940 0 0 0 0 0 0
m5c8 0 0 0 .0278 .0751 0 0 0 .8873 0 .9957 0 .1821 0 0 0
m5c9 0 0 0 0 0 0 .0001 0 0 0 0 .9932 0 0 0 0
m5c10 0 0 0 0 0 0 .0004 0 .3988 0 .1518 0 .9938 0 0 0
m6c1 0 0 0 0 0 0 0 0 0 0 0 0 0 .9995 .3489 0
m6c2 0 0 0 0 0 .0150 0 0 0 .0490 0 0 0 .3176 .9992 .1037
m6c3 0 0 0 0 0 .5769 0 0 0 .7100 0 0 0 0 .0857 .9994
thematchedfilterfortheprofilingofwirelesssignals. Ma- networks. Technicalreport,CarletonUniversity,Schoolof
jor challenges include adjusting the sensitivity of the filter ComputerScience,October2003.
to handle fluctuations of amplitude. Possible solutions to [2] L. Couch. Digital and Analog Communication Systems.
thisproblemincludesignalnormalizationandequalization. MacmillanPublishingCompany,1990.
[3] K.J.EllisandN.Serinken. Characteristicsofradiotrans-
mitterfingerprints. RadioScience,36:585–598,2001.
6.Conclusion
[4] P.J.Ferrell.Methodandapparatusforcharacterizingaradio
transmitter. UnitedStatesPatent5,005,210,April1991.
We have shown that the matched filter can be reliably [5] M. B. Frederick. Cellular telephone anti-fraud system.
UnitedStatesPatent5,448,760,September1995.
used to build signal profiles that can be used to discrimi-
[6] B. Gassend, D. Clarke, M. Dijk, and S. Devadas. Delay-
nate between Ethernet cards of different models. By ap-
based circuit authentication and applications. In Proceed-
plying the matched filter in non-traditional ways, we have
ings of the 2003 ACM symposium on Applied computing,
alsodemonstratedthatitispossibletodiscriminatebetween
Computer security, pages 294–301, Melbourne, FL, 2003.
seeminglyidenticalcards,whichappeartohaveoriginated ACMPress.
fromthesamemanufacturinglot. Finally,wehavedemon- [7] B.Gassend, D.E.Clarke, M.Dijk, andS.Devadas. Con-
stratedthattheanalogsignalcharacteristicsofEthernetde- trolledphysicalrandomfunctions.InProceedingsoftheAn-
vices can be tracked, and are thus suitable for use in net- nual Computer Security Applications Conference (ACSAC
workaccesscontrolschemes. Thetechniquesusedineval- 02),page149,LasVegas,NV,December2002.IEEECom-
uating the effectiveness of the matched filter method have puterSociety.
[8] B.Gassend,D.E.Clarke,M.Dijk,andS.Devadas. Silicon
also been given. Future work will focus on applying our
physicalrandomfunctions.InProceedingsoftheACMCon-
methodstothehigh-speed(100Mband1GbEthernet)and
ferenceonComputerandCommunicationsSecurity, pages
wirelessdomains(802.11b,sensornetworks,andRFIDsys-
148–160,Melbourne,FL,2002.ACMPress.
tems), as well as exploring how device behavior changes [9] J.Hall,M.Barbeau,andE.Kranakis. Detectionoftransient
duetoenvironmentalfactorsandaging. inradiofrequencyfingerprintingusingphasecharacteristics
ofsignals. InL.Hesselink, editor, Proceedingsofthe3rd
7.Acknowledgments IASTEDInternationalConferenceonWirelessandOptical
Communications(WOC2003),pages13–18,Banff,Alberta,
Canada,July2003.ACTAPress.
The authors would like to thank Ed Jackson for his
[10] J.Hall,M.Barbeau,andE.Kranakis. Detectionoftransient
invaluable and insightful contributions to the project, Ja- inradiofrequencyfingerprintingusingsignalphase. ITACS
son Sytsma for his diligence and exactitude in collecting ITThemeMeeting,October2003. SlidePresentation.
data, and Adrienne Huffman for her help in proofing the [11] R. D. Hippenstiel and Y. Payal. Wavelet based transmit-
manuscript. ter identification. In Proceedings of the Fourth Interna-
tionalSymposiumonSignalProcessingandItsApplications
(ISSPA96),GoldCoast,Australia,1996.
References
[12] D.N.Hoogerwerfetal. Activewaveformcollectionforuse
intransmitteridentification.UnitedStatesPatent6,035,188,
[1] M. Barbeau, J. Hall, and E. Kranakis. Intrusion detection March2000.
and radio frequency fingerprinting in mobile and wireless [13] R.Jones. MostSecretWar. Hamilton,1978.[14] J.Kamarainen,V.Kyrki,andT.Lindh. Signaldiscrimina-
tionbasedonpowerspectrumoffilterresponse. Technical
Report80,LappeenrantaUniversityofTechnology,Depart-
mentofInformationTechnology,2002. ResearchReport.
[15] D. Kaplan and D. M. Stanhope. Waveform collection for
useinwirelesstelephoneidentification.UnitedStatesPatent
5,999,806,December1999.
[16] T.Kohno,A.Broido,andK.C.Claffy.Remotephysicalde-
vicefingerprinting. InProceedingsoftheIEEESymposium
onSecurityandPrivacy,pages211–225.IEEE,May2005.
[17] D. L. Mensa et al. Radar signature evaluation apparatus.
UnitedStatesPatent6,529,157,March2003.
[18] H.Mustafa,M.Doroslovacki,andH.Deng. Automaticra-
diostationdetectionbyclusteringpowerspectrumcompo-
nents. InProceedingsoftheIEEEInternationalConference
onAcoustics,Speech,andSignalProcessing,(ICASSP02),
volume4,page4168.IEEE,May2002.
[19] T.L.OvermanandK.C.Overman.Adaptiveradarthreatde-
tectionandtrackerverificationsystem. UnitedStatesPatent
4,146,892,March1979.
[20] Y. Payal. Identification of push-to-talk transmitters using
wavelets.Master’sthesis,NavalPostgraduateSchool,Mon-
terey,CA,1995.
[21] C.L.Phillips,J.M.Parr,andE.A.Riskin.Signals,Systems
andTransforms. PrenticeHall,2003.
[22] P. S. Ravikanth. Physical one-way functions. PhD thesis,
MassachusettsInstituteofTechnology,2001.
[23] D. Shaw and W. Kinsner. Multifractal modeling of radio
transmitter transients for classification. In Proceedings of
theIEEEConferenceonCommunications,Power,andCom-
puting(WESCANEX97),pages306–312,Winnipeg,Mani-
toba,Canada,May1997.IEEE.
[24] J. Toonstra and W. Kinsner. Transient analysis and ge-
netic algorithms for classification. In Proceedings of the
IEEEConferenceonCommunications,Power,andComput-
ing(WESCANEX95),pages432–437,Winnipeg,Manitoba,
Canada,May1995.IEEE.
[25] O.UretenandN.Serinken. Detectionofradiotransmitter
turn-on transients. Electronics Letters, 35(23):1996–1997,
November1999.