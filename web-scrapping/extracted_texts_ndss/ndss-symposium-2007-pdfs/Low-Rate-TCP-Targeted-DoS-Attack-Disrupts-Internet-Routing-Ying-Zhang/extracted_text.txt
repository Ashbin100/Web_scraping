Low-Rate TCP-Targeted DoS Attack Disrupts Internet Routing
YingZhang Z.MorleyMao JiaWang
UniversityofMichigan UniversityofMichigan AT&TLabs(cid:150)Research
wingying@umich.edu zmao@umich.edu jiawang@research.att.com
Abstract partitionbetweenlowertierISPstotherestoftheInternet
bybringingdownseverallinks simultaneously. Thus,it is
Compared to attacks against end hosts, Denial of Ser- importanttounderstandattacksagainsttheInternetinfras-
vice (DoS)attacks against the Internet infrastructuresuch tructuregivenitscriticalimportancetothewell-beingofthe
asthosetargetedatrouterscanbemoredevastatingdueto Internet. Inthispaper,wefocusonexaminingaparticular
theirglobalimpactonmanynetworks.Wediscoverthatthe typeofattackagainsttheinterdomainroutingprotocol(cid:150)the
recently identi(cid:2)edlow-rate TCP-targeted DoS attacks can BorderGatewayProtocol[39].
havesevereimpactontheBorderGatewayProtocol(BGP).
TheBorderGatewayProtocol(BGP),thedefactostan-
As the interdomain routing protocol on today’s Internet, dardInternetinterdomainroutingprotocol,usesTCPasits
BGP is the critical infrastructure for exchanging reacha- transport protocol. A fundamental (cid:3)aw with routing pro-
bility information across the global Internet. We demon-
tocolsdeployedtodayisthatthereisusuallynoprotection
strateempiricallythatBGProutingsessionsonthecurrent in the form of priorities in using routerresources for con-
commercialroutersaresusceptibletosuchlow-rateattacks trol plane packets. Thus, congestion of other data traf(cid:2)c
launched remotely, leading to session resets and delayed canadverselyaffectBGPpackets,asshownintheprevious
routing convergence, seriously impacting routing stability studybyShaikhetal.[43]. Recentstudies[50,21,7]have
and network reachability. This is a result of a fundamen-
indicatedthat data congestioncan severelyimpact routing
talweaknesswithtoday’sdeployedroutingprotocols:there sessions.Thus,anyattackthatexploitsthislackofisolation
isoftennoprotectionintheformofguaranteedbandwidth withanimpactonTCPcannegativelyaffectthefunctioning
forroutingtraf(cid:2)c. UsingtestbedandInternetexperiments,
ofBGP.
we thoroughlystudy theeffectof suchattacksonBGP.We
In this work, we studyhow the recentlyidenti(cid:2)edlow-
demonstratethefeasibilityoflaunchingtheattackinacoor-
rate TCP-targeted DoS attacks [27] disrupt interdomain
dinatedfashionfromwide-areahosts witharbitrarilylow-
routingontoday’sInternet. Thisisthe(cid:2)rst studythatsys-
rateindividualattack(cid:3)ows,furtherraisingthedif(cid:2)cultyof
tematically examines the impact of this type of attack on
detection. Weexploredefensesolutionsbyprotectingrout-
interdomainrouting, andwe discoveredtheimpact can be
ingtraf(cid:2)cusingexistingroutersupport. Our(cid:2)ndingshigh-
quite severe. It has been shownthat low-rateTCP attacks
light the importance of protecting the Internet infrastruc-
can severely degrade TCP throughput by sending pulses
ture,inparticularcontrolplanepackets.
of traf(cid:2)c leading to repeated TCP retransmission timeout.
Given the fundamentalsusceptibility of TCP to such low-
rate attacks due to its deterministic retransmission time-
1 Introduction
out mechanism, any application using TCP is vulnerable.
Inparticular, theeffecton protocolsusingTCP withinthe
ThereisevidenceofincreasingoccurrencesofDenialof Internet infrastructure is arguably more severe due to the
Service(DoS)andDistributedDenialofService(DDoS)at- globalscopeoftheimpact.Asidefromthepotentialimpact
tacksontheInternettoday[40]. Mostofthewidelyknown onthethroughputofBGPpackets,amorecriticalquestion
attacks target a single host or multiple hosts within a par- iswhethersuchattacksarepowerfulenoughtoresetBGP’s
ticularedgenetwork,ratherthantheInternetinfrastructure routingsessionasaresultofasuf(cid:2)cientlylargenumberof
suchasroutersinsidetransitISPnetworks. Thelattertype consecutivepacketdrops.Ifthesessionisreset,itcanhave
of attack can be quite devastating. For example, attacks serious impact on the Internet in the form of routing in-
againstrouterscan impactsigni(cid:2)cant amountof traf(cid:2)c, as stability, unreachabledestinations,andtraf(cid:2)cperformance
many networks rely on them to reach other destinations. degradation [29, 28]. Note that attackers can launch such
Moreover, attacks on the routing infrastructure can create attacks remotely from end hosts without access to routers
1northeabilitytosendtraf(cid:2)cdirectlytothem. Its low-rate
nature makes detection inherently dif(cid:2)cult. More impor-
tantly,theexistingbestcommonpracticeforprotectingthe
Internetroutinginfrastructurebydisallowingaccessandre-
search proposals such as SBGP [26] are not suf(cid:2)cient to
preventthis type of low-rate attack since this attack is ex-
ploringatransportlayervulnerabilityofBGP.
We show empirically using testbedexperiments that to-
day’srouterswithdefaultcon(cid:2)gurationsaresusceptibleto
BGP session resets as a result of low-rate TCP-targeted
DoSattacks. Weobservethatattackerscanbringdownthe
targetedBGPsessioninlessthan216seconds.Sessionreset
probabilitycanbeashighas30%withonly42%utilization
ofthebottlenecklinkcapacity.Andwhenthesessionisnot
reset,BGPtabletransfercanbeincreasedfrom85seconds
uptoanhourwithonly27%ofthelinkcapacityused. Us-
ing wide-area experiments, we show the ease with which
coordinatedlow-rate attacks can be launched, resulting in
arbitrarilylow-rateindividualattack(cid:3)ows. Thisraises the
dif(cid:2)culty of attack detection. Fortunately, major peering
linkswithsigni(cid:2)cantavailablebandwidtharedif(cid:2)culttoat-
tack due to required resources. We subsequently explore
defensestrategiesthroughpreventionanddemonstratethat
it is possibleto signi(cid:2)cantlylower the risk of suchattacks
byprioritizingroutingtraf(cid:2)cusingexistingroutersupport.
We providerecommendationsfor better default BGP con-
(cid:2)gurations.
The rest of the paper is organizedas follows. We pro-
videthebackgroundoflow-rateTCP-targetedDoSattacks
andBGP inSection2. Section3discussesimpactofsuch
attacksonBGP andkeyfactorsindeterminingvulnerabil-
ity of BGP. We show using testbed experimentsthat BGP
canbedisruptedbylow-rateTCPattacksinSection4.Sec-
tion5showsusingwide-areaexperimentshowmultipleat-
tack hosts coordinate to launch low-rate attacks against a
givenBGPsession.WediscussdefensemechanismsinSec-
tion6andconcludeinSection7.
2 Background
In this section we describe low-rate TCP-targeted DoS
attacksandtheBorderGatewayProtocolsusceptibletoit.
2.1 Low›rateTCP›targetedDoSAttacks
In their seminal work [27], Kuzmanovic and Knightly
showedthatTCP’s retransmissiontimeoutmechanismcan
beexploitedbyusingmaliciouslychosenlow-rateDoStraf-
(cid:2)c to throttle TCP (cid:3)ows to a small fraction of their ideal
rate. AsshowninFigure1,thelow-rateattackconsists of
periodic, on-off square-wave of traf(cid:2)c bursts with magni-
tude of the peak
(cid:0)
, burst length (cid:1)
Burst length L(cid:13)
Magnitude of the(cid:13)
peak R(cid:13)
Inter-burst period T(cid:13)
Figure 1. Notation for low›rate TCP›targeted
DoSattacks
, and inter-burst period
(cid:2)
. There are several requirements for the low-rate TCP-
targetedattacktobesuccessful: (i) An integermultipleof
theinter-burstperiodcoincideswiththeminimumretrans-
mission timeout value (minRTO) of TCP. (ii) The magni-
tudeoftheattackpeaktraf(cid:2)cislargeenoughtocausepacket
loss. (iii) The burst length is suf(cid:2)ciently long to induce
loss: It needs to be longer than roundtrip time (RTT) of
TCP(cid:3)ows. Whentheseconditionsaresatis(cid:2)ed,theaggre-
gateTCP(cid:3)owssharingthebottlenecklinkwill haveclose
tozerothroughput. Evenif theinter-burstperiodtakes on
othervaluesoutsidetheminRTOrange,thethroughputcan
still be severely degraded. The reason is that the TCP re-
transmissiontimerrepeatedlytimesoutduetolossinduced
bytheattacktraf(cid:2)cburst, as thetimervalueexponentially
increasesforanygiven(cid:3)owsharingthebottlenecklinkwith
theattacktraf(cid:2)c.
One way to defend against such attacks is to random-
ize the minimum retransmission timeout value (minRTO)
value; however,this doesnot fully mitigatethe attack due
to the inherently limited range for minRTO as shown by
Kuzmanovic and Knightly [27]. They also found that
evenrouter-assistedmechanismsdonoteliminatetheattack
impact without incurring excessively high false positives.
There has also been follow-upworkon detectinglow-rate
attacks[47,44,30,14].Mostoftheexistingdetectionalgo-
rithmsrelyonsignalanalysis. Noneoftheproposeddetec-
tionalgorithmshas beenshownto be suf(cid:2)cientlyaccurate
andscalablefordeploymentinrealnetworks.Furthermore,
no knownsolution exists to effectivelymitigate such low-
rateattacks.Thus,allapplicationsusingTCPareinherently
susceptibletodegradedperformanceduetosuchattacks.In
thiswork,wefocusontheBorderGatewayProtocolasan
important(cid:147)application(cid:148)usingTCPgivenitscriticalroleas
theinterdomainroutingprotocolontheInternet.
2.2 BorderGatewayProtocol
The Border Gateway Protocol (BGP) is used as the in-
terdomainroutingprotocolon today’s Internet. In BGP, a
routing session is established over a TCP connection be-
2tweenneighboringborderroutersto exchangereachability understanditthoroughly. Inthispaper,wefocusoninves-
information. Thereare two typesof BGP sessions: eBGP tigatingtheeffectoflow-rateattacksonasingle-hopBGP
andiBGPsessions. Theformerarebetweenrouterswithin session. However, the results can be generalized to mul-
differentautonomoussystems(ASes)ornetworks,andusu- tihopBGP sessions. ArguablymultihopBGP sessions are
allyconsistofasinglehop,i.e.,thetworoutersaredirectly moresusceptibleastheytraversemultiplelinks,thusmore
connected with a physical link. The latter are within the likelytoexperiencecongestion.
sameASandcangothroughmultiplerouterhops.
BecauseBGPisastatefulprotocol,routinginformation 3.1 ImpactofAttacksonBGPSessions
previouslyreceivedisassumedtobevaliduntilwithdrawn.
Toensureconnectionliveness,KeepAlivemessagesareex-
The impact on BGP sessions caused by low-rate TCP-
changedperiodically.AccordingtoBGP’sprotocolspeci(cid:2)-
targetedDoSattacksaretwofold: throughputdegradation
cation[39],eachBGProutermaintainsaHoldTimerwhich
andsessionreset. First, thethroughputoftheBGPupdate
limits the maximum amount of time that may elapse be-
messages can be signi(cid:2)cantly reduced. However, the av-
tweenreceiptofsuccessiveKeepAliveand/orupdatemes-
erage BGP update rate is quite low, except during signi(cid:2)-
sages from its neighbor in the BGP session. If the Hold
cant routing changes or table transfer upon session estab-
Timerexpires, a noti(cid:2)cationerrormessage is sent and the
lishment. TheimpactintheformofratereductionofBGP
BGP connection is closed. Upon session reset, all routes
traf(cid:2)cislesscritical,butcanfurtherexacerbatethealready
previously exchanged in the session are implicitly with-
slowBGPconvergenceprocess. Thesecondtypeofattack
drawn, potentially propagating routing instability to other
impactduetoBGP sessionreset is muchmoresevere. To
networks.
resetaBGPsession,theinducedcongestionbyattacktraf-
Note that one may arguethat BGP session reset due to
(cid:2)c needs to last suf(cid:2)ciently long to cause the BGP Hold
data congestion is actually desirable, given the associated
Timertoexpire.Tomonitortheattacksuccess,onecanan-
routesarenotpreferableduetothebadqualityofthelink.
alyzetraf(cid:2)ctraversingtheimpactedlinkorroutingupdates
Westronglydisputethisclaim.Sessionresetcreatessigni(cid:2)-
relatedtothesession. Furthermore,itiseasiertokeepthe
cantdisruptionandcancauseglobalroutinginstability.Per-
sessiondownasSYNpacketsaresentlessfrequentlycom-
formancebasedrouteselectioncanbeusedinstead. More-
paredtoretransmitteddatapackets.
over,ISPstodayalreadyperformtraf(cid:2)cengineeringtoload
BGPsessionresetcanleadtoseverechurnontheInter-
balancetraf(cid:2)c.
net’scontrolplane. This notonlyimpacts bothroutersin-
There are other BGP security problems, such as lack
volvedintheBGPsession,aseachwithdrawsalltheroutes
of deployed mechanisms to verify the correctness, au-
previouslyadvertisedby its neighbor,but also manyother
thenticity, integrity of the routing information exchanged.
networksontheInternetduetothepropagationofrouting
Proposed protocols such as SBGP [26], SoBGP [34] ad-
changes. For example, the number of routes in a default-
dress some of these issues. Other attacks against rout-
freerouterinthecoreInternetisaround170,000basedon
ing protocols such as the link cutting attack described by
routingdatafromRouteViews[5]. Asigni(cid:2)cantfractionof
Bellovin [12] are related. It uses topology information to
thetable can beaffectedupona BGP sessionreset. With-
selectspeci(cid:2)clinkstocutsothattraf(cid:2)cisreroutedthrough
drawingalargenumberofroutescancausemanydestina-
routerscontrolledbyattackers.Theattackdescribedinthis
tionnetworkstobecometemporarilyunreachableduetoin-
paperalsousestopologyinformationtoidentifytargetlinks.
consistentroutingstate[48]andalargeamountoftraf(cid:2)cto
Routervendorshaveprovidedprotectionagainstknownat-
becomererouted,whichmayfurtherleadtocongestiondue
tackssuchasTCPRSTandSYN(cid:3)oodattacks[18,23].Us-
toinsuf(cid:2)cientcapacity.
ingtestbedexperimentsweveri(cid:2)ednoneoftherouterswe
A recent proposal to mitigate the potential negative
tested is vulnerableto TCP RST attacks. Note that unlike
impact of short-lived session resets is termed graceful
RSTorSYN(cid:3)oodattacks,itispossibletoremotelylaunch
restart[42]. Routerssupportingthismechanismattemptto
resource-basedattacks,suchastheattackdescribedinthis
continue to forward packets using the stale routes. There
paper,usingpacketspassingthroughtherouterswithoutthe
is, however,anupperbound(bydefaulttwo or threemin-
abilitytosendpacketsdestinedtothem.
utes)ontheamountoftimearouterretainsthestaleroutes
toavoidlengthyroutinginconsistency. Thus,asessionre-
3 Low-rate DoSAttacksonBGP
set that lasts suf(cid:2)ciently long time, possibly due to an in-
tense low-rate attack, can still have severe impact on the
BecauseBGPrunsoverTCPforreliability,BGPisalso dataplane.
vulnerabletotherecentlydiscoveredlow-rateTCP-targeted Ingeneral,theimpactofaneBGPsessionresetislarger
DoSattacks.Duetoitslow-bandwidthproperty,suchattack thanthatofaniBGPsessionresetbecauseroutingchanges
ismuchmoredif(cid:2)culttodetect,andthusitisimportantto receivedfromeBGP sessions aremorelikelyto propagate
3across multiple networks and the routing table is usually Gigabit(cid:13) Gigabit(cid:13)
Ethernet(cid:13) OC3 155Mbps(cid:13) Ethernet(cid:13)
default-free,thus carryingall the destinations to the Inter-
net.TheroutesexchangedbetweentworoutersinaneBGP
session consist of all the routes of their respective cus- Sender A(cid:13) Router R1(cid:13) Router R2(cid:13) Receiver B(cid:13)
tomers. Thus, foreBGP sessions betweentwo largeISPs,
thisnumbercanbequitelarge. Weanalyzedroutingtables Figure2.Labexperimenttestbed
froma tier-1 ISP and foundthat up to 13% of the routing
tablecancomefromasingleeBGPsessionversusonly4%
enoughpacketloss,sothattheTCP(cid:3)owoftheBGPsession
fromaniBGPsession.
enters into retransmission timeout state. This may appear
to be dif(cid:2)cult to achieve, especially for BGP sessions in-
3.2 KeyFactorsinAttackingaBGPSession
volvingInternetcorebackbonelinksgiventheheavilyover-
provisionedcore. However,eBGPsessionsinvolvepeering
Westudythekeyfactorsthatdeterminethevulnerability links which may not be as well-provisioned compared to
ofBGPtosuchattackstoilluminatepossiblesolutions. linkswithinanISPbackbone.Therehasbeenanecdotalev-
1. Priority of routing traf(cid:2)c. The fundamental prob- idencethat congestionoftenoccurson peeringlinks. Pre-
lem that makes BGP vulnerableto low-rate attacks is that viousmeasurementstudiessuchas[6,24]haveshownthat
routertraf(cid:2)cmaynotbesuf(cid:2)cientlyprotectedfromconges- someofthebottlenecklinksoftoday’sInternetpathsoccur
tioncausedbyotherdata traf(cid:2)c. Manyofthecommercial attheboundarybetweentwonetworks.Linksbetweenstub
routers today by default use First-In-First-Out (FIFO) or networksandtheirprovidersoftenhavemuchlowerspeed,
DropTailqueueingdiscipline,givingnoprioritytorouting andthesenetworksoftenuseeBGPtoobtainroutes. Using
packets. Eveninthecasewhereroutingdataareprotected datafromRouteViews[5],wefound23%of100,482eBGP
(e.g., through the RED queue management scheme [22]), peeringsessions belongto stub networks. Furthermore,it
therearenodefaultpolicingmechanismstopreventattack is not necessary that a single attack host overwhelms the
packets from spoo(cid:2)ng packets of higher priority. For ex- target link. As we show later in Section 5, multiple hosts
ample,weobservedthatmanyrouterswillmarktherouting possiblyfromabotnetcanbeusedtolaunchacoordinated
packetswithanIPprecedencevalueof6[8]. However,at- attack,aslongastheytraversethelinkinvolvedintheBGP
tackpacketscanalsousethesameorevenhigherIPprece- sessionunderattack. Inthis work,weinvestigatethenec-
dencevaluesgiventhelackofauthenticationforsuchvalues essaryconditionsandshowexperimentallyhowthiscanbe
by default. Packet remarkingor TTL value checking[23] achieved.
can help ensure only routing packets receive higher prior-
ity. Inthiswork,weilluminatetheseissuesbyexperiment- 4 Testbed Experiments
ingwithrealcommercialrouterswithvariouscon(cid:2)guration
settings. Instead of using simulations, we focus on using Inthissection,wedescribeexperimentsconductedona
experimentstoobtainresultsclosertothereality. routertestbedandempiricallyshowthatcommercialrouters
2. Proprietary router implementation. Commercial canbeseverelyimpactedbylow-rateTCP-targetedDoSat-
router behavior is much less understood compared to that tacksintheformofsessionresetsanddegradedtabletrans-
ofendhostsduetoitsproprietarynatureandlackofsource ferthroughput. We(cid:2)rst presentourexperimentsetup, and
codeaccess. Forexample,itisunclearhowtheTCPstack theninferredTCPcharacteristicsandobservedBGPparam-
oncommercialroutersreallybehaves.Unlikeforend-hosts, etersofdifferentcommercialrouters,followedbydetailed
critical parameters to the attack such as minRTO are un- analysisofattackimpact.
known, making successful attacks much more dif(cid:2)cult. If
minRTO is randomized, it would further reduce the prob- 4.1 TestbedSetup
ability of a session reset. Even with known router behav-
ior, depending on its con(cid:2)guration, its dynamic behavior Our experiment testbed consists of two commercial
maybequitedifferentcomparedtothedefaultsettings.We routersandtwoPCsshowninFigure2. Thetwolinkscon-
mainly focus on default settings as most deployed routers nectingtheroutersandthePCsarefull-duplexGigabitEth-
probably use default con(cid:2)gurations. When we know that ernet. The target link between the routers is Packet Over
theroutersupportscertainfeaturesthatwouldhelpprotect SONET(POS)with155Mbpslinkcapacity. Notethatour
againstthelow-rateattacks,wealsoexaminethesefeatures experimenttestbedcloselymodelstherealoperationalsce-
ingreatdetails. nario of an eBGP session with two key differences. First,
3. Capacity of peering links. In order for low-rate wedonotmodelbackgroundtraf(cid:2)candselectthelinktypes
TCPattackstobesuccessfulagainstBGProutingsessions, toallowtraf(cid:2)cfromSender
the traf(cid:2)c burst needs to be suf(cid:2)ciently powerful to cause
(cid:3) toReceiver (cid:4) toeasilyover-
loadthelinkbetweenthetworouters. Second,attackhosts
4TCPproperties BGP/Routerparameters(default)
Routertype RouterOS minRTO SYNretry KeepAlive HoldTimer Queue Gracefulrestart
version (msec) pattern(sec) (sec) (sec) alg. timer(sec),range
Cisco3600 IOS12.2(25a) 300 2,4,8,16,(2). 60 180 FIFO Notsupported
Cisco7200 IOS12.2(28)S3 600 2,4,8,16,(152). 60 180 FIFO Supported,120,1-3600
Cisco7300 IOS12.3(3b) 300 2,4,8,16,(152). 60 180 FIFO Supported,120,1-3600
Cisco12000 IOS12.0(23)S 600 2,4,8,16,(152). 60 180 FIFO Supported,120,1-3600
JuniperM10 JUNOS[6.0R1.3] 1000 3,6,12,24,(30). 30 90 FIFO Supported,180,1-3600
Table1.RouterTCPbehavior,routerandBGPparameters.
areusuallyseveralIPhopsawayfromthetargetlink,with
morevariableandlongerdelaystothetargetlink. Longer
delaysdonotaffectattackeffectiveness,butmorevariable
delays can make attacks more dif(cid:2)cult to control. We de-
scribe later in Section 5 how all these dif(cid:2)culties can be
overcomeusingcoordinatedattacks.
Theexperimentis conductedasfollows. A senderpro-
gramtransmits fromSender (cid:3) UDP-based low-rateattack
traf(cid:2)c1 of the shape shown in Figure 1 with peak rate at
185Mbpstraversingthelinkbetweenthetworoutersarriv-
ingatReceiver (cid:4) . Thepeakrateissettobe185Mbps,as
itisthelowestrateneededtosuccessfullyresetthesession
withaburstlengthof150ms. Withashorterburstlength,
weobservethatthesessiondoesnotresetevenwithalarger
peakrateduetoinsuf(cid:2)cienttimetosaturatetherouterbuffer
tocausecongestion. Whenthebottlenecklinkbetweenthe
tworoutersbecomescongested,weobserveattackpackets
aredroppedatboththeinputandtheoutputqueueofrouter
(cid:0)(cid:6) (cid:5)
. Usingdefault routercon(cid:2)gurations,locally generated
BGPpacketsfrom (cid:0)(cid:7) (cid:5) to (cid:0)(cid:9) (cid:8) alsoexperiencepacketlossdue
tosharedrouterbuffer. Ifoneof (cid:0)(cid:7) (cid:5)
mechanism.
Inthispaper,weuseCiscoGSRswithIOSversion12.0
toillustrateourresultsbecausetheyarearecommonlyused
in Internet backbone networks and are the most powerful
routersweexaminedonourtestbed.Inparticular,theCisco
GSRs used are equipped with Cisco 12410/GRP (R5000
CPUat200Mhz)processor,512KBL2cache,and512MB
memory. Thelinecardontherouterhasa4portPOSOC-
3c/STM-1MultiModewithEnginetype0,abuffersizeof
12560packetsforpacketsizesmatchingthatofBGPpack-
ets.
4.2 RouterImplementationDiversity
Tounderstandwhycommercialroutersarevulnerableto
low-rateattacks, weanalyzetheTCPbehavioranddefault
routercon(cid:2)gurationsettings.
In our work, TCP related parameters are obtained us-
ing software we developed based on TBIT (TCP Behav-
ior Inference Tool) [36], which infers TCP properties on
’s BGP packetandits Web servers. We enhanced it by integrating BGP-related
functionalitytoestablishaBGPsessionwithacommercial
subsequentlyretransmittedpackets are all lost causing the
HoldTimertoexpire,theBGPsessionisclosed. router. Afterthesession establishment,thetoolconstructs
packetsinspecialwaystoinferrouter’sTCPbehavior.The
We experimented with a wide variety of commercial
most important TCP property inferred is minRTO which
routers using the latest router OS whenever possible from
canbeaccuratelydetermined.
theSchoonertestbed[4]andourownlocallab. Theycon-
Table1alsoshowsthedefaultrouterBGPcon(cid:2)gurations
sistofthefollowingtypes: Cisco3600,7200,7300,12000
for several features relevant to the low-rate attack. Cisco
(commonlyknown as GSRs), and Juniper M10. To study
routers use a 60 seconds KeepAliveTimer and a 180 sec-
theextentofthephenomenon,thesame experimentswere
onds Hold Timer by default, while Junipers have smaller
performedonalltheserouters,andsimilarresultswereob-
defaulttimervalues: 30secondsforKeepAliveand90sec-
served. Onemaindifferenceisthatlower-endrouterssuch
ondsforHoldTimer. WederivethattoresettheBGPses-
asCisco3600havesmallerbufferscomparedtomorepow-
sion,attackersneedtocauseatleast8consecutivepackets
erfulrouterssuch as Cisco GSRs, makingthemmorevul-
to be droppedfor Cisco GSR and only6 for Juniper M10
nerable to attacks. Another difference is that the Juniper
duetothetimervalues.Thus,JuniperM10ismorevulnera-
M10is foundtobe morevulnerabledueto its largermin-
bletolow-rateattackscomparedtoCiscoGSR.Thedefault
RTO and smaller KeepAlive and Hold Timer values. We
queuingalgorithmforallroutersstudiedisFIFOinsteadof
emphasize that susceptibility to low-rate DoS attacks is a
RED.WeightedREDdescribedlatercanhelpprotectrout-
generalproblemwithanyrouterwhennotcon(cid:2)guredwith
ingpackets.GracefulrestartsupportprovidedbyCisco[17]
waystoprioritizeBGP traf(cid:2)candhasaBGP implementa-
isnotenabledbydefault(Gracefulrestartisnotsupported
tionusingTCPwithadeterministicretransmissiontimeout
inCisco3600). Itcanhelprouterstolerateshort-livedses-
siondowntime;however,thereisatimerlimitonthedown
1UDPisusedasopposedtoTCPtopreciselycontrolthesendingrate.
time,withadefaultof2or3minutes,beforethestaleroutes
TCPpackets,withoutconformingtocongestioncontrolcanalsobeused
toavoiddetection. arewithdrawn.
51
0.8
0.6
0.4
0.2
0
150 200 250 300 350 400 450 500
teseR
noisseS
fo ytilibaborP
1
0.8
0.6
0.4
0.2
0
150 200 250 300 350 400 450 500
Burst Length (msec)
etaR
egarevA
dezilamroN
5000
Probability of Session Reset Normalized Average Rate
4000
3000
2000
1000
0
0.5 1 1.5 2 2.5 3
)ces(noitaruD
refsnarT
elbaT
0.3
0.25
0.2
0.15
0.1
0.05
0.5 1 1.5 2 2.5 3
Inter−Burst Period (sec)
etaR
egarevA
dezilamroN
0.4
Table Transfer Duration Normalized Average Rate 0.3
0.2
0.1
0
180 190 200 210 220
ytilibaborP 0.5
0.45
0.4
0.35
180 190 200 210 220
Peak Magnitude(Mbps)
etaR
gvA
dezilamroN
2000
1500
1000
500
0
150 160 170 180 190 200 210 220 230
)ces(noitaruD
refsnarT
elbaT
0.24
0.22
0.2
0.18
0.16
150 160 170 180 190 200 210 220 230
Peak Magnitude(Mbps)
etaR
gvA
dezilamroN
Probability
Normalized Avg Rate
Table Transfer Duration
Normalized Avg Rate
(a)Attackburstlength (b)Inter-burstperiod (c)Peakmagnitude
( (cid:10) =185Mbps, (cid:11) =600ms) ( (cid:10) =185Mbps, (cid:12) =200ms) (Top: (cid:11) =600ms, (cid:12) =200ms)
(Bottom: (cid:11) =1.2second, (cid:12) =200ms)
Figure3.Impactofattacktraf(cid:2)conBGPsessionresetandtabletransferduration: minRTO=600ms,
withCiscoGSRs.
4.3 ExperimentResults
Asshownin[27],threekeyfactorsdeterminetheattack
impact: burst length, inter-burst period, and peak magni-
tude. Intuitively,longerburst lengthcauses thebottleneck
queuetobefullforlongerduration,leadingtolargerattack
impact. Shorter inter-burst period results in larger proba-
bilityofdroppingBGPpackets. Thelargertheattackpeak
magnitude,thesoonerpackets(cid:2)lluptherouter’squeueon
thebottlenecklink. Attacks withsuf(cid:2)cientlyhighaverage
ratewouldnolongerbeconsideredlow-rate.However,such
attackscanbecomposedofmanyindividuallow-rateattack
(cid:3)owsfromadistributedattackdescribedinSection5.
Next, we analyze attack impact to con(cid:2)rm these intu-
itionsandfocusontheattackimpactonBGP.Weusethree
metricstomeasuretheBGPperformanceunderattack:ses-
sion reset probability, time to reset the session, and BGP
tabletransferduration. Inparticular, we conductfour sets
ofexperiments. Theresultsreportedinthissectionareob-
tainedbyrepeatingeachindividualexperiment100times.
1. Impact of attack burst length on session reset. In
this experiment, we analyze how attack burst length im-
pacts session reset probability. The experiment is set up
as follows. Router
(cid:0)(cid:7) (cid:5)
periodicallysends KeepAlive mes-
sagestoRouter
(cid:0) (cid:8)
. Sender (cid:3) startsalow-rateattackwith
traf(cid:2)c destined to Receiver (cid:4) with a given burst length, a
(cid:2)xed inter-burst period of 600 ms and peak magnitude of
185Mbps. Figure3(a)showsas expectedthat the session
reset probability and the average attack (cid:3)ow rate increase
with larger burst length. When the burst length is half of
theinter-burstperiod,thesessionresetprobabilityisabout
(cid:13)(cid:15) (cid:14)(cid:17) (cid:16)
sultinginlongerBGPconvergencedelays.WeusetheBGP
tabletransferdurationasameasureto studytheimpactof
varyinginter-burstperiodoflow-rateattacks.Inthisexper-
iment, we (cid:2)x the peak magnitude at 185 Mbps and burst
length at 200 ms. The smallest inter-burst period is set at
800ms givenminRTOof600ms to preventsession reset.
We conduct the experimentas follows. First, we load
.
2. Impact of attack inter-burst period on BGP table
transfer. Asobservedabove,anattackmightnotresetthe
session. Whenthesessionisnotreset,attack(cid:3)owscande-
layupdatesduetoincreasedqueueingandpacketloss, re-
(cid:0) (cid:5)
witharandomlychosendefault-freeBGPtableof166,527
routing entries obtained from RouteViews [5]. Then, the
BGP session between
(cid:0) (cid:5)
and
(cid:0) (cid:8)
is con(cid:2)guredandestab-
lished. Subsequently within at most 3 seconds of session
establishment,Sender (cid:3) startsthelow-rateattackwithtraf-
(cid:2)c destined to Receiver (cid:4) . We record the time when
(cid:0)(cid:18) (cid:8)
receives the entire table. Figure 3(b) illustrates the aver-
ageandstandarddeviationofBGPtabletransferdurations
with varying inter-burst period. For inter-burst period of
0.8secondandlessthan30%averageutilizationofthelink
capacity, it takes on average more than one hour to (cid:2)nish
transferringtheBGPtable,whichnormallylastsonlyabout
85seconds! As theinter-burstlengthincreasesto 1.2sec-
onds,BGPtabletransferstillneeds21minutesto(cid:2)nishon
average.However,theimpactonBGPtabletransferdimin-
ishesquicklywithincreasinginter-burstperiod.
3. Impact of attack peak magnitude on session reset
and table transfer. To evaluate the impact of peak mag-
nitudeon session reset probability,we (cid:2)x the burst length
at200msandtheinter-burstperiodat600msmatchingthe
minRTOvalue.CiscoGSRallocatesbufferspaceinchunks
of varying sizes, matching packets of different sizes. We
usea(cid:2)xedattackpacketsizeof30bytes,ofsimilarsizeto
theKeepAlivepackets,sothattheyareplacedin thesame
buffers. We vary the peak magnitude from 175 Mbps to
225Mbpsbychangingthesendingrate. 175Mbpsischo-
sen as it is the lowest rate needed to reset the session for
oursetup. AsshowninthetopplotofFigure3(c),theses-
sionresetprobabilityincreasesgraduallywithlargerattack
61
0.8
0.6
0.4
0.2
0
0 20 40 60 80 100 120
session reset time (minute)
FDC
Only KeepAlive
Update Trace
Table Transfer
Figure 4. Attack duration to cause session reset with
Cisco GSRs ( (cid:11) =600 ms, (cid:12) =200 ms, (cid:10)
withlargerBGPtables,containingmoreunstableroutes,are
morelikelyimpacted.
We examine the attack duration needed for session re-
set in the following three scenarios with increasing BGP
messagefrequency. (i)OnlyKeepAlivemessages aresent
(every60seconds).(ii)Onetypicalday’sBGPupdatetrace
fromRouteViewsisplayedback. (iii)Onedefault-freeta-
blefromRouteViewsistransferred. Thescenario(ii)isthe
common case. Figure 4 shows the distribution of the at-
tackdurationneededforsessionreset(cutoffat2hourtime
limit). Asexpected,onaverageittakestheleasttimetore-
setthesessionforscenario(iii)whenupdatesaremostfre-
quentlyexchanged. Scenario(i)requiresonaveragemore
time compared to the other scenarios. In the best case, it
takesonly216secondstoresetthesession.
=185 Mbps, min-
Tosummarize,theexperimentsdescribedaboveanalyze
RTO=600ms).
in detail howvariousparametersof low-rateattacks affect
theattackeffectivenessonBGP.Weobservethatincreasing
burst length and peak magnitude, and reducinginter-burst
rate. Basedonsimplecalculations,increasingpeakmagni- periodincreaseattackeffectiveness. Theseresults con(cid:2)rm
tudefrom175Mbpsto215Mbps(ortheexcessbandwidth thedangerthatalow-rateattackcanresetaBGPsession.
relative to the bottleneck link from 20 Mbps to 60 Mbps)
reducesthetimeto(cid:2)ll upthe3Mbitqueue2 from150ms 4.4 Router Architecture: Explaining Packet
to 50 ms. This effect is equivalent to increasing the burst Drops
lengthby100ms,showninFigure3(a).Theimpactofpeak
magnitudeonBGPtabletransferdurationwasanalyzedby Therouterarchitecturesfromdifferentvendorsandtypes
(cid:2)xingtheburstlengthat200msandtheinter-burstperiod varyindetails; however,packetdropsoccurwheneverany
at 1.2 seconds, intentionally chosen to be different from bufferbecomesfull withthe defaultFIFO queuing. There
the minRTO value to prevent session resets. Attack UDP are usually multiple buffers in a router, traversed by for-
packetsizeissetto1,500bytes,matchingthesizeofBGP wardedpackets. BGP packetssharewithattacktraf(cid:2)cand
packetfor table transfer. The attack peak rate varies from otherbackgroundtraf(cid:2)csomeofthesebuffers.Morespecif-
155 Mbps to 225 Mbps. The bottom plot of Figure 3(c) ically, locally generatedBGP packets by the routershares
showsas expectedthat with increasingpeakrate, BGP ta- withotherpacketsthebufferspaceontheoutputinterface.
bletransferdurationgraduallyincreases. BGP traf(cid:2)c forwarded by the local router, in the case of
4. ImpactofBGPupdatebehavioronsessionreset. The iBGP sessions, experiences resource sharing in all these
bufferswith othertraf(cid:2)c. Thus, protectionfor BGP traf(cid:2)c
BGP session is brought down as soon as the Hold Timer
expires. ThisrequireslosingalltheBGPpacketsforadu- needstobeprovidedatbothincomingandoutgoinginter-
faces.
rationat least as longas theHoldTimer value. To trigger
the (cid:2)rst set of packet loss, a BGP packet must encounter In our experiments, BGP traf(cid:2)c is associated with a
congestionpossiblyinducedbytheattacktraf(cid:2)c. Tocause single-hop eBGP session and thus is locally generated.
Some attack traf(cid:2)c is observed to be dropped at the input
retransmission timeout, the attack (cid:3)ow needs to cause all
thepacketswithinoneTCPwindowtobedroppedtoavoid interface,andweobservethatBGPpacketsexperienceloss
TCPfastretransmission. IfBGPpacketsareexchangedin- atoutputqueues. Underthedefaultcon(cid:2)gurations,thereis
no protectionfor the BGP traf(cid:2)c which thus competes for
frequentlyandhappentoalwaysmisscongestion,itwillbe
impossibleto reset thesession. Thus, themorefrequently bufferspacewithallothertraf(cid:2)c.Recentproposals[11,10]
onreducingrouterbuffersizepartlytoimprovedelaysmay
BGPmessagesareexchanged,themorelikelytheBGPses-
sionisresetgivenaregularlyoccurringlow-rateattackpat- endangerBGPpackets,astransientcongestioneitherinten-
tern. Inall theaboveexperiments,wefocusontheoverly tional throughattacks or unintended by regular traf(cid:2)c can
resultinBGPpacketloss,especiallywithsmallerbuffers.
conservativescenariowhereonlyKeepAlivemessages are
exchanged.Inreality,routersfrequentlysendupdatesasso-
5 Coordinated Low-rate Attacks
ciatedwithroutingchanges.Thus,(cid:147)busier(cid:148)routers,routers
2Thequeuesizeof3Mbitisderivedfromabufferof12,560packets In previous sections, our focus was on a simpli(cid:2)ed
with30bytepackets. network setting with two topological advantages from at-
7tacker’s view point: (i) The network path (cid:19) from the at-
tacker to a selected destinationhost (which the attacker is
not required to have access to) goes through at least one
link (cid:20) oftheBGPsessionunderattack. (ii)Thebottleneck
link for the path (cid:19) is link (cid:20) between the two BGP routers
involved in the session. Besides, the attack hosts need to
send suf(cid:2)cient amount of burst traf(cid:2)c to congest the bot-
tlenecklink (cid:20) butwithsuf(cid:2)cientinter-burstperiodtoavoid
detection, which requires correctly guessing minRTO and
estimatingtargetlinkcapacity. However,theserestrictions
aredif(cid:2)culttoimpose,asthelinkofinterestmaybecloseto
thecorenetwork,likelywithmuchhigherbandwidthcom-
paredwiththecaseofattackingendhosts.Wenowexplore
howattackerscansucceedwithouttheseconditions.
Onewaytoovercomethesedif(cid:2)cultiesistolaunchaco-
ordinated attack with multiple attack hosts. Attackers can
identifyhostswhosenetworkpathsforselecteddestinations
traversethelinksinvolvedintheBGPsessionandsynchro-
nize attack (cid:3)ows to avoid detection. However, the bottle-
neck link does not need to be shared, as long as the com-
binedattack(cid:3)owsissuf(cid:2)cienttooverloadthelink.Further-
more,eachattack(cid:3)owdoesnotevenneedtomatchrouter’s
minRTO.Attackhostscanbeusedtosendoverlappingtraf-
(cid:2)cbursts. The overlapcan occurbothin attackamplitude
as well as occurrence in time. The feasibility of such co-
ordinatedlow-rateattacksdependsonsuf(cid:2)cientnumberof
attack(cid:3)ows, thetargetlink’s availablebandwidth,andthe
timesynchronizationgranularityamongdifferenthosts.
Inthefollowing,wefocusonthealgorithmfortwokey
stepsinlaunchingcoordinatedlow-rateattacks,attackhost
selectionandtimesynchronization,incompletingsuchco-
ordinatedlow-rateattacksgivenalinkofinterest (cid:20) involved
inaBGPsession. GuessingminRTOandlinkcapacityac-
curatelyis outofthescopeofthispaper. Instead,we ran-
domlyguessminRTOandestimatelinkcapacityusingex-
istingtoolssuchasPathneck[24].Wethendemonstratethe
feasibilityusingwide-areaexperiments,includinganactual
attackperformedagainstalocallyconstructedBGPsession
usingwide-areaattackhosts.
5.1 Attack Host Selection and Synchronization
Algorithm
Therearetwokeystepsincompletingsuchcoordinated
low-rateattacksgivenalinkofinterest (cid:20) involvedinaBGP
session: (i) Selecting hosts whose network paths to cho-
sendestinationstraverse (cid:20) . (ii)Synchronizingattacktraf(cid:2)c
sendingtime so that attack traf(cid:2)c arrivingat (cid:20) follows the
desiredsquarewavepattern. The(cid:2)rststepisnontrivial,as
unlikeendhosts,IPinterfaceaddressesassociatedwiththe
targetlink (cid:20)
such as routers. The second step is not strictly necessary,
as the aggregate attack (cid:3)ow can be consistently high-rate
to overload the target link. However, it is useful to make
detectionmorechallenging.
5.1.1 SelectionofAttackHostsandDestinations
Weassumethatanattackerhasidenti(cid:2)edatargetlink
cannotbedirectlyreachedfromendhosts. For
protection,mostnetworksdonotgloballyadvertisethein-
frastructure addresses used to number network equipment
(cid:20) in-
volved in a BGP session between two routers on the In-
ternet.3 The BGP session can be any of thefollowing: an
eBGPsessionbetweentwoISPpeersoracustomerandits
provider,oraniBGPsessionwithinanAS.Hereweonlyfo-
cusoneBGPsessionsastheimpactofsuchsessionresetsis
generallylargercomparedtoiBGP sessions. We highlight
thekeystepsinselectingattackhostssuchthatfortheirse-
lecteddestinationhoststhenetworkpathstraversethelink
(cid:20) . In the following we illustrate the steps to select attack
hosts whichneeds to be repeatedovertime due to routing
changes.
1. Identify the target link’s geographic location and
AS(es). Given the target link (cid:20) denoted by its two router
interface IP addresses, an attacker can map them to their
ASes [33] and the approximate geographic location [37,
45]. We denote the IP addresses as (cid:21)(cid:17) (cid:22)
(cid:5)
and (cid:21)(cid:17) (cid:22)
(cid:8)
, and the
associatedASnumbersas (cid:3)(cid:24) (cid:23)
(cid:5)
and (cid:3)(cid:24) (cid:23)
(cid:8)
.
2. Identify host to destination pre(cid:2)x pairs whose path
traverses the link of interest at AS level. We (cid:2)rst iden-
tify at AS level host to pre(cid:2)x pairs whose network paths
traverse the (cid:3)(cid:24) (cid:23)
(cid:5)
- (cid:3)(cid:9) (cid:23)
(cid:8)
link from the BGP data of either
the attack hosts’ local network or other public sources as
RouteViews [5] and RIPE [3]. By taking advantage of
destination-based forwarding, we (cid:2)nd pre(cid:2)xes whose AS
pathcontainsthefollowingpattern[ (cid:3)(cid:9) (cid:23)(cid:26) (cid:25)(cid:28) (cid:27)(cid:29) (cid:27)(cid:30) (cid:27)(cid:31) (cid:3)(cid:9) (cid:23)
(cid:5)
(cid:3)(cid:9) (cid:23)
(cid:8)
(cid:27)(cid:29) (cid:27)(cid:30) (cid:27) ],
where (cid:3)(cid:24) (cid:23)(cid:26) (cid:25) istheupstreamproviderortheoriginASofthe
attackhost,and(cid:147) (cid:27)(cid:29) (cid:27)(cid:30) (cid:27) (cid:148)denoteszeroormoreASes.
3. IdentifyIP-levelpaths. Toselecttheoneswhosepaths
traverse (cid:21) (cid:22)
(cid:5)
- (cid:21)(cid:17) (cid:22)
(cid:8)
givenAS level path, we traceroutefrom
eachattackhosttoarandomlyselectedIPfromeachofits
destination pre(cid:2)xes to check if (cid:20) is traversed. To reduce
probing overhead, we can further narrow down the attack
hostsbyselectingthosethataregeographicallyclosetothe
link (cid:20) . This is especially useful if the target link is be-
tweentwopeers,whichusuallyusesthehot-potatoorearly
exit routing strategy. Known IP aliasing resolution tech-
niques[45]can beusedtoidentifyinterfacesbelongingto
thesamerouterto(cid:2)ndmorepathstraversingthetargetlink.
5.1.2 TimeSynchronization
Time synchronization ensures that aggregate attack (cid:3)ows
from diverse hosts arriving at the target link (cid:20) follow the
3SimilartotheminRTOdiscovery,wedonotdiscusshowtoidentify
suchlinks,whichcanbeachievedusingnetworktopologyinformation.
8Host 1(cid:13)
Ts(cid:13)1(cid:13)
D(cid:13)1=(cid:13)Tr(cid:13)1-(cid:13)Ts(cid:13)1(cid:13)
D(cid:13)2=(cid:13)(cid:13)Tr(cid:13)2-(cid:13)Ts(cid:13)2(cid:13) start_time(cid:13)
Host 2(cid:13)
Ts(cid:13)2(cid:13) start_time(cid:13)
Target(cid:13)
Link l(cid:13)
Router 1(cid:13) Router 2(cid:13) Router Z(cid:13)
Controller C(cid:13)
Ts(cid:13)n(cid:13) Dn=Trn-Tsn(cid:13)
start_time(cid:13)
Host n(cid:13)
Figure5.Synchronizingcoordinatedlow›rate
attacks.
square wave shape for maximal attack ef(cid:2)ciency, making
attacksourcedetectionmorechallenging. The differences
ineachhost’slocalclockandthenetworkdelayfromeach
hostto (cid:20) necessitatetimesynchronization.Nextwedescribe
ouralgorithmforattacksynchronizationamongst ! attack
hosts,asillustratedinFigure5. Theideaofusingonecon-
trolhostorrouterattheotherendofthepathtosynchronize
issimilartowhatwasproposedin[13].
1. Select a reference time. Attackers need to select one
localclockasthereferencetimeforcomputingtherelative
timetolaunchtheattack. Ifattackershaveaccesstoacon-
trollerhost " ,suchthatnetworkpathsfromeachattackhost
to " traverse (cid:20) asshowninFigure5andalsomatchtheac-
tualattacknetworkpath, " ’slocalclockcanbeusedasthe
referencetime. " recordsthearrivaltimeofpacketsfrom
eachattackhost. Alternatively,anattackercanusearouter
#
,suchthatnetworkpathsfromeachattackhostto
#
tra-
verse (cid:20) .ICMPtimestamprepliesfrom
#
[32,9]serveasthe
referencetime.Ifnosuchrouterisfound,theattackermight
(cid:2)ndalivedestinationandsendtoitICMPorIPtimestamp
request[1]. Ideally,thehostorrouterservingastherefer-
encetimeshouldbecloseto (cid:20) ,sothatthedelayvariability
ofthenetworkpathsegmentfrom (cid:20) tothehostortherouter
willhaveminimaleffectonsynchronization.
2. Synchronize with the reference time. Once the con-
troller " is identi(cid:2)ed, each host $ (cid:25) sends a packet to " ,
embeddingthe sending local time
(cid:2)(cid:9) %
(cid:25) as the payload. "
recordsthereceivingtime
(cid:2)’ &
(cid:25) basedonitslocaltime.Then
" computes the time difference: ( (cid:25)* )
(cid:2)(cid:28) &
(cid:25), +
(cid:2)(cid:24) %
(cid:25) , cap-
turing the difference in both the local clocks and the net-
work one-way delays from $- (cid:25) to " . After " receives a
packetfromeachhost, " obtains ! timedifferencevalues
(
(cid:5)/ .
(
(cid:8)/ .(cid:30) 0(cid:29) 0(cid:29) 0(cid:30) .
(, 1 . The controller " decides to start the at-
tackattime
%(cid:29) 24 3(cid:17) &5 2 27 69 8; :
basedonitslocalclock,allocating
suf(cid:2)cient time for the packet to be received by each host.
Subsequently, " sendsamessagetoeachhost $ (cid:25) withthe
valueof ( (cid:25) and
%(cid:29) 24 3(cid:17) &5 2 27 69 8< :
. Receivingthemessage,host
$ (cid:25) startsattackattime
%(cid:30) 24 3(cid:17) &= 2 27 69 8; :
+ ( (cid:25) basedon $ (cid:25) ’slo-
calclock. Alternatively,ifrouterICMPtimestampsorhost
ICMP/IP timestamps are used as the reference time, upon
receivingICMPtimestampreplies,theinformationneedsto
be aggregatedto coordinatethe attackstarting time. Even
if the attacker does not know the exact minRTO, the con-
troller can randomize the
%(cid:29) 24 3(cid:17) &5 2 27 69 8; :
on each host within
arangetocauseoverlappingintheaggregated(cid:3)owonthe
targetlink.
5.2 CaseStudies: Wide›AreaExperiments
Ourwide-areaexperimentsillustratethefeasibilityofse-
lecting attack hosts and synchronizingcoordinatedattacks
targetedatvarioustypesoflinksusingtheprocessoutlined
above. We further demonstrate the feasibility of coordi-
natedattacksusingInternetexperiments.
Practical dif(cid:2)culties in executing the attack. There are
somepractical challengesin successfully executingtheat-
tack. Identifying a link involved in a target BGP session
requiresnetworktopologyinformation. RouterIPaliasing,
parallellinks,andinconsistencybetweenBGPpathsandIP
forwardingpathscancomplicatetheprocessofidentifying
attack hosts and destinations. To estimate the number of
attackhosts needed, theattacker needs to assess theavail-
able bandwidth of the target link. Moreover, attack (cid:3)ows
may share common bottleneck links, reducing the overall
attack rate. Attackers couldbe limited by the attack hosts
they control, which may not be suf(cid:2)cient to overload the
targetlink,duetolimitedbandwidthandtheinabilitytotra-
versethetargetlink.However,thecasestudiesbelowshow
that most of these challengescan be overcomeusing vari-
ousheuristics,exceptthoseassociatedwithresourcelimita-
tions.
Experiment methodology. As attack host candidates, we
choosealltheavailablePlanetLab[38]hostslocatedindif-
ferent organizations. The resulting >? > hosts reside in 64
distinctASes,connectedto58distinctupstreamproviders.
These providers belong to diverse levels of Internet hier-
archy [46]. We focus on BGP sessions associated with a
largetier-1 ISP @ (anonymizedfor privacyconcerns)and
the Abilene network AS 11537 for our study, as we have
accesstomostoftheirroutercon(cid:2)gurationsusedforidenti-
fyingeBGPpeeringlinks.Weleaveforfutureworkamore
complete study on how to identify links involved in BGP
sessions,butweshowlateraccuracyofsimpleheuristicsin
identifying eBGP sessions validated using router con(cid:2)gu-
rations. BGP AS paths from RouteViews [5] are used for
identifying potential host and destination pre(cid:2)x pairs that
traversethetargetlink. Wetracerouteto(cid:147).1(cid:148)IPaddressin
each candidate destination pre(cid:2)x to collect IP level paths
fromassociatedPlanetLabhosts. Forourstudy,weprobed
AC B5 (cid:13) D
destinationsaltogether. Forthepathsthattraversethe
9Category Target AS- IP- Attack Dest. Bottleneck ASrelations(%) Guessed
links level level hosts pre(cid:2)xes link(Avg (enter E exit) BGP
(cid:2)ltered (cid:2)ltered min,max,avg min,max,avg BWMbps) (peer,customer,provider) session(%)
Twotier-1ISPs 100 11 5 1,25,9 1,1853,234 1(65.8) (29,71,0 E 8,92,0) 85
TwosmallISPs 60 6 7 1,57,32 1,553,179 2(63.6) (15,63,22 E 28,63,9) 77
Multi-connected 250 33 34 1,46,13 1,225,98 9(42.7) (16,84,0 E 2,98,0) 50
customer(ISP F )
Multi-connected 40 1 5 22,64,47 1,466,114 4(33.7) (23,57,20 E 9,83,8) 68
customer(Abilene)
Single-connected 40 1 13 88 1,28,9 3(27.3) (48,52,0 E 0,100,0) 35
customer
Table2.Summaryresultsforselectingattackhostsanddestinations.
targetlink,weusePathneck[24]tomeasureandlocatethe
bottlenecklink.
Attackhostanddestinationselection. Wede(cid:2)neamulti-
connected customer to be one with more than one physi-
cal connection to one or more providers. To help explain
results, we categorize target links into (cid:2)ve types of eBGP
peeringlinks, between the followingtwo entities: 1. Two
tier-1ISPs; 2. Twosmall ISPs; 3. Amulti-connectedcus-
tomeranditstier-1ISPprovider;4.Amulti-connectedcus-
tomer and its small ISP provider; 5. A single-connected
customer and its provider. Here we summarize our main
(cid:2)ndings:
G
ForlinksassociatedwithbigISPs,therearefewerat-
tackhoststochoosefromcomparedtosmallISPs.
G
Exceptforsingle-connectedcustomers,therearemany
destination pre(cid:2)xes to be used by attackers for most
links,increasingattackdetectiondif(cid:2)culties.
G
relationshipbetween
For big ISPs, most paths enter from and exit to cus-
tomer networks. For small ISPs, paths are more
spread out across customer, peer and provider links,
butmostlyexittocustomernetworks.
Table2showstheresultssupportingtheabove(cid:2)ndings.
A set of links are randomly selected for each link type,
shown in the (cid:147)Target links(cid:148) column, based on router con-
(cid:2)gurations. We (cid:2)rst identifypre(cid:2)xes at the AS path level
asdescribedbefore. Forsomelinks,weareunabletoiden-
tifyanydestinationpre(cid:2)xshowninthe(cid:147)AS-level(cid:2)ltered(cid:148)
column. The(cid:147)IP-level(cid:2)ltered(cid:148)columnshowsthenumber
oflinksweareunableto(cid:2)ndanypathtraversingviatracer-
oute.Limitedvantagepoints,incompletetraceroute,andIP
aliasingaccountfortheirexistence. Weuseroutercon(cid:2)gu-
rationstomoreaccuratelydealwithIPaliasingforrouters
with a singleBGP peeringsession with anotherAS. Iden-
tifyingthattheIPlevelpathgoesthroughsuchrouters,we
candetermineifthetargetlinkistraversed.
Theattackhosts anddestinationsforeachlinktypeare
showninthecolumnslabeledas(cid:147)Attackhosts(cid:148)and(cid:147)Dest.
pre(cid:2)xes.(cid:148) The (cid:147)Bottleneck link(cid:148) column shows it is dif(cid:2)-
cult to overload the target link via a single link. The AS
@ orAbileneandthenetworkwhich
a particular path enters from or exits to are shown in the
second to last column. Finally, we observe high accura-
ciesofdeterminingpeeringlinksbasedonthetwoadjacent
IP hops in the traceroute path with different AS numbers
using BGP origin AS to IP mapping for most target links
except for single-connected customers most likely due to
numberingcustomernetworkequipmentusingproviderad-
dresses[33].
Wenowelaborateonour(cid:2)ndingsforthetargetlinksbe-
tween two tier-1 ISPs and two small ISPs. Even with the
limited vantage points of >? > PlanetLab hosts, we are able
to (cid:2)nd some IP level paths to traverse most target links.
Theresultsindicatethatitismorechallengingto(cid:2)ndpaths
traversingtargetlinksassociatedwiththeISP @ compared
toAbilene.Wefound85%oftargetlinksbetweentwotier-
1 ISPs can onlybe traversedfromno morethan 10 attack
hostsandreachingfewerthan300destinationpre(cid:2)xes.This
canbeexplainedbythemultipleconnectionsbetweenlarge
ISPs and the hot potato or early-exit routing policy, mak-
ingitdif(cid:2)cultto(cid:2)ndhostsgoingthroughthespeci(cid:2)ctarget
peering link. Furthermore, we only discovered one target
linkbetweentier-1ISPstobethebottlenecklinkononeof
thepaths.
ComparedtopeeringlinksbetweenlargeISPs,wefound
after (cid:2)ltering, among the 47 target links between Abilene
andits 25peers, morecandidateattack hosts can beused:
51%ofthesetargetlinkscanbereachedfrommorethan20
hosts. ComparedtolargeISPs,smallerISPsnaturallyhave
less richnetworkconnectivity,thus fewerchoicesto route
traf(cid:2)c between them. On average, there are slightly more
destination pre(cid:2)xes to select from for links between large
ISPs, explained by a larger number of customer pre(cid:2)xes,
alsosupportedbythesecondlastcolumn.
Thenexttwotypesarelinksbetweenamulti-connected
customeranditsprovider. Mostaremultihomedcustomers
to different providers. Compared to the (cid:2)rst two types of
peeringlinks,weidentifymoreattackhosts: 40%oftarget
links in AS @ can be traversed from more than 35 hosts,
while 40% in Abilene can be reached from more than 60
hosts. This is due to fewer choices to reach a customer
network compared to a peer ISP network. Interestingly,
101
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35
time difference in packet arrival at control host(seconds)
FDC
Two Tier−1 ISPs
Two Small ISPs
Big Provider and Multi−connected Customer
Small Provider and Multi−connected Customer
Figure 6. Attack timesynchronization granularity (100
runs).
there are slightly more destination pre(cid:2)xes to select from
formulti-connectedcustomersofAbilenethanthoseofISP
@ duetorichernetworkconnectivityto @ . Insummary,it
is harderto (cid:2)ndnetworkpathsto traverselinksassociated
withlargernetworkswithmorediversenetworkconnectiv-
ity. This applies to selecting both attack hosts as well as
destinationpre(cid:2)xes.
Forthelasttypeoflink,thesingle-connectedcustomer-
providerlink,wesample2linksfromAbileneand38links
from AS @
R=2 Mbps L=300 ms(cid:13)
T=[0.5s,1.5s](cid:13)
UW1(cid:13)
Average Rate = 0.45 Mbps(cid:13)
UCB1(cid:13) UW2(cid:13)
100 Mbps(cid:13) 10 Mbps(cid:13)
BGP(cid:13)
UCB2(cid:13) WAN(cid:13) Session(cid:13)
THU1(cid:13)
Zebra-based(cid:13) Zebra-based(cid:13)
THU2(cid:13) software(cid:13) software(cid:13)
router 1(cid:13) router 2(cid:13)
UC1(cid:13) UC2(cid:13)
Figure 7. WAN testbed to reset a local BGP
session.
We observe that attack hosts can be synchronized within
100msinmorethan80%oftheruns,andwithin130msin
morethan90%oftheexperiments.
Wide-areacoordinatedattacksagainstalocalBGPses-
sion. We have shown above the feasibility of attack host
selection and synchronization for a wide range of target
links, we now perform an actual attack against a locally
constructedBGPsession,whichwesetupbetweentwoPCs
runningZebrasoftware[2],withonePCservingasthegate-
. This attack is analogous to DDoS attacks wayfortheotherasshowninFigure7. Toincreasetheat-
against a single customer network and is more easily de- tack dif(cid:2)culty, only BGP KeepAlives are exchanged. We
tected. Exceptforthe(cid:2)ltered14links,theremaininglinks use Planetlab hosts as attack hosts.4 In the following, we
canbetraversedfromalltheattackhosts,asbyde(cid:2)nition. mimic how the attacker is able to launch the attack with-
Mostlythereexistonlyoneortwopre(cid:2)xesasdestinations. outtheinformationofminRTOandlinkcapacity. Without
Notethatthedistributionofpotentialattackpathsshown knowingminRTO,theattackerguessesavaluewithinacer-
inTable2ispartlybiasedbythePlanetLabprobelocations, tainrangeforinter-burstperiodeachtime. Insteadofsyn-
especiallyforentrypoints. Itisalsoimportanttonotethat chronizingall hosts to start attack at the exact same time,
attacktraf(cid:2)centersfromandexitstoadiversetypesoflinks. thecontrollersynchronizeeachhosttostartwithinacertain
Timesynchronization.Weselectasubsetofpeeringlinks rangeusingbursttraf(cid:2)cwitha(cid:2)xedburstperiodandaran-
for which we have access to a controller host needed for domburst-freetimeperiod.Asaresult,theaggregated(cid:3)ow
calibration,fromeachcategorylistedinTable2toevaluate causes congestion on the targeted link. The link capacity
theaccuracyofthesynchronizationalgorithmpresentedin can be estimated from the maximum available bandwidth
Section5.1.2. Inparticular,weselect2,3,5,and13links measuredbyothermeasurementtools.
respectivelyfromthe(cid:2)rstfourtypes. Thenumberofattack The link capacity between the two PCs with the local
hostsforatargetlinkvariesfrom9to27. Weused19dis- BGPsessionis10Mbps.Eachattack(cid:3)owhasaburstlength
tinctcontrollerhosts. DuetothelimitedlocationofPlanet- of300ms,aninter-burstperiodrandomlyselectedbetween
Labhosts,weareunabletoidentifyacontrollerhostforthe 0.5secondto1.5seconds5.Thepeakmagnitudeisadjusted
single-connectedcustomer links to evaluate time synchro- withdifferentnumberofattackhostschosen. We varythe
nizationgranularity. Thishoweverdoesnotpreventattack- number of hosts from 6 hosts each sending 3 Mbps peak
ers from successfully attackingsuch links. As we discuss rateto16hostswith1.1Mbps.Inordertoresetthesession,
earlier, attackers could use ICMP timestamp replies from
routersorlivehostsasthereferencetime. 4Giventhisarti(cid:2)cialsetup,anyhostcanbeused,aseachhostsending
traf(cid:2)cdestinedtorouter2traversesthetargetlink.
Figure6showsthedistributionofthetimedifferencebe-
5TherangeisbasedontheguessofpossibleminRTOsinceminRTO
tweentheearliestandlatestpacketsarrivingatacontroller
shouldnotbetoobigforperformanceconcernsnortoosmallforunneces-
hostfromcorrespondingattackhostsfor100experiments. saryre-transmission.
11the peak rate required decreases roughly linearly with the lengthorsmallerthantheattacksynchronizationgranular-
numberofhosts.Figure7illustratesanexperimentofusing ity,itwouldbeimpossibletolaunchlow-rateattacks. The
8 attack hosts from various geographic locations. In this burst length needs to be suf(cid:2)ciently long to induce packet
case, the peak magnitude is 2 Mbps based on our experi- drops, and is usually several hundredmilliseconds. How-
ments. We launch 50 attacks from these 8 hosts with the ever, small minRTOs might result in unnecessary retrans-
averagerate of 0.47 Mbps from each host. Everyattempt missions especially for multi-hop BGP session. Another
ledtoaBGPsessionreset.Therequiredtimetobringdown way to mitigate the attack is to randomize the minRTO
the BGP session varies from 4.2 minutes to 43.3 minutes value as suggested in [27]. The minRTO value is speci-
withanaverageof18.9 minutesandstandarddeviationof (cid:2)edbyarange[
95.
Theaboveexperimentsdemonstratethefeasibilitytore-
motely reset a BGP session possibly in the core Internet
frommultipleendhosts.Withcoordinatedattacks,theburst
durations can overlap among different (cid:3)ows so that each
(cid:3)owcanhaveashorterburstlengthandalongerinter-burst
period. Thepeakmagnitudeforasingle(cid:3)owcanbesmall
as long as there are enoughhosts sending traf(cid:2)c to (cid:2)ll up
theavailablebandwidthatthetargetlink. Wenextdiscuss
howthisandotherlow-rateattacksagainstBGPcanbepre-
vented.
6 Defense Mechanisms
Noknowndetectiontechniquesexisttodaythatcan ac-
curately identify coordinated low-rate attacks given arbi-
trarilylow-rateindividualattack(cid:3)ows.Wefocusonpreven-
tionmechanismssothatlow-rateTCP-targetedDoSattacks
cannot impact BGP sessions. To achievethis we enumer-
atethenecessaryconditionsforsuchattacksonBGPtobe
successful. (1)AbilitytoinfertheminRTOvalueandsend
low-ratetraf(cid:2)cwith minRTOas theinter-burstperiod. (2)
AbilitytoidentifythelocationoftheBGPsessionandsend
traf(cid:2)ctraversingthetargetlinkinvolvedintheBGPsession.
(3)Abilitytocongestthetargetlink. Wedescribetwogen-
eral approaches: hiding the necessary informationneeded
fortheattackandprotectingBGP packetsfromothertraf-
(cid:2)c. These prevention solutions are themselves not novel,
and fortunatelysome of them can be readily deployed to-
day. WeencourageISPstoimmediatelyadoptthemasde-
faultcon(cid:2)gurationsandbestcommonpractices.
6.1 HidingInformation
To successfully reset a BGP session, the attacker must
know the minRTO value for the TCP stack on the target
router. AsshownearlierinSection4,suchinformationcan
beobtainedbyexperimentallystudyingcommercialrouters.
Differentvendorsandroutertypescanhavedissimilarmin-
RTOs.Fingerprintingtechniquessuchasnmap[35]orsim-
plytrialanderrormaybeusedforinference.
TherearetwowaysrelatedtominRTOtothwartthelow-
rate attack. First, if the minRTO, determining the attack
inter-burst period, is small relative to the minimum burst
3
, H ]. Arandomvaluewithintherangeis
assignedastheminRTOforeach(cid:3)ow. Randomizationre-
ducesthelikelihoodthatattack(cid:3)owswillhitallconsecutive
retransmitted packets required to reset the session. How-
ever, it does not eliminate the impact on BGP throughput
degradation.
Related to hiding minRTO values, another way to pre-
ventlow-rateattacksistoconcealnetworktopologiesfrom
end-hosts, so that it becomes impossible for attackers to
identifytargetlinksofBGPsessions. Infact,manyrouters
in edge networks already disable ICMP TTL Time Ex-
ceededrepliesusing(cid:2)rewalls,whichareneededfortracer-
outetodiscovertopologies. ThedeploymentofMPLSalso
makes discovering internal ISP topologies dif(cid:2)cult. The
disadvantageis that legitimate use to discover topologyis
also denied. Related to disabling ICMP TTL Time Ex-
ceededreplies,disallowingICMPtimestampreplieswould
makecoordinatedattacksmoredif(cid:2)culttosynchronize.
6.2 PrioritizingRoutingTraf(cid:2)c
Adirectapproachtodefeatlow-rateDoSattacksagainst
BGPsessionsistoprovidebandwidthguaranteeandprior-
itized scheduling for BGP traf(cid:2)c so that it is not affected
by congestion caused by other traf(cid:2)c. This approachpro-
tectsroutingtraf(cid:2)cfrombothintentionalattacksaswellas
unintended traf(cid:2)c surges. Thus, this is the recommended
approach.Moreimportantly,thiscanbeachievedtodayus-
ingexistingroutersupport.Fromahighlevel,therearetwo
essential components: (1)Prioritization: each BGP router
and any other router that may forward BGP traf(cid:2)c needs
to prioritize BGP traf(cid:2)c at both input and output queues.
(2) Marking: the edge router must ensure that non-BGP
traf(cid:2)c is not marked with the high priority needed to dif-
ferentiateBGP traf(cid:2)c. Ifdifferentiationis basedonrouter
source IP addresses, sourcespoo(cid:2)ngcan be preventedus-
ing either ingress (cid:2)ltering or the Generalized TTL Secu-
rity Mechanism (GTSM) [23].6 TTL and priority check-
ingcanalsobecombinedtohelppreventspoo(cid:2)ngofprior-
itymarkings. Nextweempiricallyexamineseveralwidely
implemented features for traf(cid:2)c differentiation on today’s
commercialroutersintheireffectivenessatprotectingBGP
traf(cid:2)c against low-rate attacks: Random Early Detection
6This works by dropping packets with smaller than expected TTLs
basedonthenumberofhopsbetweenthetworoutersinaroutingsession.
125000
4000
3000
2000
1000
0
0.5 1 1.5 2 2.5 3
Inter−Burst Period (sec)
)ces(noitaruD
refsnarT
elbaT
Low priority attack packets
High priority attack packets
Figure 8. Impact of inter›burst period on
BGP table transfer with WRED enabled
(
(cid:0)
=185Mbps, (cid:1) =200ms)
(RED) [22, 15, 31], Committed Access Rate (CAR) [19],
and class-based policing [20]. These mechanisms either
provideprioritizedbufferaccessorlinkscheduling.
Random Early Detection (RED): RED [22] has been
widelyimplementedinrouterstohelpmaintainsmallqueue
sizes and prevent TCP synchronization. Weighted RED
(WRED) [15] allows traf(cid:2)c differentiation based on IP
precedence by setting different RED parameters for each
traf(cid:2)cclass. Inourexperiments,wetakeCiscorecommen-
dations [15] to givelower priorityto packets markedwith
IP precedence of 0 (default) and higher priority to those
marked with precedence of 6. Newly arriving high prior-
ity packets are not discarded until all incoming low prior-
itypacketsaredropped. Bydefault, routerswestudieddo
notenableWREDandmarklocallygeneratedBGPpackets
withaprecedencevalueof6.WREDisappliedonlyatout-
putqueues,andisthusunabletoprotectroutedBGPtraf(cid:2)c
foriBGPsessions.
We use the same experimental setup as in Figure 2
in Section 4 except WRED is enabled for router R1’s
output queue. Under low-rate attacks con(cid:2)gured with
(cid:0)
=185 Mbps and (cid:1)
queueing using several criteria. For example, Committed
Access Rate (CAR) [19] supported by Cisco routers we
studied limits boththe inputandoutputtransmissionrates
onaninterfacebasedoncriteriasuchasincominginterface,
IPprecedence,QoSgroup,orIPaccesslist,andalsoclassi-
(cid:2)espacketsbysettingtheIPprecedenceorQoSgroups.
In ourexperiments,we con(cid:2)gureCAR onthe inputin-
terface to reset incoming attack packets to have IP prece-
denceof0,preventingattackpacketsfromspoo(cid:2)nghigher
precedencevalues. We also con(cid:2)gure CAR on the output
interfacetodropthepacketswithIPprecedenceof0when
its burst rate exceeds 100 Mbps. We found that CAR is
veryeffectiveinisolatingBGP packetsfromattacktraf(cid:2)c.
Theperformanceissimilartothecurvemarkedwith(cid:147)low-
priority attack packets(cid:148) in Figure 8. Class-based polic-
ing[20]isasimilarmechanismwhichweexperimentedon
Ciscorouterswiththesameeffectiveness.
Insummary,preventionmechanismsdescribedherecan
be readily con(cid:2)gured in today’s routers. Complementary
router-supportedfeatures,suchasGracefulRestart[42]and
thoseproposedbytheresearchcommunityFRTR[49]can
helpreducethe overheaddue to session resets. Theexist-
ingfocusofthenetworkcommunity[16,25,41]hasbeen
onpracticessuchaspreventingunauthorizedrouteraccess
bysettingupaccesscontrollistsandpreventingrouterCPU
overload by rate-limiting ICMP replies. However, this is
notsuf(cid:2)cientinprotectingroutersfromremotelylaunched
resource-based attacks such as low-rate attacks described
here. Weprovideheresuggestionstoprotectroutingtraf(cid:2)c
fromgeneralDoSattacksincludinglow-rateattacksbeyond
existing proposals. Operators need to con(cid:2)gure routers to
provide class-based queueing or prioritized buffer access
for BGP traf(cid:2)c markedwith higher priority. Edge routers
mustsetupnecessary(cid:2)lterstopreventattackpacketsfrom
spoo(cid:2)nghigherpriority. Finally,hidingthenetworktopol-
ogy and infrastructure IP addresses also help protect the
network. We recommend that router vendors enable such
protectionforroutingtraf(cid:2)casthedefaultcon(cid:2)guration.
Alternatively, a better transport protocol for BGP can
helppreventBGPfromlow-rateattacks. BGPonlyrequire
reliabletransferforthelatestupdatemessageforeachindi-
=200 ms, Figure 8 compares the ta-
vidualpre(cid:2)xas well as in-orderdeliveryformessages be-
bletransferdurationwhenattacktraf(cid:2)cusesIPprecedence
longingtothesamepre(cid:2)x.Furthermore,transportforBGP
value of 0 (low priority) with the scenario when it uses
shouldbemoreaggressive thanTCP (cid:3)ows ofregulardata
IP precedence value of 6 (high priority). In the former
traf(cid:2)c.Suchtransportmodi(cid:2)cationwillprioritizeBGPtraf-
case,BGPtabletransferisnotimpacted. Inthelattercase,
(cid:2)cwhose(cid:3)owwilllesslikelybackoffduringcongestion.
WREDcannotprotectBGP traf(cid:2)cresultinginsimilarper-
formanceasinFigure3(b)withoutWRED.Thisillustrates
7 Conclusion
the importance of policing the IP precedence marking on
packets,sothatattackpacketsaretreatedwithlowerprior-
ity.WealsofoundthatWREDcanpreventsessionresetfor Attacks against the Internet infrastructures such as
low-priorityattacktraf(cid:2)c. routerscanhavedevastatingglobalimpactonnetworksta-
Class-based queueing and traf(cid:2)c marking: Today’s bility and robustness. A fundamentalweakness in today’s
routers generally support packet marking and class-based Internetis that the controlplaneor routingpackets by de-
13faultisnotprotectedfromothertraf(cid:2)c. Thus,dataconges- [7] J. Aldridge and A. Vural. A (cid:2)rst look at Saturday’s MS-
tion due to either intentional attacks or unintended traf(cid:2)c SQLwormasseenbyBGPactivityrecordedbyRISproject.
burstscanadverselyimpactroutingsessions. Inthiswork, RIPE44Meeting,January2003.
we examine the impact of low-rate TCP-targeted DoS at- [8] P.Almquist. TypeofServiceintheInternetProtocolSuite.
RFC1349,July1992.
tacksonBGP.Suchattackscanbelaunchedremotelywith-
[9] K.G.Anagnostakis,M.Greenwald,andR.S.Ryger. Mea-
out access to routers. Using detailed experimentation, we
suringNetwork-internalDelaysusingonlyExistingInfras-
show that routers using default con(cid:2)gurations are vulner-
tructure. InProc.IEEEINFOCOM,2003.
able to such low-rate attacks. The attacked BGP session
[10] G. Appenzeller, I. Keslassy, and N. McKeown. Sizing
can suffer severe impact in the form of session reset and
RouterBuffers. InProc.ACMSIGCOMM,2004.
increased convergencedelays, resulting in global network
[11] G.Appenzeller,N.McKeown,J.Sommers,andP.Barford.
instability,unreachabledestinations,anddataplaneperfor- RecentResultsonSizingRouterBuffers. InNetworkSys-
mance degradation. Moreover, we illustrate that coordi- temsDesignConference,2004.
natedlow-rateattacksarefeasiblefrommultipleend-hosts, [12] S.M.BellovinandE.R.Gansner.UsingLinkCutstoAttack
furtherraisingthedetectiondif(cid:2)cultygivenevenlowerin- InternetRouting. ATTResearch,Tech.Rep.,2004.
dividualattack (cid:3)ow rate. As defensemechanisms, we ad- [13] H.BurchandB.Cheswick. TracingAnonymousPacketsto
vocatepreventiontechniquestoeliminatethepossibilityof TheirApproximateSource. 2000.
anyDoSattackswhichexploittraf(cid:2)ccongestiontoimpact [14] Y.Chen,Y.-K.Kwok,andK.Hwang.FilteringShrewDDoS
Attacks Using A New Frequency-Domain Approach. In
routing protocols. Using testbed experiments we demon-
Proc.IEEELCNWorkshoponNetworkSecurity,2005.
strates the effectiveness of such solutions to prevent low-
[15] Cisco Systems. Weighted Random Early Detection
rateattacks.
(WRED),1998.
[16] CiscoSystems. NSA/SNACRouterSecurityCon(cid:2)guration
Acknowledgements Guide,2001.
[17] Cisco Systems. BGP Nonstop Forwarding (NSF) Aware-
ness,2005.
We would like to thank the anonymous reviewers for
[18] CiscoSystems. CiscoSecurityAdvisory: TCPVulnerabili-
theirhelpfulcomments.WeareparticularlygratefultoDan tiesinMultipleIOS-BasedCiscoProducts,2005.
Pei,JenniferRexford,andAmanShaikhfortheirinsightful [19] CiscoSystems. Con(cid:2)guringCommittedAccessRate,2005.
comments.SuggestionsfromJonAndersen,XuChen,Evan [20] CiscoSystems. Class-BasedPolicing,2006.
Cooke, Ranga Vasudevan, and Kevin Borders help signif- [21] J.Cowie,A.Ogielski,andB.Premore. InternetWormsand
icantly improve the presentation of the paper. Our work GlobalRoutingInstabilities. InProc.SPIE,2002.
alsobene(cid:2)tedfromthefeedbackofAlbertGreenberg,Tom [22] S.Floyd and V. Jacobson. Random Early Detection gate-
scholl, Jean-Franois Le Pennec, Leonard Ciavattone, Xi- ways for Congestion Avoidance. IEEE/ACMTransactions
onNetworking,1993.
angqunLiu,AswatnarayanRaghuram,andMarkLyn. Our
[23] V. Gill, J. Heasley, and D. Meyer. The Generalized TTL
workwouldnothavebeenpossiblewithoutthededication
SecurityMechanism(GTSM). RFC3682,February2004.
from the support staff of the Wisconsin Schooner router
[24] N.Hu,L.E.Li,Z.M.Mao,P.Steenkiste,andJ.Wang. A
testbed. This work was supported in part by the National
MeasurementStudyofInternetBottlenecks. InProc.IEEE
ScienceFoundationunderthegrantCNS-0430204.
INFOCOM,2005.
[25] JuniperNetworks.Bestcommonpracticesforhardeningthe
infrastructure,2002.
References
[26] S.Kent,C.Lynn,andK.Seo. SecureBorderGatewayPro-
tocol(Secure-BGP).IEEEJ.SelectedAreasinCommunica-
[1] clockdiff. http://www.linuxforum.com/man/ tions,2000.
clockdiff.8.php. [27] A. Kuzmanovic and E. W. Knightly. Low-Rate TCP-
[2] GNU Zebra-routing software. http://www.zebra. TargetedDenialofServiceAttacks(TheShrewvs.theMice
org. andElephants). InProc.ACMSIGCOMM,2003.
[3] RISRawData. http://www.ripe.net/projects/ [28] C.Labovitz,A.Ahuja,andF.Jahanian.ExperimentalStudy
ris/rawdata.html. of Internet Stability and Wide-Area Network Failures. In
[4] Schooner User-Con(cid:2)gurable Lab Environment. Proc.International Symposium on Fault-Tolerant Comput-
http://www.schooner.wail.wisc.edu/ ing,June1999.
index.php3?stayhome=1. [29] C. Labovitz, R. Malan, and F. Jahanian. Internet routing
[5] UniversityofOregonRouteViewsArchiveProject.http: stability. IEEE/ACMTrans.Networking,6(5):515(cid:150)528,Oc-
//www.routeview.org. tober1998.
[6] A.Akella,S.Seshan,andA.Shaikh. AnEmpiricalEvalu- [30] X. Luo and R. K. C. Chang. On a New Class of Pulsing
ationofWide-AreaInternetBottlenecks. InProc.Internet Denial-of-Service Attacks and the Defense. In Proc. Net-
MeasurementConference,2003. workandDistributedSystemSecuritySymposium,2005.
14[31] R.Mahajan,S.Floyd,andD.Wetherall. ControllingHigh-
BandwidthFlowsattheCongestedRouter. InProc.Inter-
nationalConferenceonNetworkProtocols,2001.
[32] R. Mahajan, N. Spring, D. Wetherall, and T. Anderson.
User-levelInternet PathDiagnosis. InProc.ACMSympo-
siumonOperatingSystemsPrinciples,2003.
[33] Z. M. Mao, J. Rexford, J. Wang, and R. Katz. Towards
anAccurateAS-levelTracerouteTool. InProc.ACMSIG-
COMM,2003.
[34] J. Ng. Extensions to BGP to Support Secure Origin
BGP(soBGP).IETFDraft:draft-ng-sobgp-bgp-extensions-
01.txt,November2002.
[35] Nmap(cid:150)Network Mapper. http://www.insecure.
org/nmap/.
[36] J. Padhye and S. Floyd. Identifying the TCP Behavior of
WebServers. InProc.ACMSIGCOMM,2001.
[37] V.N.PadmanabhanandL.Subramanian. AnInvestigation
of Geographic Mapping Techniques for Internet Hosts. In
Proc.ACMSIGCOMM,2001.
[38] PlanetLab. http://www.planet-lab.org.
[39] Y.RekhterandT.Li. ABorderGatewayProtocol4(BGP-
4). RFC1771,March1995.
[40] R. Richmond. Firms Join Forces Against Hackers. Wall
StreetJournal,March28,2005.
[41] RyanMcDowell.ImplicationsofSecuringBackboneRouter
Infrastructure. NANOGMeeting,May2004.
[42] S. R. Sangli, Y. Rekhter, R. Fernando, J. G. Scudder, and
E.Chen.GracefulRestartMechanismforBGP.IETFInter-
netDraft,June2004.
[43] A.Shaikh,L.Kalampoukas,R.Dube,andA.Varma. Rout-
ingStabilityinCongestedNetworks: Experimentationand
Analysis. InProc.ACMSIGCOMM,2000.
[44] A.Shevtekar,K.Anantharam,andN.Ansari.LowRateTCP
Denial-of-ServiceAttackDetectionatEdgeRouters. IEEE
CommunicationsLetters,April2005.
[45] N.Spring, R.Mahajan, and D.Wetherall. ISPTopologies
withRocketfuel. InProc.ACMSIGCOMM,2002.
[46] L. Subramanian, S. Agarwal, J. Rexford, and R. H. Katz.
CharacterizingtheInternethierarchyfrommultiplevantage
points. InProc.IEEEINFOCOM,2002.
[47] H.Sun,J.C.Lui,andD.K.Yau. DefendingAgainstLow-
rate TCP Attacks: Dynamic Detection and Protection. In
Proc.InternationalConferenceonNetworkProtocols,2004.
[48] F.Wang,L.Gao,J.Wang,andJ.Qiu. OnUnderstandingof
Transient Interdomain Routing Failures. In Proc.Interna-
tionalConferenceonNetworkProtocols,2006.
[49] L.Wang,D.Massey,K.Patel,andL.Zhang.FRTR:AScal-
ableMechanismforGlobalRoutingTableConsistency. In
Proc.InternationalConferenceonDependableSystemsand
Networks,2004.
[50] L.Wang,X.Zhao,D.Pei,R.Bush,D.Massey,A.Mankin,
S.F.Wu,andL.Zhang. ObservationandAnalysisofBGP
BehaviorunderStress. InProc.ACMSIGCOMMInternet
MeasurementWorkshop,2002.
15