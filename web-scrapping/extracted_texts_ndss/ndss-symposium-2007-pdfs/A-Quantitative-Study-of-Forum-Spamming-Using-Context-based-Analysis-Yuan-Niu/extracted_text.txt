A Quantitative Study of Forum Spamming Using Context-based Analysis
Yuan Niu†, Yi-Min Wang‡, Hao Chen†, Ming Ma‡, and Francis Hsu†
†University of California, Davis {niu,hchen,hsuf}@cs.ucdavis.edu
‡Microsoft Research, Redmond {ymwang,mingma}@microsoft.com
Abstract forums range from the older message boards and
guestbooks to the newer blogs and wikis. Since
forums are designed to facilitate collaborative content
Forum spamming has become a major means of search
contribution, they become attractive targets for
engine spamming. To evaluate the impact of forum
spammers. For example, spammers have created spam
spamming on search quality, we have conducted a
blogs (splogs) and have injected spam comments into
comprehensive study from three perspectives: that of
legitimate forums (See Table A1 in Appendix for
the search user, the spammer, and the forum hosting
sample spammed forums). Compared to the
site. We examine spam blogs and spam comments in
“propagandist” methods of web spamming through the
both legitimate and honey forums. Our study shows use of link farms2 [16], forum spamming poses new
that forum spamming is a widespread problem.
challenges to search engines because (1) it is easy and
Spammed forums, powered by the most popular
often free to create forums and to post comments in
software, show up in the top 20 search results for all
processes that can often be automated, and (2) search
the 189 popular keywords. On two blog sites, more
engines cannot simply blacklist forums that contain
than half (75% and 54% respectively) of the blogs are
spam comments because these forums may be
spam, and even on a major and reputably well
legitimate and contain valuable information.
maintained blog site, 8.1% of the blogs are spam1. The
Anecdotal evidence as well as our own experience
observation on our honey forums confirms that
indicates that spammers have successfully promoted
spammers target abandoned pages and that most
their web sites in search results through forum
comment spam is meant to increase page rank rather
spamming. To combat forum spamming and to gain
than generate immediate traffic. We propose context-
insight on effective defense mechanisms, we need a
based analyses, consisting of redirection and cloaking
comprehensive study of the problem, such as its scale
analysis, to detect spam automatically and to overcome
and its popular techniques.
shortcomings of content-based analyses. Our study
This paper reports our quantitative study of forum
shows that these analyses are very effective in
spamming. We examine the scale of forum spamming
identifying spam pages.
from three different perspectives: that of the search
user, the spammer, and the forum hosting site. We
1 Introduction
examine both spam blogs, and spam comments in
forums. For such a large-scale study, manual
Search engine spamming (or search spamming or identification of spam would be unscalable, so we need
web spamming [1]) refers to the practice of using automated approaches. Most existing automatic spam
questionable search engine optimization techniques to detection approaches are based on content analysis.
improve the ranking of web pages in search results. However, since spammers have discovered many ways
When search spamming started, spammers created a to circumvent content-based analysis (such as
large number of web pages with crafted keywords and plagiarized legitimate content, redirection3, and
link structures to promote the ranking of their web sites cloaking4), we propose context-based analyses of
in search results. As search engines develop more redirection and cloaking.
sophisticated techniques to identify spam web pages,
spammers are moving towards more fertile
2 A link farm consists of a group of sites using specific linking
playgrounds: web forums. We define a web forum as a structures to boost rankings of one or more pages in the farm.
web page where visitors may contribute content. Web 3 Redirection changes the user’s final destination or fetches dynamic
content from other web sites.
4 Cloaking serves different content to different web visitors. For
1 We detected only redirection spam, so the actual percentage of example, it may serve browsers a page with spam content while
spam blogs could be much higher. serving crawlers a page optimized for improving ranking.1.1 Three perspectives of forum spamming based approach that uses URL-redirection and
cloaking analysis. Our work was primarily motivated
First, we examine forum spamming from the by two key observations:
search user’s perspective: when a user searches • Many spam pages use cloaking and
forums, how much spam shows up among the top redirection techniques [1,4] so that search
results? To answer this question, we search for 190 top engines see different content than human
keywords in forums powered by nine most popular users. A common technique is to serve page
forum programs. We will describe our findings in content that the browser will dynamically
Section 3.1.1. rewrite through script executions but the
Second, we examine forum spamming from the crawler will not. Our approach is to treat each
spammer’s perspective: we try to understand the page as a dynamic program, and to use a
spammer’s modus operandi. To this end, we set up “monkey program” [6] to visit each page with
three honey blogs, which should attract no legitimate a full fledged browser (so that the program
comments, and have collected 41,100 comments over a can be executed in full fidelity) while
year. We will analyze these spam comments in analyzing the redirection traffic.
Section 3.1.2.
• Many successful, large-scale spammers have
Finally, we examine forum spamming from the
created a huge number of doorway pages that
forum hosting site’s perspective: how many forums are
generate redirection traffic to a single domain
spam on a hosting site, and what typical techniques do
that serves the spam content. By identifying
spammers apply to avoid detection? We examine over
those domains that serve content to a large
20,000 blogs from four blog sites and will describe our
number of doorway pages, we can catch
findings in Section 3.2 and 3.3.
major spammers’ domains together with all
their doorway pages and doorway domains.
1.2 Context-based analysis
1.3 Contributions
To avoid exposing their spam domains directly
and being blacklisted by search engines, many
We make the following contributions:
spammers are creating doorway pages on free-hosting
• We conduct a comprehensive, quantitative
domains and using their URLs in comment spamming.
study of forum spamming. We examine this
When a user clicks a doorway-page link in search
problem from three perspectives: that of the
results, her browser is instructed to either redirect to or
search user, the spammer, and the hosting site.
fetch ad listings from the actual spam domain or
advertising companies that serve the spammer as a • To overcome the limitation of content-based
customer. For example, the comment-spammed URL spam detection, we propose context-based
http://mywebpage.netscape.com/fendiblog/fendi- detection techniques that use URL redirection
handbag.html redirects to the well-known domain tracing and cloaking analysis. We show that
topsearch10.com. our context-based detection is effective in
Many spammers set up doorway pages on free identifying spam pages automatically.
forum hosting websites such as blogspot.com, Particularly, the two domains of a prolific
blogstudio.com, forumsity.com, etc. Such doorway spammer, who created a large percentage of
pages are a form of spam blogs. For example, as of this spam on two blog sites, appear in the top
writing, http://seiko-diver-watch.blogspot.com results returned by our analysis tool.
appeared as the top Yahoo! search result for “Seiko
diver watch”, and http://forumsity.com/mobile/1/free- • Our study confirmed that forum spamming is
motorola-ringtone.html appears as the top MSN search a widespread problem. The observation on
result for “free motorola ringtone”. Figure 1 illustrates our honey forums confirms that spammers
the end-to-end search spamming activity involving target abandoned pages and that most
both spam blog creation and spam comment injection. comment spam is meant to increase page rank
To overcome the limitations of content-based rather than generate immediate traffic.
spam detection, we propose an orthogonal context-Spammed Pages
#3: Search-engine Spamming
“http://foobar.blogspot.com”
“http://foobar1.blogspot.com” Spammed Forum
…
Search Engine
“http://foobar.blogspot.com” Spammed
“http://foobar1.blogspot.com”
Spammer Message Board
…
Search Results
“http://foobar.blogspot.com” Spammed (1) http://foobar.blogspot.com
#2: Comment Spamming “http://foobar1.blogspot.com” Guestbook (2) http://GoodSite.com
… (3) http://foobar1.blogspot.com
(4) http://OKSite.com
…
Spam Blogs (Splogs) as Doorways
#4: User Clicking
http://good.blogspot.com Blogspot.com
http://foobar.blogspot.com
#5: URL Redirection Spammer Domain
http://foobar1.blogspot.com
Spammer’s content
#1: Splog Creation
(Usually advertisement)
http://blogstudio.com/good Blogstudio.com
http://blogstudio.com/foobar
http://blogstudio.com/foobar1
Figure 1: Spam Blogs (splogs) and Comment Spamming. #1: The spammer creates
splogs. #2: The spammer spams forums with the URLs of his splogs. #3: These splog
URLs are ranked high in search results. #4: The search user clicks the splog URLs in the
search results. #5: The splogs redirect the user to the spammer domain.
syndicators and web-analytics servers, may crowd the
Top Domain view because they serve a large number
2 Redirection-based spam detection
of non-spam URLs. To filter out the noise, we scanned
the top one million (mostly non-spam) click-through
2.1 URL redirection tracing and analysis URLs [6] to obtain a “known-good whitelist” of top
third-party domains and filtered them out from the Top
Our context-based spam detection process starts Domain view. The remaining ranked Top Domain list
with the collection of a list of “URLs of interest”. Such is then used to prioritize manual investigation. Once a
URLs can be gathered from spammed forums, website third-party domain is determined to be a spammer
and blog hosting sites, or search results, etc. We then domain, it is added to the “known-bad blacklist” and
feed the list of URLs to the Strider URL Tracer [5]. will be excluded from future Top Domain view so that
The tracer provides a key functionality called the Top newer but smaller redirection receiver domains are
Domain view: given a list of (primary) URLs, the exposed near the top. All doorway URLs associated
tracer launches an actual browser to visit each URL with a blacklisted domain are labeled as high-potential
and records all secondary URLs visited as a result. At spam URLs and will be referred to as redirection
the end of the batched scan, the Top Domain view spam. How such information is utilized in a search
provides the list of third-party domains that received ranking algorithm depends on each individual search
secondary-URL traffic and rank them by the number of engine. We note that our approach can be viewed as a
primary URLs that generated traffic to them. If the combination of behavior-based and signature-based
input is a list of highly suspicious spam URLs (such as spam detection: Top Domain analysis is behavior-
those collected from a spammed forum), the Top based, while third-party domain blacklisting is
Domain view highlights those behind-the-scenes signature-based.
spammer domains that are associated with a large It is possible that some of the legitimate ads
number of doorway URLs. syndicators may have a significant number of
If the input consists of a mix of spam and non- spammers among their customers, in which case their
spam URLs, certain web sites, such as legitimate ads domains are removed from the whitelist so that theirredirection traffic remains present in the Top Domain known-bad domains, we scan it twice with anti-
view. For those ads syndicators that embed their client cloaking on and off, respectively, and take a diff of the
IDs in the redirection URLs (e.g., resulting two URL redirection lists. If there is a
googlesyndication.com), the tracer provides a second- significant discrepancy, the URL is highlighted for
level grouping and ranking of primary URLs by client manual investigation. Once the URL is confirmed to be
IDs. Doorway URLs associated with a blacklisted spam, its associated spam domain(s) are added to the
client ID are also referred to as redirection spam in this blacklist and used by all future anti-cloaking scans to
paper. identify similar URLs associated with the same
spammer.
2.2 Cloaking
3 Analysis of forum spam
To achieve effective search spamming and evade
spam detection, spammers are increasingly using 3.1 Comment spam
sophisticated cloaking techniques, which serve
different content to different visitors. Crawler-
3.1.1 Top forums and top search keywords. In this
browser cloaking is intended to fool the search engines
section, we examine forum spamming from the search
into giving the spam URLs high ranks, while allowing
user’s perspective: how likely will the search user
spammers to serve ad pages that do not deserve the
encounter spam in the forum search results? Since it is
high ranks to the users. The cloaking server either
difficult to select a set of top forums objectively
provides different page content based on the User
because forums cover very diverse topics, we selected
Agent field or known crawler IP addresses, or provide
top forum software programs instead. We chose nine
pages that contain scripts that will rewrite the page
of the most popular forum programs: WWWBoard,
content (since most crawlers do not execute scripts,
Hypernews, Ikonboard, Ezboard, Bravenet, Invision
they will not see the rewritten content, while most
Board, Phpbb, Phorum, and VBulletin.
browsers will execute the scripts to render the rewritten
We created a list of 190 top keywords using
content to users).
popular tags from directories like
Click-through cloaking, a new and lesser-known
http://technorati.com, http://weblogs.com,
technique, attempts to fool human spam investigators
http://metafilter.com, and http://icerocket.com as well
and automatic spam-detection tools that directly visit
as lists of commonly spammed terms from
the spam URLs instead of clicking through search
http://codex.wordpress.org. Using both Google and
results. It is primarily based on browser referrer
MSN, we collected the top 20 results from searches for
checking and can be done in two ways: if the
all the pairs of top keywords and top forum program
spammers own the website that hosts the spam URL,
names. To identify heavily spammed forums, we
they can perform a server-side check of the Referer
looked for sites that appeared in the search results for
field in the HTTP header and serve different pages
different keywords as well as sites whose pages
based on that. If the spam URL resides on a free
appeared multiple times in the results for a single
hosting website, the spammer can serve a page
keyword.
containing a script that performs a client-side check of
the browser document.referrer object and displays Table 1: Most Heavily Spammed Forums
different pages based on that. For example, this spam Forum Pages Keywords
URL http://gucci-handbag.bigcityhandbags.com/ http://fs.fed.us/cgi- 175 102
sondra-roberts-squared/song-titles-with-handbag/ was bin/HyperNews_mm/get/mmfor
umA.html
doing both checks: it used HTTP 302 to redirect to
topsearch10.com if the HTTP request came with the http://www.comm.fsu.edu/inter 134 82
right Referer field; otherwise, it served a client-side active/forum/
check script that used document.write() to display a
http://www.usra.edu/phorum 119 94
bogus “Account is suspended” page if the check
suggested that the visit did not come from a search http://classicauthors.net/messa 117 97
geboard/list.php?f=1
click-through. (See Figure A1 in Appendix for more
details.) http://samba.eecs.umich.edu/p 105 79
We have incorporated anti-cloaking techniques horum/list.php?2
into the URL Tracer by making every visit from the http://phorum.nettwerk.com/ 101 73
tracer appear to come from a search click-through for
both server-side and client-side referer checks.
Table 1 shows the most heavily spammed forums,
Furthermore, we use a diff-based technique to turn
identified by the total number of keywords whose
spammers’ cloaking activities against themselves: for
search results contain the forum’s URL, and by the
every suspicious URL that does not redirect to anytotal number of unique pages from the forum in the 2005), ilium focused on mythology (final post: January
combined Google and MSN search results. Even 18, 2006), and yabi was an online diary which
forums on government sites were not immune from contained no useful information (final post: December
spamming, as shown in Table 2. In both Google and 5, 2005). We configured each to be as open for
MSN search, we found spammed forums within the top commenting as possible, e.g., no moderation and no
20 search results for each type of the top forum keyword blacklist. To attract spammers, we pinged
software for 189 of the 190 keywords (with “palm- http://rpc.pingomatic.com each time when we created a
texas-holdem-game” being the only exception). This post so that our URL appeared on the list of recently
shows that spam has significantly affected forum updated blogs at various sites. We also linked the
search users. blogs to each other and provided one incoming link
from a legitimate blog already indexed by several
Table 2: Spammed Forums on Government
search engines. To date, the three honey blogs have
Sites
received only two legitimate comments, among a total
Forum Software
of 41,100 comments. We define a “post” as the content
http://giscouncil.oshpd.ca.gov/viewf PhpBB that the blog owner adds. “Comments” are any
orum.php?f=2&sid=9c8902ab2604e
contributions made to the post through use of the
74f29f30eb1abf3d64b
comment form, trackbacks, or pingbacks. Trackbacks
http://www.deltastate.gov.ng/www WWWBoard are pings sent to a user-specified URL when a blog
board/wwwboard.html post is published. The trackback appears on the
http://www.hants.gov.uk/forum/iko Ikonboard comment page of the user specified URL as a comment
nboard.cgi?s=8f5b05787d185c281f that contains the URL of the blog post. Pingbacks are
208403dd9dd79d;act=ST;f=12;t=5 automated pings sent to every URL within a blog post.
04;&#top
It too appears on the comment page of the URLs
http://mdk.kinmen.gov.tw/phorum3 Phorum specified, as long as those sites also support pingbacks.
32c/
Temporal analysis. Figure 2 shows the number of
accumulative comments received by each of the three
3.1.2 Honey blogs. We set up three honey blogs honey forums during the first 339 days, from
powered by Wordpress on September 25, 2005 and September 25, 2005 to August 30, 2006. The majority
posted at irregular intervals. The forum litlog contained of the comments received by each honey blog arrived
quotations from literature (final post: December 7, after we stopped posting content. For example, yabi,
Accumulated Comment Totals by Day
35000
32500
30000
27500
25000
22500
20000
17500
15000
12500
10000
7500
5000
2500
0
0 25 50 75 100 125 150 175 200 225 250 275 300 325
Day
detalumuccA
stnemmoC
latoT
ilium_total
litlog_total
yabi_total
Figure 2: Accumulated comments received by each of three honey forumsthe most popular of the three honey blogs, received domain filldirect.com was behind 259 (24%) cloaked
33,954 comments in its first 339 days but the majority splogs.
of comments were received after March 2006 (starting 3.2.2 Blogspoint analysis. Blogspoint.com is a much
from Day 188). On its busiest day (August 2, 2006, smaller blog site. On August 23, 2006, we extracted
day 311), yabi received 3,142 new comments and scanned its entire 4,714 blogs from their
distributed over 21 posts. By August 30 (day 339), “memberlist” page. Our redirection analysis identified
ilium amassed a total of 1,432 comments and litlog 3,535 (75%) pages as spam. Among the 3,535 spam
5,714 comments. Ilium and litlog, which we updated pages, 2,166 redirected to finance-web-search.com and
less regularly, did not observe a dramatic increase in 917 redirected to casino-web-search.com. These top
comments until well after 200 days after their creation. two third-party domains were registered by the same
This supports the observation that spammers target spammer with a Russian address, who most likely
abandoned pages and that most comment spam is created these 3,083 splogs (65% of the entire 4,714
meant to increase page rank, not to generate immediate blogs and 91% of the 3,398 identified splogs). Because
traffic. this spammer did not use cloaking, the cloaking
Figure 2 shows the rapid growth of comment totals percentage was much smaller than the blogspot
for each blog. Yabi’s growth was the most prolific, but number: only 3.9%, or 131 URLs.
all three clearly show that the bulk of comments were
received at increasingly high rates in the last 30 days. Table 3: Number of Spam Blogs at Four
In yabi’s case, half of its total comments were received Blog Hosting Sites
in the last 30 days, and the majority of comments for Blog Host Examined Spam % of URLs
ilium and litlog came in this time period as well. URLs URLs Spam using
It is worth noting that the amount of spam Cloaking
continued to grow faster after the last day in Figure 2.
Blogspot 13,389 1,091 8.1% 652
In the 10 days between August 30 and September 9
(day 339 – 349), yabi received 3,449 new comments, Blogspoint 4,714 3,535 75% 131
almost 10% of the total comments received; ilium
Blogstudio 369 198 54% 0
gained 305 new comments, 17.3% of its total; and
litlog gained 1,081 comments, 16% of its total. The
Blogsharing 99 82 83% 0
increased spam rate as these blogs got older could be
because spamming had increased overall on the web or
because spammers had identified these three blogs as 3.2.3 Blogstudio analysis. Blogstudio.com is a lesser-
“abandoned.” known blog site, but its blog URLs appeared in a large
number of spammed forums. Because some of these
3.2 Spam blogs and cloaking analysis URLs had appeared among top query results at major
search engines, we adopted the following sampling
In this section, we analyze sample blogs from method: we issued a “site:blogstudio.com” query to
three different blog sites --- blogspot.com, MSN Search, retrieved the top 1000 results, and
blogspoint.com, and blogstudio.com --- to evaluate the extracted 369 unique blogs. Our analysis identified 198
prevalence of splog doorways and cloaking. The (54%) blogs as redirection spam. The same major
numbers for spam that we report in the following are blogspoint spammer owned 184 of these splogs (50%
lower bounds because we only investigated spammer of all the sampled blogs and 93% of all the redirection
domains that received secondary traffic from a spam), with 130 redirecting to http://finance-web-
significant number of primary URLs (see the search.com and 54 redirecting to http://casino-web-
discussion on Top Domain view in Section 2.1). search.com. None of these splogs used cloaking.
3.2.1 Blogspot analysis. Blogspot.com, or eBlogger, 3.2.4 Summary. Table 3 summarizes the number of
is one of the most popular blog hosting sites. We splogs at the above three blog hosts (the table also
randomly sampled 1% of the 1,749,150 blogspot shows splogs at Blogsharing, which we will discuss in
profile pages created in July of 2006 that contained at Section 3.3). Although only fewer than 10% of the
least one blog link, and extracted all the blog links sampled blogspot URLs were identified as redirection
from these profile pages. In this way, we collected spam, the fact that we could find over a thousand
19,271 blogspot URLs, of which 5,882 (31%) had been splogs by sampling only 1% of the profiles created in
removed. Among the remaining 13,389 active blogs, one month suggests that the total number of redirection
our redirection analysis identified 1,091 (8.1%) pages splogs could be in the millions. The surprisingly high
as spam. Among the 1,091 spam blogs, 652 (60%) percentage of splogs using cloaking (3 out of every 5)
used click-through cloaking, and the top third-party suggests that blogspot.com might have been actively
identifying and removing less sophisticated spam, butspammers who used click-through cloaking might have http://www.google.com/url?q=http://213.190.10.80/
successfully evaded detection. This demonstrates the chase.com/index.html appeared in an actual phishing
importance of using anti-cloaking techniques in spam email targeting the Chase Manhattan Bank. Another
detection and investigation. universal redirector http://rds.yahoo.com/_ylt=/*[any
Our analysis showed that smaller blog sites were URL] is also starting to get abused by email spammers.
heavily spammed by redirection spammers: in both During our manual investigation of comment
blogspoint and blogstudio, more than half (75% and spam, we noticed that a few universal redirectors
54% respectively) of the analyzed blogs were hosted on university and government websites were
redirection spam. A single spammer created an used by some spammers as (a different form of)
overwhelmingly large percentage (over 90%) of the doorway URLs to redirect to spammer domains;
splogs as doorways. His two spam domains were examples included http://www.usaid.gov/cgi-bin/
exposed prominently at the top of our Top Domain goodbye?http://catalog-online.kzn.ru/free/funny-
view, which convincingly demonstrates the ringtones/ (which appeared as the second result of a
effectiveness of our approach. Yahoo query for “funny ringtone”) and
http://www.library.drexel.edu/cgi-bin/r.cgi?url=http://
3.3 Second-level spam blogs replica-watches.20six.co.uk. By searching through the
forums where these URLs were comment-spammed,
Blogsharing.com is another smaller blog site. Its we were able to find 23 universal redirectors that were
spam blogs started appearing in top-10 search results in used by spammers, as shown in Table A2 in Appendix.
August 2006. Between August 23 and September 4, we As of August/September 2006, six of them had been
collected 99 blogs from its “recently registered users” disabled but the other 17 remained active.
pages and our analysis identified 42 of them as Although many of these redirectors appear to have
redirection spam. In addition, we observed other tens legitimate uses, the website owners should weigh the
of blogs that appeared to be created by the same redirectors’ benefits against their potential abuse. As
spammer and shared the same format: the blog pages hinted by the partially encoded spam URL found in the
themselves were not doorways, but they contained 9th universal redirector example, the spammer could
spam URLs in the midst of junk text that redirected to have encoded the entire non-bold-face part of the URL,
the same spammer domain. For example, this blog thus completely hiding the “spammy part” of the spam
http://www.blogsharing.com/undangstrtresda/ URL. (Search spamming could still be achieved
contained the following three spam URLs: through the anchor text not shown here.) Furthermore,
http://plumbers-plumbing.com, http://the-plumber.info, as we will discuss in Section 4.2, many of the
and http://smartplumbers.info, all of which redirected comment-spammed URLs are malicious, so an
to http://1rrk.com/plumber. Essentially, these “second- innocent universal redirector on a legitimate web site
level spam blogs” played the same role as a spammed may serve inadvertently as an entry point through
forum: they provided links to spam URLs to improve which malware spreads to many vulnerable machines.
their search ranking by exploiting link-counting
algorithms that search engines use. 4.2 Malicious spam URLs
By first extracting links from each of the blogs and
then performing redirection scan and analysis on those A previous study [6] shows that a small percentage
links, we identified another 40 spam blogs, each (0.071%) of the top one million URLs based on click-
containing a few plumber-related links. In total, we through counts at a search engine were malicious; they
found 58 unique plumber-related links, all of which downloaded javascript code that attempted to exploit
redirected to http://1rrk.com/plumber. So the total unpatched browser vulnerabilities on the visiting
number of splogs becomes 82, which account for 83% machines. A natural question to ask is whether
of the 99 sampled blogs. malicious website operators are using comment
spamming techniques to boost the ranking of their
4 Other observations URLs. To answer this question, we investigated eight
malicious URLs that appeared among the top-30 search
results at the three major search engines between July
4.1 Universal redirectors
and September 2006. For each URL, we used the
search engine to try to find a forum that had been
We use the term universal redirectors to refer to
spammed with the URL. If we could find such a forum,
legitimate websites’ URLs that accept and redirect
we then extracted all URLs spammed on the same
visiting browsers to arbitrary third-party URLs. A
forum page and scanned them to see if we could
well-known universal redirector is
identify additional malicious URLs. The results are
http://www.google.com/url?q=[any URL], which has
shown in Table 4.
been used by many phishers to make their phishing
URLs look less suspicious; for example, this URLTable 4: Malicious URLs in Spammed Forums
Malicious URLs Spammed at (cached pages of) these # Malicious
forums URLs (%) of #
Spam URLs
1 http://eclatlantus.yiffyhost.com/fe http://members.tripod.com/deportivolap 688 (47%) of 1,463
ssee-progenco.html igeon/guestbook.htm
2 http://humorrise.sitesled.com/bur http://sgtrois.webator.net/?2004/11/02 6 (18%) of 33
berry-handbag-supplier- /4-un-cd-gratuit-offert-par-ladisq
wholesale.html
3 http://alexandrsultz.sitesled.com/c http://www.no- 164 (49%) of 338
hloe/handbag.html nation.org/article347.html
4 http://nowodus.tripod.com/new- http://aose.ift.ulaval.ca/modules.php?o 174 (14%) of 1,280
mexico-lottery.html p=modload&name=News&file=article&si
d=137
5 http://lermon.t35.com http://68.15.204.73/ngallery/albums/3/ 22 (26%) of 85
1.aspx
6 http://granboggy.xoompages.com Not comment-spammed; used link farm N/A
/download-porn-movie.html
7 http://acura.elkam.info Not comment-spammed; used referrer log N/A
spamming
8 http://pertest.info/nokia/Nokia- Not comment-spammed; used link farm N/A
ringtone.html
on the same forum page. Scan results showed that 14%
We found that, for five of the eight malicious to 49% of these related URLs were also malicious. In
URLs, we were able to locate forums that were total, from this small set of five “seed URLs”, we were
spammed with each of these URLs. The remaining able to find 1,054 unique, comment-spammed
three URLs appeared to use different search spamming malicious URLs, most of which were doorway URLs
techniques: URLs #6 and #8 used a farm of malicious residing on free-hosting websites. Figure 3 illustrates
URLs linking to each other, while URL #7 used the distribution of malicious URLs among the top-20
referrer log spamming [25]. domains according to the number of malicious URLs
For each of the five comment-spammed URLs, we hosted. Clearly, several of these domains are heavily
found many other seemingly related URLs spammed targeted by exploiters.
140
120
100
80
60
40
20
0
t35 s. itc eo slm 5e 0d. 1c xmo oem ogs m. pc ao 5g 0m e 0s. 0c mo em gs o. rc gfo rm ee. tc rio p pm o od r. kc y fo rh eom est h. oc so tpm ro. bc ato cm ta e 1v k 0e. c 0in ti me et
e
fs. g rc s efo r ee hm e os5 t.c oo nlim ne 2. 7c 5o mm b 2. 5c 0o f arm ne ae l. lc oo tv eem r ez n. pc oo sm be es c. plc ya bo c em re frd. ec eo hm ost.co pm hp5.cz
Domains hosting malicious URLs
no
detsoh
sLRU
suoicilam
fo
rebmuN
niamod
hcae
Figure 3: Number of comment-spammed malicious URLs hosted on each top-20 domainsTable 5: Distribution of Malicious Sub-domains
t35 sitesled tripod porky 100megs 250free anal php5 1access myopen
.com .com .com host free5 .com loverz .cz host.com web.com
.com .com .com
Kalovalex X X X X X X X
Maripirs X X X X X
Sadoviktor X X X X X X
Vinnerira X X X X X X
Footman X X X X X
ivan0505 X X X X X X X
Krukuduk X X X X X
Genianna X X X X
Brandoras X X X X X
Dandoras X X X
We also observed that many same-named PageRanks vary in a great range, whereas a spam site
malicious sub-domains existed on multiple domains. would likely violate the model and would have
Table 5 illustrates the distribution of the top-10 sub- supporters with mostly very low PageRanks. Metaxas
domains (in rows) across top domains hosting and DeStephano [16] also tried to identify spam sites
malicious sites (in columns) with “X” indicating that and their supporters, which they called ring leaders and
the sub-domain existed on the hosting domain as a their trust neighborhoods respectively. They examined
malicious site. We suspect that exploiters are using the problem of web spam from a propagandist point of
their account names as the sub-domain names so that view. To identify trust neighborhoods, they applied an
payment tracking can be portable across different anti-propagandistic technique called backwards
hosting domains: when a browser is redirected from propagation of distrust using initial nodes of known
one of these comment-spammed doorway pages to the untrusted sites and examined backlinks. Similar to
actual malicious websites, the sub-domain name in the these trust-based methods, our redirection analysis
HTTP Referer field indicates which spammer attracted essentially propagates distrust backwards from known
the traffic and should get paid. spammer redirection domains to the doorways pages
In addition, we found a total of 75 behind-the- that redirect to them.
scenes, malicious URLs that received redirection Content based approaches often use statistical
traffic from these thousands of doorway URLs and analysis of page content and link structure in
were responsible for the actual vulnerability-exploit combination with other techniques, such as machine
activities. In particular, the following three URLs were learning, to weed out spam sites. Fetterly, Manasse and
behind all five sets of malicious URLs: Najork [17] used a combination of several techniques
http://zllin.info/n/us14/index.php, http://linim.net/fr/? to flag spam sites. These techniques included
id=us14, and http://alllinx.info/fr/?id=us14. All three examining the URL properties and page content of the
domains share the same registrant with an Oklahoma site, forming clusters of pages with similar content, and
state address, whose owner appears to be a major measuring average amount of change of a given site.
exploiter involved in search spamming. Mishne, Carmel, and Lempel generated statistical
models using unigrams from sample text [18] to
5 Related work identify comment spam. To determine the probability
that a comment was spam, they compared two
Search engines detect web spam via several language models: one of the blog post content, and the
common approaches. One approach analyzes the link other of the comment and the target page pointed to by
structures to yield the metrics for trust. Google and the comment. Kolari, Finn and Joshi [3] presented a
Yahoo measured a site's trust (PageRank and machine-learning approach using features based on the
TrustRank) to determine its ranking within the search meta tag text, anchor text and tokenized urls for
results [1]. Also using this notion of trust, Benczur et support vector machines. Trained on data from
al. presented the idea of SpamRank, which used the technorati, a popular blog directory and search engine,
power law distribution as an intuitive model for how their classifier identified splogs with 88% accuracy.
links should be distributed over the Internet [13]. They They later analyze update notifications (pings) from
used a calculated PageRank for the target site and the blogs, and determined that 50% of blogs sending
PageRanks of that site's "supporters" to identify notifications to weblogs.com are splogs [21]. Our
outliers of the model. A legitimate site would likely fit context-based techniques are complementary to these
the model and would have supporters whose content-based techniques, and are immune to typicaltricks for circumventing content-based analysis, such same redirection lists but display different text to the
as plagiarized content, redirection, and cloaking. users and to the spam investigators.
Popular plugins to help bloggers protect their sites
include Akismet [22], Bad Behavior [23], and Spam 6 Conclusions
Karma [24]. Akismet is a web service that employs a
content-based approach. Each comment is sent to a Forum spamming is the new battleground between
central server for processing. Spam Karma determines spammers and search engines. Currently, spammers
a 'Karma' score for each comment based on content have the upper hand, as they have successfully
factors such as IP addresses, the HTML present, and promoted their web sites through spam blogs and
URLs contained. It also checks whether the poster is a comments. To help search engines defend against
registered user, the target post's age, the time taken to forum spamming, we have conducted a
post the comment, and frequency of the posts (first comprehensive, quantitative study of the problem. We
time posters contributing many comments vs. approved examined the problem from three different
regular posters). Spam Karma also relies on a real-time perspectives: that of the search user, the spammer, and
blacklist server for updates to IP and URL information. the forum hosting site. We have examined spam blogs
Bad Behavior targets spambots by examining the on several blog hosting sites and spam comments on
HTTP requests and the robot's behavior, particularly its our three honey blogs. Our study has shown that
compliance with “robots.txt.” These plugins help forum spamming is a widespread problem, as
willing and diligent forum owners to filter out spam in highlighted in the following observations:
their forums. By contrast, our context-based approach Each of the nine most popular types of forums is
can identify spam without requiring the cooperation spammed with all the 189 popular keywords, as
from forum owners, and therefore is useful to search evidenced by the fact that the spammed forums show
engines. up among the top 20 results from two major search
The diff-based cloaking detection method is engines.
similar in spirit to the diff-based hidden-resource Our three honey blogs showed consistent behavior
detection method used in the Strider GhostBuster of comment spammers. The observation on these blogs
rootkit detection tool [7]. Both methods turn the confirms that spammers target abandoned pages and
adversary’s devious activities against themselves by that most comment spam is meant to increase page
taking a diff of “the truth” and “the lie”: in rank rather than generate immediate traffic.
GhostBuster, “the truth” is the actual list of resources On two blog hosting sites – blogspoint and
and “the lie” is the list provided by the rootkits after blogstudio – more than half of the analyzed blogs are
they removed the resources they want to hide; in this spam (75% and 54% respectively). Even on blogspot,
paper, “the truth” is the actual page displayed to the a major and reputably well maintained blog site, 8.1%
users and “the lie” is the page displayed to spam of the blogs are spam.
investigators who do not click through search results. Among the eight malicious URLs that appeared in
Wu and Davison combined content and context top search results, five appeared in forum spam.
based analysis to identify web spam [15]. They built a Additionally, between 14% to 49% of the spam URLs
classifier for web spam by identifying pages using diff- collocated with these five URLs were also malicious.
based cloaking detection and using machine-learning To overcome the pitfalls of content-based spam
to discriminate based on extracted features from the detection, we proposed context-based spam detection
content of the page. Their crawl of over 4 million that looks for redirection and cloaking. Our study has
URLs from dmoz.org found 46,806 web spam pages shown that redirection analysis is very effective in
with 96.8% accuracy. They have also surveyed the use identifying forum spammers. For example, the two
of redirection as a technique for web spam [20], but do domains of a prolific spammer, who had created a
not accurately identify pages using JavaScript large percentage of spam on two blog sites, appeared at
redirection techniques since they use a standard the top in our analysis tool prominently. Cloaking is
crawler. In addition to the cloaking techniques another popular technique used by spammers. In
investigated by them, our tool also detects click- addition to the older crawler-browser cloaking, click-
through cloaking, a technique this is becoming very through cloaking is a new trick. To the best of our
popular among spammers. knowledge, we are the first to perform systematic
Breuel and Keysers [8] proposed using OCR analysis to evaluate the prevalence of click-through
(Optical Character Recognition) to capture the actual cloaking: on blogspot, 3 out of 5 splogs used this
rendered text and use it in place of HTML for deriving cloaking. Our study suggests that as blog sites start to
index terms in order to combat cloaking. This remove splogs more aggressively, spammers will
technique can potentially be incorporated into our diff- resort to cloaking more frequently to avoid detection.
based cloaking detection system to detect more
sophisticated cloaked spam that generates exactly the7 References [17] D. Fetterly, M. Manasse, and M. Najork. Spam, damn
spam, and statistics: using statistical analysis to locate
spam web. In Proceedings of the 7th International
[1] Zoltan Gyongyi and Hector Garcia-Molina. Web Spam
Workshop on the Web and Databases. 2004.
Taxonomy. In the First International Workshop on
[18] G. Mishne, D. Carmel, and R. Lempel. Blocking Blog
Adversarial Information Retrieval on the Web
Spam with Language Model Disagreement. In
(AIRWeb), 2005.
Proceedings of the First International Workshop on
[2] Alexandros Ntoulas, Marc Najork, Mark Manasse, and
Adversarial Information Retrieval on the Web
Dennis Fetterly. Detecting Spam Web Pages through
(AIRWeb), 2005.
Content Analysis. In Proc. International World Wide
[19] L. Page, S. Brin, R. Motwani, and T. Winograd. The
Web Conference (WWW), 2006.
PageRank Citation Ranking: Bringing Order to the
[3] Pranam Kolari, Tim Finni, and Anupam Joshi. SVMs
Web. Technical Report, Stanford University, 1998.
for the Blogosphere: Blog Identification and Splog
[20] P. Kolari, A. Java, and T. Finni. Characterizing the
Detection. In AAAI Spring Symposium on
Splogosphere. In Workshop on Weblogging Ecosystem:
Computational Approaches to Analysing Weblogs,
Aggregation, Analysis and Dynamics, WWW. 2006
March 2006
[21] 75% of new pings are spings (splogs)
[4] Baoning Wu and Brian D. Davison. Cloaking and
http://ebiquity.umbc.edu/blogger/?p=429 2005.
Redirection: A Preliminary Study. In the First
[22] Akiskmet. http://akismet.com
International Workshop on Adversarial Information
[23] Bad Behavior. http://www.homelandstupidity.us/
Retrieval on the Web (AIRWeb), May 2005.
software/bad-behavior/
[5] Yi-Min Wang, Doug Beck, Jeffrey Wang, Chad
[24] Spam Karma. http://unknowngenius.com/blog/
Verbowski, and Brad Daniels. Strider Typo-Patrol:
wordpress/spam-karma/
Discovery and Analysis of Systematic Typo-Squatting.
In Proc. 2nd Workshop on Steps to Reducing Unwanted [25] Referrer Spam. http://en.wikipedia.org/wiki/
Referrer_spam
Traffic on the Internet (SRUTI), July 2006.
[6] Yi-Min Wang, Doug Beck, Xuxian Jiang, Roussi
Roussev, Chad Verbowski, Shuo Chen, and Sam King.
Automated Web Patrol with Strider HoneyMonkeys:
Finding Web Sites That Exploit Browser
Vulnerabilities. In Proc. Network and Distributed
System Security (NDSS) Symposium, February 2006.
[7] Yi-Min Wang, Doug Beck, Binh Vo, Roussi Roussev,
and Chad Verbowski. Detecting Stealth Software with
Strider GhostBuster. In Proc. IEEE International
Conference on Dependable Systems and Networks
(DSN), June 2005.
[8] T. Breuel and D. Keysers. Round-Trip HTML
Rendering and Analysis for Testing, Indexing, and
Security. Extended abstract. In 7th IAPR Workshop on
Document Analysis Systems, February 2006.
[9] Ben Edelman and Hannah Rosenbaum. The Safety of
Internet Search Engines. May 12, 2006.
[10] Splog software from Hell.
http://ebiquity.umbc.edu/blogger/splog-software-from-
hell/.
[11] Z. Gyongyi, H. Garcia-Molina, and J. Pedersen.
Combating Web Spam with TrustRank, In Proc. of the
30th VLDB Conference, 2004.
[12] N. Eiron, K. S. McCurley, and J. A. Tomlin. Ranking
the Web Frontier. In Proc. International World Wide
Web Conference (WWW), New York, 2004
[13] A. Benczur, K. Csalogany, T. Sarlos, and M. Uher.
SpamRank – Fully Automatic Link Spam Detection. In
the First International Workshop on Adversarial
Information Retrieval on the Web (AIRWeb), May
2005.
[14] B. Wu and B. D. Davison. Identifying Link Farm
Pages. In Proc. International World Wide Web
Conference (WWW), 2005.
[15] B. Wu and B. D. Davison. Detecting Semantic
Cloaking on the Web. In Proc. International World
Wide Web Conference (WWW), 2006.
[16] Panagiotis Metaxas and Joseph DeStefano. Web Spam,
Propaganda and Trust. In AIRWeb 2005. May, 2005.Appendix
(a): Advertising page that browser users see when they click through search engine results
(b): Fake “Account is suspended” page that spam investigators see when they visit the URL directly,
without clicking through search results
(c): Page full of spammer-targeted keywords that crawlers see (or browser users see when they
access the cached page with scripting turned off)
Figure A1: A Click-Through Cloaking ExampleTable A1: Sample Spammed Forums
Types of Spammed Pages Sample URLs of Spammed Pages
Spammed Guest Books Blogsharing.com URLs spammed at
http://cc.msnscache.com/cache.aspx?q=3992631391091&lang=en-
US&mkt=en-US&FORM=CVRE3
Hometown.aol.com doorway URLs spammed at
http://cc.msnscache.com/cache.aspx?q=4025292423423&lang=en-
US&mkt=en-US&FORM=CVRE19
Spammed Forums Blogstudio.com URLs spammed at
http://cc.msnscache.com/cache.aspx?q=3920853991619&lang=en-
US&mkt=en-US&FORM=CVRE
Blogspot.com URLs spammed at
http://www.stat.ucla.edu/forums/read.php?f=325&i=21&t=15
Spammed Message Store.adobe.com universal redirector URLs spammed at
Boards http://cc.msnscache.com/cache.aspx?q=3919768655648&lang=en-
US&mkt=en-US&FORM=CVRE
Spammed Journals Blogspot.com URLs spammed at
http://cc.msnscache.com/cache.aspx?q=3962899993396&lang=en-
US&mkt=en-US&FORM=CVRE24
Spammed Galleries Blogspoint.com URLs spammed at
http://cc.msnscache.com/cache.aspx?q=4014541360829&lang=en-
US&mkt=en-US&FORM=CVRE35Table A2: Universal Redirectors Used by Comment Spammers
Sample Spam URLs That Used Universal Redirectors Redirector status
as of September,
2006
1 www.infosec.co.uk/page.cfm?HyperLink=http://replica-watches.20six.co.u Active
k
2 www.library.drexel.edu/cgi-bin/r.cgi?url=http://replica-watches.20six.co. Active
uk
3 web.grand-canyon.edu/redirect.php?url=http://pizdetc.50g.com/gambling Active
33.html
4 www.rit.edu/~ksa/cgi-bin/splinks/click.cgi?num=2&url=http://pizdetc. Active
50g.com/ultram27.html
5 www.tui.edu/research/Redirect.asp?ID=2572&url=http://pizdetc.50g.co Active
m/holdem17.html
6 www.ualr.edu/www/404/redirect.asp?id=28634&changeID=&action= Active
3&actionURI=http://pizdetc.50g.com/refinance13.html
7 www.3gsmworldcongress.com/page.cfm?HyperLink=http://waypossible.c Active
om/dr/cialis
8 www.ku.dk/default2.asp?src=http://theylook.com/dr/viagra Active
9 www.ny.com/cgibin/frame.cgi?url=http%3A%2F%2Fyourhandbook.com%2 Active
Fgambling%2Fcasino%2F
10 store.adobe.com/cgi-bin/redirect/n=14630?http://rme19-funny-ringtones Active
.blogspot.com
11 mentalhealth.about.com/gi/dynamic/offsite.htm?site=http://rme18-hum Active
our-ringtones.blogspot.com
12 adoption.about.com/gi/dynamic/offsite.htm?site=http://alourolvar.probo Active
ards92.com
13 big5.china.com/gate/big5/acelricmonolo.proboards91.com Active
14 www.aerointernational.de/index.php?http://bocalracta.proboards98.com Active
15 actifpub.com/jump.php?sid=489&url=http://basbooloer.proboards101.com Active
16 www.usaid.gov/cgi-bin/goodbye?http://xanax.anothervision.info Active (delay
before redirection)
17 www.ihs.gov/PublicInfo/Publications/Kids/safety/IHS_DisclaimerKids Active
_prod.cfm?link_out=http://waypossible.com/dr/casino
18 lternet.edu/shared/redirect.php?url=http://pizdetca.white.prohosting.com/tenua No longer active
te4.html
19 translate.google.com/translate?u=http://viagra.anothervision.info No longer active
20 www.buffalo.edu/redirect.cgi?s=eUB%20Home&l=Send%20a%20UB%20Postcar No longer active
d&u=http://pizdetc.50g.com/wager16.html
21 sedac.ciesin.columbia.edu/tg/redirect.jsp?url=http://pizdetc.50g.com/viagra21. No longer active
html
22 www.plymouth.edu/library/redirect.php?http://pizdetc.50g.com/keno39.html No longer active
23 chamber.columbia.mo.us/visitlink.asp?url=http://replica-watches.20six.co.uk No longer active