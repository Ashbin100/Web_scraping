Shedding Light on the Configuration of Dark Addresses
SushantSinha,MichaelBailey,andFarnamJahanian
DepartmentofElectricalEngineeringandComputerScience
UniversityofMichigan
AnnArbor,Michigan,48109
{sushant,mibailey,farnam}@umich.edu
Abstract andavailabilityofthesesystems. Asecurityapproachthat
alleviatestheseproblemsistocreateanon-productivehost
A popular approach to detecting and characterizing (also called a honeypot) and place it at an unused or dark
threatssuchaswormsandbotnetsinvolvestheuseofsac- address. Honeypotsarehostandnetworkresourcesthatdo
rificialhostcollectionscalledhoneynets. Thesecollections nothaveproductionvalueandsoanyinteractionwithahon-
are explicitly deployed to be scanned, compromised, and eypot is suspicious. For example, a honeypot deployment
used in attacks. Unfortunately, existing approaches to de- mightconsistofamailserverthatisconfiguredidenticalto
ploying honeynets largely ignore the problem of configur- a production mail server and placed nearby to detect pos-
ingoperatingsystemsandapplicationsonindividualhosts, sible intrusions against the real mail server. Because no
leavingtheusertoconfiguretheminamanualandoftenad legitimate clients are configured to use the honeypot mail
hocfashion. Inthispaper,wedemonstratethatsuchadhoc server, anytraffictoitistheresultofmaliciousactivityor
configurations are inadequate–they misrepresent the secu- misconfiguration.
ritylandscapeofthenetworkstheyaretryingtoprotectand Individual honeypots provide excellent visibility into
are relatively easy for attackers to discover. We show that threats that affect specific host and operating system con-
manually building configurations with good visibility and figurations. However, detecting threats quickly with only
resistancetodiscoveryishard,aseachnetworkhasitsown a few honeypots is difficult. In order to quickly capture
unique threat and vulnerability spaces, and the potential threat details, a number of commercial and non-profit or-
numberofhoststoconfigureinthehoneynetisquitelarge. ganizations [2, 34], academic projects [6, 22, 36, 37], and
Therefore,weneedautomatedsystemstoassistnetworkand tools [4, 25] have started monitoring large numbers of un-
securityadministratorsinbuildinghoneynetconfigurations. usedanddarkaddresses. Wecollectivelycallhoneypotsys-
We argue that honeynets with individually consistent hosts temsthatmonitormultipleunusedanddarkaddresseshon-
andproportionalrepresentationofthenetworkwillachieve eynets.
thetwodesiredgoalsofvisibilityintonetworkattacksand
Unfortunately,assystemshavemovedfromasinglehon-
resistancetodiscovery.Wedevelopanautomatedtechnique
eypottoanetworkofhoneypots,theproblemofdetermin-
basedonprofilingthenetworkandrandomsamplingtogen-
ing the configuration of these systems has largely been ig-
eratethesehoneynetconfigurations. Throughexperimental
nored. Asinglehoneypotiseasilyconfiguredwiththeop-
evaluation and deployment of configurations generated by
erating system and applications matching an existing pro-
ourtechnique, wedemonstratesignificantly morevisibility
ductionsystem. However,foralargenumberofaddresses,
andhigherresistancetodiscoverythancurrentmethods.
thenetworkadministratormustmakedecisionsaboutwhat
systemstheywanttoprotectandwhatattackstheywishto
observe. For example, a single academic network in this
1 Introduction studywith5,512hostshadover1,386uniquehostandnet-
work configurations (see Table 4), and over 3000 unused
The rapid growth in malicious Internet activity, due to addresses available for monitoring [11]. This effort is fur-
theriseofthreatslikeautomatedworms,viruses,andrecent ther complicated as the number of vulnerable services and
botslikeAgoBot[10],hasdriventhedevelopmentoftools potential attacks increase on the Internet. For example,
designed to protect host and network resources. The fun- Symantec documented 1,896 new software vulnerabilities
damental problem in instrumenting live (i.e., production) from July 1, 2005 to December 31, 2005, over 40% more
hosts is that such instrumentation affects the performance thanin2004[33]. Inspiteofthedifficultyofthetask,little
1workhasbeendoneonhowtoautomatehoneynetconfigu- • We develop a simple technique that achieves the two
ration,leavingadministratorstoperformthetaskmanually, criticalgoalsautomaticallyandweevaluatethistech-
andofteninagenericoradhocfashion. niquethroughnetworkmonitoringanddeploymentof
Inthispaper,weshowthepotentiallimitationsofgeneric honeynetsinproductionnetworks.
and ad hoc approaches to honeynet configurations, and
demonstrate that they lack visibility into network attacks. Theremainderofthispaperisstructuredasfollows:Sec-
As an example, Table 1 shows that the most popular ser- tion2discussesthecurrentstate-of-the-artinhoneynetcon-
vice on an example network is SSH, but attackers are fo- figuration, and Section 3 shows the limitations of ad hoc
cused primarily on nonexistent services such as Microsoft configurations. Section 4 provides the compelling reasons
SQL Server. The honeynets in this network report neither for automatically generating configurations, and discusses
ofthetwoasthemostcriticalsecuritythreat,indicatingNet- individualhostconsistencyandproportionalrepresentation
BIOS instead. As the example illustrates, these system do ofthenetworkasimportantpropertiesthatmakesuchacon-
notrepresenttheservicesrunningonthenetwork(i.e., the figuration. Section 5 describes our algorithm for honeynet
vulnerable population) and fail to capture the existing at- configuration and its evaluation. Section 6 concludes our
tacks observed at the network (i.e., the threat landscape). workwithdirectionsforfuturework.
Furthermore, we show that these honeynet configurations
presentveryunusualoperatingsystemsandserviceconfig- 2 Background
urationsinmanyproductionnetworksandaretriviallyeasy
to detect, avoid, and corrupt (i.e., fingerprint). However,
Thewayinwhichhoneynetsareconfiguredgreatlyim-
configuringhoneynetsisnottrivial,aswefindthatthereis
pacts their effectiveness. In an effort to understand how
lackofgeneralityinvulnerablepopulationsandthreatland-
honeynetsarecurrentlyconfigured,wehaveexaminedpub-
scapesovertimeandacrossnetworks. Furthermore,thepo-
liclyavailablehoneynetdeploymentdata.Wefindthatthese
tentialnumberofaddressestoconfiguremaybeverylarge
deploymentsareoftentiedwithaspecifichoneynettoolor
andtherefore,werequireautomatedprocessestoconfigure
technique. Each of these tools, in turn, has its own set of
ahoneynet.
configurationcapabilities. Oneofthemainfactorsthatdis-
In order to automatically generate honeynet configura-
tinguishes each of these honeypot systems is their level of
tions with the goals to provide visibility into the vulnera-
interactivity[31]. Interactivitydefinesthedegreetowhich
blepopulationandavoiddetection,wearguethathoneynets
ahoneypotbehaveslikearealend-hostsystem,asabroad
shouldbeconfiguredwithindividuallyconsistenthostsand
spectrumofend-hostbehaviorscanbeemulatedinorderto
proportionallyrepresentthesurroundingnetwork. Wepro-
captureincreasingamountsofattackdetails. Therefore,we
vide a simple, automated approach based on profiling the
groupthesedeploymentsbytheirlevelofinteractivityand
network and random sampling to generate honeynets with
discusstheconfigurationcapabilitiesofeachaswellastheir
individualhostconsistencyandproportionalrepresentation
limitations.
of the network. We evaluate our approach by applying it
On the lowest end of interactivity, a passive monitor
to live networks and deploying the configurations gener-
logs incoming traffic to unused addresses without any re-
ated. We find that the honeynets achieve the desired goals
sponse[22].Forexample,theTeamCymru[14]andMoore
ofprovidinganaccurateviewofthreatstothenetworksand
et. al. [22] have deployed passive monitors in unused ad-
resistance to discovery. For example, the honeynets rep-
dresses.Passivemonitorsdonotallowforanyresponseand
resentativetoacademicnetworksaccuratelyshowthatSSH
have no service configurations. Because they do not emu-
bruteforceattacksarethemostwidelyimpactingthreat,and
lateanyservices,theyprovidelimitedvisibilityintothreats
those representative to web server farms accurately show
andrequireadvancedtechniquestofingerprint[27].
webproxyattacksasthemostwidelyimpactingthreatdur-
Alight-weightTCPresponderreplieswithaTCPSYN-
ingtheperiodanalyzed.
ACK packet for every TCP SYN packet received on every
Tosummarize,themaincontributionsofthispaperare:
TCP port in order to recover the first payload from TCP
worms[6]. TheInternetMotionSensorproject[13]hasde-
• Weshowthatadhocconfigurationsdonotprovidevis-
ployedalightweightTCPresponderin28monitoredblocks
ibilityintothevulnerablepopulationorintothethreat
within18networks,withsizesoftheseblocksvaryingfrom
landscape, and they are highly unusual in many net-
/24 to /8 [5]. These systems emulate part of the network
works,causingeasydetectionandfingerprinting.
stack, accept incoming connections on all ports, but pro-
• Wejustifytheneedforautomaticconfigurationmeth- vide no application-level response. They provide minimal
ods and then identify visibility and resistance to fin- visibilityintoallapplications,butaretrivialtofind. Wecall
gerprinting as the two goals of such a configuration thisconfigurationAllTCPResponder.
system. Honeyd emulates network stacks of multiple hosts on asingle machine and has a plug-in system for service em- goalcanbeachievedonlyifthehoneynetsareconfiguredto
ulation modules [25]. The Brazilian Honeynet Team [32] representthenetworkandservices. Intheprevioussection,
deployed numerous sensors of sizes from /28 to /24 with we showed that the configuration of honeynets has largely
Honeyd,andtheGermanHoneynetTeamhasalsodeployed beenignoredbyexistingdeploymentsandtools.Inthissec-
a /18 honeyd sensor [20]. Finally, the French Honeynet tion, we argue that ignoring this problem is dangerous be-
Project [17] and the Norwegian Honeynet Team [23] have causelackofproperconfigurationimpactsboththevisibil-
also deployed Honeyd sensors. Honeyd has a great deal itythatthesehoneynetscanprovideaswellastheirability
of flexibility in honeypot configuration, enabling arbitrary toavoiddetection.
personalities to be specified for each host. We call the de-
fault Honeyd 1.1 configuration [31] Generic Honeyd. To 3.1 Impactofadhocconfigurationonvisibility
simplify configuration of large addresses, Honeyd allows
declaration of default host configuration and ties it to all In the previous section, we observed that, while some
darkaddressesthathavenotbeenassignedanyhostconfig- flexibility exists in how honeynets can be configured, the
uration. ToautomaticallygenerateHoneydconfigurations, absenceofautomatedtechniqueshascausedthisprocessto
RandomNet[30]allowsoperatorstochooseoperatingsys- be manual. If careful attention is not paid to this manual
temsandemulatedservices,andconstructshostswithran- process, theseconfigurationscandrasticallyimpacttheef-
domcombinationsofchosenOSsandservices. Wecallthis fectiveness of the monitoring systems. The effectiveness
configurationRandomHoneyd. depends on the honeynet ability to protect important net-
Nepenthes emulates certain vulnerabilities to recover work resources from the most likely threats. As a result,
moreexploitsforthevulnerabilities[4]. TheChineseHon- improperly configured honeynets can fail to be effective if
eynet Team has deployed a /24 Nepenthes sensor [8], the theycannotaccuratelyrepresent:
UKHoneynetTeam[35]hasdeployedtwoNepenthessen-
sors, the German Honeynet Team has deployed a /18 Ne- • the vulnerable population. The vulnerable popula-
penthes sensor [20], and the Georgia Honeynet Team [19] tion is the set of services on the network that can be
has started experimenting with Nepenthes. While some remotelyaccessed. Itisimportanttonotethatthisdef-
configuration of these systems exists, as various vulnera- inition of vulnerable population includes all services
bility modules can be turned on or off, most deployments onthenetworkratherthanonlythosewithknownvul-
arelimitedtothosemodulesthatalreadyexist. Wecallthe nerabilities.
defaultNepenthes0.1.7configurationNepenthes.
Numerous end-host systems can be run on the same • thethreatlandscape. Thethreatlandscapedescribes
hardware platform by using virtual machine tools such thecurrentattacksonthenetwork.
as VMWare [24]. A variety of academic projects
To understand the impact of ad hoc configurations on
havedeployedVMWare-basedsolutionsincludingGeorgia
visibility, we compared them to the threat landscape and
Tech[15],UCSD[36],andPurdue[21]. Theconfiguration
the vulnerable population. Table 1 shows the top 10 open
ofend-hostsislimitedonlybythenumberofoperatingsys-
TCPportsfoundonanacademic/16networktogetherwith
tem and application compatibilities. However, a common
the top 10 attacked ports on a /24 honeynet in the net-
approachisavanillaoperatingsysteminstall,suchasthose
work,andseveralhoneynetconfigurations. TCPportsrep-
promotedin[24].
resent broad characterization of the vulnerable population,
In summary, we find that most published honeynet de-
the threat landscape, and the threats a honeynet configura-
ployments use well-known techniques for honeynet con-
tion can capture. All TCP Responder provides minimal
struction. Thesetechniqueshaveavarietyofconfiguration
visibility into all ports and is not shown in the table. The
characteristics that range from no configuration to a fixed
results of the comparison are rather startling. The ad hoc
configurationandfinally,tofullyconfigurable. Whencon-
configurations of honeynets do a poor job of representing
figuration options exist, there is no automated system to
both the attacks to the network as well as the potentially
choose between these options and are left to the adminis-
vulnerablepopulation. Thislackofvisibilityhasprofound
tratorformanualconfiguration.
implications, as the monitoring system will fail to provide
anyinsightintoattacksatlargenumbersofvulnerablehosts
3 Limitations of Ad Hoc Honeynet Configu-
(e.g., those running TCP/106, TCP/311, TCP/427). In ad-
rations
dition, these systems fail to capture the attacks prevalent
onthenetwork(e.g.,thosetargetingTCP/1433,TCP/1080,
One of the original goals of deploying honeynets is to TCP/1521, TCP/5900)andmaymakecertainattacks(e.g.,
provideprotectiontoanorganizationbyunderstandingthe TCP/139)appeartobemoreimportantonthenetworkthan
means and motives of attackers. However, this important theyinfactare. Interestingly,italsoappearsthatattackersTCP %of %of HoneynetConfigurations
Port Vulnerable Attacks %of %of %of
Population Nepenthes GenericHoneyd RandomHoneyd
hosts hosts hosts
21 24 - 100 4 45
22 53 - 100 3 -
23 34 - - 3 65
80 26 0.4 100 4 62
106 14 - - - -
135 9 0.6 100 - -
139 17 0.5 100 96 74
311 14 - - - -
427 26 - - - -
445 10 1.4 100 1 40
497 28 - - - -
554 - 0.9 - - -
1080 - 1.7 - - -
1433 - 6.8 - - -
1521 - 0.9 - - -
4444 - 0.5 - - -
5900 24 0.9 - - -
Table1.Thelackofvisibilityintoboththethreatlandscape,aswellasthevulnerablepopulationsfor
avarietyofdifferenthoneynetconfigurations.
donotnecessarilytargetthemostpopularservices. Infact, productionsnetworkusingthistechnique.
onlyasmallnumberofcommonportsareactuallypopular
acrossthethreatlandscape,vulnerablepopulation,andcon-
3.2.1 Fingerprintingalgorithm
figurationsincluding80,135,139,and445. Wewillshow
inthenextsectionthatthethreatlandscapeandthevulner- Honeynets configured in an ad hoc fashion provide incon-
ablepopulationschangeovertimeandnetworks,andthese sistent view of services on a network. Because we do not
honeynetconfigurationswillhavedifficultyinrepresenting knowofanysystematicapproachtodetectsuchconfigura-
themtoo. tionsinanetwork,wedevelopedageneralapproachthatin-
volvescomparingserviceconfigurationswithinasubnetto
3.2 Impactofadhocconfigurationonfingerprint- theconfigurationoftheentirenetwork. Anaiveapproach,
ing suchasexaminingeachindividualhostinthesubnettosee
ifitisanomalouswithrespecttotherestofthenetwork,will
Aswesawintheprevioussection,adhochoneynetcon- onlydetermineifthathosthasauniqueconfigurationinthe
figurations do not represent either the exploit space or the network. Inordertocomparecollectionsofhostconfigura-
vulnerable population. In addition to reducing important tions,wefirstperformactiveteststodetecthostconfigura-
visibility, this behavior can be effectively used by attack- tions,aggregatetheseconfigurationsbycommonoperating
ers to detect, or fingerprint, the locations of the honeynets systemsandservices, andthencomparethedistributionof
within a network. This type of activity is important to de- anewserviceinthesubnetswiththenetworkasawhole.
fenders,asfingerprintedhoneynetscanbeactivelyavoided Consider a set of tests {T ,T ,...,T } that can be per-
1 2 n
or corrupted by attackers. The key insight that makes this formed on an Internet host, with the result of test T being
i
fingerprintingpossibleistheobservationthatsomecombi- anymemberofthesetR ={r1,r2,...,rmi}ofsizem. For
i i i i i
nationofservicesandoperatingsystemsonanadhoccon- example, atest(orvariable)thatcheckswhetherTCPport
figured honeynet may seem highly anomalous when com- 139 is open or not on an Internet host has results (or val-
paredwiththerestofthenetwork. Inthenexttwosections, ues) in the set {open,closed} of size 2. The combination
we discuss a novel technique for fingerprinting honeynets oftestvaluesforanInternethostmakesahostprofile. For
andshowhowadhocconfigurationsareeasytospotwithin example,checkingport139andport445onanInternethostmighthavehostprofilesintheset{(closed,closed),(closed, 3.2.2 Detectingadhocconfigurations
open), (open, closed), (open, open)}. While the algorithm
is test-set independent, in this paper we utilize three sets In order to study the impact of ad hoc configurations in
of tests. Tests constructed based on existing tools, such as terms of their ability to be discovered, we embedded dif-
nmap[18], easilydifferentiateTCPsoftwarebyexploiting ferent honeynet configurations into six network (A/16 and
ambiguitiesinRFCsandimplementations,andwecallthem B/16areacademicnetworks,andC#1/17,C#2/19,D#1/19
tcp. We similarly developed a set of 26 new tests to iden- and D#2/19 are web-server farms) profiles. The network
tifyawebserveranditsconfigurationsandcallthemhttp. profiles were created by probing live networks and storing
Finally,wetestopenTCPportsfrom1-1024withasimple theirconfigurations. Thehoneynetconfigurationswerecre-
programthatattemptsconnectiontotheseportsthatwecall ated by a variety of existing approaches. We then applied
ports. our fingerprinting algorithm to create a list of anomalous
subnetconfigurationsineachofthesenetworksandsorted
Our main idea is to group hosts by test values and then
them into descending order of how anomalous they were
comparethesubnetwiththenetworkasawholefortheval-
(i.e., by z-values). Ideally, each of the embedded subnets
ues of a new test. First, we order tests by the increasing
(i.e., honeynets) should appear on the top of these lists.
value of their entropy, each of which is computed by the
Therefore,wewillevaluateahoneynetresistancetofinger-
distribution of test values among the hosts in the network.
printingbytheposition(orrank)inthelists.
The tests are ordered by increasing entropy because a test
withlowerentropyhasmostcertainvaluesforthehostson Figure1presentstherankofthefirsthoneynetanomaly
the network and hence, a significant anomaly can be de- insixnetworkswhenthehoneynetisconfiguredusingAll
tectedifasubnetdiffersfromthedominantvaluesfoundin TCP responder, Nepenthes, Generic Honeyd and Ran-
thenetwork. Second,wecompareeachsubnetwiththenet- dom Honeyd (average of ten random honeyd configura-
workforthevaluesoffirsttest,thenweaggregatebyvalues tions). Wefindthattheadhochoneynetconfigurationssur-
of this test and compare for values of the second test. We face as the most anomalous configurations in almost all of
iteratethiscomparisonbetweenthesubnetandthenetwork the networks for many set of tests. This result is perhaps
overthedeterminedtestorderuntilthelasttest. easy to realize for honeynets such as All TCP Responder
withallportsturnedon, butquitesurprisingforhoneynets
To quantify anomalies for a new test, the values for the
configuredwithindividuallyconsistenthosts(i.e.,theylook
testisarrangedonanormaldistributioncurveusingthefre-
likearealhost). ThisisbecauseNepenthes,GenericHon-
quency associated with each value. Then, we measure the
eyd, and Random Honeyd often emulate services or run
anomalyusingatestofsignificancecalledz-statistics[16]
servicecombinationsthatareanomalousinmanynetworks.
becauseofthreespecificreasons. (1)Theanomalyquanti-
Aswasthecasewithvisibility,theimpactofadhocconfig-
fied by z-statistics is significant if the values of a new test
urations can be profound, allowing attackers to easily fin-
forhostsonthesubnetaresignificantlydifferentfromthose
gerprinthoneynets.
onthenetwork. (2)Ifthenetworkexhibitssignificantvari-
ationinthevaluesofthenewtestchosenforanalysis,then
the anomaly is of low magnitude. (3) If only a few hosts
4 ThePropertiesofHoneynetConfiguration
inthenetworkareaggregatedbytestvalues,thenitcauses
an anomaly of smaller magnitude for the new test values.
Foraformaldefinitionandasmalldiscussionofz-statistics, Inprevioussections,wehaveshownthatexistingmeth-
pleaserefertoAppendixA.Acompleteillustrativeexample odsforhoneypotconfigurationarelargelymanualinnature.
oftheabovealgorithmispresentedinAppendixB. We have shown that if proper care is not taken in the con-
Thereareawidevarietyoftechniquesforfingerprinting structionoftheseconfigurations,theycanproducehoneynet
honeypots. Ourgoalisnottoenumerateallpossibleattacks systemsthatfailtoprovidevisibilityandthatareeasytofin-
butrathertoillustratetheimportanceofconfigurationarti- gerprint. Inthissection, wedescribetheprocessofgener-
factsinhoneynetfingerprinting. Onerelevantapproachfor atinghoneynetconfigurations. First, wemotivatetheneed
detecting honeypots involves probing and analyzing pub- toautomatehoneynetconfigurationbyshowingthelackof
lished records from honeypots [7] . However, this attack temporalgeneralityofexploitsandspatialgeneralityofvul-
is possible only when attack statistics from honeypots are nerable populations, the diversity of systems in networks,
publicly available. Rajab et. al. [27] fingerprint passive and the large number of addresses to be configured. Sec-
darknetsthatdonotrespondtoanyprobewhereaswedis- ond,wepresentvisibilityintovulnerablepopulationandre-
cover active honeynets without a prior knowledge of how sistancetofingerprintingasthetwodesiredobjectivesand
theyareconfigured. Thisisachievedbycomparingsubnet argue that a honeynet configuration with individually con-
configurationswiththesurroundingnetworkanddetecting sistenthostsandproportionalrepresentationofthenetwork
anomalousconfigurations. willachievethedesiredobjectives.12
10
8
6
4
2
0
A/16 B/16 C#1/17 C#2/19 D#1/21 D#2/21
ylamona
tenyenoh
tsrif
fo
knar
tcp http 12
tcp+http
port
tcp+port 10
tcp+port+http
8
6
4
2
0
A/16 B/16 C#1/17 C#2/19 D#1/21 D#2/21
ylamona
tenyenoh
tsrif
fo
knar
tcp http
tcp+http
port
tcp+port
tcp+port+http
AllTCPResponder Nepenthes
12
10
8
6
4
2
0
A/16 B/16 C#1/17 C#2/19 D#1/21 D#2/21
ylamona
tenyenoh
tsrif
fo
knar
tcp
http 12
tcp+http
port
tcp+port 10
tcp+port+http
8
6
4
2
0
A/16 B/16 C#1/17 C#2/19 D#1/21 D#2/21
ylamona
tenyenoh
tsrif
fo
knar
tcp
http
tcp+http
port
tcp+port
tcp+port+http
GenericHoneyd RandomHoneyd
Figure1.Therankofthefirstanomalywithadhochoneynetconfigurationsinsixnetworksforvarious
combinations of tests that identify operating systems and services. Most honeynets represent the
first,ormost,anomaloussubnetinanetwork
4.1 Needforautomaticconfiguration weretheunusualonestargetedinApril,theTCPport5000
was targeted in May, the TCP ports 22 and 5900 were tar-
Whilewehaveclearlyshownthatadhocconfigurations getedinJune,andTCPport4444inJuly. Moreover,theex-
are a danger to the goals of any honeypot deployment, we ploitsobservedvarysignificantlywithlocations,asdemon-
have not yet shown that the process of generating these strated by significantly different data observed on sensors
requires anything more than careful manual configuration. deployed in different networks [12]. Therefore, a highly
We believe that two properties of the configuration space variable nature of threat landscape makes chasing the ex-
motivatetheneedforautomaticconfiguration: ploitsreallydifficultforthedefenders,whomustmanually
configuretheirhoneynets.
4.1.1 Lackofgenerality
Spatialgeneralityalsoimpactstheeffectivenessofman-
A major impact on the effort of manual configuration of uallygeneratinghoneynetconfigurations.Differencesinat-
honeynetsisthelackoftemporalgeneralityofattacks. Ta- tackbehaviorsandvulnerablepopulationsacrossnetworks
ble2showsthetopfiveTCPportsandthenumberofpack- makesharingofconfigurationanearimpossibility. Forex-
etsobservedoveradayforlastfivemonthsonthe/24hon- ample, Table 3 compares vulnerable population in various
eynetintheB/16network. Wefindthatnewserviceswere networksintwoways,bytheoperatingsystemandtheTCP
targetedheavilyeachmonth. TheTCPports6000and1080 ports. ThesecondlargestoperatingsysteminnetworkA/1604/19/2006 05/19/2006 06/19/2006 07/19/2006 08/19/2006
6000 445 22 135 1433
445 139 5900 80 1080
1433 5000 3128 4444 445
1080 1433 8080 445 5900
135 80 80 1433 1521
Table 2. The top 5 TCP ports observed in a /24 sensor in network B/16, over a period of 5 months.
Exploitschangequicklyovertime.
TCP Networks
Port A/16 B/16 C#1/17 D#1/19
Operating Networks 139 42 17 - -
System A/16 B/16 C#1/17 D#1/19 22 41 53 30 25
Windows 44 25 76 77 135 39 10 42 69
CiscoIOS 14 7 - - 23 27 34 4 5
Apple 9 36 - - 445 27 11 - -
Linux 9 7 15 6 80 21 26 93 96
HPprinter 3 13 - - 25 12 10 70 83
Solaris 9 7 1 2 21 8 24 77 79
*BSD 1 - 8 15 427 4 26 - -
497 3 28 - -
110 1 - 39 17
OperatingSystems TCPports
Table3.Comparingthevulnerablepopulationinfournetworks,byoperatingsystemsandTCPports.
Thevulnerablepopulationsaredifferentacrossnetworks.
is surprisingly Cisco IOS, which is found in the wireless Unfortunately, manual honeynet approaches for achieving
access points and routers in the academic campus. On the this visibility are difficult to apply. Consider the data pre-
otherhand,AppleMacOSisthedominantoperatingsystem sentedinTable4,whichshowssurprisinglylargenumbers
in network B/16. As expected, the web-server farms were ofTCPimplementations,HTTPimplementations,services,
dominated by Windows servers. While SSH seems to be andthecomplexassociationsbetweentheminvariouspro-
predominant service found in A/16 and B/16, HTTP, FTP duction networks. For example, in network A/16, we find
and SMTP seems to be the dominant services in the web thatthe5,512hostsresultin352uniqueTCPstackimple-
server farms. Therefore, the vulnerable population varies mentations. Ofthose5,512hosts,1,237wererunningWeb
significantlywiththenatureofthenetworksmakingitdif- servers,andwhenprobed,yielded241differingserversand
ficult for a single honeynet configuration to represent the configurations. ThisincludedTCPstacksandWeb-servers
vulnerablepopulationacrossnetworks. fromabewilderingvarietyofdevicesincludingNATs,wire-
less access points, printers, power switches, and webcam-
eras.
4.1.2 Scaleofconfiguration
In addition to the diversity in the numbers and types of
Traditionally,asmallnumberofindividualhoneypotswere individual host configurations, network administrators are
configured manually. For example, a dedicated host will also required to configure a potentially large number of
be configured as a clone of a valuable network resource, unused addresses in order to maximize visibility. Tradi-
such as a mail server. However, as the number of services tionalhoneynetdeploymentsofstaticallyallocatednetwork
andthenumberofhostsrunningthemonthenetworkhave blocks are giving way to dynamic discovery of all unused
increased, defenders have been under increasing pressure addresses [11]. The number of addresses available can be
to manage and provide visibility into these new services. surprisinglylarge,eveninsmallorganizations.Network Type Hosts Web- TCP HTTP TCP+ TCP+ TCP+
of servers Ports HTTP Ports+
organization HTTP
A/16 universitynetwork 5512 1237 352 241 1210 699 1386
B/16 universitynetwork 1289 169 156 73 392 249 463
C#1/17 web-serverfarm 11342 10080 256 862 1625 1764 3394
C#2/19 web-serverfarm 2438 2208 93 293 394 559 811
D#1/19 web-serverfarm 1859 1513 118 221 330 451 590
D#2/19 web-serverfarm 1652 1171 137 208 266 417 487
Table4.Thenumberofuniquehostconfigurationsobservedatsixproductionnetworksforvarious
testsandtheircombinations. Eachnetworkhasasurprisinglylargenumberofuniqueconfigurations.
4.2 Individual host consistency and proportional ratioofnetworkhostswiththosecombinations.Proportion-
representation alityprovidesvisibilityinthatthemostprominentsoftware
on the live network appear more frequently and hence can
A number of objectives can be used to define honeynet capturenewthreatstothesoftwarequickly. Thisalsohelps
configurations. For example, one may choose the easiest in prioritizing attacks by their widespread possible impact
set of configurations to deploy, or one may want to rep- on the network, and hence arranging attacks by the maxi-
resent global host or threat distribution. In this paper, we mum number of honeynet hosts that observed each one of
setourobjectiveasprovidingvisibilityintothevulnerable them. Furthermore,whenconfiguringlargeaddresseswith
populationonthedefender’snetworkandresistancetofin- realisticoperatingsystemsandservices,proportionalityen-
gerprinting. Wechosetheseobjectivessothatthehoneynet suresresistancetofingerprintinginthatthesystemwillnot
provides intelligence into zero-day threats to the network add a number of configurations that skew the distributions
quickly. Eventhoughwechosespecificobjectives, webe- oftheseconfigurationsinthenetworkasawhole.
lievethatthegeneralapproachdescribedinthispaper(sam-
ple and configure) can be applied to configure honeynets
5 ASimpleTechniqueforHoneynetConfigu-
representingotherdistributions(e.g.,threat).
ration
Toprovidevisibilityintonetworkthreatsandresistance
to fingerprinting, we argue that a honeynet configuration
musthaveindividuallyconsistenthostsandshouldpropor- Our algorithm for generating representative and consis-
tionally represent the network. An individually consistent tent configurations has two components: profiling the net-
host is one whose configuration appears in a live network. work and generating configurations. Profiling the network
Individual consistency is necessary for two reasons. First, istheprocessofdeterminingtheconfigurationoftheexist-
inordertoprovidevisibilityintothreatsthatimpactthede- ingproductionnetworkforwhichwewantvisibility. After
fenders network, the configuration must provide the same profiling the live network, we need to determine host pro-
opportunitiesforattackersastheyoccurintherealnetwork. filestobedeployedonthehoneynet.Whilewelimitourdis-
It is obvious that in order to capture threats against a ser- cussiontothewidestvulnerablepopulation,ourapproachis
vice, you must run that service. Perhaps less obvious is alsovalidforspecificvulnerabilitiesscannedbyatoolsuch
that sophisticated worms, like Slapper, attempt to identify asNessus[3].
specific services and versions of operating systems to de- The generated host profiles should be individually con-
liverthecorrectexploit[28]. Inadditiontovisibility,indi- sistentandproportionallyrepresentthenetworkforallcom-
vidualhostconsistencyprovidesresistancetofingerprinting binationoftestsvalues(astheyidentifyoperatingsystems
againstattackersthatlookforunusualservicesonthehost. and services). For example, consider a network with three
Inadditiontoindividualconsistency, wearguethatvis- hosts whose profiles for port (139, 445) tests are [(open,
ibilityandresistancerequireproportionalrepresentationof open), (open, closed), (closed, closed)]. A honeynet pro-
thenetwork. Honeynetsareprimarilydeployedfordetect- portionaltothisnetworkshouldmeetmultipleconstraints.
ing new threats. However, we do not know the operating Wheneachportisconsideredseparately,2/3oftheirhosts
systemsandtheserviceconfigurationsthatwillbetargeted should have port 139 open, and 1/3 of their hosts should
byanewattack. Sincewecannotanticipateanyparticular haveport445open. Whentheportsareconsideredincom-
configuration,theratioofhoneynethostsforanycombina- bination,1/3oftheirhostsshouldhavebothportsopen,1/3
tionofoperatingsystemandservicesshouldbeequaltothe of their hosts with port 139 open and port 445 closed, andfinally 1/3 of their hosts with both ports closed 1. Due to sampling involves hierarchically separating the population
resource (address space and machines) constraints, a hon- andallocatingthesizetobesampledproportionallyateach
eynet may only approximate the network. Therefore, we pointinthehierarchy.
need to develop an algorithm that best approximates pro- Previously we have assumed that all hosts in a network
portionalrepresentationforallcombinationsoftestvalues, are equally important. Situations caneasily arise in which
andatthesametime,producesindividuallyconsistentpro- this will not hold true. An operator might need better vis-
files. However, itisdifficulttoconstructanalgorithmthat ibilitytospecificmachines. Forexample,asystemadmin-
minimizeserrorinproportionalrepresentationforallpossi- istrator may wish to weigh his DNS server, a single point
blecombinationsoftestvalues. Surprisinglyasimpletech- of failure, twice when compared to other hosts on the net-
nique to select a random sample [9] of hosts in a network work. To provide additional visibility to a machine when
ensuresourtwocriticalproperties: comparedtoothers,additionalmatchingconfigurationsare
added to the configuration pool before sampling. In addi-
• Proportional representation. The probability that tion,theoperatormightindicateaparticularvalueforatest
a combination of test values (T i1 = r ij 11,T i2 = variable as more important than other values. For exam-
rj2,...,T =rjk)isselectedbythesamplingalgorithm ple,configuringahostwithport80openismoreimportant
isi2
equal
ti ok theik
fraction of live hosts that satisfy them. thanwhenitisclosed. Toaccountforthesecases,weallow
Therefore,simplerandomsamplingchooseshostpro- userstospecifysuchpreferencesasinputtotunehoneynet
fileswithaprobabilitydistributionpresentintheactual configuration. Then a host is replaced by a preferred host
networkandapproximatesitintheselectionofhosts. beforesampling. Forexample,ifport80openispreferred
IfnhostsarepickedfromatotalpopulationofN,then over closed, then a Windows XP host might be replaced
the standard error in estimating the ratio on the hon- byWindowsXPwithIISwebserverfoundinthenetwork.
eynet for a combination of test values with standard Thisensuresthathoneynethostsareindividuallyconsistent
q evenwithuserinput.
deviationσisequaltoσ (1− 1)[9]. Therefore, as
n N Now we evaluate our approach to configuring hon-
more and more hosts are picked up to be represented
eynets. Recall that our objective was to create configura-
onthehoneynet,thebetterthehoneynetrepresentsthe
tions that provide visibility into network attacks and resis-
actualnetwork.
tance against fingerprinting. To demonstrate this, we vali-
datedourconfigurationsbycomparingwiththevulnerable
• Individualhostconsistency.Tobeeffectiveincaptur-
populationandbyapplyingthefingerprintingalgorithm.To
ing threats and in warding off possible fingerprinting
evaluate visibility of honeynets into real network threats,
efforts, we would like the configuration for each host
we created and deployed various honeynet configurations
on the honeynet to be individually consistent. This
in production networks. Then, we examined the attacks
means that none of the hosts should be assigned an
observed by each of the honeynets, and show that non-
unusual configuration that is not possible in the real
representative configurations provide skewed views of the
world. Since a configuration is assigned to a host in
networkthreats. Finally,wedeployrepresentativeconfigu-
thehoneynetonlyifthereisahostwiththatparticular
rationsforvariousothernetworksinouracademicnetwork
configuration in the network, every host in the hon-
and show that they provide different insights, even when
eynethasarealisticconfiguration. Hence,forasubset
deployedinasinglenetwork.
of configuration values, a honeypot host will match a
numberoflivehosts,yetrepresentaveryspecificlive
host when all configuration values are considered to- 5.1 Evaluating correctness of representative con-
gether. figurations
Thesimplerandomsamplingiseffectivebecausewedo
Inordertoachievevisibility,wehavearguedthatacon-
not know the host configuration that will be targeted by
figuration needs to provide proportional representation of
a new attack. However, when we know certain tests are
the target network. Table 5 (a) shows the visibility that a
more important than other ones, then we can achieve bet-
representativehoneynetprovidesintothevulnerablepopu-
ter proportionality to the important tests. For example, if
lation. Wefindthatthedistributionofnetworkservicesand
we know that services are frequently being targeted, then
operating systems on the representative honeynet closely
we can achieve better proportionality for the service dis-
match the vulnerable population. The combination of op-
tribution than say the operating system distribution. This
eratingsystemsandservicesbetweenarepresentativehon-
isusuallyachievedusingstratifiedsampling[9]. Stratified
eynet and the network also matched closely and we omit
thoseresultshere.
1an open port by may be preferred over a closed port, and we will
discussthislater. To evaluate honeynet configurations by their resistance%of %of
Network Representative
Hosts Hosts
Apple 36 35 1000
Windows 25 23
OperatingSystems HPprinter 13 15
Linux 7 5 100
Solaris 7 6
22 53 54
23 34 34 10
TCPPorts 497 28 31
427 26 27
80 26 24 1
A/16 B/16 C#1/17 C#2/19 D#1/21 D#2/21
(a)Visibilityintothevulnerablepopulation
ylamona
tenyenoh
tsrif
fo
knar
tcp
http
tcp+http
port
tcp+port
tcp+port+http
(b)Resistancetofingerprinting
Table5.Evaluatingrepresentativehoneynetconfigurationby(a)visibilityintovulnerablepopulation
and (b) resistance to fingerprinting. The percentage of vulnerable hosts for the top five services
and top five operating systems in network B/16 match closely to the representative honeynet. The
representativehoneynetisveryresistanttofingerprintingaswell.
Rank Exploit %NetworkHosts %RepresentativeHosts
1 RPCportmaprusersrequestUDP 90 100
2 NETBIOSSMB-DSC$shareunicodeaccess 7 10
3 NETBIOSSMB-DSIPC$shareunicodeaccess 7 10
4 BAREBYTEUNICODEENCODING 4 24
5 WEB-MISCrobots.txtaccess 4 24
Table6.Thevisibilityofconfigurationsintotheexploitsonthenetwork. Thepercentageofnetwork
hosts that observed each of the top five exploits in network B/16 is compared with the distribution
intherepresentativeconfiguration.
to fingerprinting, the representative configurations for six using an intrusion detection system called Snort [29] and
networkswereembeddedinthenetworksandtheanomaly thencomparehoneynetvisibilitytothosethreats.
detection algorithm from Section 3 was used on all of the
We monitored the gateway router to B/16 via a span
networks. Table 5 (b) shows the rank of the first honeynet
port connected to a FreeBSD machine running Snort 2.1.3
anomalyforsixnetworkswhenthehoneynetisconfigured
configured with default signature distribution and recent
to be Representative to these networks. It shows that a
bleeding-snort [1] signatures. The experiment was con-
representative honeynet is very resistant to techniques that
ducted for five hours on 2nd May, 2006. The detected ex-
attempttodetectnetwork-wideanomalies.
ploitswereorderedbyspreadoftheattacki.e.,bytheper-
centageofnetworkhoststhatobservedtheattack. Wethen
5.2 Evaluating visibility of representative config-
grouped hosts that received a particular exploit and iden-
urationbynetworkmonitoring
tified host characteristics necessary to receive the exploit.
Finally, we analyzed the honeynet profile to discover sus-
Wedemonstratedthatthebroadcharacterizationofvul- ceptible hosts on the Representative honeynet. Table 6
nerable population on the network matches the represen- showsthetopfiveattacks(server-based)discoveredonthe
tative honeynet. In this section, we explore the visibility networkandcomparesitwiththepercentageofsusceptible
ofrepresentativehoneynetintospecificexploitsonthenet- hostsonthehoneynet. Ninetypercentofthenetworkhosts
work. For this, we capture exploits on the network B/16 observed attempts to list currently logged users. This wasConfiguration Exploits %ofHoneynet %ofSusceptible
hosts NetworkHosts
1. SSHBrute-Forceattack 41 53
2. NETBIOSDCERPCISystemActivator
Representative pathoverflowattempt 8 9
3. SHELLCODEx86NOOP 6 9
4. NETBIOSSMB-DSC$shareunicodeaccess 1 10
5. NETBIOSSMB-DSIPC$shareunicodeaccess 1 10
1. NETBIOSDCERPCISystemActivator
pathoverflowattempt 60 9
AllTCPResponder 2. WEB-IISviewsourceviatranslateheader 17 26
3. P2PGNUTellaGET 5 0
4. LSAexploit 4 10
5. SHELLCODEx86NOOP 4 9
1. SSHBrute-Forceattack 8 53
2. SCANProxyPort8080attempt 2 100
GenericHoneyd 3. BACKDOORtypottrojantraffic 1 100
4. BehavioralUnusualPort135traffic 1 9
5. SquidProxyattempt 1 100
1. WEB-IISviewsourceviatranslateheader 21 26
2. LSAexploit 6 10
RandomHoneyd 3. FTPanonymousloginattempt 6 24
4. MS04011Lsasrv.dllRPCexploit(WinXP) 3 10
5. MS04011Lsasrv.dllRPCexploit(Win2k) 3 10
Table 7. The impact of different configuration approaches into threat visibility. Non-representative
configurationsaremisleadingabouttherealthreatstothenetwork.
targetingUDPport111andwouldhavebeenvisibleonall network and exposed it to the present day attacks. Each
honeynet hosts. Seven percent of network hosts observed honeynetconfigurationwasdeployedwithHoneyd1.0[26],
administrativeaccessattemptstoSMBserviceonTCPport for a period of one day using the service scripts for FTP,
445 and would have been visible on 10% of the honeynet SMTP, FINGER, HTTP and IIS-emulator, and the entire
hosts. The rest of the exploits were slow moving attacks experimentlastedfrom22nd April, 2006to1st May, 2006.
and were observed on a few hosts on the network. There- Weevaluatedtheresultsacrosstwodimensions: theaffect
fore,existingexploitsonthenetworkwouldbedetectedon ofvariousconfigurationapproachesonthethreatsobserved,
thehoneynetdependingontheirimpactonthenetwork. andtheimpactofcontextinrepresentativeconfigurations.It
isimportanttonotethatcomparisonsacrossconfigurations
5.3 Evaluating visibility of honeynet configura- inthisexperimentarenotvalidduetotemporalchangesin
tionsbyrealdeployments threat. Instead, ourgoalistoevaluateahoneynetconfigu-
rationbycomparingitwiththevulnerablepopulation.
In this section, we deploy honeynet configurations in Table 7 compares a honeynet representative of network
B/16andevaluatethembytheaccuracyofthreatviewthey B/16withthreeotherhoneynetconfigurations. Itshowsthe
provide. First, we compare threat observed on different topfiveexploits, orderedbythenumberofhoneynethosts
honeynet configurations with the vulnerable population on thatobservedtheexploit. FortheRepresentativeconfigu-
the network. Second, we deploy representative configura- ration, we found that the SSH Brute-Force attack was ob-
tions for various networks in B/16 and observe how rep- servedonalargenumberofhoneynethostsanditmatched
resentative honeynets provide unique view of threats to a with the university network B/16, which has a significant
network. number of hosts configured with SSH service. An attack
We deployed a real /24 honeynet (monitoring 256 ad- on NETBIOS DCERPC service on port 135 was observed
dresses)withdifferenthoneynetconfigurationsintheB/16 on a small percentage of hosts, as only 9% of the networkA/16 C#1/17 C#2/19 D#1/19 D#2/19
1. SSHBrute-Force 1. WebProxyGET 1. WebProxyGET 1. NETBIOS 1.NON-RFCHTTP
attack Request Request DCERPCISystem- DELIMITER
Activatorpath
overflowattempt
2. NETBIOS 2. WEB-IISviewsource 2. NETBIOS 2. SSHBrute-Force 2. NETBIOS
DCERPCISystem viatranslateheader DCERPCISystem attack DCERPCISystem-
Activatorpath Activatorpath Activatorpath
overflowattempt overflowattempt overflowattempt
3. MS04-007Kill- 3. NETBIOS 3. HTTPChallenge/ 3. WebDAVsearch 3. FTPanonymous
BillASN1 DCERPCISystem- Response access loginattempt
exploitattempt Activatorpath Authentication
overflowattempt
Table 8. The importance of context. The top three attacks captured on honeynets representatively
configuredforfivedifferentproductionnetworks,butplacedwithinthesamenetwork.
hosts were susceptible to this attack. On the other hand, honeynetprovidesaccurateviewofthreatsonthenetwork
All TCP Responder observed a NETBIOS DCERPC at- than ad hoc configuration methods whose results are often
tackona60%honeynethosts. TheGenericHoneydcon- misleading. Wealsodemonstratedthatrepresentativecon-
figurationobservedtheSSHbrute-forceattackononly8% figurationsobservesdifferentthreatviewsdependingonthe
ofthehosts,but53%ofthehostsweresusceptibletothisat- networkvulnerabilityspace.
tack. TheRandomHoneydconfigurationobservedanIIS
attackon21%ofthehosts,whichwascloseto26%ofWeb 6 Conclusion
serversinthenetwork. However,around50%ofRandom
Honeydhostswerecapableofreceivingtheexploit(much Inthispaper,weaddressedtheproblemofhoneynetcon-
higher than what actually received) but did not receive it figuration. Weshowedthattheexistingapproachestocon-
becauseofslowmovingattacks. Whenexaminingthesere- figureahoneynetaremanual,causinghoneynetstobecon-
sults,wefindthatthenon-representativeconfigurationsbias figured either in a generic or ad hoc fashion. We demon-
thethreatviewofanetworkawayfromtheexploitsthatare strated the limitations of generic and ad hoc configuration
actually the most widely affecting, and hence most impor- inthattheyprovidepoorvisibilityintonetworkattacksand
tant. they are easy to discover. We show that providing visi-
To analyze how well a representative configuration re- bility into network attacks is not trivial because the threat
flected attacks on a network, we deployed honeynet con- landscapeandthevulnerablepopulationschangewithtime
figuration representatives for five other networks. Each of and across networks. Furthermore, large number of dark
themweredeployedforonedayinthe/24unusedaddress addresses available in an organization requires automated
space in the B/16 network. Table 8 compares representa- approaches to configure honeynets. We identify individ-
tive honeynet configurations with the susceptible network ualhostconsistencyandproportionalrepresentationastwo
population for five networks. We find that the SSH Brute propertiesrequiredtoachievethedesiredgoalsofproviding
force attack was commonly observed on honeynet hosts, visibility into vulnerable population and resistance to dis-
anditcoincidedwiththelargenumberofhostsintheuni- covery. Wethendescribedanautomaticapproachbasedon
versity network A/16 that were configured with SSH ser- profilingthenetworkwithactivetestsandrandomsampling
vice. Thedominantexploitsfoundonthewebserverfarms thatachievesthedesiredgoals.Weevaluatedtheefficacyof
were those impacting web service and the TCP port 135, representativehoneynetsthroughdeploymentofthesecon-
which are the dominant services in those networks. What figurationsinaproductionnetwork.
is interesting to note is that, although these configurations Inthis paper, we haveexplored andevaluated honeynet
were placed within the same network, the configurations configurations only for public facing networks. However,
observed vastly different views depending on the network thedeploymentoffirewallsandNATshaveledtotheneed
vulnerabilityspaces. for internal honeynets [11] and we plan to evaluate the ef-
In this section, we have examined a variety of different fectivenessofourtechniquesinthesetypesofdeployment.
aspectsofvisibility. Wehaveshownthattherepresentative There are numerous means of discovering honeynets, andwebynomeansattempttoaddressallofthem. Inthispa- [12] E. Cooke, M. Bailey, Z. M. Mao, D. Watson, and F. Ja-
per, we only examined configuration artifacts that can be hanian. Towardunderstandingdistributedblackholeplace-
usedtoaidattackers. Infuture,weplantodeployrepresen- ment. InProceedingsofthe2004ACMWorkshoponRapid
tativehoneynetswithhighinteractionhoneypotsanddetect Malcode(WORM-04),NewYork,Oct2004.ACMPress.
[13] E.Cooke,M.Bailey,D.Watson,F.Jahanian D.McPherson,
exploitsusinghostbasedintrusiondetectionsystems.
andZ.M.Mao. TheInternetMotionSensorProject. http:
//ims.eecs.umich.edu,June2004.
Acknowledgments
[14] T.Cymru. Thedarknetproject. http://www.cymru.com/
Darknet/index.html,June2004.
This work was supported in part by the Department [15] D. Dagon, X. Qin, G. Gu, J. Grizzard, J. Levine, W. Lee,
of Homeland Security (DHS) under contract number andH.Owen. Honeystat:Localwormdetectionusinghon-
NBCHC040146,bytheNationalScienceFoundation(NSF) eypots.InRecentAdvancesinIntrusionDetection,7thInter-
nationalSymposium,(RAID2004),LectureNotesinCom-
undercontractnumberCNS0627445andbycorporategifts
puter Science, Sophia-Antipolis, French Riviera, France,
from Intel Corporation and Cisco Corporation. We would
Oct.2004.Springer.
like to thank Evan Cooke for providing valuable feedback
[16] D.Freedman,R.Pisani,andR.Purves. Statistics. Norton,
on early drafts and anonymous reviewers for critical and
1998.
useful comments. We would like to also thank Dan Peek, [17] French Honeynet Team. Status report: October 2005 –
JoseNazario,EdBalas,DaveDittrichandAndrewMyrick March2006. ,March2006.
fornumerousinsightfulconversations. [18] Fyodor. Nmap. http://www.insecure.org.
[19] Georgia Tech Honeynet Team. Georgia tech hon-
eynet report (September 15, 2005 – March 15, 2006).
References
http://www.ece.gatech.edu/research/labs/nsa/
honeynet/status/2006-03/ind%ex.shtml, March
[1] BleedingedgeSnort. http://www.bleedingsnort.com/.
2006.
[2] Honeynet research alliance. http://honeynet.org/
[20] GermanHoneynetTeam. Projectstatusreport:PeriodApril
alliance/index.html.
2005 to October 2005. http://lufgi4.informatik.
[3] Nessus:Vulnerabilityscanner.http://www.nessus.org/.
rwth-aachen.de/projects/honeynet/status2005-2,
[4] P.Baecher,M.Koetter,T.Holz,M.Dornseif,andF.Freil-
October2005.
ing. Thenepenthesplatform: Anefficientapproachtocol-
[21] X. Jiang and D. Xu. Collapsar: A VM-based architecture
lect malware. In 9th International Symposium On Recent
for networkattack detention center. InProceedings ofthe
AdvancesInIntrusionDetection.Springer-Verlag,2006.
13th USENIX Security Symposium, San Diego, CA, USA,
[5] M.Bailey,E.Cooke,T.Battles,andD.McPherson. Track-
August2004.
ing global threats with the Internet Motion Sensor. 32nd
[22] D.Moore,C.Shannon,G.M.Voelker,andS.Savage. Net-
MeetingoftheNorthAmericanNetworkOperatorsGroup,
worktelescopes. TechnicalReportCS2004-0795, UCSan
October2004.
[6] M.Bailey,E.Cooke,F.Jahanian,J.Nazario,andD.Watson. Diego,July2004.
[23] Norwegin Honeynet Team. Bi-annual status report
TheInternetMotionSensor: Adistributedblackholemon-
itoringsystem. InProceedingsofNetworkandDistributed 2005 q4. http://www.honeynor.no/docs/Honeynor\
System Security Symposium (NDSS ’05), San Diego, CA,
_bi-annual\_statusreport\_2005q4.p%df,2005.
[24] H. Project. Know Your Enemy: Learning with VMware.
February2005.
[7] J. Bethencourt, J. Franklin, and M. Vernon. Mapping In- 2003.
ternetsensorswithproberesponseattacks. InProceedings [25] N.Provos. Honeyd—Avirtualhoneypotdaemon. In10th
of the 14th USENIX Security Symposium, Baltimore, MD, DFN-CERTWorkshop,Hamburg,Germany,Feb.2003.
[26] N.Provos. AVirtualHoneypotFramework. InProceedings
August2005.
[8] Chinese Honeynet Team. Project status re- ofthe13thUSENIXSecuritySymposium, pages1–14, San
port: Period September 2005 to March 2006. Diego,CA,USA,August2004.
http://www.icst.pku.edu.cn/honeynetweb/ [27] M.A.Rajab, F.Monrose, andA.Terzis. Fastandevasive
honeyneten/statusreport_200604.h%tm, March attacks: Highlightingthechallengesahead. InProceedings
2006. ofthe9thInternationalSymposiumonRecentAdvancesin
[9] W. G. Cochran. Sampling Techniques, 3rd Edition. John IntrusionDetection(RAID),Sept.2006.
Wiley,1977. [28] E.Rescorla.Securityholes...Whocares? InProceedingsof
[10] Computer Associates. Win32.Agobot. http: USENIXSecuritySymposium,August2003.
//www3.ca.com/securityadvisor/virusinfo/virus. [29] M.Roesch. Snort: Lightweightintrusiondetectionfornet-
aspx?id=37776,July2004. works. InProceedingsofUsenixLisaConference,Novem-
[11] E.Cooke,M.Bailey,F.Jahanian,andR.Mortier. Thedark ber,2001.
oracle: Perspective-aware unused and unreachable address [30] A. B. Smith and J. M. Fox. RandomNet. http://www.
discovery. In Proceedings of the 3rd USENIX Symposium citi.umich.edu/u/provos/honeyd/ch01-results/3/,
on Networked Systems Design and Implementation (NSDI March2003.
’06),May2006.[31] L. Spitzner. Honeypots: Tracking Hackers. Addison- (e.g., predicting poll outcome, estimating number of peo-
Wesley,2002. plesufferingfromAIDS)asitrequiresgatheringthevalues
[32] K. Steding-Jessen. The honeynet project: ofeachobjectinthepopulation. Statisticiansapproximate
Distributed honeynet deployment in Brazil.
the standard deviation of the population by assuming that
http://www.honeynet.org.br/presentations/
thestandarddeviationofthepopulationisthesameasthat
hnbr-dod-honeynet-project2006.%pdf,2006.
of the sample. We can compute the average and the stan-
[33] Symantec. Symantec Internet threat report: Trends for
July ’05 - December ’05. http://www.symantec.com/ darddeviationofthepopulationeasily,aswecanprobethe
entirenetworkwithlightweighttests.Hence,thezvalueac-
enterprise/threatreport/index.jsp,March,2006.
[34] Symantec Corporation. DeepSight Analyzer. http:// curatelymeasuresthedegreeofinconsistencybetweenthe
analyzer.securityfocus.com/,2005. subnethostswhencomparedwiththenetworkhosts.
[35] UK Honeynet Team. Status report for the period Octo-
B:Illustrativeexample
ber 2005 – March 2006. http://www.ukhoneynet.org/
reports.html,March2006.
Figure 2(a) shows the configuration of machines in
[36] M.Vrable,J.Ma,J.Chen,D.Moore,E.Vandekieft,A.C.
10.0.0.0/29 with different subnets. Figure 2(b) detects,
Snoeren,G.M.Voelker,andS.Savage. Scalability,fidelity
andcontainmentinthePotemkinvirtualhoneyfarm.InPro- quantifies, and produces reasons for various anomalies on
ceedingsofthe20thACMSymposiumonOperatingSystem the network using our algorithm. First, it orders the tests
Principles(SOSP),Brighton,UK,Oct.2005. by their increasing entropy values. The order of the tests
[37] V.Yegneswaran,P.Barford,andD.Plonka. Onthedesign is 445, 497, 139, 22, and 135, which can be observed on
anduseofInternetsinksfornetworkabusemonitoring. In the successive depths of the tree. The values assigned to
RecentAdvancesinIntrusionDetection—Proceedingsofthe
test results are shown on tree edges. For port 445, the
7thInternationalSymposium(RAID2004),SophiaAntipo-
subnet 0 has an average of 1/2 while the network has an
lis,FrenchRiviera,France,Oct.2004.
average of 1/8. The standard deviation for test 445 is
Appendix q 1×(1−1/8)2+7×(0−1/8)2
=0.33, andthestandarderrorper
8 √
object is std.dev./ 2 = 0.23. Therefore, the magnitude
A:Z-Statistics
of anomaly when subnet 0 is analyzed for the test 445 is
Z-Statisticsisformallydefinedas: z= 1/2−1/8 =1.6. Similarly, subnets 1, 2, and 3 produce
0.23
averylowz-valueof0.53. However, forhostsaggregated
averageof thesample−averageof the population
z= byport445=open,analyzingport22forsubnet3produces
standard error perobject
a strong z-value of 2.23. Hosts in subnet 0 with port 445
where standard error is dependent on the standard devia- open, when analyzed for port 22, produce a subnet aver-
tionandthesizeofthesampleas: age of 0, a network average of 2/7, a standard deviation
q
standard deviationof population of
5×(0−2/7)2+2×(1−2/7)2
=0.45,ahighstandarderrorof
standarderrorperobject= √ 7
sizeof thesample 0.45 because of small sample size, and a low z-value of
−0.63(onlypositivevaluesshowninthefigure). Forsub-
Therefore, a small sample will result in high standard er-
net 2, hosts with port 445 open and port 22 closed, when
ror that will reduce z values. Furthermore, high standard
analyzedforport135,raiseasmallanomalywithaz-value
deviation implies significant variation in value for the new
of1.1. Figure2(c)presentsthereasonsandz-valuesforthe
testandwouldcausehighstandarderrorresultinginlowz
topthreeanomaliesinthesubnet. Anodewithsingleedge
value.
doesnotclassifyreasonforananomalyandcanberemoved
Z-Statistics is primarily used to measure the likelihood
fromthereason. Forexample,thetopanomaly,becauseof
of a predicted average when only the average of a sample
22/445=open,497=closedand139=open,hasbeenreduced
of population is known. However, this requires comput-
tojustthereason22/445=open.
ing the standard deviation of the population. This is par-
ticularly difficult to estimate for many statistics problems[0:1.6, 1: 0.53,
22 135 139 445 497
2:0.53, 3:0.53]
ssh msrps netbios smb dantz 445
closed open
Mac OS 10.0.0.0 open open subnet 0
1 0
Windows 10.0.0.1 open open open 497 497
Windows 10.0.0.2 open open open subnet 1 open
Windows 10.0.0.3 open open open closed
Linux 10.0.0.4 open open subnet 2 139 139
Windows 10.0.0.5 open open open closed open
Linux 10.0.0.6 open open open subnet 3 [0: 0.63, 1: 0.89,
Linux 10.0.0.7 open open open 22 2 2 2:0.89, 3:2.23]
(a) open closed open
[0: 0.5, 1:0.71, 0 1
2:1.1] 135 135
Top 3 Anomalies 135
closed closed open closed
subnet reason z−value 1 0
3 22/445=open 2.23
10.0.0.0 10.0.0.4 10.0.0.1 10.0.0.6
10.0.0.2 10.0.0.7
0 445 1.6 10.0.0.3
10.0.0.5
2 135/445=open, 1.1
22=closed
(c) (b)
Figure 2. (a) Eight systems over the network 10.0.0.0/29 with configuration for different ports (un-
marked ports are closed). (b) The anomaly computed for different subnets at various aggregation
pointsinthegraph(shownassubnet: z-value). (c)Thetopthreeanomaliesinthenetworktogether
withthereasonthattriggeredtheanomaly.