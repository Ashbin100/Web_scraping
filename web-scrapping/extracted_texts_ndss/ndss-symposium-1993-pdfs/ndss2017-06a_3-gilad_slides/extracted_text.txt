Are We There Yet?
On RPKI Deployment and Security
Yossi Gilad
joint work with: Avichai Cohen,
Amir Herzberg, Michael Schapira, Haya ShulmanThe Resource Public Key Infrastructure
The Resource Public Key Infrastructure (RPKI) maps IP
preBixes to organizations that own them [RFC 6480]
• Intended to prevent preBix/subpreBix hijacks
• Lays the foundation for advanced defenses against
path-manipulation attacks on interdomain routing
– BGPsec, SoBGP,…
2RPKI Allows Route Origin Validation
Autonomous System (AS) X uses the RPKI to issue a Route Origin
Authoriza8on (ROA) mapping from 91.0/10 to AS 3320
Route Origin
ROA:
AS X
Valida8on (ROV)
91.0.0.0/10
91.0.0.0/10
Max-length = 10
Path: Y-3320 91.0.0.0/10
AS 3320
AS Y
Path: 666
AS 666
91.0.0.0/10
AS
Deutsche
Path: 3320
3320 BGP Ad. Data flow
Telekom
3 3Talk Outline
• ROV
– First measurements of ROV
– How “good” is ROV in partial deployment?
• ROAs
– Mistakes
– Improving accuracy with ROAlert
4Filtering Bogus Advertisements
Route-Origin Validation (ROV):
use ROAs to discard/deprioritize route-
advertisements from unauthorized origins [RFC 6811]
Autonomous System
RP KI cache
Verify signatures
ROAs
RPKI pub.
point
91.0.0.0/10:
AS = 3320, max-length = 10
BGP Routers 5Measuring Non-ROV-Filtering ASes
ASes that propagate invalid BGP advertisements do
not perform Biltering
Origin 1 A
1.2.3.0/24
Origins 1 & 2 adverZse in BGP RV
B C
RPKI-invalid IP prefixes sensor
Origin 2 D
4.5.6.0/24
RV
E
F
sensor
6Measuring Non-ROV-Filtering ASes
ASes that propagate invalid BGP advertisements do
not perform Biltering
Route Views sensor observes
“bad” route to: 1.2.3/24
Origin 1 A
AS path: C, A, Origin 1
1.2.3.0/24
RV
B C
sensor
Route Views sensor observes
Origin 2 D “bad” route to: 4.5.6.0/24
AS path: F, E, D, Origin 2
4.5.6.0/24
RV
E
F
sensor
7Measuring Non-ROV-Filtering ASes
ASes that propagate invalid BGP advertisements do
not perform Biltering
Origin 1 A
1.2.3.0/24
RV
B C
sensor
We find that at least 78 of 100 largest ISPs do not filter
Origin 2 D
4.5.6.0/24
RV
E
F
sensor
ASes that don’t filter
invalid adver8sements
8What is the Impact of Partial
ROV Adoption?
• Collateral beneBit:
– Adopters protect ASes behind them by discarding invalid routes
1.1.0.0/16
To: 1.1.1/24 AS 3 is only offered
Max-length = 16
AS 666
AS path: 666 a good route
AS 1
AS AS
2 3
To: 1.1/16
Origin AS path: 2-1
AS 1
9What is the Impact of Partial
ROV Adoption?
• Collateral damage: ASes not doing ROV might cause ASes
that do ROV to fall victim to attacks!
– Disconnection: Adopters might be offered only bad routes
1.1.0.0/16
AS 3 receives only bad
Max-length = 16 AS 666 To: 1.1/16
AS 1 AS path: 2-666 adverZsement and
disconnects from 1.1/16
AS AS
AS 2 prefers to adverZse
2 3
routes from AS 666 over AS 1
To: 1.1/16
Origin
AS path: 1
AS 1
10What is the Impact of Partial
ROV Adoption?
• Collateral damage: ASes not doing ROV might cause ASes
that do ROV to fall victim to attacks!
– Control-Plane-Data-Plane Mismatch! data Blows to
attacker, although AS 3 discarded it
1.1.0.0/16
Max-length = 16 To: 1.1.1/24
AS 666
AS 1
AS path: 2-666
AS 3 discards bad
subprefix route
AS 2 adverZses both
AS AS
prefix & subprefix routes
2 3
AS 2 does not filter and uses
To: 1.1/16
bad route for subprefix
AS path: 2-1
Origin
11
AS 1Quantify Security in Partial Adoption:
Simulation Framework
• Pick vicZm & aeacker
1.1.0.0/16
• VicZm’s prefix has a ROA
A
Max-length = 16
B
• Pick set of ASes doing ROV
AS A
C
• Evaluate which ASes send
traffic to the aeacker
D
E F
G
H
I
J
K
L
Empirically-derived AS-level network from CAIDA
Including inferred peering links [Giotsas et al., SIGCOMM’13] 12Quantify Security in Partial Adoption
• Top ISP adopts with probability p
• SigniBicant beneBit only when p is high
Subprefix hijack
Prefix hijack
success rate
success rate
13Quantify Security in Partial Adoption
• Comparison between two scenarios:
– today’s status, as reBlected by our measurements
– all top 100 ISPs perform ROV
• Each other AS does ROV with Bixed probability
Subprefix hijack
AdopZon by the top 100 ISPs makes a huge difference!
success rate
14Security in Partial Adoption
Bottom line:
ROV enforcement by the top ISPs is both necessary and
suf=icient for substantial security beneBits from RPKI
15Talk Outline
• Security in partial ROV deployment
– First measurements of ROV
– How “good” is ROV in partial deployment?
• ROAs
– Mistakes
– Improving accuracy with ROAlert
16Mistakes in ROAs
Many mistakes in ROAs (see RPKI monitor)
– ``bad ROAs’’ cause legitimate preBixes to appear invalid
– Biltering by ROAs may cause disconnection from legitimate destinations
– extensive measurements in [Iamartino et al., PAM’15]
17Bad ROAs
Concern for disconnection was pointed out in our survey
– anonymous survey of over 100 network operators (details in paper)
What are your main concerns regarding executing RPKI-based
origin authentication in your network?
18Bad ROAs
Who is responsible for “bad ROAs”?
• Hundreds of organizations are responsible for invalid IP
preBixes, but…
• Good news: most errors due to small number of organizations
19Insecure Deployment: Loose ROAs
1.2.0.0/16
Max-length = 24
AS A
Longest-prefix-match
Path length does not ma^er
ROA allows adverZsing subprefixes up to length /24
AS A originates 1.2.0.0/16
Valid adverZsement
but not 1.2.3.0/24
since AS A is the “origin”
AS X
ROA is “loose”
1.2.0.0/16 1.2.3.0/24
Path: A Path: 666-A
AS A
AS 666
BGP Ad. Data flow
20Insecure Deployment: Loose ROAs
• Loose ROAs are common!
– almost 30% of IP preBixes in ROAs
– manifests even in large providers
21Improving Accuracy with ROAlert
• roalert.org allows to check whether networks are protected by ROAs
– … and if not, why not
• Online, proactive notiBication system
– constantly monitoring
– not opt-in
• Retrieves ROAs from the RPKI and compares them against BGP advs.
• Alerts network operators about “loose ROAs” & “bad ROAs”
22Improving Accuracy with ROAlert
• Initial results are promising!
– notiBications reached 168 operators
– 42% of errors were Bixed within a month
23Conclusion
• The RPKI can be very effective in preventing hijacks
– Incentivize ROV adoption by the top ISPs!
– Both sufBicient and necessary for signiBicant security beneBits
• Information accuracy is a major challenge
– ROAlert informs & alerts operators about:
• Bad ROAs
• Loose ROAs
24Thank You!
Questions? J
25