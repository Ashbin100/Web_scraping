Feb. 26 – Mar. 1
FBS-Radar: Uncovering Fake Base
Stations at Scale in the Wild
Zhenhua Li Weiwei Wang Christo Wilson Jian Chen Chen Qian
Taeho Jung Lan Zhang Kebin Liu Xiangyang Li Yunhao Liu
lizhenhua1983@gmail.com
http://www.greenorbs.org/people/lzh/
Mar. 1st, 2017
1Outline
Background
State of the Art
Our System
Locating FBSes
Summary
2Story 1
SMS Text
Message
From 95599 (Agriculture
Bank of China):
We’re processing the
student loan you’ve
applied for, and now
requiring you to transfer
a deposit of ¥9900 (≈
$1500) to the bank
account XXXXXXXXX.
* Note: This is a simplified version of the actual story which involves more complex details. 3Story 2
SMS Text
Message
From 95566 (Bank of
China): Fake Base
We’re processing the
Stations
house mortgage for
you. Please prepare
¥17,600,000 (≈
$2,600,000) ...
* Note: This is a simplified version of the actual story which involves more complex details. 4GSM
(Global System for Mobile Communication)
Birth Year User Scale Speed Security
2G – GSM 1990 > 1 billion Low Poor
3G – CDMA 2008 < 2 billion Middle Middle
4G – LTE 2009 ≈ 3 billion High Fine
authentication
X
Fake Base
5
StationsFBS Carrier
Very high
signal strength
6Fake Base Station (FBS)
Engineering
Cellphone
Legitimate
FBS
USB
BS
Cable
Engineering Wireless
Laptop Transceiver
FBS
7FBS Attack on GSM Phones
- 70 dBm - 100 dBm
Current
Which BS has
Connection
the highest
signal strength?
- 60 dBm I may have to - 30 dBm
switch my BS
connec8on … Location
Update
GSM
8FBS Attack on GSM Phones
- 70 dBm - 100 dBm
New Connection
- 60 dBm - 30 dBm
GSM
9FBS Can Also Impact 3G/4G Phones
Jamming Signal
3G/4G
GSM
Degrade
GSM
GSM has existed for
many years, so
abandoning GSM also
needs many years …
10FBS Attack Is NOT Hypothetical
Russia
UK
☜
US
China
India
Year # FBS Msgs
2013 >> 2.9 billion
2014 >> 4.2 billion
2015 >> 5.7 billion
N * billion
11FBS Industry in China
Device: $400
Daily income: $40
Device: $1000
Daily income: $70
Device: $700
Daily income: up to $1400
12FBS Industry in China
Device: $400
Daily income: $40
Device: $1000
Daily income: $70
Device: $700
Daily income: up to $1400
13State of the Art
14Electronic Fence
Huge infrastructure costs à Poor scalability
15FBS-signal Detection Car
Random walk à Limited coverage & “dull”
16User Reporting
Dial 12321
Most users don’t realize the existence of FBSes
17Client-side Tools
Do they really work in large-scale practice? …
18Our System:
FBS-Radar
19Baidu PhoneGuard Users Opt-in
p Sender’s number is not in
Report multiple
the recipient’s contact list
fields of suspicious
SMS messages p Sender’s number is an
authoritative number
20Five Methods
1. Signal
0.23%
Strength
Examina8on
5. BS-Handover
2. BS ID Syntax
0.39%
Speed 0.15%
Checking
Es8ma8on
~100M
users
4. BS-WiFi
4.1% 3. Message
Loca8on 0.16%
Content Mining
Analysis
213.1 Signal Strength Examination
22
☜
-40 dBm
> -40 dBm
FBS
0.23% of user-
reported suspicious
SMS messages3.2 BS ID Syntax Checking
BS ID = MCC + MNC + LAC + CID
p MCC: Mobile Country Code, 3 digits
p MNC: Mobile Network Code, 2 digits
p LAC: Location Area Code, 16 bits
p CID: Cell Identity, 16 bits for 2G/3G and 28 bits for 4G
0.15% of suspicious messages were
sent by BSes with syntactically invalid
IDs
233.3 Message Content Mining
p Bag-of-words SVM (Support Vector Machine)
classifier trained on 200,000 hand labeled SMS
-
messages
① Labelling suspicious messages;
② Word segmenta8on;
l Computa8on
③ Feature extrac8on;
intensive
④ Quan8zing the feature vector;
l Viola8on of
⑤ Training the SVM model;
user privacy
⑥ Preprocessing the test set;
⑦ SVM classifica8on of the test set.
0.16% of suspicious messages came from
authoritative phone numbers and were
determined to contain fraud text content
243.4 BS-WiFi Location Analysis
BS Location
User WiFi Location
4.1%
of suspicious messages were sent by BSes
that were not in their correct geolocation, i.e., they
were spoofing the ID of a legitimate but distant BS.
253.4 Counterfeiting a Nearby BS ID
- 70 dBm - 100 dBm
My loca8on does
not change a lot,
Current
so I needn’t switch
Connection
to a new BS J
- 60 dBm - 30 dBm
If I counterfeit
Location
a nearby BS ID
Update
…
263.5 BS-Handover Speed Estimation
p For BS-WiFi location analysis, what if the WiFi
location information is not available?
274.5 BS-Handover Speed Estimation
>> 0.39% of suspicious SMS
messages come from FBSes
28Detection Performance
p > 4.7% of suspicious messages should have come from FBSes
- False positive rate is only 0.05% (according to user feedback),
mainly due to the inaccuracy of our WiFi database
p Set-3 (by message content mining) is >98% covered by the
other 4 sets
- No need to collect the text content of users’ messages!
29Arresting FBS Operators
p With the help of FBS-Radar, the police have arrested
tens to hundreds of FBS operators every month
30Locating FBSes
31Locating FBSes
based on User Device Locations
p FBSes frequently move and change their IDs
Ø We take both temporal and spatial locality into
account
Time
Only those FBS messages
1) using the same BS ID,
BS ID
1
2) happening in the same time window,
Window and 3) located in the same spatial cluster
Ć Ć
can be attributed to one FBS.
BS ID Ć Ć
2
32Locating FBSes
based on User Device Locations
p The centroid of every cluster is
the estimated location of an
FBS.
☜
deviation
distance
FBS
This loca8on accuracy is
sufficient for us to track FBSes!
33Real-time Locations of FBSes
Public URL à
http://shoujiweishi.baidu.com/static/map/pseudo.html
34Summary
l Using extensive crowdsourced data, we evaluate five
different methods for detecting FBSes in the wild,
and find that FBSes can be precisely identified without
sacrificing user privacy.
l We present a reasonable method for locating FBSes
with an acceptable accuracy.
l FBS-Radar is currently in use by ~100M
people. It protects users from millions of malicious
messages from FBSes every day, and has helped the
authorities arrest numerous FBS operators every month.
35Backup slidesFBS Attack: Passive vs. Active
Passive: IMSI-catcher
Rarely reported in
China, but sometimes
reported in the US
Active:
Push spam/fraud SMS
Year # FBS Msgs
messages with spoofed phone numbers
2013 >> 2.9 billion
2014 >> 4.2 billion
2015 >> 5.7 billion
37Ground Truth
p Our ONLY ground truth comes from users’ feedback
We think this
message comes
from an FBS. What
do you think?
p Yes: 99.95%
p No: 0.05%
Manual
double-check
38Why not use GPS?
p Most people turn GPS off in most time to save
battery, so we have to ask users for GPS privilege
Locajon User scale
accuracy decreases by
increases by 20%? for
20%? harassment …
39Localizing User Devices
based on WiFi Information
p The centroid of the dominant
cluster is the estimated
location of the user device
k-means
deviation
distance
Centroid
Dominant
DBSCAN
Cluster
40Spam and Fraud SMS Messages
“Dear user, you are lucky to be the winner of this month’s big
award! You will be offered 10-GB FREE 4G traffic by clicking on
this URL: http://www.10086a☜ward.co m.” --- sent from 10086 (China
Mobile).
Spoofed phone numbers
Fraud
“Dear customer, you have failed to pay for this year’s
management fee of 100 dollars. If you do not pay for
it before Jul. 30th, you will face a fine of 500 dollars.
You should pay it by transferring money to the
following bank account: ...” --- sent from 95533 (Bank of China).
“We are selling excellent, cheap goods and food from
Jul. to Aug. 2016. Visit our shops at the People’s
Square as soon as possible!” --- sent from a (usually not
Spam well-known) mart or grocery.
(Ads)
“We provide very cheap and legal invoices that can
help you quickly make a big fortune. Don’t hesitate,
dial us via the phone number: 010-61881234!” --- sent
from a (usually not well-known) company.
41FBS-Radar: 4-fold Design Goals
p Detect as many FBSes as possible with very
few false positives, without specialized hardware
p Automatically filter spam/fraud FBS messages
from user devices with a high precision
p Provide actionable intelligence about geolocations
of FBSes to aid law enforcement agencies
p Use minimal resources on client side, minimize
collection of sensitive data, and not require root.
42FBS-Radar & Baidu PhoneGuard
SVM Machine
WiFi-location
BS-location
Learning Cluster
Database
Database
User Report Content-free Content
Analysis Analysis
Message Authoritative
Baidu
Logs Phone Number List
PhoneGuard
http://
shoujiweishi.baidu.com
Crowdsourced data from ~100 Million Users
43Database and List
WiFi MAC à
<lat, lon, tag>
BS ID à
<lat, lon,
radius, tag>
SVM Machine
WiFi-location
BS-location
Learning Cluster
Database
Database
User Report Content-free Content ≈ 1500
Analysis Analysis
phone
numbers
Message Authoritative
Logs Phone Number List
44FBS-Radar: Timeline
2016
~32 million
2015 suspicious SMS
messages
~17.5 million
2014.08 reported per day
suspicious SMS
Online released
messages
2014.01-07 reported per day
Design &
Implementa8on
45Informed Consent from Users
46Opt-in Options for Users
Detection Rules (for FBS-Radar)
Intelligent Detection ON/OFF
Cloud-side Detection ON/OFF
Content Detection of Suspicious
SMS Messages ON/OFF
Suspicious Voice Call & SMS
Message Detection ON/OFF
Contacts’ Voice Call & SMS
Message Detection ON/OFF
Baidu
PhoneGuard
App
47