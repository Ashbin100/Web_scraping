Are We There Yet?
On RPKI’s Deployment and Security
Yossi Gilad∗, Avichai Cohen†, Amir Herzberg‡, Michael Schapira† and Haya Shulman§
∗Boston University and MIT CSAIL
†Hebrew University of Jerusalem
‡Bar Ilan University
§Fraunhofer SIT
Abstract— The Resource Public Key Infrastructure (RPKI) (e.g., [1], [8], [51], [52]), and many others go under the
binds IP address blocks to owners’ public keys. RPKI enables radar [55].
routerstoperformRouteOriginValidation(ROV),thusprevent-
ing devastating attacks such as IP prefix hijacking. Yet, despite The Resource Public Key Infrastructure (RPKI) [38] is a
extensive effort, RPKI’s deployment is frustratingly sluggish, hierarchical certification system. RPKI stores Route Origin
leaving the Internet largely insecure. We tackle fundamental Authorizations (ROAs), signed records that bind an IP address
questions regarding today’s RPKI’s deployment and security: block to the AS that is allowed to advertise it in BGP. ROAs
What is the adoption status of RPKI and ROV? What are the can be leveraged by BGP routers to perform Route-Origin
implicationsforglobalsecurityofpartialadoption?Whatarethe Validation(ROV)[9],[45]:identifyinganddiscarding“invalid”
root-causes for slow adoption? How can deployment be pushed
BGP route-advertisements from unauthorized ASes, thus pro-
forward? We address these questions through a combination of
tecting against IP prefix hijacking. Beyond being the leading
empirical analyses, a survey of over 100 network practitioners,
and, thus far, only standardized solution to prefix hijacking,
and extensive simulations. Our main contributions include the
RPKI is also a prerequisite for prominent routing security
following.WepresentthefirststudymeasuringROVenforcement,
revealingdisappointinglylowadoptionatthecoreoftheInternet. mechanisms such as BGPsec [42], and for other proposals for
We show, in contrast, that without almost ubiquitous ROV defending against BGP path-manipulation attacks, e.g., [15],
adoption by large ISPs significant security benefits cannot be [16], [58].
attained.Wenextexposeacriticalsecurityvulnerability:abouta
Yet, despite RPKI’s crucial role in securing the Internet
thirdofRPKIauthorizationsissuedforIPprefixesdonotprotect
the prefix from hijacking attacks. We examine potential reasons routing system, RPKI’s deployment is frustratingly low [47],
for scarce adoption of RPKI and ROV, including human error leaving the Internet largely exposed to dangerous traffic hi-
inissuingRPKIcertificatesandinter-organizationdependencies, jacking attacks. We embark on a systematic study of RPKI’s
and present recommendations for addressing these challenges. deploymentandsecurity.Wetacklethefollowingfundamental
questions: What is the adoption status of RPKI and ROV?
I. INTRODUCTION What are the implications for security of partial adoption of
RPKI/ROV? What are the root-causes for the slow adoption
The Border Gateway Protocol (BGP) computes routes
rates? How can deployment be pushed forward? We address
between the tens of thousands of smaller networks, called
thesequestionsthroughacombinationofempiricalanalysesof
Autonomous Systems (ASes), which make up the Internet.
multiple datasets, a survey of over 100 network practitioners,
ASes range from large ISPs and content providers to small
andextensivesimulationsonempirically-deriveddata.Wenext
businesses and universities. BGP is notoriously vulnerable
describe our main contributions.
to devastating attacks and configuration errors. Consequently,
nation states and corporations are in constant danger from
attacks that utilize BGP’s insecurity to disconnect ASes from A. Deployment Status
the Internet and to launch highly effective man-in-the-middle
Extensive effort is devoted to promoting the adoption
attacks. A particularly worrisome and common attack vector
of RPKI and ROV. The IETF’s SIDR (Secure Inter-Domain
is IP prefix hijacking, where an AS advertises in BGP an
Routing) working group standardized the relevant protocols,
IP prefix not belonging to it. Prefix hijacks are effective and
androutersupportforROVisalreadyavailablefromallmajor
easy to launch, with the extra benefit of a plausible excuse:
vendors. For RPKI to provide meaningful security guarantees,
benign configuration errors [53]. Every year several high-
two conditions must be met: (1) ASes should issue ROAs
profile incidents resulting from prefix hijacks make the news
covering their address blocks, and (2) ASes should configure
BGP routers to do ROV, i.e., discard BGP advertisements that
are incompatible with ROAs. Only about 6.5% of IP prefixes
Permission to freely reproduce all or part of this paper for noncommercial
purposes is granted provided that copies bear this notice and the full citation advertised in BGP are covered by ROAs [47], [57]. (We will
on the first page. Reproduction for commercial purposes is strictly prohibited discuss the root-causes for this scarce deployment later on.)
without the prior written consent of the Internet Society, the first-named author What about adoption of ROV?
(for reproduction of an entire paper only), and the author’s employer if the
paper was prepared within the scope of employment. Any AS, anywhere, can enforce ROV, provided that its
NDSS ’17, 26 February - 1 March 2017, San Diego, CA, USA
routers support ROV (most modern routers do). We aim
Copyright 2017 Internet Society, ISBN 1-891562-46-0
http://dx.doi.org/10.14722/ndss.2017.23123 to understand how many ASes actually do. We present thefirst quantitative study of ROV adoption. Our findings are Our survey of network operators confirms that mistrust in the
disappointing: only a very small fraction of the large ISPs RPKI infrastructure is indeed an important reason for non-
at the core of the Internet enforce ROV. deployment. Our empirical measurement results, however, re-
veal a more nuanced (and somewhat more optimistic) picture:
B. Security Evaluation abreakdownofinvalidIPprefixesbyorganizationsshowsthat
roughly 20 organizations are responsible for the invalidity of
Security in partial deployment. Given our results for ROV
most of these IP prefixes, giving hope that this situation can
adoption, a natural question arises: What is the impact on
be greatly improved via highly focused efforts.
global routing security of partial adoption of ROV? We
identify interesting phenomena that can manifest when ROV Inter-organization dependencies. Another potential reason
isnotgloballyadopted.Notsurprisingly,ROVenforcementby for RPKI’s slow certification rates is inter-organization de-
an AS can yield collateral benefits, protecting others routing pendencies that force an AS that wishes to issue a ROA to
through thatAS fromtraffic hijackingattacks. Lessobviously, wait for other ASes to issue ROAs first. We show that while
however, non-adoption by an AS can cause collateral damage such dependencies do not pertain to most ASes, some of the
resulting in ROV-enforcing ASes falling victim to attacks. world’s largest ISPs cannot easily issue ROAs for this reason.
To gain insights into how these effects impact security,
D. Recommendations
wepresenttheresultsofextensivesimulationsofpartialROV-
adoptionscenarios.WefindthatROViseffectiveagainstprefix We present several concrete proposals for driving RPKI
hijacking if and only if almost all of the largest ISPs (e.g., top adoption forward. We advocate concentrating standardization,
100) enforce ROV. Consequently, under today’s meagre ROV regulatory, and educational efforts in the following directions.
adoption, an AS that issues a ROA for its IP address blocks
is largely unprotected from such attacks. Eliminating obstacles to deployment via modest changes
to RPKI. We introduce a new kind of ROAs, compatible
InsecureROAs.Wenextexposeacriticalsecurityvulnerabil- withthecurrentformat,whichcaneliminatetroublesomeinter-
ityofRPKI:aboutathirdoftheIPprefixesinBGPtablesthat organization dependencies.
are covered by ROAs are badly issued and, consequently, the
issuing organizations remain vulnerable to traffic hijacking. In TargetingthecoreoftheInternet.Oursecurityevaluationof
fact, an attacker can hijack all traffic destined for the issuers ROV in partial deployment shows that adoption by the largest
of such “insecure ROAs” even if all ASes on the Internet ISPs is key to attaining meaningful security guarantees. We
do ROV. We show that even large ISPs, e.g., Swisscom and thus advocate targeting effort (regulatory, providing proper in-
Orange,sufferfromthisvulnerability.(Wepresent,throughout centives,etc.)onboostingROVadoptionamongstthetopISPs.
this paper, real-world examples of security vulnerabilities and
Improving RPKI’s reliability and integrity. Our results
otherRPKI-relatedundesirablephenomena.Alltheseproblems
on RPKI deployment show that human error (when issuing
have been reported to network operators.)
ROAs) is a key factor in RPKI’s unreliability and insecurity
and that relatively few organizations are responsible for the
C. Obstacles to Adoption
majority of badly issued ROAs. Thus, concentrating effort
While the hurdles to deployment of BGPsec were studied on these organizations can lead to a drastic decrease in the
in depth (e.g., see [23], [41]), fairly little attention has been number of badly issued ROAs. To alert network operators
given to RPKI’s (non)deployment. Clearly, RPKI and ROV about “bad ROAs” affecting their connectivity or security,
suffer froma circulardependency: ASesdo not gainsufficient and inform them about their organization-specific obstacles to
security benefits from ROV so long as so many IP prefixes RPKI deployment, we present ROAlert, identifying incorrect
advertised in BGP are not certified through RPKI, yet there is ROAs and alerting administrators via email and via web. We
little incentive to certify ownership over an IP prefix (issue a encouragethereadertoentertheROAlertwebsiteatroalert.org
ROA) when so few ASes do ROV. todiscoverwhetherher/hisIPaddress(oranyotherIPaddress
of her/his choice) is correctly protected by a ROA in RPKI
This circular dependency is not unique to RPKI and ROV.
and, if not, why (the relevant terminology is presented in
Similar dependencies hinder adoption of other standards, e.g.,
the sequel). Our experience with ROAlert, including feedback
DNSSEC and IPv6 (see, for example, DNSSEC adoption
fromdozensofnetworkadministrators,indicatesthatROAlert,
rates [18], [22]). RPKI and ROV, however, do not share other
if employed and promoted by the relevant entities, could aid
majordrawbacksoftheseotherstandards,e.g.,interoperability
in building trust in RPKI and boosting its adoption.
concerns (i.e., compatibility with legacy protocols), runtime
overheads (e.g., resulting from online cryptography), etc.
E. Organization
What, then, are the main factors hindering RPKI deployment?
Section II provides the required background on RPKI and
Human error. Beyond insufficient value/incentive for adop- ROV. We discuss ROV’s adoption status and its impact on
tion, RPKI and ROV suffer from an even worse problem: global routing security in Sections III and IV, respectively.
(justified) mistrust. Past studies [19], [33], [34] show that We present our results on the insecure ROAs in Section V,
about8%ofIPprefixesadvertisedinBGPthatarecoveredby exposing a vulnerability of RPKI deployment in practice. We
ROAs are “invalid”. Consequently, an AS doing ROV would discuss and quantify obstacles to adoption in Section VI and
be immediately disconnected from thousands of legitimate IP introduce, in Section VII, our proposals for facilitating wider
prefixes owned by hundreds of organizations, an arguably adoption.WereviewrelatedworkinSectionVIIIandconclude
worse outcome than the attack RPKI is meant to prevent. in Section IX.
2Fig. 1: Deutsche Telekom received an RC from RIPE and
issuedaROAtoprotectitsIP-prefix(advertisedthroughBGP)
Fig.2:AlocalcachesyncswithRPKIpublicationpoints.BGP
II. BACKGROUND:RPKI,RCS,ROAS,ANDROV routers periodically pull the cache for whitelist updates.
RPKI [38] maps IP address blocks to organizations that
“own” them, thus laying the foundation for combating IP
B. Route-Origin Validation (ROV)
prefix hijacking and for further protection from attacks on
inter-domain routing via BGPsec and alternative proposals for Organizations can enforce route-origin validation
defending against BGP path-manipulation attacks [15], [16], (ROV) [9], [45] to identify and discard BGP route-
[42], [58]. We next elaborate on how ownership of IP prefixes advertisements that violate ROAs. Namely, advertisements
is certified in RPKI and how this information can be used to where the destination IP prefix is not mapped to the origin
discard bogus BGP route-advertisements. AS specified in the ROA. A local cache machine at the AS
periodicallysyncswiththeRPKIdatabasetoretrieveRCsand
ROAs, validating them from the root of the RPKI hierarchy
A. Certifying Ownership to its leaves. Valid ROAs mapping IP prefixes to ASes are
then used to generate whitelists which BGP routers in that
RPKI assigns an IP prefix to a public key via a Resource
AS pull from the cache periodically using the RPKI-to-Router
Certificate (RC), issued by the authoritative entity for that IP
protocol [10]. See Figure 2. With cryptographic operations
prefix. This allows the owner of the corresponding private key
outsourced to the cache machine, routers can enforce ROV
toissueaRouteOriginAuthorization(ROA)specifyingtheAS
without changes to their hardware or BGP-message handling
numbers ofASes authorized to advertisethe IP prefixin BGP.
architecture (routers supported configuration of filters to BGP
We explain below some of the specifics involved in issuing
messages long before RPKI).
RCs and ROAs.
UponreceivingaBGProute-advertisement,theBGProuter
RPKIRCsformacertificationhierarchyasfollows.Atthe checks whether the advertised destination IP prefix p is “cov-
top of the hierarchy are the five Regional Internet Registries ered” by a ROA, that is, whether there exists a ROA for a
(RIRs).EachRIRholdsaroot(self-signed)RCcoveringallIP superprefix P ⊇ p. The route-advertisement is then assigned
addresses in its geographical region. Organizations that were one of following three states:
allocatedanIPprefixdirectlybyanRIRcanrequesttheRIRto
issue them an RC, validating their ownership of the IP prefix. • Unknown: p is not covered by any ROA.
For example, Deutsche Telekom in Figure 1 was certified by • Valid: p is covered by a ROA, the origin AS number
RIPE for its address space 91.0.0.0/10. matches AS number specified in the ROA and the
IP prefix is no longer than the maximum length
In case of that ownership was later delagated, that is, if an
specified in the ROA (e.g., see Deutsche Telekom’s
organization A further allocated a subprefix to organization B,
advertisement in Figure 1).
then A is responsible for certifying B as the owner for that
subprefix. Of course, to accomplish this, A must itself possess • Invalid: Otherwise (p is covered, but not “valid”).
an RC for its assigned IP addresses.
Routers use this state assignment to realize route-filtering
As explained above, once an organization holds an RC, policies. The default action for most routers is to discard
it can issue a ROA to protect its IP prefixes from hijacks.1 invalid routes (e.g., see [14], [35]) and this is also the
ROAs specify an IP prefix, the number of the AS authorized considered best practice [21] (RFC7454 states that routers
to advertise that IP prefix in BGP, and the maximum-length SHOULDdiscardinvalidroutes).However,anROV-enforcing
of subprefixes the specified AS may advertise. Figure 1 shows AS may instead choose to configure its router to merely de-
that Deutsche Telekom used its RC to issue a ROA so as to preferinvalidroutesoverotherroutes.Indeed,oursurveyfinds
protect its IP prefix against hijacking. that some operators do this (see Section III). However, as
observed in [17], [28], de-preferring invalid routes leaves the
AScompletelyvulnerabletosubprefixhijacking.Wetherefore
1Actually,theownerissuesanend-entity(EE)certificateforanephemeral
focus our attention henceforth only on ROV adopters that
one-time-usekey,whichisusedtosigntheROA[38,Section2.3].TheROA
andEEcertarestoredtogether,sowehavetreatedthemasoneobject. discard invalid routes.
3Fig. 3: Using invalid route advertisements (marked by red
arrows) and valid/unknown route advertisements (marked by
black arrows), to find ASes that do not enforce ROV (marked
in red) and ROV-enforcing ASes (marked in green).
Fig. 4: ROV enforcement among the 100 largest ISPs
III. ROVADOPTIONSTATUS
RouteOriginValidation(ROV),definedinRFC6483[32],
allows BGP routers to prevent prefix hijacking by detecting
thatanincomingBGPadvertisementisinconsistentwithROAs
in RPKI. Major vendors support ROV in their BGP routers
with negligible computational overhead (e.g., see [14], [35]).
Hence, deploying ROV involves only a modest, one-time
installation effort, and no significant operational expenses. We
present the first measurements of ROV adoption, showing that
it is very limited, in particular at the core of the Internet. To
complement and support our measurements, we also surveyed
over 100 network practitioners about ROV adoption in their
networks.
Fig. 5: Survey. Do you apply RPKI-based route origin valida-
A. Quantifying ROV Adoption
tion (ROV)?
While measurements regarding the issuing of ROAs exist,
e.g., [47], [57], we are unaware of any previous measurement
ofROVadoption.Indeed,measuringadoptionofROVbyASes
seems challenging: how can we tell if a BGP router performs see the black arrows in Figure 3) and an invalid BGP adver-
ROV or not? We identified a way to gain empirical insights tisement, like the origin AS in Figure 3. Intuitively, we then
regarding the extent to which ROV is adopted by leveraging check which ASes discarded the invalid route-advertisement
invalidBGProute-advertisements,i.e.,advertisementsthatare from that AS but relayed the other advertisement from the
incompatible with ROAs (see Section II-B). We first explain same AS. Specifically, we check whether there is only one
our measurement techniques and then discuss our results. transit AS on the non-invalid advertisement’s route that did
not relay any invalid route-advertisement (see green node in
IdentifyingASesthatdonotenforceROV.WeexamineBGP Figure 3).3 We categorize an AS as ROV-enforcing if it meets
paths from the multiple vantage points afforded by 44 Route the above criterion with respect to three different destination
Views sensors [54] and identify ASes that propagate BGP- ASes.
path advertisements that are classified as “invalid” according
to RPKI (see red nodes in Figure 3).2 We conclude that these Results. Our measurement techniques, as described above,
ASes do not enforce ROV (at least not for all invalid IP provide a view on the state of ROV enforcement amongst the
prefixes). Of course, this measurement identifies only non- ASes at the core of the Internet (since these are likely to be
adopting ASes. When an AS does not appear in any of the on the paths observed by the Route Views sensors). Figure 4
received announcements, this might not be due to ROV but to shows the results for the top 100 ISPs (ordered by the number
other reasons, e.g., its BGP paths to the relevant IP prefixes of the customer ASes). We find that almost all of the top 100
did not propagate to the vantage points. Hence, our results set ISPs do not enforce ROV. Specifically, we found only one AS
a lower bound on ROV non-adoption. of the top 20 ISPs that enforces ROV, and at least 78 of the
top 100 ISPs do not enforce ROV. In fact, we found only 9
IdentifyingASesthatenforceROV.ToidentifyASesthatdo of the top 100 ISPs enforce ROV. Note that 13 of the top 100
enforceROV,weapplythefollowingmethodology.Weseekan ISPscouldnotbeclassifiedbyourmethod(ascapturedbythe
AS that originates both a BGP-route advertisement that is not grey line in Figure 4).
invalid (i.e., is classified as either valid or unknown by RPKI,
3SincetheBGPdecisionprocessatanASisoftenidenticalacrossdifferent
2WeexcludedadvertisementsfromthesameASastheRouteViewssensor, destinationIPprefixesinthesameAS,thisapproachislikelytoidentifyASes
orfromitscustomers,sincethesemightnotbesubjecttofiltering. thatfilteredtheinvalidadvertisementandpropagatedthevalidone.
4(b) Collateral damage (disconnection): AS 3 (c) Collateral damage (hijack): AS 3’s traffic
(a) Collateral benefit: AS 3 does not fall receives only an invalid route from (non- to AS 1 is forwarded via the attacking AS
victim although it does not perform ROV enforcing)AS2,andhencehasnovalidpath 666, although AS3 discarded the attacker’s
to AS 1 advertisement
Fig. 6: Collateral benefit and collateral damage in partial ROV adoption. Solid arrows represent BGP advertisements, dashed
arrows represent data packet forwarding.
B. Survey Results selves. To see this, consider the simple network depicted in
Figure 6a.Suppose that AS 1is the legitimate ownerof prefix
To complement and corroborate the above results, we
1.1/16, issued a ROA protecting this IP prefix, and advertises
conducted an anonymous survey of over 100 network se-
this IP prefix in BGP. Suppose also that AS 2 enforces ROV
curity practitioners. Our survey was conducted by sending
and all other ASes do not. Now, consider the scenario that an
requests over different mailing lists, including ‘closed’ lists
attacker, AS 666, announces the subprefix 1.1.1/24. AS 2 will
(where membership is limited only to recognized practition-
discard the false route-advertisement from 666 and, in doing
ers).4 Among participants 80% were network operators or
so, also protect AS 3. We refer to this as a collateral benefit
managers and most others were security/networking consul-
from ROV enforcement.
tants, Appendix A provides additional characterization of the
participants.
Collateral damage. In contrast, an AS that does not apply
We asked survey participants whether and how they apply ROV can cause ROV-enforcers to get disconnected from the
RPKI-basedROVintheirBGProuters.Figure5illustratesour victim or, surprisingly, have their traffic forwarded to the
results. Over 84% of responses indicate not enforcing ROV attacker. We describe such scenarios using the same network
at all. Less than 6% of the participants reported enforcing topologyasbefore,onlynowweassumethatAS3ratherthan
ROV. A larger fraction of the participants (over 10%) reported AS 2 performs ROV.
assigninglowerpreferencetoBGProute-advertisementswhose
ROV validation status is “invalid”. As described in Section II, A BGP-speaking router only advertises one route per
this adoption mode leaves adopters completely vulnerable to prefixtoneighboringASes.Assumethattheattackerperforms
subprefix hijacks. prefix hijacking, i.e., advertises the same prefix as the victim.
AS 3 that enforces ROV will automatically discard BGP route
advertisementsthatareinconsistentwithROAs.Ifitsprovider
IV. SECURITYINPARTIALADOPTION
(AS 2) advertises the attacker’s invalid route advertisement,
ThemeasurementresultsinSectionIIIinvitethefollowing then AS 3 will disconnect from the legitimate origin (AS 1).
question: What is the impact of partial ROV deployment on See Figure 6b.
security?
While AS 3 may be disconnected from legitimate desti-
A. Collateral Benefit and Damage nations, it may seem that its data traffic to such IP prefixes
willneverreachillegitimatedestinations(i.e.,prefixhijackers)
Weidentifycollateralbenefitandcollateraldamageeffects since it discards invalid routes. To see why this is incorrect
that greatly impact the security of ROV in partial deployment. consider the same network but when the attacker performs a
The scenarios in Figure 6 illustrate these effects, which we subprefix hijack, as described in Figure 6c. AS 2, which does
next describe. not apply ROV, will fall victim to the attack and select the
directBGPpathtoAS666forIPprefix1.1.1/24andthedirect
Collateral benefit. ROV allows adopting ASes to pro-
BGP path to AS 1 for the larger IP prefix 1.1/16. (Recall that,
tect the ASes “behind” them by blocking malicious route-
under BGP, routes to every destination IP prefix are computed
advertisements even if these ASes do not perform ROV them-
independently.) Upon receiving the corresponding two BGP
route-advertisements from AS 2, AS 3 will detect the attack
4Webelievethattheresultsarebiased,tosomedegree,inthedirectionof
anddiscardtheroute-advertisementfor1.1.1/24.Consequently,
strongersecurityandadoption,sinceexpertandsecurity-awareoperatorsare
morelikelytoparticipateinsuchforumsandtorespond. all packets from AS 1 to addresses in IP prefix 1.1.1/24 will
50.5
0.4
0.3
0.2
0.1
0
0 10 20 30 40 50 60 70 80 90 100
etaR
sseccuS
s’rekcattA
1. ROV adoption prob. 1 1
2. ROV adoption prob. 0.75
3. ROV adoption prob. 0.50 0.8
4. ROV adoption prob. 0.25
0.6
0.4
0.2
0
0 10 20 30 40 50 60 70 80 90 100
Expected Deployment (top ISPs)
(a) Prefix hijack success rate
etaR
sseccuS
s’rekcattA
1. ROV adoption prob. 1
2. ROV adoption prob. 0.75
3. ROV adoption prob. 0.50
4. ROV adoption prob. 0.25
Expected Deployment (top ISPs)
(b) Subprefix hijack success rate
Fig. 7: Collateral benefit: enforcing ROV only at top ISPs dramatically reduces attacker success rates
0.5
0.4
0.3
0.2
0.1
0
0 10 20 30 40 50 60 70 80 90 100
etaR
noitcennocsiD
retpodA
1. ROV adoption prob. 1 1
2. ROV adoption prob. 0.75
3. ROV adoption prob. 0.50 0.8
4. ROV adoption prob. 0.25
0.6
0.4
0.2
0
0 10 20 30 40 50 60 70 80 90 100
Expected Deployment (top ISPs)
(a) Prefix hijack leads to adopter disconnection
etaR
sseccuS
s’rekcattA
1. ROV adoption prob. 1
2. ROV adoption prob. 0.75
3. ROV adoption prob. 0.50
4. ROV adoption prob. 0.25
Expected Deployment (top ISPs)
(b) Subprefix hijack steals traffic from adopters
Fig. 8: Collateral damage: without adoption at top ISPs, ASes are “doomed” even if they perform ROV
bematchedatAS3totheBGPpath(2,1).Observe,however, from the set of x top ISPs (i.e., the ISPs with the highest
p
that packets from AS 3 to IP addresses in 1.1.1/24 would number of customer ASes). All other ASes do not enforce
be forwarded to AS 2 and then, after being matched to the ROV.Theresultspresentedareaveragedvaluesafterrepeating
BGP path for 1.1.1/24 at AS 2, forwarded to the attacker. the experiment 20 times for each possible number of adopters
Thisphenomenonresultsfromanattack-inducedinconsistency x∈{0,10,...,100}.
between AS 3’s perceived path to IP addresses in 1.1/16 (in
the control plane) and AS 2’s actual forwarding path to IP We find that, on the one hand, when all of the top 100
addresses in 1.1.1/24 (in the data plane). ISPs enforce ROV, hijack success rates diminish rapidly (as
a function of the number of deploying ISPs). Specifically,
the success rate of prefix hijacks is below 10% when the
B. Security Evaluation
50 largest ISPs enforce ROV and below 5% when the 100
largest ISPs enforce ROV (see Figure 7a). For the subprefix
We next quantify, through extensive simulations on
hijack attack, the attacker’s success rate falls from almost
empirically-derived datasets, the impact of collateral benefit
completesuccesstoabout22%whenthe100topISPsenforce
and damage, as described above, on global routing security.
ROV (see Figure 7b). On the other hand, we find that when
Simulationframework.OursimulationsapplytheBGProute- adoption rate is low (as it is today), the attacker’s success
computationmethodpresentedin[23],[24],[26]totheCAIDA rates diminish much more slowly. For example, the subprefix
AS-connectivity graph from July 2016. Our results average hijacker’ssuccessrateremainsashighas90%evenwhen25%
over 106 combinations of attacker and victim (i.e., the legit- of the 400 top ISPs perform ROV (i.e., for x=100 adopters).
imate owner of IP prefix) ASes, both selected uniformly at Forprefix-hijacking,successratesarelower,butstillhigh,e.g.,
random from the set of all ASes, as in [23], [26]. about 40% even when 25% of the top 400 ISPs adopt.
Impact of collateral benefit and damage. The results in BenefitfromROVadoptionnotatthecore.Wenextquantify
Figure 7 quantify the extent to which partial enforcement thebenefitthatanASnotatthecorecanderivefromadopting
of ROV at the core of the Internet can mitigate prefix and ROV. Our results in Figure 8 show the attacker’s success rate
subprefix hijacks, for prefixes covered by ROAs. We consider in harming (disconnect or hijack) ASes that enforce ROV for
different probabilities of adoption p, and different numbers different rates of partial ROV adoption at the core of the
of expected adopters x (between 0 to 100), chosen randomly Internet.OurresultsshowthatenforcingROVdoesnotbenefit
60.5
0.4
0.3
0.2
0.1
0
0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
etaR
sseccuS
s’rekcattA
1. Today’s status 1
2. Top ISPs perform ROV
0.8
0.6
0.4
0.2
0
0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
Deployment Probability of other ASes
(a) Prefix hijack success rate
etaR
sseccuS
s’rekcattA
1. Today’s status
2. Top ISPs perform ROV
Deployment Probability of other ASes
(b) Subprefix hijack success rate
Fig. 9: Comparing the benefit of RPKI under (1) today’s ROV deployment, and (2) when the top ISPs perform ROV
such an AS much over the benefits gained by only deploying BGP, e.g., if the max-length is set to /24, but only a /20
at the core, especially against subprefix-hijacking (observe the subprefix is advertised in BGP by the legitimate origin AS.
similarities between Figure 7a and 8a for prefix hijack, and We found that almost 30% of the IP prefixes covered by
Figure 7b and 8b for subprefix hijacks). We conclude that the ROAs fall in this category. Indeed, our analysis reveals that
benefit that an AS not at the core derives from ROV adoption network administrators often specify very relaxed restrictions
at the core of the Internet is essentially invariant (on average) onthemaximumlength.Specifically,over85%oflooseROAs
to whether or not that AS adopts ROV itself. Put differently, allowed maximum length of /24 (for IPv4 prefixes) or /48
global routing security is primarily affected by the collateral (for IPv6 prefixes), the most specific prefix lengths typically
benefit (and damage) from ROV enforcement at the core of accepted [21]. Our interactions with network administrators
the Internet. revealconfusionregardingthemax-lengthfieldandthepercep-
tionisthatspecifyinghighvaluesprovidesflexibilityinfuture
Today’s status. We explore the security benefits provided by changes to BGP advertisements, namely, enables advertising
today’s ROV enforcement at the Internet’s core. We compare more specific IP prefixes without revisiting the ROA. We
two cases: (1) ROV’s current deployment state, at the top show, however, that IP prefixes covered by loose ROAs are
100 ISPs as presented in Section III-A, and (2) when all of vulnerable to the following attack vector, which allows traffic
the top 100 ISPs enforce ROV. Figure 9 contrasts these two hijacking even if all ASes on the Internet perform ROV.
scenarios (compare the green and red lines). We measure the
attacker’s success rate when performing prefix and subprefix Attacking IP prefixes in loose ROAs. Suppose that a certain
hijacks for different ROV adoption probabilities of all other ROA specifies that an IP prefix p may be advertised in BGP
ASes on the Internet, i.e., ASes that are not in the 100 largest only by the (legitimate) origin AS a and that AS a advertises
ISPs, and/or ASes that were classified in “unknown” ROV- prefix p in BGP. Suppose further that this ROA is loose
enforcement status in Section III-A. We observe that if all according to the above definition. Then, the attacker may
top 100 ISPs enforce ROV, the security benefits of RPKI are advertise the BGP announcement 666 − a − p¯, where 666
dramatically improved. In contrast, under today’s enforcement representsanAScontrolledbytheattackerandp¯isapermitted
of ROV at the Internet’s core, prefix hijack attacks are likely subprefix of p. Observe that since p¯ is a subprefix of p, all
to succeed, and subprefix hijacks would remain very effective traffic destined for IP addresses in p¯will be forwarded to the
evenifallotherASesontheInternetenforceROV(about60% attacker due to IP’s longest-prefix matching. Observe also that
success rate, see Figure 9b). this attack cannot be detected by ROV, as the attacker’s BGP
advertisement specifies the legitimate origin, AS a. We point
Conclusion.Puttogether,alloursimulationresultsgiveriseto
out that this attack is a hybrid of two well-studied attacks:
the following conclusion. Enforcement of ROV at the core of subprefix hijacking, e.g., the attacker advertising the route
the Internet, by the top ISPs, appears to be both necessary 666−p¯, and the “next-hop attack”, i.e., the attacker advertises
and sufficient for gaining substantial benefits from RPKI. the route 666−a−p. The former is detectable by ROV but
Consequently,untilalargefractionoftheseISPsenforceROV, guarantees that all traffic from victims flow to the attacker (as
other ASes have limited incentive to issue ROAs for their IPlookupprioritizesmorespecificprefixes),whereasthelatter
prefixes (since they will remain largely unprotected). is undetectable by ROV but typically much less effective [16]
since the attacker’s success is a function of its location, the
V. INSECUREROAS BGP routing policies of others, etc. Through the exploitation
of loose ROAs and BGP path-manipulation, the attacker can
WeexposebelowanewvulnerabilityofRPKIthatrenders
enjoy the best of both worlds: attract all traffic to the victim
about a third of IP prefixes covered by ROAs insecure from
and going unnoticed by ROV.
traffic hijacking attacks even if ROV is ubiquitously adopted.
We say that a ROA is loose, when not all subprefixes of Real-world example. Swisscom, a large Swiss ISP, issued a
the maximum length allowed by the ROA are advertised in ROA for the prefix 81.62.0.0/15, with origin AS 3303. Swiss-
7Fig.10:SwisscomissuedaROAauthorizingupto/24prefixes, Fig. 12: BGP advertisement status according to RPKI
yet only announces two /16 subprefixes
real-world example in Figure 11, identified by our empirical
analyses of ROAs and BGP advertisements. Orange (previ-
ously France Telecom), a large French ISP, issued a ROA
for IP prefix 194.2.0.0/15 specifying the origin AS number
as 3215 (its own AS number). Orange has several customer
ASes that advertise in BGP subprefixes of 194.2.0.0/15 under
different AS numbers. E.g., Danone advertises the (sub)prefix
194.2.35.0/24 from its own AS, numbered 1272. Most of
Orange’s customers, including Danone and Ubisoft shown
in the figure, did not issue a ROA. Consequently, the BGP
advertisement of these customers are viewed as invalid ac-
Fig. 11: Orange (formally France Telecom) issued ROA inval-
cording to RPKI (since they appear like subprefix hijacks, see
idating customer announcements
discussion on the decision process in Section II-B). Thus, any
AS enforcing ROV will discard all BGP route-advertisements
to these destination IP prefixes. Not only that, Orange’s ROA
permits /24 advertisements, yet Orange and its customers
com also advertises this prefix and its two /16 subprefixes in
only advertise 23 of the 512 /24 subprefixes in Orange’s
BGP.SeeillustrationinFigure10.However,Swisscom’sROA
address space, rendering the rest vulnerable to our attack
specifies a max-length of 24, exposing it to the above attack.
fromSectionV.OthermistakesinROAsincludeinadvertently
E.g.,inordertohijackalltraffictotheprefix81.63.0.0/16,the
specifying the wrong AS number and advertising in BGP IP
attacker can announce through BGP its two /17 subprefixes
prefixes that are more specific (longer) than the maximum
81.63.0.0/17 and 81.63.128.0/17 with AS-path 666-3303. To
length specified in the ROA.
mitigate the attack, Swisscom should simply change the max-
length in their ROA to 16. Badly issued ROAs render the BGP route-advertisements
of the covered IP prefixes “invalid” to ROV-enforcing ASes.
VI. OBSTACLESTODEPLOYMENT Thus,anROV-enforcermaynotbeabletoreachtheIPprefixes
of the issuers of such “bad ROAs” or even the IP prefixes
We investigate the root causes for RPKI and ROV’s low
of other organizations (as illustrated in the Orange example
adoption. Our measurements in Section III revealed that only
above)5. Figure 12 presents the results of our measurement of
fewofthetopISPsenforceROV,i.e.,filterroutesaccordingto
the status of ROAs available in the RPKI database (in July
theROAsinRPKI.Thus,notsurprisingly,RPKIsuffersfroma
2016), and the corresponding BGP advertisements observed
circulardependencybetweenissuingROAsandadoptingROV:
in Route Views (6.5% of IP prefixes advertised in BGP are
ASes do not gain sufficient benefits from adopting ROV so
covered by ROAs). Beyond invalid IP prefixes, as described
long as so many IP prefixes are unprotected by ROAs, yet
above, the figure also shows the large fraction (almost 30%)
there is little incentive to issue a ROA so long as so few ASes
of valid but unprotected IP prefixes (due to loose ROAs,
enforce ROV. We turn our attention to two other main factors
as discussed in Section V). As evidenced by Figure 12, a
contributing to non-deployment: unreliability of RPKI due
significant number ofIP prefixes covered byROAs are invalid
to badly issued ROAs, and inter-organization dependencies.
(over 8%), matching the results in [34]. A few of these may
Unlike past studies of RPKI [19], [33], [34], our analysis
beactualprefixorsubprefixhijackingattacks,yetthemajority
reliesonabreakdownofROAsbyorganizations,thusyielding
is likely a result of configuration errors.
important new insights into RPKI and ROV’s deployability.
Our survey of network operators validates that being dis-
A. Mistakes in ROAs connected from legitimate destinations due to badly issued
Operators should specify in ROAs the IP prefixes adver- 5Notethat38%oftheinvalidannouncementsareforasubprefixofsome
tised by their organizations through 3 fields: the AS number, validannouncementbythesameoriginAS.Inthiscase,trafficfromtheROV-
enforcertoaddressesinthesubprefixwillreachtheoriginAS,althoughthe
IP prefix, and maximum length (see Section II) [39]. Unfortu-
ROV-enforcer discarded the invalid subprefix advertisement. However, ROV-
nately,mistakescommonlyoccurwhenissuingROAs[34].To
enforcerwillnotpublishtheinvalidsubprefixannouncementandhencemay
illustrate the dire implications of such mistakes consider the ‘lose’traffictothissubprefixfrommulti-homecustomers.
8Fig. 13: Survey. What are your main concerns regarding
executing RPKI-based origin authentication in your network?
Fig. 15: Level 3 Communications did not obtain an RC. As a
result, all its customers that own subprefixes cannot obtain an
RC.
1
0.8
0.6
0.4
0.2
0
w/RC no dep. 1 2 3+
(no dep.)
Fig. 14: Organizations responsible for bad ROAs
ROAsisamajorconcern.Indeed,fearfrombeingdisconnected
from other ASes (due to invalid ROAs) was the most common
reason specified for not performing ROV (over 30%), even
morecommonthannodemandfromcustomersandinsufficient
value; see Figure 13.
We aimto gaindeeper insightsinto thehuman errorfactor
in RPKI deployment in practice. To this end, we associate
badlyissuedROAsandthecorrespondingBGPadvertisements
withorganizations.(Thisturnsouttobenontrivial;weexplain
how it is done in Appendix B.)
WeattributeeachIPprefixrenderedinvalidbyROVtothe
organization responsible for that error. Our analysis reveals
some encouraging news. Although hundreds of organizations
are responsible for invalid IP prefixes, most of the errors
are caused by a small number of organizations, as shown in
Figure 14. Specifically, only 20 organizations are responsible
for issuing the ROAs causing 50% of the errors. We discuss
the significance of this finding, in terms of driving RPKI
deployment, in Section VII.
B. Inter-Organization Dependencies
Another potential reason for the disappointingly small
numberofROAsinRPKIareinter-organizationdependencies
that arise when to issue an RC and/or ROA for a prefix an
organization must wait for other organizations to take action
first. Two such dependencies exist: upward and downward.
The upward dependency is for issuing RCs: the RC for
prefix p must be signed by an entity already in possession
of a valid RC for a super-prefix containing p. Figure 15
noitcarF
Prefixes
IP-address space
Number of upward dependencies
Fig. 16: Upward dependency histogram
illustrates the hierarchical structure of RPKI and the inter-
organizational upward dependencies that it entails. Level 3
Communications is one of the largest ISPs worldwide. It
was allocated its IP addresses directly from ARIN, the RIR
for North-America, but did not issue an RC. Consequently,
over 500 other organizations are unable to obtain RCs and
issue ROAs to protect their thousands of prefixes. These
organizations include, for example, Twitter, LinkedIn, and
eBay, as illustrated in Figure 15.
ThedownwarddependencyisforissuingROAs:ifaprefix
p originates from some AS a, but p has a subprefix p¯ that
originates from a different AS b (belonging to a different
organization),thenpublishingaROAspecifyingaastheorigin
AS of p, before a ROA specifying b as the origin AS of p¯,
would invalidate BGP advertisements of p¯, as in the example
of Orange and its customers in Figure 11. (See discussion in
Section II on issuing RCs and ROAs.)
We next investigate the extent to which upward and down-
ward dependencies explain the slow adoption of RPKI. Our
resultsshowthatwhiletherearenotmanyinter-organizational
dependencies,downwarddependenciesposeobstaclestoRPKI
deployment for some of the largest ISPs worldwide.
Quantifying upward dependencies. We utilize our mapping
from RCs and ROAs to quantify upward dependencies. Fig-
ure 16 depicts the upward dependencies. See Appendix B
for a detailed exposition of our measurement methodology.
We find that about 20% of the prefixes are upward-dependent
on another organization. In fact, when looking at the portion
of the IP address space (the green bars in Figure 16), we
find that these prefixes hold less than 10% of the whole IP
91
0.8
0.6
0.4
0.2
0
w/ROA no dep. 1 2-9 10-99 100+
(no dep.)
noitcarF
Prefixes
IP-address space
Number of downward dependencies
Fig. 17: Downward dependency histogram
addressspace,probablysinceorganizationswithlargeprefixes
typically received their prefixes directly from the RIRs and so Fig. 18: Organizations with downward dependencies (CDF)
havenoupwarddependencies.Similarmeasurementsfocusing
onlyontheprefixesadvertisedinBGPexhibitthesametrends.
We also find that the number of prefixes with no upward
dependency, i.e., prefixes that may be covered by a certificate
but their owners refrain from doing so, is very high as shown
in the blue ‘no dep.’ bar in Figure 16.
Quantifying downward dependencies. As explained above,
downward dependencies arise when to issue a ROA for its
IP prefix an organization must wait for other organizations
advertising a subprefix of that prefix to issue ROAs first.
We next quantify downward-dependencies (see detailed de-
scription of our measurement methodology in Appendix B).
Figure 17 describes our results: about 90% of the IP prefixes
not protected by ROAs are not downward-dependent.
Unfortunately, the relatively few prefixes that are
downward-dependent constitute a large portion of the IP-
address space (compare blue and green bars for those with
Fig. 19: ROAlert system design
more than 100 dependencies in Figure 17) and belong to
some of the largest ISPs worldwide (Orange and Level 3
in Figures 11 and 15 are but a few examples). Figure 18
illustrates this problem, observe the sharp curve showing that the majority of badly issued ROAs. Thus, the number of
few organizations have most of the downward dependencies. BGP advertisements incorrectly categorized as invalid due
This is no surprise as the vast majority of ASes are smaller to human error can be significantly decreased via focused
organizations (that do not sell/lease IP address blocks to effort. To alert network operators about badly issued ROAs
other organizations), whereas large ISPs own large IP address and inform them about their organization-specific obstacles to
blocks and suballocate IP addresses to customers. We present RPKIdeployment,wepresentROAlert.WearguethatROAlert,
a solution to downward dependencies in Section VII. if adopted by the relevant entities (e.g., the RIRs), could aid
in building trust in RPKI and boosting its adoption.
VII. DRIVINGRPKIFORWARD
Eliminating downward dependencies with wildcard ROAs.
Wepresentbelowseveralconcreteproposalsforaddressing
We present a new kind of ROAs, compatible with today’s for-
the concerns pertaining to RPKI and ROV deployment dis-
mat, which eliminates downward dependencies. As explained
cussed in the previous sections. We first briefly present three
in Section VI-B, this form of inter-organization dependencies
high-level directions and then dive into the details.
pertains to a significant portion of IP addresses and to some
of the world’s largest ISPs.
Targeting the large ISPs. Our results in Section IV establish
that ROV adoption by the largest ISPs can lead to significant
improvementsinglobalsecurity.Thus,concentratingeffortson A. ROAlert
the top ISPs can yield significant incentives for issuing ROAs,
hopefully breaking the vicious circular dependency between As shown in Figure 12, one of the biggest obstacles to
the non-issuing of ROAs and the non-enforcement of ROV. performing ROV is the significant number of bad ROAs. To
mitigate this problem we developed ROAlert, an automated
Improving RPKI’s reliability and integrity. As shown in system that detects bad ROAs and alerts the corresponding
Section VI-A, relatively few organizations are responsible for network administrators (through emails and web interface).
10IP-prefix Organization ASnumber Problem on careful data analysis of multiple datasets (e.g., to map
DeutscheTelekom None
91.0.0.0/10 (Figure1) 3320 (validandprotected) RCs, ROAs, and IP prefixes to organizations, as explained
Validbutunprotected in Appendix B). Through such data analyses ROAlert can,
81.62.0.0/15 Swisscom(Fig.10) 3303
(has“looseROA”) for instance, inform a network operator interested in issuing a
Validbutunprotected
194.2.0.0/15 Orange(Fig.11) 3215 (has“looseROA”) ROAwhichorganizationsitsnetworkisupward-ordownward-
Invalid dependent on.
194.2.35.0/24 Danone(Fig.11) 1272
(Orange’sdowndep.)
Invalid
194.2.155.0/24 Ubisoft(Fig.11) 8361 Feedback from network operators. We have received feed-
(Orange’sdowndep.)
NoRC, back and engaged in discussions with 52 of the network
8.0.0.0/8 Level3(Fig.15) 3356,3549
preventsRCfromcustomers administratorswhoreceivedouralerts.Oftheseresponders,40
CannotgetRC
8.25.197.0/24 Twitter(Fig.15) 35995 reported fixing the problem. Five administrators who received
(dependentonLevel3)
CannotgetRC notification that another organization had caused their prefix
8.22.121.0/24 LinkedIn(Fig.15) 13443
(dependentonLevel3) tobecomeinvalidreportedthattheyhadsubsequentlyengaged
CannotgetRC
8.42.114.0/24 eBay(Fig.15) 62955 with the offenders. The rest of the responses mostly explained
(dependentonLevel3)
problematicscenariosthattheyhavedifficultyaddressing,such
TABLEI:Examplesofnetworksandissuesraisedinthepaper as BGP advertisements sent to peering networks, which were
supposed to only be used by these internally, but were in fact
“leaked”onwards.Tworesponsesindicatedthattheprefixwas,
in fact, hijacked (probably due to configuration errors at the
offending AS).
Online, proactive notification. ROAlert periodically retrieves
ROAsfromRPKI’spublicationpointsandthencomparesthem
Measurements. We have sent notifications to a total of 552
against the BGP advertisements retrieved from Route Views
victims and offenders through ROAlert over the course of six
using CAIDA’s BGPStream architecture [5] (every 5 minutes)
months, yet only 168 emails did not “bounce” (see discussion
soastoidentifyandclassifybadROAs(bothinvalidatingBGP
of limitations below). We checked whether one month after
advertisements and “loose”). ROAlert uses the RIRs’ Whois
notification the problem was fixed by re-examining the ROAs
databases to alert the network administrator (at most once a
and BGP route-advertisements via ROAlert. The results of
month for the same violation). Figure 19 illustrates ROAlert’s
thesefollow-upchecksrevealthatROAlertnotifications,when
design.
reaching the network operator’s mailbox, are effective. Over
42% of “bad ROA” alerts resulted in fixing the problematic
Web interface, ROAlert.org. ROAlert also provides a web
ROA one month later, this is contrasted with about 15% of
interface that allows network operators to check whether their
ROAsfixedinvolvingoperatorsthatROAlertcouldnotcontact.
network is (correctly) protected by ROAs. In the event that
ROAlert also notified administrators of “loose ROAs”, i.e.,
the network is not properly protected, ROAlert explains the
when their prefix is valid but in fact unprotected and had 19%
causes for this situation (be it loose ROAs, inter-organization
success rate. We conclude that a proactive, non-opt-in alert
dependencies, etc.). We encourage the reader to enter the
system can help mitigate bad ROAs.
ROAlert website to find out whether her/his IP address is
protected by RPKI and also to learn more details about the Limitations. ROAlert relies on information from the Whois
networksmentionedinthispaper(TableI)andothernetworks. databases in order to contact victims and offenders. However,
whoisentriesareoftenoutdated,resultinginunreachableemail
Differences from existing systems. ROAlert is not the first addresses (see measurements above). Consequently, only a
systemthatcomparesBGPadvertisementsandROAstodetect fairly small fraction of victims and violators were alerted. We
errors. In particular, RIPE allows network administrators issu- believe, based on our experience with ROAlert and the above
ing a ROA to check how that ROA would effect the prefixes results, that ROAlert can aid in greatly reducing the number
advertised through BGP [20], [46]. However, in contrast to of bad ROAs, thus increasing the level of trust in RPKI. We
existing systems, ROAlert is not an opt-in service. This is hopethattheseresultswillmotivatetheRIRs,whichhavemore
particularly important when an IP prefix of one organization reliable contact points to prefix owners, to adopt ROAlert.
becomes invalid due to a ROA issued by another organization
(like in the example in Figure 11). In this scenario, the victim Selective, ROAlert-informed ROV. While ROAlert and simi-
may not even be aware of that ROA issuance or may not fully larmechanismscouldhopefullycontributetoeliminatingmany
comprehend the intricacies of RPKI. Furthermore, ROAlert badly issued ROAs, surely some bad-ROAs will remain. To
is constantly running (whereas [20], [46], for instance, is address this concern we propose that ASes enforce ROV
only active when registering a new ROA). Hence, if BGP selectively, i.e., enforce ROV for ROAs that have been “well-
announcements change, and “good” ROAs become “bad”, behaved” for a pre-defined amount of time. ROAlert allows
alerts are issued in real time. ROAlert also identifies loose this to be automated (by identifying new ROAs, and marking
ROAs, which are not detected by other systems (since such them “well-behaved” if they do not conflict with BGP adver-
ROAs are valid according to RPKI). Lastly, ROAlert notifies tisements for sufficient period).
bothoffendersandvictimswithconcretesuggestionsastohow
Of course, this is not immune to pitfalls. What if an
to fix a given issue.
organizationchangesitssetofIPprefixesadvertisedinBGPin
Importantly, beyond error-detection, ROAlert also serves amannerthatisincompatiblewithapreviouslyissuedROAby
another important purpose: identifying organization-specific thesameorganization?Thismightstillleadtotheorganization
challenges to deployment. To accomplish this, ROAlert relies being disconnected by those doing selective ROV. We point
11out, however, that using a platform like ROAlert implies that on designing defenses. See an overview of the security issues
the organization would be quickly notified when its prefix in[11],[29]andastudyofcommonmisconfigurationsin[43].
becomes invalid. Foranexampleofoneoftheearliestdesigns,suggestingmany
ofthebasicideasunderlyingbothRPKIandBGPsec,see[36].
We argue that the use of selective ROV could mitigate the
We focus below on the studies most relevant to deployment.
justifiedconcernsaboutdiscardingBGPadvertisementsdueto
mistakes in ROAs, while protecting issuers of “good” ROAs Several studies, beginning with [13], explore deployment
from prefix and subprefix hijacking. of path-security mechanisms, mainly BGPsec. Gill et al. [23]
study how to encourage adoption of BGPsec by creating
B. Wildcard ROAs appropriate incentives for ISPs to deploy it. Other studies [26]
explore the security guarantees of BGPsec, including under
Downwarddependencies,discussedinSectionVI-B,posea
partialdeployment[41].Manyotherstudies,e.g.,[50],present
challengetodeploymentofRPKIbysomelargeorganizations,
alternative path-security mechanisms which are easier to de-
e.g., Orange in Figure 11. Consider a large IP prefix p, with
ploy. See a survey of the long and winding road to BGP
origin AS number a, owned by organization Foo. Suppose
security in [25].
that several subprefixes p ,...p are contained within p, but
1 n
belong to other organizations and in particular, have different
Adoption of RPKI was also studied. In [37], a provider,
origin ASes, a ,...a . Suppose further that these organiza-
1 n SURFnet, studied the false-positive rate it would incur if it
tions have not yet issued a ROA for these prefixes.
performed ROV. Several studies [19], [33], [34] explore the
FoomaygoaheadandissueaROAforp,specifyingorigin issuing of ROAs and measure the number of prefixes that
a. That was, for instance, the approach taken by Orange in would be discarded with ROV. A study of ROAs covering
Figure 11. However, the result is that BGP advertisements for content provider prefixes was presented in [57]. These stud-
p ,...p (thatbelongtoDanoneandUbisoftinourexample), ies, however, did not address the issues we focus on, such
1 n
would conflict with the ROA for p and hence be discarded by as quantifying the adoption of ROV and its benefits under
ROV-enforcing ASes. partial deployment, loose ROAs, upward and downward inter-
organizational dependencies, designing an online alert system,
Alternatively, Foo may choose to break p into subprefixes
and more.
that are entirely owned by Foo and only issue ROAs for
these prefixes and advertise them in BGP (instead of p in its Wahlisch et al. present preliminary results of a survey
entirety). However, this may result in significant increase to of network operators regarding deployment of RPKI and
BGP routing tables. We evaluate this possibility by testing the DNSsec [56]. Indeed, many of the challenges of deploying
increase ratio in BGP table size. We used the Route Views and enforcing DNSsec and RPKI are similar; see [40] for a
dataset [54] to build the Routing Information Base (RIB) study comparing deployment of DNSsec with deployment of
for each of the 44 different sensors (BGP routers located RPKI, and [30] for discussion on the deployment of DNSsec.
in different and geographically dispersed ASes). We then Other studies [17], [28] investigate another problematic aspect
measured, for each sensor, the increase in the number of RIB of RPKI: disproportionate power of centralized authorities to
entries. We find that on average, the increase is over 26% of unilaterally revoke any IP prefixes under their control.
prefixes in the routing tables, or approximately 160K prefixes
Network operators sometimes rely on repositories such
(the standard deviation was approximately 2%).
as IRR/RADB to filter suspicious BGP route-advertisements.
We now present a simple alternative solution, called wild- Like RPKI, these repositories bind IP prefixes to origin ASes
card ROA, which allows organizations to issue ROAs and and can thus be used to realize filtering policies, including
protect their IP prefixes before their descendants issue ROAs additional filtering beyond route-origin validation (see [27]).
for themselves. Wildcard ROAs are intended to allow an AS However, these repositories are not fully reliable/secure and
holding an RC that covers an address block containing a contain numerous errors, as highlighted and measured in [31].
specific IP prefix p i not belonging to that AS to specify that IRR/RADBrepositoriesaretypicallyused,inpractice,onlyto
any AS may be the origin of that prefix (p i). Thus, any AS filter incorrect BGP advertisements from customer ASes [21],
with an RC could issue a ROA for itself without having to [44] and thus provide quite limited security benefits.
wait for its descendants to do the same (or giving up on BGP
aggregation)simplybyissuinganotherROA,usinga“wildcard
ASnumber”,thatincludesallsubprefixesthatarenolongerin IX. CONCLUSION
its possession and thus may be announced using other ASNs.
Extensive efforts have been invested, for many years
Importantly,however,wildcardROAsmustbeassignedalower
now, to improve the security and reliability of BGP routing.
priority than “regular” ROAs for the same prefix, so that if a
These efforts range from a patchwork of ad-hoc mechanisms
specific IP prefix is included in both a regular ROA (issued
(monitoring services, IRR/RADB registries, etc.) to carefully
by the legitimate owner) and (possibly many) wildcard ROAs,
designed standards such as RPKI and BGPsec. Recent studies
the regular ROA prevails, thus protecting the legitimate owner
have shown that deployment of BGPsec faces significant,
from hijacking and eliminating the downward-dependency
possibly insurmountable challenges. In contrast, RPKI de-
problem.
ployment, crucial both for combating IP prefix and subprefix
hijacking and as a prerequisite to defenses against BGP path-
VIII. RELATEDWORK
manipulations (incl. BGPsec), is regarded as more feasible.
ThereisalonghistoryofattacksagainstBGP,whichmoti- Indeed, monitoring of RPKI certificates and ROAs indicates
vatedmanypaststudiesonanalyzingBGP’svulnerabilitiesand progress, although at a hardly satisfactory rate.
12Our results showed that not only does RPKI suffer from [10] R. Bush and R. Austein, “The Resource Public Key Infrastructure
verylowdeployment,butevenRouteOriginValidation(ROV), (RPKI) to Router Protocol,” RFC 6810 (Proposed Standard),
which uses RPKI to defend against prefix hijacking, is rarely Internet Engineering Task Force, Jan. 2013. [Online]. Available:
http://www.ietf.org/rfc/rfc6810.txt
enforced. Since ROV is the first and only use of RPKI so far,
[11] K.R.B.Butler,T.R.Farley,P.McDaniel,andJ.Rexford,“ASurveyof
itsdeploymentandRPKI’sdeploymentsufferfromtheclassic
BGPSecurityIssuesandSolutions,”ProceedingsoftheIEEE,vol.98,
chicken and egg problem. We investigated the implications of
no.1,pp.100–122,2010.
ROV’sscarceadoptiontoglobalroutingsecurity,showingthat
[12] Center for Applied Internet Data Analysis, “Routeviews Prefix to
almostubiquitousdeploymentofROVbythelargestISPs(e.g., AS mappings Dataset for IPv4 and IPv6,” https://www.caida.org/data/
top100)isbothnecessaryandsufficienttoprotecttheInternet routing/routeviews-prefix2as.xml,May2016.
from prefix and subprefix hijacking. We showed, however, [13] H.Chan,D.Dash,A.Perrig,andH.Zhang,“ModelingAdoptabilityof
that unless many RPKI records are fixed, even global ROV SecureBGPProtocols,”inSIGMETRICS,R.A.Marie,P.B.Key,and
E. Smirni, Eds. ACM, 2006, pp. 389–390. [Online]. Available: http:
adoption will not protect many networks from devastating
//dblp.uni-trier.de/db/conf/sigmetrics/sigmetrics2006.html#ChanDPZ06
traffic hijacking attacks.
[14] “BGPOriginASValidation,”CiscoIOSguide,Cisco,2013.
We embarked on a systematic study of the root-causes [15] A. Cohen, Y. Gilad, A. Herzberg, and M. Schapira, “One Hop for
RPKI,OneGiantLeapforBGPSecurity,”inHotNets,J.deOliveira,
for RPKI’s slow adoption, including negative incentives for
J.Smith,K.J.Argyraki,andP.Levis,Eds. ACM,2015,pp.10:1–10:7.
deployment due to loss of traffic as a result of badly issued
[Online].Available:http://dl.acm.org/citation.cfm?id=2834050
ROAs, and inter-organization dependencies. On the positive
[16] ——,“JumpstartingBGPSecuritywithPath-EndValidation,”inSIG-
side, our results show that many of the banes plaguing RPKI COMM, M. P. Barcellos, J. Crowcroft, A. Vahdat, and S. Katti, Eds.
and ROV deployment can be vastly improved via highly ACM,2016,pp.342–355.
focused efforts. Specifically, focusing deployment efforts on [17] D. Cooper, E. Heilman, K. Brogle, L. Reyzin, and S. Goldberg, “On
the large ISPs, modest changes to RPKI, and adoption of a theRiskofMisbehavingRPKIAuthorities,”inHotNets. ACM,2013,
p.16.[Online].Available:http://dl.acm.org/citation.cfm?id=2535771
system such as ROAlert by entities such as the RIRs, can
[18] S. Crocker, “DNSSEC Deployment Threats - What is Real? What is
go a long way towards mitigating obstacles to adoption. We
FUD?”October2008,DNSSECandIPv6Workshop.
thus advocate concentrating standardization, regulatory, and
[19] R. de Boer and J. de Koning, “BGP Origin Validation (RPKI),”
operational efforts in these directions.
Univeristy of Amsterdam, systems and network engineering group,
Tech.Rep.,July2013.
[20] J. de Koning, “RPKI - A Dashboard for BGP Operators,” Online
ACKNOWLEDGEMENTS in https://labs.ripe.net/Members/javy de koning/rpki-dashboard, July
2013.
This work was supported by ISF grants 420/12 and [21] J. Durand, I. Pepelnjak, and G. Doering, “BGP Operations and
1354/11,IsraelMinistryofSciencegrants3-9772and3-10884, Security,” RFC 7454 (Best Current Practice), Internet Engineering
theIsraeliCenterforResearchExcellenceinAlgorithms,NSF Task Force, Feb. 2015. [Online]. Available: http://www.ietf.org/rfc/
rfc7454.txt
grant 1414119, and an ERC Starting Grant. We thank Steve
Bellovin, Randy Bush, Sharon Goldberg, Joel Halpern, Ethan [22] L. Eggert, “DNSSEC Deployment Trends,” http://eggert.org/meter/
dnssec.
Heilman, Tomas Hlavacek, Hezi Moriel, Hank Nussbacher,
[23] P.Gill,M.Schapira,andS.Goldberg,“LettheMarketDriveDeploy-
Alvaro Retana, and Nickolai Zeldovich for their helpful com-
ment: A Strategy for Transitioning to BGP Security,” in SIGCOMM,
ments and suggestions. Special thanks to Daniel Davidovitch S. Keshav, J. Liebeherr, J. W. Byers, and J. C. Mogul, Eds. ACM,
for helping us create ROAlet’s web interface, to Matthias 2011,pp.14–25.
Waehlisch and his research group at Freie University Berlin [24] ——, “Modeling on Quicksand: Dealing with the Scarcity of Ground
for helping us utilize Miro [48], and to Christian Teuschel TruthinInterdomainRoutingData,”ComputerCommunicationReview,
from RIPE for helping us utilize the RIPEStat database. vol.42,no.1,pp.40–46,2012.
[25] S.Goldberg,“WhyisitTakingsoLongtoSecureInternetRouting?”
Commun.ACM,vol.57,no.10,pp.56–63,2014.[Online].Available:
http://doi.acm.org/10.1145/2659899
REFERENCES
[26] S. Goldberg, M. Schapira, P. Hummon, and J. Rexford, “How
Secure are Secure Interdomain Routing Protocols?” Computer
[1] “TheNewThreat:TargetedInternetTrafficMisdirection,”http://www.
Networks, vol. 70, pp. 260–287, 2014. [Online]. Available: http:
renesys.com/2013/11/mitm-internet-hijacking/.
//dx.doi.org/10.1016/j.comnet.2014.05.007
[2] “AFRINIC Whois Database,” https://www.afrinic.net/services/
[27] G. Goodell, W. Aiello, T. Griffin, J. Ioannidis, P. D. McDaniel,
whois-query,Jul.2016.
and A. D. Rubin, “Working around BGP: An Incremental Approach
[3] “APNICWhoisDatabase,”https://wq.apnic.net/apnic-bin/whois.pl,Jul. to Improving Security and Accuracy in Interdomain Routing,”
2016. in NDSS. The Internet Society, 2003. [Online]. Available: http:
[4] “ARINWhoisDatabase,”https://whois.arin.net/ui,Jul.2016. //www.isoc.org/isoc/conferences/ndss/03/proceedings/papers/5.pdf
[5] “BGPStreambyCAIDA,”https://bgpstream.caida.org/,Jul.2016. [28] E. Heilman, D. Cooper, L. Reyzin, and S. Goldberg, “From the
Consent of the Routed: Improving the Transparency of the RPKI,”
[6] “LACNIC Whois Database,” http://lacnic.net/cgi-bin/lacnic/whois, Jul.
in SIGCOMM, F. E. Bustamante, Y. C. Hu, A. Krishnamurthy, and
2016.
S. Ratnasamy, Eds. ACM, 2014, pp. 51–62. [Online]. Available:
[7] “RIPE NCC Whois Database,” https://apps.db.ripe.net/search/query. http://dl.acm.org/citation.cfm?id=2619239
html,Jul.2016.
[29] A. Herzberg, M. Hollick, and A. Perrig, “Secure Routing for Future
[8] Andree Toonk, “BGP Hijack Incident by Syrian Telecommunications Communication Networks (Dagstuhl Seminar 15102),” Dagstuhl
Establishment,”BGPMonblog,2015. Reports, vol. 5, no. 3, pp. 28–40, 2015. [Online]. Available:
[9] R. Bush, “Origin Validation Operation Based on the Resource http://drops.dagstuhl.de/opus/volltexte/2015/5267
PublicKeyInfrastructure(RPKI),”RFC7115(BestCurrentPractice), [30] A. Herzberg and H. Shulman, “Retrofitting Security into Network
Internet Engineering Task Force, Jan. 2014. [Online]. Available: Protocols:TheCaseofDNSSEC,”InternetComputing,IEEE,vol.18,
http://www.ietf.org/rfc/rfc7115.txt no.1,pp.66–71,2014.
13[31] T.Hlavacek,“RoutingPoliciesandRealPathsintheInternet,”Master’s [53] ——, “BGP Routing Incidents in 2014, Malicious or Not?” http:
thesis,CharlesUniversity,Prague,82016. //www.bgpmon.net/bgp-routing-incidents-in-2014-malicious-or-not/,
2015,BGPMon.
[32] G. Huston and G. Michaelson, “Validation of Route Origination
Using the Resource Certificate Public Key Infrastructure (PKI) and [54] UniversityofOregon,“RouteViewsProject,”http://bgplay.routeviews.
Route Origin Authorizations (ROAs),” RFC 6483 (Informational), org/,May2016.
Internet Engineering Task Force, Feb. 2012. [Online]. Available: [55] P.-A. Vervier, O. Thonnard, and M. Dacier, “Mind Your Blocks:
http://www.ietf.org/rfc/rfc6483.txt On the Stealthiness of Malicious BGP Hijacks,” in NDSS. The
[33] D. Iamartino, “Study and Measurements of the RPKI Deployment,” Internet Society, 2015. [Online]. Available: http://www.internetsociety.
2015. org/events/ndss-symposium-2015
[34] D. Iamartino, C. Pelsser, and R. Bush, “Measuring BGP Route [56] M. Wa¨hlisch, O. Maennel, C. Perta, T. C. Schmidt, G. Tyson, and
Origin Registration and Validation,” in PAM, ser. Lecture Notes S. Uhlig, “Preliminary Results of Survey about RPKI/DNSSEC,” in
in Computer Science, J. Mirkovic and Y. Liu, Eds., vol. 8995. proceedingsofthe92ndIETF,March2015.
Springer, 2015, pp. 28–40. [Online]. Available: http://dx.doi.org/10. [57] M. Wa¨hlisch, R. Schmidt, T. C. Schmidt, O. Maennel, S. Uhlig, and
1007/978-3-319-15509-8 G. Tyson, “RiPKI: The Tragic Story of RPKI Deployment in the
[35] “ConfiguringOriginValidationforBGP,”JuniperTechLibrary,Juniper
WebEcosystem,”inHotNets,J.deOliveira,J.Smith,K.J.Argyraki,
Networks,2013. and P. Levis, Eds. ACM, 2015, pp. 11:1–11:7. [Online]. Available:
http://dl.acm.org/citation.cfm?id=2834050
[36] S.T.Kent,C.Lynn,andK.Seo,“SecureBorderGatewayProtocol(S-
[58] R. White, “Deployment Considerations for Secure Origin BGP
BGP),” IEEE Journal on Selected Areas in Communications, vol. 18,
(soBGP).” June 2003. [Online]. Available: http://tools.ietf.org/html/
no.4,pp.582–592,2000.
draft-white-sobgp-bgp-deployment-01
[37] J. Kloots, “RPKI Routing Policy Decision-Making: A SURFnet Per-
spective,”https://labs.ripe.net/Members/jac kloots/,January2014.
APPENDIXA
[38] M.LepinskiandS.Kent,“AnInfrastructuretoSupportSecureInternet
ADDITIONALSURVEYQUESTIONS
Routing,”RFC6480(Informational),InternetEngineeringTaskForce,
Feb.2012.[Online].Available:http://www.ietf.org/rfc/rfc6480.txt Wepresenttherestofthequestionsweaskedsurveypartic-
[39] M. Lepinski, S. Kent, and D. Kong, “A Profile for Route ipantstocharacterizetheirnetworksinFigures20through24.
Origin Authorizations (ROAs),” RFC 6482 (Proposed Standard),
Internet Engineering Task Force, Feb. 2012. [Online]. Available:
http://www.ietf.org/rfc/rfc6482.txt
[40] W. Lian, E. Rescorla, H. Shacham, and S. Savage, “Measuring the
PracticalImpactofDNSSECDeployment,”inProceedingsofUSENIX
Security,2013.
[41] R. Lychev, S. Goldberg, and M. Schapira, “BGP Security in Partial
Deployment:IstheJuiceworththeSqueeze?”inSIGCOMM. ACM,
2013,pp.171–182.[Online].Available:http://dl.acm.org/citation.cfm?
id=2486001
[42] E. M. Lepinski, “BGPsec Protocol Specification,” RFC, Internet
Engineering Task Force, Oct. 2014. [Online]. Available: https:
//tools.ietf.org/html/draft-ietf-sidr-bgpsec-protocol-10
[43] R. Mahajan, D. Wetherall, and T. E. Anderson, “Understanding BGP
Misconfiguration,” in SIGCOMM. ACM, 2002, pp. 3–16. [Online].
Available:http://doi.acm.org/10.1145/633025.633027 Fig. 20: Survey participant distribution
[44] D. McPherson, S. Amante, E. Osterweil, L. Blunk, and D. Mitchell,
“Considerations for Internet Routing Registries (IRRs) and Routing
PolicyConfiguration,”RFC7682(Informational),InternetEngineering
Task Force, Dec. 2015. [Online]. Available: http://www.ietf.org/rfc/
rfc7682.txt
[45] P. Mohapatra, J. Scudder, D. Ward, R. Bush, and R. Austein,
“BGP Prefix Origin Validation,” RFC 6811 (Proposed Standard),
Internet Engineering Task Force, Jan. 2013. [Online]. Available:
http://www.ietf.org/rfc/rfc6811.txt
[46] R. NCC, “RIPE NCC Tools and Resources,” Online in
https://www.ripe.net/manage-ips-and-asns/resource-management/
certification/tools-and-resources.
[47] NIST,“NISTRPKIMonitor,”http://rpki-monitor.antd.nist.gov/,2016.
[48] A.Reuter,M.Wa¨hlisch,andT.C.Schmidt,“RPKIMIRO:Monitoring
andInspectionofRPKIObjects,”inSIGCOMM,S.Uhlig,O.Maennel,
B. Karp, and J. Padhye, Eds. ACM, 2015, pp. 107–108. [Online].
Available:http://dl.acm.org/citation.cfm?id=2785956 Fig. 21: Survey. Which of the following best describes your
[49] RIPE Network Coordination Centre, “RIPE NCC Statistics,” https:// network?
www.ripe.net/analyse/statistics,2016.
[50] L. Subramanian, V. Roth, I. Stoica, S. Shenker, and R. H.
Katz, “Listen and Whisper: Security Mechanisms for BGP,”
in NSDI. USENIX, 2004, pp. 127–140. [Online]. Available: APPENDIXB
http://www.usenix.org/events/nsdi04/tech/subramanianListen.html MODELINGINTER-ORGANIZATIONALHIERARCHY
[51] A. Toonk, “Hijack Event Today by Indosat,” http://www.bgpmon.net/
hijack-event-today-by-indosat/. We used the IP prefix allocation database [49] and con-
structed the tree formed by IP-prefix assignments to orga-
[52] ——, “Turkey Hijacking IP Addresses for Popular Global DNS
Providers,”BGPMon. nizations, we refer to it as the prefix allocation tree. We
14Fig. 22: Survey. How many IP addresses does your network Fig. 24: Survey. Does your organization have an AS number?
include?
tree. In particular, we identified the owners of all prefixes that
are announced in BGP (since those are associated with an
AS number). We thus believe that our measurements provide
a good approximation as to the extent of inter-organizational
dependencies.
Next, we identify the owners of ROAs. We use the AS
numbers specified in ROAs to indicate which ASes are al-
lowed to announce the protected IP prefixes, and the mapping
from ASes to organizations in [12], to identify the owner
organizations. Finally, we find the owners of RCs. The RPKI
specification [38] does not identify the owner in the RC, to
get around this we use a combination of our prefix and ROA
mappings. If the RC was used to issue a ROA, we assign the
Fig. 23: Survey. Where is your network?
owner of the ROA to that RC. Otherwise, we use the owner
of the largest prefix specified in this RC.
B. Measuring upward dependencies
obtain the RCs and ROAs using Miro, a tool developed by
Reuter et al. [48]. The datasets are from July 2016. From For each prefix in the allocation tree, we find the first
each RIR we root an RPKI-object tree that illustrates the RC “ancestor IP prefix” that is covered by an RC. Importantly,
and ROA hierarchy (i.e., which RC was used to issue other the owner of this prefix is the one who must first issue an
RCs or ROAs). Each vertex in both trees identifies the owner RC to its descendant (and the owner of that descendant to
organization as we next describe. its descendant, until reaching the original prefix). We then
find the number of intermediate IP prefixes in the allocation
tree, i.e., prefixes that must be covered by RCs before the
A. How to map prefixes, RCs, and ROAs to their owners?
original prefix may be covered by RC. Finally, we count the
To understand RPKI’s deployment status we must be able distinct organizations on the path between the prefix and its
map IP prefixes, ROAs, and RCs, to the organizations that ancestorprefix,excludingtheorganizationowningtheoriginal
“own” them. This turns out to be a nontrivial feat. prefix and the organization owning the ancestor prefix. We
thus quantify the number of organizations that lie between an
We begin by finding the owner of the prefixes in the organization that wishes to issue a ROA and the organization
allocation tree. We use Route Views [54] to find prefixes that must initiate the chain of RC issuing.
advertised through BGP, and identify their owner by the AS
number that advertised the prefix (using CAIDA’s ASN to
C. Measuring downward dependencies
organization mapping [12]). For all other prefixes, which are
ownedbyorganizationsyetunannouncedthroughBGP,weuse For each prefix in the allocation tree, we find the number
the Whois databases of the five RIRs [2], [3], [4], [6], [7] to of prefixes below it (i.e., subprefixes) that are announced in
identifytheowner.Wefurtherusethe“contacte-mailaddress” BGP and are not protected by ROAs. These “child prefixes”
domain, commonly included in Whois entries, to match IP- will be considered invalid by the routers that perform ROV if
prefixes owned by the same organization. In case we could the parent is issued a ROA. We count the number of distinct
notidentifytheowneroftheprefix,weassumethattheparent organizations that own them.
organization still owns that IP space and remove that prefix
fromtheIPallocationtree.Wewereabletoidentifytheowners
of 92.3% of the prefixes, whereas almost all the prefixes we
couldnotresolvetoanownerareleavesintheprefixallocation
15