INTERNET-SCALE PROBING OF CYBER-PHYSICAL SYSTEMS
INFERENCE, CHARACTERIZATION AND ORCHESTRATION ANALYSIS
Claude Fachkha, Elias Bou-Harb, Anastasis Keliris, Nasir Memon, Mustaque Ahamad
1st of March, 2017 The Network and Distributed System Security Symposium (NDSS) 2017Some of our previous works
22
An operational capability to passively identify DDoS
¨
amplification (reflection) attempts
Traces from the largest (300 Gbps) DNS amplification attack in 2013 against SpamhausSome of our previous works
33
An operational capability to passively identify large-scale
¨
orchestrated probing campaignsCyber-Physical Systems
44
Control
Transportation Healthcare Defense
• Interactive • Wearable • Smart
traffic control sensors Unmanned
Vehicles
Software
SystemsIn the news…
5
The four
amigos:
Stuxnet,
Flame,
Gauss &
DuQuDHS reported CPS threats
6Motivation
7
Properly comprehending and accurately characterizing
¨
malicious attackers’ capabilities, intents and aims, remains
challenging
Lack of real malicious empirical data that can be captured,
¨
inferred, and analyzed from within the boundaries of
operational CPS realms
lack of complete maturity related to CPS
n
the significant diversity of such types of systems
n
logistic and privacy constraints
nContributions
8
Automated approaches that aim at disclosing real CPS
¨
attackers’ strategies, by passively inferring, characterizing, and
correlating CPS probing events
Proposing a formal preprocessing probabilistic model that aims at
n
filtering noise (i.e., misconfiguration traffic)
Executing multidimensional investigation of probing activities
n
targeting more than 25 communication and control CPS services
distributed over 120 ports
Validating the proposed models, methods and approaches by
n
experimenting with 50 GB of darknet dataRelated Work: Control-Theoretic Approaches
9
Models describing the underlying physical phenomena enables the prediction
of future behavior and, more importantly, unforeseen deviations from itRelated Work: Cyber Security Approaches
10Related Work
11
Probing analysis
¨
Inference
n
Analysis
n
Measurements
n
Network Telescope: Measurements & Analysis
¨
CPS Traffic Analysis
¨Passive Measurements
12Darknet Preprocessing Model
13
How unusual the access to a darknet IP d isDarknet Preprocessing Model
14Darknet Preprocessing Model
15
A source accessing a
predefined n darknet
destinations
A source accessing a number of darknet
destinationsDarknet Preprocessing Model
16CPS Probing Inference
17CPS Characterization and Co-occurrence
18
Amalgamated Statistics
¨
Significance and Prevalence
¨
Distribution of different types of scans
¨
Jaccard similarity to infer co-occurrence patterns
¨CPS Probing Orchestration Fingerprinting
19
Large-scale probing events
¨
the population of the participating bots is several orders of
n
magnitude larger
the target scope is generally the entire IP address space
n
the sources adopt well-orchestrated, often botmaster-
n
coordinated, stealth scan strategies that maximize targets’
coverage while minimizing redundancy and overlapCPS Probing Orchestration Fingerprinting
20
Inferring CPS large-scale probing events
¨
Time series analysis
¤
Infer temporal similarities
n
Dynamic Time Warping (DTW) technique
n
Netflow analysis
¤
Infer netflow characteristics
n
Context triggered piecewise hashing (CTPH)
n
Select and cluster CPS probing sessions that minimize the DTW
¨
similarity metric while maximizing the CTPH measureEmpirical Findings: Characterization
21
April April May May
Week 3 Week 4 Week 1 Week 2
Total Scanners 7954 8871 8731 8341
Total Uniq
Scanners 3007 3727 3950 3731
Top Scanners
Consistency and overlap targeting
Modbus
Validation:
• AbuseIPDB and Cymon: 4.37% of scanners were involved in various
malicious reported activities (hacking (41.25%), portscan (31.46%), FTP/SSH,
brute force (13.28%), and DDoS (6.29%)).
• Dshield: 88.1% found.
• Remaining: never reportedEmpirical Findings: Characterization
22
Top five used/abused src-port
April Week 3 April Week 4 May Week 1 May Week 2
6000 609 53 (535) 1048 785 6000 426
( ) ( ) ( )
53933 348 43490 356 42880 576 60000 330
( ) ( ) ( ) ( )
53 315 6000 235 53 334 53 314
( ) ( ) ( ) ( )
43490 267 22 214 59651 223 63030 156
( ) ( ) ( ) ( )
59531 244 1048 146 58017 221 50449 128
( ) ( ) ( ) ( )
Common used ports:
- Port 6000 (often reported to be used by trojans)
- 40k and 60k range
- For Modbus communication, 30% of its traffic originated from source port 6706Empirical Findings: Characterization
23
Top five IP-ID values
(Probe packet count)
April Week 3 April Week 4 May Week 1 May Week 2
0xd431 (13060) 0xd431 (12632) 0xd431 (11640) 0xd431 (12849)
0x0100 (820) 0x0100 (343) 0x0100 (566) 0x0100 (530)
0x0049 (11) 0x0b1c (10) 0x843d (9) 0x0438 (13)
0x9625 (9) 0x052a (10) 0x591e (9) 0xb530 (9)
0x0ae7 (9) 0x058d (9) 0x01da (9) 0x8faf (9)Empirical Findings: Sources of Probes
24Empirical Findings: Top Targeted CPS Services
25Empirical Findings: Co-occurrence Patterns
26Empirical Findings: Orchestrated Campaigns
27
58 inferred campaigns
¨
Some employ very low probing rate
¨
5 large-scale coordinated events
¨
(more than 50 hosts)Empirical Findings: Orchestrated Campaigns
28
Number of
Reference Source Distinct IP
Source Domain Addresses
A *.edu 64
B *.io 136
*.com
C *.de 188
D *.cn 116
E *.ru 54
Focused (A)
¨
Modbus on TCP port 502, Niagara Fox on TCP port 1911 and BACnet on TCP port 47808
¤
(CPS-specific)
Employed unique hosts
¤
Distributed (B)
¨
Probed 191 services, including, Modbus and BACnet
¤
Recycled 13 hosts per week
¤Empirical Findings: Orchestrated Campaigns
29
Number of
Reference Source Distinct IP
Source Domain Addresses
A *.edu 64
B *.io 136
*.com
C *.de 188
D *.cn 116
E *.ru 54
C, D, E: Possibly malicious campaigns
¨
C, D:
¨
Sources from US, Germany and China
¤
Large-scale stealthy probing
¤
Dedicated for brute force attacks (HMI exploitations)
¤
E:
¨
Attributed to Russia
¤
Probed almost all the darknet IP space
¤
Focused on coordinated scanning towards Foundation Fieldbus systems (factory automation)
¤Discussion
30
Challenges
¨
Attackers’ IP Address Selection
¨
Particularly or randomly targeted?
¤
Incomplete view of the CPS abuse
¨
Defense against scanning
¨
Blacklisting
¤
Research Trends
¨
Collaborative approach for CPS security
¤Concluding Remarks
31
Attempt to generate unsolicited empirical data related to CPS activities
¨
33 thousand probes towards ample of CPS protocols
¨
74% of CPS probes that were persistent throughout the entire analyzed
¨
period
Thousands of large-scale, stealthy, previously undocumented orchestrated
¨
probing events
CPS targets in rarely investigated CPS realms such as manufacturing and
¨
building automation systemsFuture Work
32
Fuse the obtained data with CPS honeypot data to build broader notions of
¨
CPS maliciousness
Identify attack models for CPS in the health and cargo terminal (ports)
¨
sectors
Empirical measurements in the IoT paradigm for inference and resiliency
¨Acknowledgment
33
Prof. Nasir Memon (NYU)
¨
Prof. Mustaque Ahamad (Georgia Tech)
¨
Our team (Elias and Tasos)
¨
NYU AD: CISO and the networking team
¨34
Questions
Claude Fachkha
Assistant Professor
claude.fachkha@gmail.com
Elias Bou-Harb
Assistant Professor
ebouharb@fau.edu