Pushing the Communication Barrier
in 2PC using Lookup Tables
Ghada Dessouky*, Farinaz Koushanfar†, Ahmad-Reza Sadeghi*,
Thomas Schneider*, Shaza Zeitouni*, and Michael Zohner*
*Technische Universität Darmstadt
†University of California, San DiegoSecure 2PC
Michael Zohner - Pushing the Communication Barrier in 2PC Page 2Secure 2PC
Michael Zohner - Pushing the Communication Barrier in 2PC Page 2Secure 2PC
This work: semi-honest (passive) security
Michael Zohner - Pushing the Communication Barrier in 2PC Page 2Applications of Secure 2PC
Sugar Beet Auction [BCD+09]
Michael Zohner - Pushing the Communication Barrier in 2PC Page 3Applications of Secure 2PC
Sugar Beet Auction [BCD+09] Face Recognition [EFG+09]
Michael Zohner - Pushing the Communication Barrier in 2PC Page 3Applications of Secure 2PC
Sugar Beet Auction [BCD+09] Face Recognition [EFG+09]
Blind En/Decryption [Dyadic]
AES
Michael Zohner - Pushing the Communication Barrier in 2PC Page 3Applications of Secure 2PC
Sugar Beet Auction [BCD+09] Face Recognition [EFG+09]
Blind En/Decryption [Dyadic] Stable Matching [DES16]
AES
Michael Zohner - Pushing the Communication Barrier in 2PC Page 3Generic Secure 2PC
Two prominent techniques: Yao's protocol and GMW
Both evaluate Boolean circuits securely
● XOR gates are „free“
● AND gates cost sym. crypto / comm.
Difference: round complexity
● Yao is constant round
● GMW requires interaction per AND gate
Michael Zohner - Pushing the Communication Barrier in 2PC Page 4Practical Improvements
Speed of 2PC Implementations
4
3
2
1
0
2004 2010 2011 2013 2015 2016
Michael Zohner - Pushing the Communication Barrier in 2PC
ces/setag
DNA
noilliM
Currently: 3 million ANDs/s per thread, however:
● We have hit a comm. lower-bound per AND for Yao [ZRE15]
● Run-time for GMW often is mostly network latency
Page 5Lookup Tables
Michael Zohner - Pushing the Communication Barrier in 2PC Page 6Our Contributions
Develop lookup table (LUT)-based protocols
Tool support for generating LUT circuits
Evaluation and comparison
(Paper: improve building blocks & comm. for GMW)
Michael Zohner - Pushing the Communication Barrier in 2PC Page 7Lookup Table Protocols
Michael Zohner - Pushing the Communication Barrier in 2PC Page 81ooN Oblivious Transfer
Bob obliviously obtains one of N messages s.t.
– Alice does not learn Bob's choice
– Bob does not learn Alice's other messages
Most efficient protocol 1ooN OT: [KK13]
Michael Zohner - Pushing the Communication Barrier in 2PC Page 9Intuition of the Protocols
Use [KK13] 1ooN OT to perform table lookups
Michael Zohner - Pushing the Communication Barrier in 2PC Page 10Pre-Computation
100000
OP-LUT
10000
SP-LUT
1000
100
10
1
2 3 4 5 6 7 8
Number of Inputs
Michael Zohner - Pushing the Communication Barrier in 2PC
]setyB[
noitacinummoC
LUT Protocols
We develop two LUT protocols based on [KK13] OT
● Online Phase LUT (OP-LUT)
● Setup Phase LUT (SP-LUT)
Online
1000
OP-LUT
100
SP-LUT
10
1
2 3 4 5 6 7 8
Number of Inputs
]setyB[
noitacinummoC
Page 11Generating LUT Circuits
Michael Zohner - Pushing the Communication Barrier in 2PC Page 12Tool Support for LUTs
Generating LUT circuits is difficult and error-prone
● Automation is required
Idea: FPGAs internally operate on single output LUTs
● Use ABC logic syntesis to generate single output LUTs
Add post-processing to improve efficiency
Michael Zohner - Pushing the Communication Barrier in 2PC Page 13Combining LUTs
FPGAs only support single output LUTs
We combine LUTs with similar inputs to improve efficiency
SP-LUT Communication: 512 bits SP-LUT Communication: 380 bits
Michael Zohner - Pushing the Communication Barrier in 2PC Page 14Extracting XORs
Since XORs are free, we can extract them
Example
Michael Zohner - Pushing the Communication Barrier in 2PC Page 15Comparison
Michael Zohner - Pushing the Communication Barrier in 2PC Page 16Communication
● Mostly: SP-LUT < GMW < OP-LUT < Yao
● Boolean circuits perform better for sequential structures
● LUT circuits perform best for tree based structures
Michael Zohner - Pushing the Communication Barrier in 2PC Page 17Communication
● Mostly: SP-LUT < GMW < OP-LUT < Yao
● Boolean circuits perform better for sequential structures
● LUT circuits perform best for tree based structures
Michael Zohner - Pushing the Communication Barrier in 2PC Page 17Communication
● Mostly: SP-LUT < GMW < OP-LUT < Yao
● Boolean circuits perform better for sequential structures
● LUT circuits perform best for tree based structures
Michael Zohner - Pushing the Communication Barrier in 2PC Page 17Interaction Rounds
● Yao is constant round
● Mostly: SP-LUT < OP-LUT < GMW
● Exception: Multiplication with Ripple-carry addition
Michael Zohner - Pushing the Communication Barrier in 2PC Page 18Interaction Rounds
● Yao is constant round
● Mostly: SP-LUT < OP-LUT < GMW
● Exception: Multiplication with Ripple-carry addition
Michael Zohner - Pushing the Communication Barrier in 2PC Page 18Empirical Evaluation
AES encryption of 1000 blocks using 4 threads
● LAN (1 GBit network, 0.2 ms latency)
● WAN (28 MBit network, 122ms latency)
1 000 AES Evaluations in WAN
60
50
Yao
40
GMW
30 OP-LUT
SP-LUT
20
10
0
Setup Online Total
Michael Zohner - Pushing the Communication Barrier in 2PC
]s[
emiT-nuR
1 000 AES Evaluations in LAN
1.8
1.6
1.4
Yao
1.2
GMW
1
OP-LUT
0.8
SP-LUT
0.6
0.4
0.2
0
Setup Online Total
]s[
emiT-nuR
Page 19Conclusion
Communication is bottleneck in 2PC
Developed LUT protocols based on 1ooN OT
Tool chain for compiling LUT circuits
Showed that LUT protocols can improve communication
Michael Zohner - Pushing the Communication Barrier in 2PC Page 20Thank you for your attention
Michael Zohner - Pushing the Communication Barrier in 2PC Page 21From 1oo2 OT to 1ooN OT
[IKNP03] [KK13]
1oo2 OT 1ooN OT
Michael Zohner - Pushing the Communication Barrier in 2PCOur Results
Michael Zohner - Pushing the Communication Barrier in 2PC1ooN OT Extension [KK13]
. . .
0 1 0 1 0 1
0 1 0 1 0 1
. . .
0 1 0 0 1 1
. . 0 0 1 1
. . 0 1 0 1
0 1 . . . .
. . .
. . . .
1 1 0 0
Hamming distance
Codewords with HD
Michael Zohner - Pushing the Communication Barrier in 2PCFrom 1oo2 OT to 1ooN OT
● 1ooN OT can be obtained from logN 1oo2 OTs
● Example 1oo4:
Michael Zohner - Pushing the Communication Barrier in 2PCFrom 1ooN OT to 1oo2 OT
● Surprising insight: reducing 1ooN OT to single bit
1oo2 OT saves communication
( , , , )
● Best for N=16: Requires 320 bits instead of 512 bits
Michael Zohner - Pushing the Communication Barrier in 2PC