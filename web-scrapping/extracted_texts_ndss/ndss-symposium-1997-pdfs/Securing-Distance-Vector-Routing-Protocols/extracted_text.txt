Securing Distance-Vector Routing Protocols
ISOC Symposium on Network and Distributed System Security ’97
Tuesday, February 11, 1997
Bradley R. Smith Shree Murthy J.J. Garcia-Luna-Aceves
Computer Science Dept. Sun Microsystems Computer Corp. Computer Engineering Dept.
University of California 2550 Garcia Avenue University of California
Santa Cruz, CA 95064 Mountain View, CA 94043 Santa Cruz, CA 95064
brad@cs.ucsc.edu shree@eng.sun.com jj@ce.ucsc.edu
0ThisworkwassupportedinpartbytheDefenseAdvancedResearchProjectsAgency(DARPA)underGrantF19628-96-C-0038.Distance-Vector Routing
(cid:15)
Neighboring routers exchange routing messages composed of one
or more routing updates.
(cid:15)
Routing updates contain, at a minimum, a destination and the
distance to the destination.
(cid:15)
A router knows the length of the shortest path from each neigh-
bor to every destination.
(cid:15)
A router computes the shortest path to each destination, sending
routing messages to its neighbors as needed.
ISOCSymposiumonNetworkandDistributedSystemSecurity Slide1 February11th,1997Vulnerabilities and Threats
(cid:15)
Routing updates can be fabricated, modified, replayed, deleted,
and snooped.
(cid:15)
Examples:
– Unauthorized nodes can simply participate in the routing pro-
tocol dialog (i.e. no access control mechanisms are defined for
the protocol).
– Nodes can masquerade as an authorized router using source
routing attacks or TCP session hijacking attacks.
– Links can be subverted by an intruder in a manner allowing
the manipulation of routing messages.
– Subverted routers can be made to run modified software, or
use a modified configuration.
ISOCSymposiumonNetworkandDistributedSystemSecurity Slide2 February11th,1997Vulnerabilities and Threats (cont.)
(cid:15)
The threats posed by these vulnerabilities include:
– Black hole routes
)
denial of service.
– Reconfigure logical topology
)
disclosure of data traffic and
inaccurate accounting of usage.
– Routing traffic snooping
)
disclosure of path information.
ISOCSymposiumonNetworkandDistributedSystemSecurity Slide3 February11th,1997Assumptions
(cid:15)
Intruders have the capabilities described previously.
(cid:15)
Information received from a router can only be trusted regarding
links incident on that router.
(cid:15)
Each router is assigned a public-key pair.
(cid:15)
Key distribution mechanisms are available to distribute public-
keys given an IP address of a host.
ISOCSymposiumonNetworkandDistributedSystemSecurity Slide4 February11th,1997Countermeasures
Message Protection: Protect the transmission of routing messages
between neighbors.
Update Protection: Protect the transmission of routing updates be-
tween an originating router and a dynamically determined set of
remote routers.
ISOCSymposiumonNetworkandDistributedSystemSecurity Slide5 February11th,1997Classes of Information
C B
A
E
D
Neighbor-to-neighbor, routing messages.
Dynamic multicast, routing updates.
ISOCSymposiumonNetworkandDistributedSystemSecurity Slide6 February11th,1997Message Protection
(cid:15)
Message sequence number.
(cid:15)
Message digital signature.
(cid:15)
Protect messages from fabrication, modification, deletion, or re-
play by “outsiders” (masquerading routers, unauthorized routers,
and subverted links).
(cid:15)
Addressed by currently proposed link-oriented, neighbor-to-neighbor
countermeasures such as the use of the IP security extensions.
ISOCSymposiumonNetworkandDistributedSystemSecurity Slide7 February11th,1997Update Protection
Update digital signature and originating router I.D.
(cid:15)
Protects all fields of a routing update, except the distance field,
from fabrication or modification by subverted routers.
(cid:15)
Computed over all fields of the routing update (including those
defined below) except the distance field.
(cid:15)
Originating router I.D. needed to verify digital signature.
Update sequence information.
(cid:15)
Protect against the replay of routing updates by subverted routers.
(cid:15)
Timestamp
)
shorter lifetime, simpler administration.
(cid:15)
Sequence number
)
longer lifetime, more complex adminis-
tration.
ISOCSymposiumonNetworkandDistributedSystemSecurity Slide8 February11th,1997Update Protection (cont.)
Predecessor network.
(cid:15)
Indirectly protects the distance field from fabrication or modi-
fication by a subverted router via mis-representation of down-
stream connectivity.
(cid:15)
E.g. protects against a node advertising a 2 hop route to a des-
tination that is 10 hops downstream.
(cid:15)
The predecessor network is the second-to-last network traversed
by packets on their way to the given destination.
(cid:15)
Given the predecessor network for all intermediate hops to a
destination, the path to the destination can be reconstructed.
ISOCSymposiumonNetworkandDistributedSystemSecurity Slide9 February11th,1997Update Protection Summary
C B
A
E
D X Y
Dest
<
Pred,SN
> D e s t
Dist
D
<
E, ...
> D
1
C
<
E, ...
> C
1
B
<
C, ...
> B
2
X
<
D,...
> X
2
Y
<
X, ...
> Y
Dest
3
Information atE beforeAis added.
<
Pred,SN
> D e s t
Dist
D
<
E, ...
> D
1
C
<
E, ...
> C
1
B
<
C, ...
> B
2
X
<
D, ...
> X
2
Y
<
X, ...
> Y
3
A
<
B, ...
> A
3
Informationat E afterAis added.
D can no longer advertise a 1 hop route to A!
ISOCSymposiumonNetworkandDistributedSystemSecurity Slide10 February11th,1997Countermeasure Effectiveness
Message protection countermeasures:
(cid:15)
protect routing updates from fabrication, modification, dele-
tion, and replay by unauthorized routers, masquerading routers,
and subverted links.
Update digital signature:
(cid:15)
protects all fields of a routing update, except the distance field,
from fabrication or modification by subverted routers.
Update sequence number:
(cid:15)
protects all fields of a routing update, except the distance field,
from replay by subverted routers.
Predecessor:
(cid:15)
protects the distance field from fabrication or modification by
a subverted router.
ISOCSymposiumonNetworkandDistributedSystemSecurity Slide11 February11th,1997Countermeasure Effectiveness
(cid:15)
Remaining vulnerabilities.
Subverted router can:
– fabricate information re: links incident on it,
– delete routing updates,
Any node can:
– snoop routing information.
ISOCSymposiumonNetworkandDistributedSystemSecurity Slide12 February11th,1997Cost of Countermeasures
Per Message:
(cid:15)
Space for 128bit digital signature and 32bit sequence number.
(cid:15)
Time to compute and validate digital signature.
Per Update:
(cid:15)
Space for 128bit digital signature, 32bit sequence number, 64bit
predecessor address and mask, and 32bit originating router
address.
(cid:15)
Time to compute digital signature (once per predecessor per
update), and verify once per router which selects a path which
uses the link.
Per Destination:
(cid:15)
Time to perform path-traversal for each change in route to a
given destination.
ISOCSymposiumonNetworkandDistributedSystemSecurity Slide13 February11th,1997Conclusions
Protection from outsiders:
(cid:15)
Reasonably straightforward.
(cid:15)
Requires sequence number and digital signature per routing
message.
Protection from subverted routers:
(cid:15)
Can be done in constant space (i.e. linear w.r.t. number of
destinations).
(cid:15)
Requires sequence information, predecessor information, and
digital signature per routing update.
(cid:15)
Time and space costs are high, but not as bad as previously
thought.
ISOCSymposiumonNetworkandDistributedSystemSecurity Slide14 February11th,1997