Securing the Nimrod Routing
Architecture
Karen Sirois and Stephen Kent
BBN CorporationOutline
n
Analysis methodology
n
Points of attack
n
Nimrod routing architecture
n
Nimrod security requirements
n
Countermeasure design for NimrodAnalysis Methodology
n
Security focus: countering denial of service attacks
n
Identify architectural elements
n
Derive requirements using a hybrid approach
– correct operation scenarios
– attack driven
– countermeasure driven
n
Base countermeasures on security requirements,
Nimrod protocols and available mechanismsPoints of Attack
F Endpoint
Endpoint Endpoint A
(dest)
(source) (other)
B
Router
Router
(inter)
(inter)
Router Router
(first hop) E (last hop)
D
Network
G
Management
C CenterNimrod Routing Architecture
n
Service specific routing
n
Scaleable architecture
n
Basic entities
– nodes: comprised of agents
– endpoints
n
Distributed databases
n
Link state maps
– produced locally (by each node)
– restricted distributionForwarding Example
source R NR2
NR1 dest
ER1 Node C
ER2
Node A
FA1 FA3
FA2
Node B
FA2’Nimrod Protocol Structure
Neighbor Agent Adjacency Locator Map Route Path Data
Discovery Discovery Procedures Procedures Procedures Requests Management Forwarding
Update Protocol Query-Response Path Management
Protocol Protocol
Nimrod Transaction Header
Transaction/TCP
Nimrod Forwarding Header
IPNimrod Security Requirements
protos cse oec lru vir cit ey n i g i r O a t a Dn o i t a c i t n e h t u A y t i t n E r e e Pn o i t a c i t n e h t u A d e s a B - e l u Rl o r t n o C s s e c c A d e s a B - y t i t n e d il o r t n o C s s e c c A s s e l n o i t c e n n o Cy t i r g e t n I e c n e u q e Sy t i r g e t n I y t i l a i t n e d i f n o C - n o Nn o i t a i d u p e R
Neighbor X X X
Discovery
Agent Discovery X X X
Locator X X X X X*
Procedures
Map Procedures X X X X X
Adjacency
X X X X X*
Procedures
Route Requests X X X X* X
Data Forwarding X X
X
Path X X X X X X* X
Setup/Accept
Path Teardown X X X X X X* X
Path Status X X X
Path Ack X X
XCountermeasure Design
n
IPSEC protection
n
Digital signatures
n
Timestamps
n
Access control and non-repudiationIPSEC protection
n
IPSEC ESP with anti-replay (in tunnel mode)
– provides authentication, integrity and replay protection.
– uses keyed hash with windowed sequence numbers
– requires (pairwise unique) shared secrets between
neighboring agents
– encryption optional, but not required
– more efficient to compute and more inclusive than AH
n
Employed to protect both neighbor discovery and
subscriber trafficDigital Signatures
n
Provides multicast authentication and integrity on an
“end-to-end” basis
n
Useful for non-repudiation and access control
n
Update, Agent Discovery and Path Management
protocols as well as Query-Response protocol
n
RSA signature algorithm and sha-1 hash algoithm
n
Use X.509 (v3) certificatesTimestamps
n
Provides anti-replay protection as well as ensuring
message timeliness
n
Timestamp window with saved hash values
mechanism
n
Increasing timestamp mechanism
n
Clock adjustmentsAccess Control and Non-Repudiation
n
Use identity-based access control
n
Cache specific messages to support weak non-
repudiation serviceSummary
n
Security requirements analysis for Nimrod was fairly
complex
n
Proposed countermeasures are a mixture of reliance
on a lower layer security (IPSEC-ESP/AR) plus
integration of Nimrod-specific measures, plus shared-
secret establishment
n
Our solution not a perfect one:
– Byzantine attacks still pose hard problems, given real world
performance requirements
– this analysis and the proposed countermeasures don’t address
many implementation vulnerabilities