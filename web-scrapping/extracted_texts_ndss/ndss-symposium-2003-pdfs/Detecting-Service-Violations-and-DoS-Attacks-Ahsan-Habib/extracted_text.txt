Detecting Service Violations and DoS Attacks
AhsanHabib,MohamedM.Hefeeda,andBharatK.Bhargava
CERIASandDepartmentofComputerSciences
PurdueUniversity,WestLafayette,IN47907
fhabib,mhefeeda,bbg@cs.purdue.edu
Abstract DoS attacks exists. They range from political conflicts
and economical benefits for competitors to just curiosity
of some computer geeks. Furthermore, cyber terrorism
DenialofService(DoS)attacksareaseriousthreatfor maynotbeexcludedinthefuture.
theInternet.DoSattackscanconsumememory,CPU,and InadditiontoDoSattacks,thequalityofservice(QoS)
network resources and damage or shut down the opera- enabled networks are vulnerable to another type of at-
tion of the resource underattack (victim). The qualityof tacks,namely,theQoSattacks. AQoS-enablednetwork,
service(QoS)enablednetworks,whichofferdifferentlev- suchasadifferentiatedservicesnetwork[3],offersdiffer-
els of service, are vulnerable to QoS attacks as well as entclassesofservicefordifferentcosts.Differencesinthe
DoSattacks. TheaimofaQoSattackistostealnetwork charging rates may entice some users to steal bandwidth
resources,e.g.,bandwidth,ortodegradetheserviceper- orothernetworkresources. Wedefineanattackerinthis
ceived by users. We present a classification and a brief environmentasauserwhotriestogetmoreresources,i.e.,
explanationof the approaches used to deal with the DoS abetterserviceclass, thanwhathehassigned(paid)for.
andQoSattacks. Furthermore,weproposenetworkmon- QoS attacks are classified into two kinds: attacking the
itoringtechniquestodetectserviceviolationsandtoinfer network provisioning process and attacking the data for-
DoS attacks. Finally, a quantitative comparison among warding process. Network provisioning involves config-
allschemesisconducted,inwhich,wehighlightthemerits urationofroutersinaQoSnetwork. Thisprocesscanbe
ofeachschemeandestimatetheoverhead(bothprocess- attackedbyinjectingbogusconfigurationmessages,mod-
ingandcommunication)introducedbyit.Thecomparison ifying the content of real configuration messages, or de-
providesguidelinesforselectingtheappropriatescheme, laying such messages. Networks can be secured against
or a combination of schemes, based on the requirements suchattacksbyencryptingtheconfigurationmessagesof
andhowmuchoverheadcanbetolerated. the signaling protocols. Attacks on the data forwarding
process are of a more serious nature. These attacks in-
ject traffic into the network withthe intentto steal band-
widthortocauseQoSdegradationforotherflows. Since
1.Introduction
the differentiated services framework is based on aggre-
gation of flows into service classes, legitimate customer
TheSanDiegoSupercomputerCenterreported12,805
trafficmayexperiencedegradedQoSasaresultoftheil-
denial of service (DoS) attacks over a three-week period
legally injected traffic. Taken to an extreme, that excess
in February 2001 [16]. This is just one of the numerous
traffic may result in a denial of service attack. This cre-
incidents in which DoS attacks are causing serious secu-
atesaneedfordevelopinganeffectivedefensemechanism
ritythreatstomanysystemsconnectedtotheInternet.The
thatautomatesthedetectionandreactiontoattacksonthe
DoSattackscanbesevereiftheylastforaprolongedpe-
QoS-enablednetworks.
riod of time preventing legitimate users from accessing
Inthispaper,wefirstelaborateonthedenialofservice
someorallofcomputingresources. Imagineanexecutive
attacks and their potential threat on the system. We then
of a financial institution deprived of access to the stock
classify the solutions proposed in the literature into two
marketupdatesforseveralhoursorevenseveralminutes.
maincategories:detectionandpreventionapproaches.We
In [16], the authors showed that whereas 50% of the at-
brieflydescribeseveralmechanismsineachapproach,fo-
tacks lasted less than ten minutes, unfortunately, 2% of
cusingmainlyonthesalientfeaturesandhighlightingthe
them lasted greater than five hours and 1% lasted more
potentialaswellastheshortcomingsofeachmechanism.
thantenhours. Thereweredozensofattacksthatspanned
In addition, we propose network monitoring techniques
multipledays. WidespectrumofmotivationbehindthesetodetectserviceviolationsandtoinferDoSattacks. We eral hosts (denoted by Hs) connected to four domains1
believe that network monitoring has the potential to de- D1;D2;D3; and D4; which are interconnected through
tectDoSattacksinearlystagesbeforetheyseverelyharm theInternetcloud. Inthefigure,A representsanattacker
i
the victim. Our conjecture is that a DoS attack injects a iwhileV representsavictim.
hugeamountoftrafficintothenetwork, whichmayalter
the internal characteristics (e.g., delay and loss ratio) of 2.1.DoSAttacks
the network. Monitoring watches for these changes and
The aim of a DoS attack is to consume the resources
identifiesthecongestedlinks,whichhelpsinlocatingthe
of a victim or the resources on the way to communicate
attacker and alerting the victim. Finally, we conduct a
with a victim. By wasting the victim’s resources, the at-
comparative evaluationstudyamongtheapproachespre-
tacker disallows it from serving legitimate customers. A
sented.Theaimofthestudyistocomparethebehaviorof
victimcanbeahost,server,router,oranycomputingen-
theapproachesunderdifferentsituationsoftheunderlying
tity connected to the network. Inevitable human errors
network. Wedrawinsightfulcommentsfromthecompar-
duringsoftwaredevelopment,configuration,andinstalla-
isonthatguidetheselectionofoneormoredefendingap-
tionopenseveralunseendoorsforthesetypeofattacks.
proachessuitableforagivenenvironment.
SeveralDoSattacksareknownanddocumentedinthe
Therestofthepaperisorganizedasfollows. Section2
literature[14,16,21,24]. Floodingavictimwithanover-
discusestheDoSattacksandpresentstheclassificationof
whelmingamountoftrafficisthemostcommon.Thisun-
the approaches used to deal with them. In Section 3, we
usualtrafficclogsthecommunicationlinksandthwartsall
show how network monitoringcan be used to detect ser-
connectionsamongthelegitimateusers,whichmayresult
viceviolationsandtoinferDoSattacks. Thecomparative
inshuttingdownanentiresiteorabranchofthenetwork.
study is presented in Section 4 and Section 5 concludes
This happened in February of 2000 for the popular web
thepaper.
sites Yahoo, E*trade, Ebay, and CNN for several hours
[14].
TCPSYNfloodingisaninstanceofthefloodingattacks
2.DoSAttacks: DetectionandPrevention
[22]. Under this attack, the victim is a host and usually
runs a Web server. A regular client opens a connection
In the literature, there are several approaches to deal with the server by sending a TCP SYN segment. The
with denial of service (DoS) attacks. In this section, we server allocates buffer for the expected connection and
provideanapproximatetaxonomyoftheseapproaches.In replies with a TCP ACK segment. The connection re-
addition,webrieflydescribethemainfeaturesofeachap- mainshalf-open(backlogged)tilltheclientacknowledges
proachandhighlightthestrengthsandweaknessesofit. the ACK of the server and moves the connection to the
WedividetheapproachesfordealingwithDoSattacks establishedstate. IftheclientdoesnotsendtheACK,the
into two main categories: detection and prevention ap- buffer will be deallocated after an expiration of a timer.
proaches. Thedetectionapproachescapitalizeonthefact The server can only have a specific number of half-open
thatappropriatelypunishingwrongdoers(attackers)will connectionsafterwhichallrequestswillberefused. The
deterthemfromre-attackingagain, andwillscareothers attacker sends a TCP SYN segment pretending a desire
todosimilaracts. Thedetectionprocesshastwophases: to establish a connection and making the server reserves
detectingtheattackandidentifyingtheattacker. Toiden- bufferforit. Theattackerdoesnotcompletetheconnec-
tify an attacker, several traceback methods can be used, tion. Instead, it issues more TCP SYNs, which lead the
asexplainedlaterinthissection. Theobviouswaytode- servertowasteitsmemoryandreachitslimitfortheback-
tect an attack is just waiting till the system performance logged connections. Sending such SYN requests with a
decreasessharplyoreventhewholesystemcollapses.We highratekeepstheserverunabletosatisfyconnectionre-
proposeamoreeffectivemethodfordetectingattacksbe- quests from legitimate users. Schuba et al. [22] devel-
fore they severely harm the system. We propose to use opedatooltoalleviatetheSYNfloodingattack. Thetool
monitoringforearlydetectionofDoSattacks.Thedetails watches for SYN segments coming from spoofed IP ad-
aregiveninSection3. Thepreventionapproaches,onthe dresses and sends TCP RST segments to the server. The
otherhand,trytothwartattacksbeforetheyharmthesys- RST segments terminate the half-open connections and
tem. Filteringisthemainstrategyusedintheprevention freetheirassociatedbuffers.
approaches. Other types of flooding attacks include TCP ACK and
To clarify the presentation, we use the hypothetical RSTflooding,ICMPandUDPecho-requestflooding,and
network topology shown in Figure 1 to demonstrate
1Throughoutthepaper,weuse“domain”torefertoanAutonomous
several scenarios for DoS attacks and how the differ-
Systems(AS)domain,whichisanetworkadministeredbyasingleen-
ent approaches react to them. The figure shows sev- tity.(cid:21)(cid:1)(cid:22)(cid:1) (cid:21)(cid:1)(cid:22)(cid:1)
(cid:5)(cid:1)(cid:6)(cid:1)
(cid:5)(cid:1)(cid:6)(cid:1)
(cid:5)(cid:1)(cid:6)(cid:1) (cid:5)(cid:1)(cid:6)(cid:1)
(cid:21)(cid:22) (cid:21)(cid:22)
(cid:5)(cid:6)
(cid:5)(cid:6)
(cid:5)(cid:6) (cid:5)(cid:6)
(cid:3)(cid:1)(cid:4)(cid:1) (cid:3)(cid:1)(cid:4)(cid:1) (cid:3)(cid:1)(cid:4)(cid:1) (cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:7)(cid:8)
(cid:7)(cid:8)
(cid:7)(cid:8) (cid:7)(cid:8) (cid:7)(cid:8)
(cid:7)(cid:8)
(cid:3)(cid:1)(cid:4)(cid:1) (cid:3)(cid:1)(cid:4)(cid:1) (cid:3)(cid:1)(cid:4)(cid:1) (cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1) (cid:0)(cid:1)(cid:2)(cid:1) (cid:0)(cid:1)(cid:2)(cid:1) (cid:0)(cid:1)(cid:2)(cid:1) (cid:0)(cid:1)(cid:2)(cid:1) (cid:0)(cid:1)(cid:2)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1) (cid:3)(cid:1)(cid:4)(cid:1) (cid:3)(cid:1)(cid:4)(cid:1) (cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:0)(cid:1)(cid:2)(cid:1) (cid:0)(cid:1)(cid:2)(cid:1) (cid:0)(cid:1)(cid:2)(cid:1) (cid:0)(cid:1)(cid:2)(cid:1) (cid:0)(cid:1)(cid:2)(cid:1) (cid:0)(cid:1)(cid:2)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1) (cid:3)(cid:1)(cid:4)(cid:1) (cid:3)(cid:1)(cid:4)(cid:1) (cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:0)(cid:2) (cid:0)(cid:2) (cid:0)(cid:2) (cid:0)(cid:2) (cid:0)(cid:2) (cid:0)(cid:2)
(cid:3)(cid:1)(cid:4)(cid:1) (cid:3)(cid:1)(cid:4)(cid:1) (cid:3)(cid:1)(cid:4)(cid:1) (cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:1)(cid:4)(cid:1)
(cid:3)(cid:4) (cid:3)(cid:4) (cid:3)(cid:4) (cid:3)(cid:4)
(cid:3)(cid:4)
(cid:25)(cid:1) (cid:25)(cid:1)
(cid:25)(cid:1)
(cid:25)(cid:1) (cid:25)(cid:1) (cid:25)(cid:1)
(cid:13)(cid:1) (cid:13)(cid:1) (cid:13)(cid:1)
(cid:13)(cid:1)
(cid:25)(cid:1)(cid:26)(cid:1) (cid:25)(cid:1)(cid:26)(cid:1)
(cid:25)(cid:1)(cid:26)(cid:1)
(cid:25)(cid:1)(cid:26)(cid:1) (cid:25)(cid:1)(cid:26)(cid:1) (cid:25)(cid:1)(cid:26)(cid:1)
(cid:13)(cid:1)(cid:14)(cid:1) (cid:13)(cid:1)(cid:14)(cid:1) (cid:13)(cid:1)(cid:14)(cid:1)
(cid:13)(cid:1)(cid:14)(cid:1)
(cid:25)(cid:1)(cid:26)(cid:1) (cid:25)(cid:1)(cid:26)(cid:1)
(cid:25)(cid:1)(cid:26)(cid:1)
(cid:25)(cid:1)(cid:26)(cid:1) (cid:25)(cid:1)(cid:26)(cid:1) (cid:25)(cid:1)(cid:26)(cid:1)
(cid:23)(cid:1)(cid:24)(cid:1) (cid:23)(cid:1)(cid:24)(cid:1) (cid:23)(cid:1)(cid:24)(cid:1) (cid:23)(cid:1)(cid:24)(cid:1) (cid:23)(cid:1)(cid:24)(cid:1) (cid:23)(cid:1)(cid:24)(cid:1)
(cid:23)(cid:1)(cid:24)(cid:1) (cid:23)(cid:1)(cid:24)(cid:1)
(cid:13)(cid:1)(cid:14)(cid:1) (cid:13)(cid:1)(cid:14)(cid:1) (cid:13)(cid:1)(cid:14)(cid:1)
(cid:13)(cid:1)(cid:14)(cid:1)
(cid:25)(cid:1)(cid:26)(cid:1) (cid:25)(cid:1)(cid:26)(cid:1)
(cid:25)(cid:1)(cid:26)(cid:1)
(cid:25)(cid:1)(cid:26)(cid:1) (cid:25)(cid:1)(cid:26)(cid:1) (cid:25)(cid:1)(cid:26)(cid:1)
(cid:23)(cid:1)(cid:24)(cid:1) (cid:23)(cid:1)(cid:24)(cid:1) (cid:23)(cid:1)(cid:24)(cid:1) (cid:23)(cid:1)(cid:24)(cid:1) (cid:23)(cid:1)(cid:24)(cid:1) (cid:23)(cid:1)(cid:24)(cid:1)
(cid:23)(cid:1)(cid:24)(cid:1) (cid:23)(cid:1)(cid:24)(cid:1)
(cid:13)(cid:14) (cid:13)(cid:14) (cid:13)(cid:14)
(cid:13)(cid:14)
(cid:25)(cid:1)(cid:26)(cid:1) (cid:25)(cid:1)(cid:26)(cid:1)
(cid:25)(cid:1)(cid:26)(cid:1)
(cid:25)(cid:1)(cid:26)(cid:1) (cid:25)(cid:1)(cid:26)(cid:1) (cid:25)(cid:1)(cid:26)(cid:1)
(cid:23)(cid:1)(cid:24)(cid:1) (cid:23)(cid:1)(cid:24)(cid:1) (cid:23)(cid:1)(cid:24)(cid:1) (cid:23)(cid:1)(cid:24)(cid:1) (cid:23)(cid:1)(cid:24)(cid:1) (cid:23)(cid:1)(cid:24)(cid:1)
(cid:23)(cid:1)(cid:24)(cid:1) (cid:23)(cid:1)(cid:24)(cid:1)
(cid:25)(cid:26) (cid:25)(cid:26)
(cid:25)(cid:26)
(cid:25)(cid:26) (cid:25)(cid:26) (cid:25)(cid:26)
(cid:23)(cid:24) (cid:23)(cid:24) (cid:23)(cid:24) (cid:23)(cid:24) (cid:23)(cid:24) (cid:23)(cid:24)
(cid:23)(cid:24) (cid:23)(cid:24)
(cid:11)(cid:12)
(cid:11)(cid:12)
(cid:11)(cid:12) (cid:11)(cid:12)
(cid:11)(cid:12)
(cid:11)(cid:12)
(cid:15)
(cid:15)(cid:16)(cid:15)(cid:16) (cid:16)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:1)(cid:10)(cid:1)
(cid:9)(cid:10)
(cid:9)(cid:10)
(cid:17)(cid:1) (cid:17)(cid:1)
(cid:17)(cid:1)
(cid:17)(cid:1)
(cid:17)(cid:1)
(cid:17)(cid:1)
(cid:17)(cid:18) (cid:17)(cid:18)
(cid:17)(cid:18)
(cid:17)(cid:18)
(cid:17)(cid:18)
(cid:17)(cid:18)
(cid:19)(cid:1)
(cid:19)(cid:1)
(cid:19)(cid:1)
(cid:20)(cid:1)
(cid:20)(cid:1)(cid:19)(cid:1)(cid:20)(cid:1)(cid:19)(cid:1)
(cid:19)(cid:1)
(cid:20)
(cid:20)(cid:19)(cid:20)(cid:19)
(cid:19)
H2
H3 Reflector D3
V R6 D4
A4
Attack using reflector
R5
H4 R4
D2
H1
R3 Forged path Internet Cloud A3
R2 D1
D5
Attack path A2
H5
R1
A5
A1
Domain Host Router
Figure1.DifferentscenariosforDoSattacks. AttackerA1launchesanattackonthevictimV. A1spoofs
IPaddressofhostH5fromdomainD5. AnotherattackerA3useshostH3asareflectortoattackV:
DNS request flooding [16, 24]. This list is by no means him liable for the damage he has caused. However, pin-
exhaustive. ning the real attacker down is not a straightforward task.
ADoSattackcanbemoreseverewhenanattackeruses One reason is that the attacker spoofs the source IP ad-
multiple hosts over the Internet to storm a victim. To dress of the attacking packets. Another reason is that
achieve this, the attacker compromises many hosts and theInternetisstateless,whichmeans,wheneverapacket
deploys attacking agents on them. The attacker signals passes through a router, the router does not store any in-
allagentstosimultaneouslylaunchanattackonavictim. formation(ortraces)aboutthatpacket. Therefore,mech-
Barros[1]showsthatDDoSattackcanreachahighlevel anisms such as ICMP traceback and packet marking are
ofsophisticationbyusingreflectors. Areflectorislikea devisedtofigureouttherealattacker. Inthissubsection,
mirrorthatreflectslight. IntheInternet,manyhostssuch wedescribeseveraltechniquestoidentifytheattackeraf-
as Web servers, DNSservers, androuterscan be usedas ter the attack took place. We defer the issue of early de-
reflectorsbecausetheyalwaysreplyto(orreflect)specific tectionofanattacktillSection3.
typeofpackets. WebserversreplytoSYNrequests,DNS
servers reply to queries, and routers send ICMP packets
2.2.1.ICMPTraceback
(timeexceededorhostunreachable)inresponsetopartic-
ular IP packets. The attackers can abuse these reflectors Bellovin [2] proposes the idea of ICMP traceback mes-
tolaunchDDoSattacks. Forexample,anattackingagent sages, where every router samples the forwarded pack-
sendsaSYNrequesttoareflectorspecifyingthevictim’s ets with a very low probability (e.g., 1 out of 20,000)
IPaddressasthesourceaddressoftheagent. Thereflec- and sends an ICMP Traceback message to the destina-
tor will send a SYN ACK to the victim. There are mil- tion. AnICMPTracebackmessagecontainstheprevious
lionsofreflectorsintheInternetandtheattackercanuse and next hop addresses of the router, timestamp, portion
thesereflectorstofloodthevictim’snetworkbysendinga of the traced packet, and authentication information. In
largeamountofpackets. Paxson[20]analyzesseveralIn- Figure 1, while packets are traversing the network path
ternetprotocolsandapplicationsandconcludesthatDNS from the attacker A1 to the victim V; the intermediate
servers, Gnutella servers, and TCP-based servers are po- routers (R1;R2;R3;R4;R5; and R6) sample some of
tentialreflectors. thesepacketsandsendICMPTracebackmessagestothe
destinationV:Withenoughmessages,thevictimcantrace
2.2.DetectionApproaches the network path A1 ! V: The pitfall of this approach
isthattheattackercansendmanyfalseICMPTraceback
Thedetectionapproachesrelyonfindingthemalicious messagestoconfusethevictim.
party who launched a DoS attack and consequently hold To address Distributed DoS (DDoS) attacks by reflec-tors, Barros [1] proposes a modification to the ICMP and the end routers of the link. The distance metric rep-
Tracebackmessages.Inhisrefinement,routerssometimes resents the number of hops between the attacker and the
send ICMP Traceback messages to the source. In Fig- victim.Toillustratetheidea,considertheattackerA1and
ure1, A3launchesaDDoSattackbysendingTCPSYN the victim V in Figure 1. Assume there is only one hop
segments to the reflector H3 specifying V as the source betweenroutersR3andR4:IfRouterR1marksapacket,
address. H3, in turn, sends SYN ACK segments to the it will encode the XOR of R1 and R2 addressesinto the
victim V: According to the modification, routers on the packetandsetsthedistancemetrictozero,thatis,itwill
path A3 ! H3 will send ICMP messagesto the source, encode the tuple <R1(cid:8)R2;0>. Other routers on the
i.e., to V: This reverse trace enables the victim to iden- pathjustincreasethedistancemetricofthispacket,ifthey
tifytheattackingagentfromthesetracepackets. There- don’t decide to mark it again. When this packet reaches
verse trace mechanism depends only on the number of thevictim,itprovidesthetuple<R1(cid:8)R2;5>.Similarly,
attackingagents,andnotonthenumberofreflectors[20]. somepacketsmaygetmarkedatroutersR2;R3;R4;R5;
Thisachievesscalabilitybecausethenumberofavailable andR6andtheywillprovidethetuples<R2(cid:8)R3;4>;
reflectors is much higher than the number of attacking < R3 (cid:8) R4;3 >; < R4 (cid:8) R5;2 >; < R5 (cid:8) R6;1 >;
agentsontheInternet. <R6;0>;respectively,whentheyreachthevictim. The
Snoerenetal. [23]proposeanattractive hashed-based victim can retrieve all routers on the path by XORing
systemthatcantracetheoriginofasingleIPpacketdeliv- the collected messages sorted by distance. (Recall that
eredbyanetworkintherecentpast. Thesystemiscalled Rx(cid:8)Ry (cid:8)Rx = Ry.) This approach can reconstruct
sourcepathisolationengine(SPIE).TheSPIEusesanef- mostnetworkpathswith95%certaintyifthereareabout
ficientmethodtostoreinformationaboutpacketstravers- 2,000markedpacketsavailableandeventhelongestpath
ingthroughaparticularrouter. Themethodusesnbitsof canberesolvedwith4,000packets[21]. ForDoSattacks,
thehashedvalueofthepackettosetanindexofa2n-bit this amount of packets is clearly obtainable because the
digest table. When a victim detects an attack, a query is attackerneedstofloodthenetworktocauseaDoSattack.
sent to SPIE, which queries routers for packet digests of (Mooreetal.[16]reportthatsomesevereDoSattackshad
the relevant time periods. Topology information is then a rate of thousands of packets per second.) The authors
usedtoconstructtheattackgraphfromwhichthesource describe ways to reduce the required space and suggest
oftheattackisdetermined. to use the identification field (currently used for IP frag-
mentation)ofIPheadertostoretheencodingofthepath
information. They also propose solutions to handle the
2.2.2.PacketMarking co-existence of marking and fragmentationof IP packets
[21].
Instead of having routers send separate messages for the
ThemainlimitationofthePPMapproachesstemsfrom
sampledpackets, BurchandCheswick[5]proposetoin-
the fact that, nothing prevents the attacker from marking
scribesomepathinformationintotheheaderofthepack-
packets. If a packet marked by the attacker does not get
ets themselves. This marking can be deterministic or
re-marked by any intermediate router, it will confuse the
probabilistic. In the deterministic marking, every router
victimandmake ithardertotracetherealattacker. Park
marksallpackets.Theobviousdrawbackofthedetermin-
and Lee [17] show that for single-source DoS attacks,
isticpacketmarkingisthatthepacketheadergrowsasthe
PPMcanidentifyasmallsetofsourcesaspotentialcan-
number of hops increases on the path. Moreover, signif-
didatesforaDoSattack. ForDDoSattacks,however,the
icant overhead will be imposed on routers to mark every
attacker can increase the uncertainty in localizing the at-
packet.
tacker. Therefore, PPM is vulnerable to distributed DoS
The probabilistic packet marking (PPM) encodes the
attacks[17].
pathinformationintoasmallfractionofthepackets. The
assumptionisthatduringafloodingattack,ahugeamount
2.3.PreventionApproaches
oftraffictravelstowardsthevictim. Therefore,thereisa
great chance that many of these packets will be marked PreventiveapproachestrytostopaDoSattackbyiden-
at routers throughout their journey from the source to tifying the attack packets and discarding them before
the victim. It is likely that the marked packets will give reachingthe victim. We summarizeseveral packet filter-
enough information to trace the network path from the ingtechniquesthatachievethisgoal.
victimtothesourceoftheattack.
Savageetal. [21]describeefficientmechanismstoen-
2.3.1.IngressFiltering
codethepathinformationintopackets. Thisinformation
containstheXOR(exclusiveOR)oftwoIPaddressesand Incomingpacketstoanetworkdomaincanbefilteredby
a distance metric. The two IP addresses are for the start ingress routers. These filters verify the identity of pack-etsenteringintothedomain,likeanimmigrationsecurity usessomeunusedIPaddressesofdomainD1;thefilters
systemattheairport.Ingressfiltering,proposedbyFargu- will not be able to stop such forged packets to reach the
sonandSenie[10], isa restrictivemechanismthatdrops victimV.
trafficwithIPaddressthatdoesnotmatchadomainprefix
connectedtotheingressrouter. Asanexample,inFigure
1,theattackerA1residesindomainD1withthenetwork 3. Monitoring to Detect Service Violations
prefixa.b.c.0/24. TheattackerwantstolaunchaDoSat- andDoSAttacks
tacktothevictimV thatisconnectedtodomainD4.Ifthe
attackerspoofstheIPaddressofhostH5indomainD5,
which has the network prefix x.y.z.0/24, an input traffic Inthissection,weshowhownetworkmonitoringtech-
filter on the ingress link of R1 will thwart this spoofing. niquescanbeusedtodetectserviceviolationsandtoinfer
R1 only allows traffic originating from source addresses DoSattacks. Webelievethatnetworkmonitoringhasthe
withinthea.b.c.0/24prefix. Thus,thefilterprohibitsan potentialtodetectDoSattacksinearlystagesbeforethey
attackerfromusingspoofedsourceaddressesfromoutside severely harm the victim. Our conjecture is that a DoS
oftheprefixrange. Similarly,filteringfoilsDDoSattacks attack injects a huge amount of traffic into the network,
that employ reflectors. In Figure 1, ingress filter of D2 which may alter the internal characteristics (e.g., delay
willdiscardpacketsdestinedtothereflectorH3andspec- and loss ratio) of the network. Monitoring watches for
ifyingV0saddressinthesourceaddressfield. Thus,these these changes and our proposed techniques can identify
packetswillnotbeabletoreachthereflector. the congested links and the points that are feeding them.
Ingress filtering can drastically reduce the DoS attack We describe the monitoring schemes in the context of a
by IP spoofing if all domains use it. It is hard, though, QoS-enablednetwork,whichprovidesdifferentclassesof
to deploy ingress filters in all Internet domains. If there servicefordifferentcosts. Theschemesarealsoapplica-
are some unchecked points, it is possible to launch DoS bletobesteffort(BE)networkstoinferDoSattacks,but
attacksfromthatpoints. Unlikeingressfilters,egressfil- nottodetectserviceviolationsbecausethereisnonotion
ters[13]resideattheexitpointsofanetworkdomainand ofservicedifferentiationinBEnetworks.
checkswhetherthesourceaddressofexitingpackets be- To monitor a domain, we measure three parameters:
longtothisdomain.Asidefromtheplacementissue,both delay, packet loss ratio, and throughput. We refer to
ingressandegressfiltershavesimilarbehavior. these parameters collectively as the service level agree-
ment(SLA)parameters,sincetheyindicatewhetherauser
isachievingtheQoSrequirementscontractedwiththenet-
2.3.2.Route-basedFiltering workprovider. Inourdiscussion,delayistheend-to-end
latency; packet loss ratio is defined as the ratio of num-
ParkandLee[18]proposeroute-baseddistributedpacket berofdroppedpacketsfromaflow2tothetotalnumberof
filtering, which rely on route information to filter out packetsofthesameflowenteredthedomain;andthrough-
spoofed IP packets. For instance, suppose that A1 be- putisthetotalbandwidthconsumedbya flow insidethe
longs to domain D1 and is attempting a DoS attack on domain. Delay and loss ratio are good indicators for the
V thatbelongstodomainD4. IfA1usesthespoofedad- current status of the domain. This is because, if the do-
dressH5thatbelongstodomainD5,thefilteratdomain mainisproperlyprovisionedandnouserismisbehaving,
D1wouldrecognizethatapacketoriginatedfromdomain theflowstraversingthroughthedomainshouldnotexpe-
D5 and destined to V should not travel through domain rience high delay or loss ratio inside that domain. It is
D1. Then,thefilteratD1willdiscardthepacket. Route- worthmentioningthatdelayjitter,i.e.,delayvariation,is
basedfiltersdonotuse/storeindividualhostaddressesfor another important SLA parameter. However, it is flow-
filtering,rather,theyusethetopologyinformationofAu- specific and therefore, is not suitable to use in network
tonomousSystems(ASes). Theauthorsof[18]showthat monitoring.
withpartialdeploymentofroute-basedfilters,about20% TheSLAparameterscanbeestimatedwiththeinvolve-
in the Internet AS topologies, it is possible to achieve a mentofinternal(core)routersinanetworkdomainorcan
goodfilteringeffectthatpreventsspoofedIPflowsreach- be inferred without their help. We describe both core-
ingotherASes. Thesefiltersneedtobuildrouteinforma- assistedmonitoringandedge-based(withoutinvolvement
tion by consulting BGP routers of different ASes. Since ofcorerouters)monitoringinthefollowingsubsections.
routesontheInternetchangewithtime[19], itisachal-
lengeforroute-basedfilterstobeupdatedinrealtime.
Finally, all filters proposed in the literature so far fall
2Aflowcanbeamicroflowwithfivetuples(addresses,ports,and
short to detect IP address spoofing from the domain in
protocol) or an aggregate one that is a combination of several micro
whichtheattackerresides.Forexample,inFigure1,ifA1 flows.0 k !R1,forinstance,canbeestimatedbysendingstripes
fromtheroot0totheleavesR1 andR2. Thefirstpacket
of a 3-packet stripe is sent to R1, while the last two are
senttoR2. Ifapacketreachestoanyreceiver,wecanin-
k ferthatthepacketmusthavereachedthebranchingpoint
k. Further,ifR2 getsthelasttwopacketsofastripe,itis
likelythatR1 receivesthefirstpacketofthatstripe. The
packetlossprobabilityiscalculatedbasedonwhetherall
R R
packets sent to R1 and R2 reach their destination. Simi-
1 2 larly, the loss ratio of the link k ! R2 is inferred using
a complementary stripe, in which the first packet is sent
Figure 2. Inferring loss ratio from the source 0
to R2 and the last two are sent to R1. The loss ratio of
toreceiversR1 andR2.
thecommonpathfrom0 ! k canbeestimatedbycom-
bining the results of the previous two steps. For general
trees,thisinferencetechniquesendsstripesfromtheroot
3.1.Core-basedMonitoring
toallorderedpairsoftheleaves ofthetree. Finally, this
techniqueisextendedin[11]forrouterswithactivequeue
Acore-basedmonitoringschemeforQoS-enablednet-
managementinaQoSdomain.
workisstudiedin[11]. Inthisscheme,thedelayismea-
DistributedMonitoring. Thedistributedmonitoringap-
sured by having the ingress routers randomly copy the
proachisproposedin[12]tofurtherreducethemonitoring
header of some of the incoming packets. The copying
overhead.Inthismechanism,theedgeroutersofadomain
depends on a pre-configured probability parameter. The
form an overlay network on top of the physical network.
ingressrouterformsaprobepacketwiththesameheader
Figure3(a)showsthespanningtreeofthedomain’stopol-
asthedatatraffic,whichmeansthattheprobepacketwill
ogy. The edge routers form an overlay network among
likelyfollowthesamepathasthedatapacket. Theegress
themselves,asshowninFigure3(b). Thisoverlayisused
router recognizes these probe packets and computes the
tobuildtunnelforprobepacketsonspecifiedpaths. The
delay.
internallinksforeachend-to-endpathintheoverlaynet-
Thismonitoringschememeasuresthelossratiobycol-
work are shown in Figure 3(c). In the distributed moni-
lectingpacketdropcountsfromcorerouters. Itthencon-
toring approach, an SLA monitor sits at any edge router.
tactstheingressrouterstogetthetotalnumberofpackets
Themonitorprobesthenetworkregularlyforunusualde-
foreachflow. Thelossratioiscomputedfromthesetwo
laypatterns. Thedelayandthroughputmeasurementsare
numbers.Tomeasurethethroughput,theschemepollsthe
the same as described in stripe-based scheme. The two
egress routers. The egress routerscan provide this infor-
schemesdifferinmeasuringloss. Sinceserviceviolation
mationbecausetheyalreadymaintainthisinformationfor
canbedetectedwithoutexactlossvalues,weneedonlyto
each flow. This scheme imposes excessive overhead on
determinewhetheralinkhashigherlossthanthespecified
thecorerouters,therefore,itisnotscalable. Othermoni-
thresholdornot. Thelinkwithhighlossisreferredtoasa
toringschemesthatinvolvebothcoreandedgeroutersare
congestedlink. Thegoalofthedistributedmonitoringis
proposedintheliterature,seeforexample[4,7,8].
todetectallcongestedlinks.
3.2.Edge-basedMonitoring Whendelaygoeshigh,theSLAmonitortriggersagents
at different edge routers to probe for loss. Each edge
We describe two edge-based monitoring schemes:
routerprobesitsneighbors. LetX beabooleanrandom
(cid:26)
stripe-basedanddistributed.Bothschemesmeasuredelay
variablethatrepresentstheoutputofprobe(cid:26).X takeson
(cid:26)
andthroughputusingthesametechniquesastheprevious
value1ifthemeasuredlossexceedsthethresholdinany
core-based scheme. They differ, however, in measuring
linkthroughouttheprobepath,andtakeson0otherwise.
thepacketlossratio.
For example, if the outcome of E1 ! E3 probing path
Stripe-basedMonitoring. Thestripe-basedschemein-
is 1, it means either E1 ! C1, C1 ! C3, C3 ! E3,
fers loss ratio inside a domain without relying on core
oracombinationofthemiscongested. Iftheoutcomeis
routers. Weshowhowtoinferlossratiosforunicasttraf-
0, then definitely all internal links are not congested. In
fic as explained in [9] and refer the reader to [6] for the
this way, we write equations to express all internal links
multicasttrafficcase. Theschemesendsaseriesofprobe
in terms of the probe outcomes. Solving these equations
packets,calledastripe,withnodelaybetweenthem.Usu-
andidentifyingthecongestedlinksaredetailedin[12].
ally,astripeconsistsofthreepackets. Tosimplifythedis-
The distributed monitoring scheme requires less num-
cussion,consideratwo-leafbinarytreespanningnodes0,
ber of total probes, O(n), compared to the stripe-based
k,R1,R2,asshowninFigure2. ThelossratioofthelinkE1
E1
E1
C1
C1
C3 C2
C3
E2 C2
E2
E2
E3 C4 C5
E3 E3 C4 C5
E4 E6 E7 E5 E6 E7
E4 E5 E4 E6 E7 E5
Edge Router Core Router Peers (Edge Router) Edge Router Core Router
(a) The spanning tree of the domain’s (b)Anoverlayconstructedoveralledge (c) Direction of probing the internal
topology. routers. links.
Figure3.Networkmonitoringusingthedistributedmechanism.
scheme,whichrequiresO(n2);wherenisthenumberof descendantfromv andtheotherfromtheleavesdescen-
i
edgeroutersinthedomain.Thedistributedschemeisable dantfromv . Thefirstsubtreehasegressroutersasleaves
j
to detect violation in both directions of any link in the through which high aggregate bandwidth flows are leav-
domain, whereas the stripe-based can detect a violation ing. If many exiting flows have the same destination IP
onlyiftheflowdirectionofthemisbehavingtrafficisthe prefix,wecaninferthateitherthisisaDoSattackorthe
same as the probing direction from the root. To achieve traffic is a going to a popular site [15]. Decision can be
sameabilitylikedistributedone,thestripe-basedneedsto taken with consulting the destination entity. If it is an
probethewholetreefromseveralpoints,whichincreases attack, we can stop it by triggering filters at the ingress
themonitoringoverheadsubstantially. routersthatareleavesoftheothersubtree.
We illustrate a scenario of detecting and controlling
3.3.ViolationandDoSDetection DoS attack using Figure 3. Suppose, the victim’s do-
main D is connected to the edge router E6. The mon-
Inboththestripe-basedanddistributed-basedmonitor-
itor observes that links C3 ! C4 and link C4 ! E6
ing schemes, when delay, loss, and bandwidth consump-
are congested for a time duration (cid:1)t sec. From both
tion exceed the pre-defined thresholds, the monitor de-
congested links, we obtain the egress router E6 through
cidesonpossibleSLAviolation. Themonitorknowsthe
which most of these flows are leaving. The destination
existingtrafficclassesandtheacceptableSLAparameters
IP prefix matching at E6 reveals that an excess amount
perclass. Highdelayisanindicationofabnormalbehav-
of traffic is heading towards the domain D connected to
ior inside the domain. If there is any loss for the guar-
E6. Tocontroltheattack,themonitorneedstofigureout
anteed traffic class and if the loss ratios of other traffic
throughwhichingressroutersthesuspectedflowsareen-
classesexceedcertainlevels,anSLAviolationisflagged.
tering into the domain. The algorithm to identify these
This loss can be caused by some flows consumingband-
ingressroutersisdiscussedin[12]. Themonitoractivates
width beyond their SLA. Bandwidth theft is checked by
filtersattheseingressrouterstoregulatetheflowsthatare
comparingthetotalbandwidthachievedbyauseragainst
destinedtoD.
theuser’sSLAforbandwidth.Themisbehavingflowsare
Theadvantageofthemonitoring-basedattackdetection
controlledattheingressrouters.
is that the neighbor domains of the victim can detect the
TodetectDoSattacks,setoflinksLwithhighlossare
attackearlybyobservingtheviolationofSLAparameters.
identified. For each congested link, l(v ;v ) 2 L; the
i j
Byconsultingwiththepotentialvictim,thesedomainscan
tree is divided into two subtrees: one formed by leavesSymbol Description Valuesusedincomparison
P Processingoverheadforschemesch –
sch
C Communicationoverheadforschemesch –
sch
M Numberofedgerouters [10–20]
N Numberofcorerouters 12
F Numberofflowsenteringthrougheachedgerouter 100,000
P Numberofpacketsperflow 10
p Probabilitytomarkapacket [0–0.20]
(cid:18) Percentageofmisbehavingflows [0–20%]
h Pathlengthinsideadomainorhopcount 4,6
s Lengthofastripe 3
f Frequencyofstripeperunittimeinstripe-basedmonitoring 20
s
f Frequencyofprobesperunittimeindistributedmonitoring 30
d
(cid:11)1 Processingoverheadforfiltering –
(cid:11)2 Processingoverheadformarking –
(cid:11)3 Processingoverheadformonitoring –
Table1.Symbolsusedinthecomparisonandtheirvalues.
regulatetheintensityoftheattackandevenanearlydetec- re-computation, and any CPU processing needed by the
tioncanthwarttheattack. Foreachviolation,themonitor scheme. For example, filters need to check the source
takes actions such as throttling a particular user’s traffic IP address to verify whether a packet is coming from a
usingaflowcontrolmechanism. valid source. This requires one extra address lookup (to
check the source IP address) for each packet. The mon-
4.ComparativeEvaluation itoring schemes inject probe packets into the network.
Each router inside a domain requires processing such as
In this section, we conduct a quantitative analysis of
address lookup, TTL field decrement, checksum compu-
theoverheadimposedbydifferentschemestodetectand
tationforeachprobepacket.Forsimplicity,wechargethe
prevent DoS attacks. The objective of this compari-
filteringscheme(cid:11)1 processingunits,themarkingscheme
son is to show the characteristics of each scheme and
(cid:11)2 processingunits,andthemonitoringschemes(cid:11)3 pro-
how they behave when different configuration parame-
cessing units for each packet processed. We express the
ters of a domain are changed. We do not emphasize on
processingoverheadintermsof(cid:11)1;(cid:11)2;and(cid:11)3 (process-
numeric overhead value of any specific scheme, rather,
ing units), and the communication overhead in terms of
we draw a relative comparison among them. The com-
thetotalkilobytes(KB)injectedinthedomain.
parison provides guidelines for selecting the appropriate
We consider a domain D with M edge routers and N
scheme, or a combination of schemes, based on the re-
core routers. We assume there are F flows traversing
quirementsandhowmuchoverheadcanbetolerated. The
through each edge router and each flow has P packets
schemes we compare here are: Ingress Filtering (Ingf),
on average. We define (cid:18) as the percentage of misbehav-
route-basedpacketfiltering(Route),tracebackwithprob-
ingflowsthatmaycauseDoSattacks. WedenoteC as
sch
abilisticpacketmarking(PPM),core-basednetworkmon-
the communication overhead and P as the processing
sch
itoring (Core), stripe-based monitoring (Stripe), and dis-
overhead respectively for scheme sch. Table 1 lists the
tributedmonitoring(Distributed).
variablesusedinthecomparisonandtheirvalues.
4.1.Setup 4.2.OverheadCalculation
Foreachscheme,wecalculatetwodifferentoverheads: Filtering and marking techniques do not incur any
processingandcommunication. Theprocessingoverhead communicationoverhead. The monitoringschemes have
is due to extra processing required at all routers of a do- bothprocessingandcommunicationoverhead.
main per unit time. The communication overhead is due
toextrapacketsinjectedintoadomain. Thecommunica- Ingress filtering. The processing overhead of ingress
tion overhead is computed as the number of extra bytes filtering depends on the number of packets entering a
(notpackets)injectedperunittime. Forprocessingover- domain. It requires one processing unit to check the
head, the extra processing at routers may contain: more source IP address of every packet. For our domain D,
addresslookups,changingsomeheaderfields,checksum thetotalenteringpacketsisM (cid:2)F (cid:2)P. Thus,thetotalprocessingoverheadofingressfilteringisgivenby: andtheprocessingoverheadisgivenby:
P Ingf =M (cid:2)F (cid:2)P (cid:2)(cid:11)1: (1) F (cid:2)(cid:18)(cid:2)d
P
Core
=(2M +N)(cid:2)max(1; )(cid:2)h(cid:2)(cid:11)3;
packet size
(5)
Route-basedfiltering. We need to deploy ingressfilters
wherepacket sizeisaconfigurableparameter.
ineverydomainintheInternettoeffectivelystopallpossi-
bleattacks.Theroute-basedfilteringscheme,ontheother
Stripe-based monitoring. In the stripe-based moni-
hand,doesnotrequireeverysingledomaintohaveafilter.
toring scheme, a stripe of s packets is sent from the
Park et al. show that placing this filter at approximately
monitor to every egress router pairs. For the network
20%ofallautonomoussystemscanpreventDoStoagreat
domain D, the total number of probing packets is
extent[18]. Foradomainthatdeploysarouter-basedfil-
s(cid:2)(M (cid:0)1)(cid:2)(M (cid:0)2)(cid:2)f ;wheref isthefrequency
ter,theoverheadisthesameastheingressfilter. Globally s s
by which we need to send stripes per unit time. The
speaking,theoverheadofroute-basedfilteringisonefifth
communicationoverheadandtheprocessingoverheadare
oftheoverheadofingressfilteringontheaverage. Inour
showninequation(6)andequation(7)respectively.
comparison,weuse
P Route =0:2(cid:2)P Ingf: (2) C Stripe =s(cid:2)(M(cid:0)1)(cid:2)(M(cid:0)2)(cid:2)f s(cid:2)packet size; (6)
Probabilisticpacketmarking(PPM).PPMdoesnotin-
cur any communication overhead but adds extra (cid:11)2 pro- P Stripe =s(cid:2)(M (cid:0)1)(cid:2)(M (cid:0)2)(cid:2)f s(cid:2)h(cid:2)(cid:11)3: (7)
cessingunitsforeverypacketthatgetsmarkedataninter-
mediaryrouter. PPMmightneedsophisticatedoperation
Distributedmonitoring. Forthedistributedmonitoring,
suchastakinghashofcertainIPfields.Thetracebackwith
each edge router probes its left and right neighbors. If it
PPMmarkspacketswithaprobabilitypateachrouteron
requiresf probesperunittime,thecommunicationover-
thepathtothevictim. Ifapacketpassesthroughhhops, d
headis:
ontheaverage, inthenetworkdomainD, theprocessing
overheadiscomputedas:
C =2(cid:2)M (cid:2)f (cid:2)packet size: (8)
Distributed d
P
PPM
=M (cid:2)F (cid:2)P (cid:2)p(cid:2)h(cid:2)(cid:11)2 (3)
On the average, each probe packet traverses h hops and
thustheprocessingoverheadcanbecalculatedas:
Core-basedmonitoring. Themonitoringschemesinject
probe traffic into the network and add processing over- P
Distributed
=2(cid:2)M (cid:2)f d(cid:2)h(cid:2)(cid:11)2 (9)
headsaswell.Thetotalnumberofinjectedprobesandthe
sizeofeachprobepacketareusedtocalculatethecommu-
nication overheads in terms of bytes. The Core scheme
4.3.ResultsandAnalysis
depends on the number of packets that core routers send
to the monitor to report drop history. The drop history
Tovisualizethedifferencesamongallschemes,weplot
at each core router depends on the flows traversing the
theprocessingandcommunicationoverheadforoneofthe
network domain and the percentage of these flows that
domain shown in Figure 1. Usually, DoS attacks are di-
are violatingtheir SLAs at a particulartime. For the do-
rectedtowardsaparticularhostorasetofhostsconnected
main D, if d bytes are required to record the drop in-
toarelativelysmallsizedomain. Intheexample, Figure
formation of each flow, then each core needs to send
1,theDoSattackisdirectedtowardsdomainD4andthe
C = max(1; F(cid:2)(cid:18)(cid:2)d )controlpacketstothemonitor.
packet size attack traffic is coming from various other domains. For
Thepacket sizeisthesizeofacontrolpacket,whichde-
our comparison, we use the parameters’values shown in
pends on the MTU of the network. To obtain loss ratio,
Table1fordomainD. Weusesecasunittimeinallcom-
the monitor queries all edges for packet count informa-
parisons.
tionofthemisbehavingflows. Everyedgerepliestothis
Figure4(a)showstheprocessingoverheadintermsof
query. Thetotalnumberofpacketsexchangedamongall
(cid:11)1 for ingress filtering, route-based filtering, and PPM
edgeroutersandthemonitoris(2M +N)(cid:2)C packets.
when packet marking probability is varied along the X-
Therefore,thecommunicationoverheadisgivenby:
axis. The route-based filtering requires less processing
F (cid:2)(cid:18)(cid:2)d than marking scheme for p (cid:21) 0:07 because this filtering
C =(2M+N)(cid:2)max(1; )(cid:2)packet size;
Core packet size schemedoes not need to be deployed at all routersof all
(4) domains. Savageetal. usemarkingprobabilityp = 0:04108
107
106
105
104
0 0.05 0.1 0.15 0.2
Packet Marking Probability
daehrevO
gnissecorP
108
107
106
Route
Ingf
PPM, h=4
PPM, h=6
105
10 12 14 16 18 20
Number of Edge Routers
(a)Effectofvaryingthemarkingprobabilityontheprocessing
overhead.
daehrevO
gnissecorP
Route
Ingf
PPM, h=4
PPM, h=6
(b)Effectofvaryingthenumberofedgeroutersontheprocess-
ingoverhead.
Figure 4. The processing overhead per unit time for filters and probabilistic packet marking (PPM)
schemes. Marking scheme has less processing overhead than filtering scheme if the marking proba-
bilityisnottoohigh(e.g.,p(cid:20)0:07).
105
104
103
102
0 5 10 15 20
Percentage of Misbehaving Flow
daehrevO
gnissecorP
105
104
103
102
Core
Stripe
Distributed
101
0 5 10 15 20
Percentage of Misbehaving Flow
(a)Processingoverhead.
setyBK
ni
daehrevO
noitacinummoC
Core
Stripe
Distributed
(b)Communicationoverhead.
Figure5.Theprocessingandcommunicationoverheadforthemonitoringschemeswhenthepercentage
of misbehaving flows is increased. The Core scheme has less communication overhead than Stripe
schemefor(cid:18) <20%. BothStripeandDistributedschemeshavelesscommunicationoverheadthanCore
unless(cid:18) isverylow.106
105
104
103
10 11 12 13 14 15 16 17 18 19 20
Number of Edge Routers
daehrevO
gnissecorP
Core 104
Stripe
Distributed
103
102
101
10 12 14 16 18 20
Number of edge routers
(a)Processingoverhead.
setyBK
ni
daehrevO
noitacinummoC
Core
Stripe
Distributed
(b)Communicationoverhead.
Figure6.Theprocessingandcommunicationoverheadforthemonitoringschemeswhenthenumberof
edgeroutersinadomainisincreased. TheCoreschemehaslessprocessingoverheadthanbothedge-
based schemes when the number of edge routers in the domain is increased. Edge-based schemes
alwaysimposelesscommunicationoverheadthantheCorescheme. TheCoremightperformbetterthan
Stripeforalargedomain(e.g.,M >20)dependingonthevalueof(cid:18).
intheirtracebackanalysis[21].Usingthisprobability,the schemeswhenthenumberofedgeroutersincreases.Even
marking mechanism has less overhead than others. We thoughtheoverheadofCoreschemedependsonbothcore
use two different path lengths in the plot; one is h = 4 and edge routers, this scheme reduces processing over-
and another is h = 6. The path length does not increase headbyaggregatingflowswhenitreportstothemonitor.
the overhead substantially because the path length does Whennumberofedgeroutersincreases,overheadforboth
notgoupveryhighforasmall-sizedomain. Figure4(b) CoreandDistributedschemesincreaselinearly.Theover-
showsthatwhennumberofedgeroutersareincreasedin headforStripeincreasessubstantiallywiththeincreaseof
adomaintheprocessingoverisincreasedforallschemes. edgerouters. Dependingon(cid:18),Figure6(b)showsthatthe
Figure 5 shows both processing and communication communicationoverheadforStripemayexceedthecom-
overhead for different monitoring schemes. The pro- municationoverheadofCorewhenM >20.
cessing overhead is low for Core scheme than the Stripe
schemefor(cid:18) (cid:20) 20%. Thisisbecausethecontrolpacket 4.4.Summary
size of Core can be set equal to the maximum transmis-
sionunitofthenetworktominimizetotalnumberofpack- We summarize the important features of all schemes
etssent,whereastheprobepacketsizeoftheStripeis20 inTable2. Ingressfilteringandcore-assistedmonitoring
byteswith20bytesofIPheader.However,iftheattackin- schemeshavehighimplementationoverheadbecausethe
tensityishigh,i.e.,thevalueof(cid:18)ishigh,theoverheadof formerneedstodeployfiltersatallingressroutersinthe
Core exceeds the overhead of both edge-based schemes. Internetandthelatterneedssupportfromalledgeandcore
In this example, probes injected by Stripe scheme con- routersinadomain. Butfilteringandmonitoringcanpro-
sumes 600K bytes of bandwidth per sec, which is dis- vide better safety compared to the traceback which only
tributedoveralllinksofthedomain. IfalllinksareOC3 canidentifyanattackeraftertheattackhasoccurred. All
type, on average each link experiences probe traffic less monitoring schemes need clock synchronization to mea-
than0.015%ofthelinkcapacity. TheDistributedscheme sure SLA parameters, which is an extra overhead. But,
consumestentimeslessthantheStripeoneinthissetup. theycandetectserviceviolationsandDoSattacksaswell.
InFigure6,wevarythedomainsizechangingthenumber Filters are proactive in nature and all other schemes are
ofedgerouterswhilekeepingthenumberofcorerouters reactive. Filters can detect attacks by spoofed packets
fixed to N = 12. The percentage of misbehaving traffic whereastherestoftheschemescandetectanattackevenif
(cid:18) is fixed and equals 1%. Figure 6 (a) shows that Core theattackerdoesnotusespoofedIPaddressesfromother
can result in less computation overhead than edge-based domains.Property PPM IngressFiltering Route-based Core-assisted Stripe-based Distributed
Filtering Monitoring Monitoring Monitoring
Overhead attack numberof numberof numberof routers, routers,
dependson volume incoming incoming flowsviolating topology, topology,
packets packets SLAs attacktraffic attacktraffic
Implementation allrouters allingress allroutersof alledgeand alledge alledge
overhead edgerouters selectivedomains corerouters routers routers
Clock — — — atedgeand atedge atedge
synchronization corerouters routers routers
Response reactive proactive proactive reactive reactive reactive
SLAviolation no no no yes yes yes
detection
Detectattacks anyIP spoofedIPfrom spoofedIPfrom anyIP anyIP anyIP
initiatedusing otherdomains otherdomains
Table2.Comparisonamongdifferentschemestodetect/preventserviceviolationsandDoSattacks.
5.Conclusions Thestripe-basedmonitoringschemehaslowercommuni-
cationoverheadthanthecore-basedschemeforrelatively
Weinvestigatedseveralmethodstodetectservicelevel small size domains. For large domains, however, core-
agreement violations and DoS attacks. We showed that basedmayimposelesscommunicationoverheaddepend-
there is no single method that fits all possible scenarios. ingontheattackintensity.Fourth,Thedistributedscheme
Specifically, in ICMP traceback and probabilistic packet outperformstheothermonitoringschemesintermsofde-
markingmechanisms,theattackermaybeabletoconfuse ploymentcostandoverheadinmanyofthecases.
the victim by sending false ICMP traceback packets and
by randomly marking attacking packets. Ingress filters Acknowledgments
need global deployment to be effective, whereas route-
basedfiltersstriveagainstthedynamicchangeoftherout- This research is supported in part by the National Sci-
inginformation. ence Foundation grants CCR-991712 and CCR-001788,
Weshowedthatnetworkmonitoringtechniquescanbe CERIAS,andIBM.
usedtodetectserviceviolationsbymeasuringtheSLApa-
rameters and comparingthem against the contractedval- References
ues between the user and the network provider. We also
[1] C. Barros. A proposal for ICMP traceback messages.
argued that monitoring techniques have the potential to
Internet Draft http://www.research.att.com/lists/ietf-
detect DoS attacks in early stages before they severely
itrace/2000/09/msg00044.html,Sept.18,2000.
harm the victim. Our argument is based on the fact that
[2] S.M.Bellovin. ICMPtracebackmessages. Internetdraft:
aDoSattackinjectsahugeamountoftrafficintothenet-
draft-bellovin-itrace-00.txt,Mar.2000.
work, which may alter the internal characteristics (e.g.,
[3] S.Blake,D.Black,M.Carlson,E.Davies,Z.Wang,and
delayandlossratio)ofthenetwork. Themonitoringtech- W. Weiss. An architecture for Differentiated Services.
niqueswatchforthesechangesandidentifythecongested RFC2475,Dec.1998.
links,whichhelpsinlocatingtheattackerandalertingthe [4] Y.Breitbart,C.Y.Chan,M.Garofalakis,R.Rastogi,and
victim. A.Silberschatz. Efficiently monitoringbandwidthandla-
Thepresentedcomparativestudyshowedseveralissues. tencyinIPnetworks. InProc.IEEEINFOCOM,Anchor-
First,itshowedthatwhilemarkingimposeslessoverhead age,AK,Apr.2001.
[5] H.BurchandH.Cheswick. Tracinganonymouspackets
than filtering, it is only a forensic method. Filtering, on
totheirapproximatesource.InProc.USENIXLISA,pages
theotherhand,isapreventivemethod,whichtriestostop
319–327,NewOrleans,LA,Dec.2000.
attacks before they harm the system. Second, the core-
[6] R.Ca´ceres,N.G.Duffield, J.Horowitz,andD.Towsley.
basedmonitoringschemehasahighdeploymentcostbe-
Multicast-basedinferenceofnetwork-internallosscharac-
cause it needs to update all edge as well as core routers.
teristics. IEEETransactionsonInformationTheory,Nov.
However,thecore-basedschemehaslessprocessingover- 1999.
head than the stripe-based scheme because it aggregates [7] M.C.Chan,Y.-J.Lin,andX.Wang.Ascalablemonitoring
flow information when it reports to the monitor. Third, approachforservicelevelagreementsvalidation. InProc.International Conference on Network Protocols (ICNP), [16] D.Moore,G.M.Voelker,andS.Savage. InferringInter-
pages37–48,Osaka,Japan,Nov.2000. net denial-of-serviceactivity. In Proc. USENIX Security
[8] M.DilmanandD.Raz. Efficient reactivemonitoring. In Symposium,WashingtonD.C,Aug.2001.
Proc.IEEEINFOCOM,Anchorage,AK,Apr.2001. [17] K.ParkandH.Lee. Ontheeffectivenessofprobabilistic
[9] N. G. Duffield, F. L. Presti, V. Paxson, and D. Towsley. packetmarkingforIPtracebackunderDenialofService
Inferringlinklossusingstripedunicastprobes. InProc. attack. InProc.IEEEINFOCOM,Anchorage,AK,Apr.
IEEEINFOCOM,Anchorage,AK,Apr.2001. 2001.
[10] P. Ferguson and D. Senie. Network ingress filtering: [18] K.ParkandH.Lee. Aproactiveapproachtodistributed
Defeating denial of service attacks which employ IP DoSattackpreventionusingroute-basedpacketfiltering.
sourceaddressspoofing agreementsperformancemonitor- InProc.ACMSIGCOMM,SanDiego,CA,Aug.2001.
ing. RFC2827,May2000. [19] V.Paxson. End-to-endinternetpacketdynamics. InProc.
[11] A. Habib, S. Fahmy, S. R. Avasarala, V. Prabhakar, and SIGCOMM’97,Cannes,France,1997.
B. Bhargava. On detecting service violations and band- [20] V.Paxson. Ananalysisofusingreflectorsfordistributed
widththeftinQoSnetworkdomains.JournalofComputer denial-of-serviceattacks.ACMComputerCommunication
Communicatons(toappear),2003. Review,31(3),July2001.
[12] A. Habib, M. Khan, and B. Bhargava. Edge-to- [21] S.Savage,D.Wetherall,A.Karlin,andT.Anderson. Net-
edgemeasurement-baseddistributednetworkmonitoring. worksupportforIPtraceback.IEEE/ACMTransactionon
Technical report, CSD-TR-02-019, Purdue University, Networking,9:(3):226–237,June2001.
Sept.2002. [22] C. L. Schuba, I. V. Krsul, M. G. Kuhn, E. H. Spafford,
[13] S. Institute. Egress filtering v 0.2. A. Sundaram, and D. Zamboni. Analysis of a denial of
http://www.sans.org/y2k/egress.htm,Feb.2000. serviceattackontcp. InProc.IEEESymposiumonSecu-
[14] L.Garber.DenialofServiceattacksriptheInternet.IEEE rityandPrivacy,Oakland,CA,May1997.
Computer,33,4:12–17,Apr.2000. [23] A.Snoeren,C.Partridge,L.Sanchez,W.Strayer,C.Jones,
[15] M.Mahajan,S.M.Bellovin,S.Floyd,J.Ioannidis,V.Pax- andF.Tchakountio. Hashed-basedIPtraceback. InProc.
son, and S. Shenker. Controllinghighbandwidthaggre- ACMSIGCOMM,SanDiego,CA,Aug.2001.
gatesinthenetwork. ACMComputerCommunicationRe- [24] G. Spafford and S. Garfinkel. Practical Unix and Inter-
view,32(3):62–73,July2002. netSecurity. O’Reilly&Associates,Inc,secondedition,
1996.