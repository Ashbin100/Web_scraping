Proxy Cryptography Revisited
AncaIvan,YevgeniyDodis
DepartmentofComputerScience
CourantInstituteofMathematicalSciences
NewYorkUniversity,NewYork,NY10012
fivan,dodisg@cs.nyu.edu
Abstract signatureforanotherkeywithoutdisclosingthesecretsig-
nature keys. We extend and generalize this notion as fol-
In this work we revisit and formally study the notion
lows. Intuitively, proxy functions allow one user to cor-
of proxy cryptography. Intuitively, various proxy func-
rectly decrypt ciphertexts or generate valid signatures on
tionsallowtwocooperatingpartiesF (the“FBI”)andP
behalf of another user without holding any information
(the“proxy”)toduplicatethefunctionalityavailabletothe
aboutthesecretkeysofthelatteruser.
third partyU (the“user”), without beingable toperform
thisfunctionalityontheirown(withoutcooperation). The Weconsiderthattheproxyfunctionscanbedividedinto
concept is closely related to the notion of threshold cryp- twocategories: bidirectionalandunidirectional. Theuni-
tography, except we deal with only two parties P and F, directionalproxyfunctionsallowoneuser(U )todecrypt
1
andplaceverystrictrestrictionsonthewaytheoperations ciphertextsorgeneratesignaturescorrespondingtothese-
areperformed(whichisdoneforthesakeofefficiency,us- cret key of another user (U ) even if the first user does
2
abilityandscalability). Forexample,fordecryption(resp. notholdthatsecretkey. However,theownerofthesecret
signature) P (F) sends a single message to F (P), after key(U )needsacompletelydifferentunidirectionalfunc-
2
which the latter can decrypt (sign) the message. Our for- tion if he desires to decrypt ciphertextsor generate signa-
malmodelingofproxycryptographysignificantlygeneral- turesonbehalfofthefirstuser(U ). Unliketheunidirec-
1
izes, simplifies and simultaneously clarifies the model of tionalproxy functions, the bidirectional ones canbe used
“atomic proxy” suggested by Blaze and Strauss [4]. In bybothuserstodecryptciphertextsorgeneratesignatures,
particular,wedefinebidirectionalandunidirectionalvari- by transforming the ciphertext/signature for one key into
antsofourmodel1,andshowextremelysimplegenericso- ciphertext/signaturefor another key. In other words, both
lutionsforproxysignatureandencryptioninthesemodels. usersU andU canusethesamebidirectionalproxyfunc-
1 2
We also give more efficient solutions for several specific tiontotransformciphertextsfromonekeytoanotherkey.
schemes. We conclude that proxy cryptography is a rela-
The original paper [4] informally defines the notion of
tively simple concept to satisfy whenlookedfrom the cor-
bidirectional proxyfunctions and describes two examples
rectandformalstandpoint.
ofproxyfunctions: oneforencryption,basedonElGamal
encryption, and one for signatures. However, both exam-
1 Introduction plesareprovedtohavelowsecurityguarantees.Ourpaper
formally defines both the bidirectional and unidirectional
proxyfunctionsforencryptionandsignature,andtheirse-
TheBlazeandStrauss[4]paperintroducedthenotionof
curity guarantees (e.g. indistinguishability/unforgeability
(atomic) proxy cryptography. The authors define “atomic
under various attacks). In addition, this paper presents
proxyfunctions”asfunctionsthattransformciphertextcor-
genericschemesforbidirectionalandunidirectionalproxy
respondingtoonekeyintociphertextforanotherkeywith-
functions for both public-key and private-key encryption
out revealing any information about the secret decryption
and signature schemes. All generic schemes can be used
keysorthecleartext. In thecaseofsignatures, theproxy
to transform any standard cryptographic primitive into a
functionsconvertavalidsignatureforonekeyintoavalid
proxy function, with a factor of two slowdown. This
1Wewillalsomentionyetanotheroff-linevariantimplicitlystudied slowdown is eliminated by the proxy functions specifi-
by[9,10].cally designed for a fewcryptographic primitives(e.g. El the actual signer. Our schemes differ from theirs in that
Gamal[12],RSA[25],RSAHash-and-Sign[2,1]). that the new signature is identical to the one that would
havebeenproducedbytheoriginaldelegator. Infact, this
The notion of proxy cryptography can be very useful
indistinguishabilityisoneofthemostimportantfeatureof
in cases when one user needs to perform sensitive oper-
our schemes. In [3], the RSA-based unidirectional signa-
ations (e.g. ciphertext decryption, signature generation)
ture scheme splits the secret key between a client and a
without holding the necessary secret keys. For example,
serversuchthatneitherisabletocreateavalidkeywithout
thepresidentofacompanycandelegatehissignaturerights
workingtogether. Thesecurityproofsrelyonthefactthat
by giving a proxy key to his assistent. The proxy key
theserverisalwaystrusted,thusobtaininglowerlevelsof
transforms a signature created by the vice-president into
security then the ones we propose here. MacKenzie and
thepresident’ssignature,thusallowingtheassistenttoco-
Reiter[22,21,20]considerasimilarquestionoftwo-party
sign only if the document was first signed by the vice-
signaturegenerationtotheoneweconsiderhere.However,
president. Another example is that of a key escrow sys-
theirsolutions,especially[22]arehighlycomplexandin-
tem [13, 23, 18, 17, 14, 27], where a trusted party can
teractiveascomparedtothenotionofunidirectionalproxy
mediate the conflicts between users and the law enforce-
signaturesweproposehere(theyalsohaveaslightlymore
ment agencies. The problem is to allow the law enforce-
sophisticatedscenario,wheretheuserhasapersonalpass-
mentagencytoreadmessagesencryptedforasetofusers,
wordinadditiontothesplitsecretkey).
for a limited period of time, without knowing the users’
secrets. The solution is to locate a key escrow agent be- As mentioned, the most closely related work is that of
tweentheusersandthelawenforcementagency,suchthat Blaze and Strauss [4] who introduce the notions of bidi-
it controls which messages are read by the law enforce- rectionaldecryptionandbidirectionalsignature. However,
ment agencies. In classic schemes, the users have to give lack of proper definitions makes them consider only the
theirsecretkeystothekeyescrowagent.Wheneverthelaw question of changing the existing encryption or signature
enforcementagencywantstoreadsamessagebelongingto schemes (like ElGamal encryption or Fiat-Shamir signa-
a user,thekeyescrowagentdecryptsthemessageandre- ture[11])intoacorrespondingproxyprimitive,insteadof
encryptsitwiththekeyofthelawenforcementagency. In looking at the abstract problem itself. As the result, they
ordertopreventthekeyescrowagentfromknowingthese- provideverylimited schemessatisfyingveryweak(semi-
cret keys andcleartext messages, we propose that the key formally stated) security properties. We contributeto this
escrow agent holds proxy keys that uses proxy functions work by clarifying and precisely defining the problems at
totransformciphertextcorrespondingtouserkeysintoci- hand(i.e.,presentingformaldefinitionsforallbidirectional
phertextcorrespondingtothelawenforcementagency. andunidirectionalproxyfunctionsandtheirsecurityguar-
antees), and describe generic as well as specific schemes
Therestofthepaperisstructuredasfollows. Thenext
forbothencryptionandsignatureproxyfunctions.
chapter presents other projects that studied the notion of
proxyfunctions.Chapter3usesthekeyescrowscenarioto We briefly consider extensions to the multi-user set-
describethecomputationalmodelusedtodefinetheproxy ting,anduserecentresultsfromidentitybasedcryptogra-
functions. Thenextfourchapterspresenttheactualunidi- phy[26,5]toimprovetheefficiencyinthissetting.Inaddi-
rectionalandbidirectionalfunctions. Thepaperendswith tion,weadaptthekey-insulatedmodelpresentedin[9,10]
somefinalthoughtsaboutlearnedlessonsandideasforthe to create offline bidirectional schemes that do not require
future. the proxy agent P to continuously assist the law enforce-
mentagencyF.
2 Related Work The unidirectional and bidirectional primitives can be
considered as special cases of general threshold cryptog-
raphy [6, 8]. However, most threshold systems assume a
The idea of delegating decryption/signature rights was
honest majority and work only for n (cid:21) 3. Thus, many
previouslyresearchedandpresentedinseveralpapers[16,
thresholdtechniquescannotbeappliedto atwo-partyset-
15,3,22,21,4].Thegoalofthe [16,15]paperissimilarto
ting. Recently, people have considered two-party primi-
ours.Inthecontextofmobilecomputing,agentsshouldbe
tivesinamulti-roundsetting: GQ,Schnorr[24]andDSA
abletocarrysignaturefunctionssuchthatuntrustedentities
signatures[22],while[19]talksaboutencryption.
signonbehalfofauserwithoutknowinghiskey.However,
the result of signing a message m is a brand new signa-
ture that combines the identities of the original user and3 Model everthe user F wants to sign a message m on behalf of a
certainuserU,itaskstheproxyPforhelp.First,theuserF
usesFSigtogenerateapartialsignatureofthemessagem.
For a better understanding and consistency throughout
The proxy P transforms the partial signature into a valid
therestofthepaper,wewillexplainandusethekeyescrow
signaturebyapplyingthePSigonthepartialsignature.
scenarioasamodelforourdefinitions.
The key escrowscenariohas four classes of actors: (i) Bidirectional encryption proxy function. A bidirec-
the general users U who delegate their decryption rights, tionalencryptionfunctionisdefinedasatupleE =(BiGen,
(ii) the law enforcement agency F that tries to decrypt ci- BiEnc, BiDec, (cid:5)). The key generation algorithm BiGen
phertexts belonging to the general users, (iii) the proxy createskeysforallusersinthesystem, includingtheuser
agent P responsible for helping the latter user to decrypt F. Foreachpairofkeys(k ;k ),theBiGenalgorithmgen-
U F
ciphertexts, and (iv) the legal court that is trusted by ev- erates a bidirectional key (cid:25). The general users U encrypt
eryone. All users register with the key escrow system by messages using BiEnc and decrypt them using BiDec. In
providingsomekindofsecretinformationtotheproxyP. ordertodecryptaciphertextbelongingtoageneraluserU,
Afterregistration,theyarefreetosendencryptedmessages the user F asks the proxy P for help. The proxy P uses
toeachother.Wheneverthelawenforcementagencywants thebidirectionalfunction(cid:5)andthebidirectionalkey(cid:25) to
to eavesdrop on the communication between two users, it transformtheciphertextforuserUintociphertextforuser
asks the legal court for a warrant. The legal court creates F.Afterthat,theuserFcandecryptthenewciphertextwith
a time-bounded warrant and gives it to the proxy agent. itsownkeyandobtainthecleartextmessage.
Then, the proxy agent helps the law enforcement agency
to decrypt the ciphertextsbelongingto the specified users Bidirectionalsignatureproxyfunction. Abidirectional
andperiodoftime. Inourmodel,wewilldisregardthelast signaturefunctionisdefinedasatupleS =(BiGen,BiSig,
actor,becausethelegalcourtisnotdirectlyinvolvedinthe BiVer,(cid:5)). Asinthebidirectionalencryptioncase,thekey
cryptographicpartoftheprotocol. generation algorithm BiGen creates keys for all users in
the system, including the user F. For each pair of keys
Thenextparagraphsinformallydefinethebidirectional
(k ;k ),theBiGenalgorithmgeneratesabidirectionalkey
andunidirectionalproxyfunctionsforencryptionandsig- U F
(cid:25). ThegeneralusersUsignmessagesusingBiSigandveri-
naturegenerationandexplainhowtheycanbeeasilyused
fiesthesignaturesusingBiVer. WhenevertheuserFwants
toconstructkeyescrowsystems.
togenerateavalidsignatureforamessagemonbehalfof
auserU,itfirstgeneratesasignaturewithitsownkeyand
Unidirectionalencryptionproxyfunction. Aunidirec-
thenaskstheproxyPforhelp. TheproxyPusesthebidi-
tionalencryptionproxyfunctionisdefinedasatupleE =
rectional function (cid:5) and the bidirectional key (cid:25) to trans-
(UniGen, UniEnc, UniDec, PDec, FDec). Thekeygener-
formthesignaturegeneratedbytheuserFintoasignature
ation algorithm UniGen generates keys for every general
generatedwiththeuser’skey.
userU. Then,foreachuserU,itgeneratestwomorekeys
fortheproxyPandtheuserF. Thegeneralusersencrypt
Table1reflectsthewaytheunidirectionalandthebidi-
cleartextmessagesusingtheUniEncalgorithmanddecrypt
rectional techniques work for both encryption and signa-
them using the UniDec algorithm. Whenever the user F
tures.
wantstodecryptaciphertexte,itaskstheproxyPforhelp.
TheproxyPusesPDectotransformtheciphertexteintoa Eventhoughbothbidirectionalandunidirectionalproxy
differentciphertexte0andsendsittotheuserF. TheuserF functions achieve the same goal, there are a few notable
appliestheFDecfunctiontothereceivedciphertexte0 and differences between them. First, the unidirectional proxy
getstheoriginalcleartextm. functionscan be used only oneway, from oneuser to an-
otheruser. Thereversesenserequiresadifferentunidirec-
Unidirectionalsignatureproxyfunction. An unidirec- tional function. The bidirectional proxy functions can be
tional signature proxy function is defined as a tuple S = usedinbothdirections. Second,thebidirectionalschemes
(UniGen,UniSig,UniVer,PSig,FSig). Asintheunidirec- assume that the law enforcement agency (user F) has its
tional encryption case, the key generation algorithm gen- ownkey. Theunidirectionalschemesdonotmakethisas-
erates keys for every general user U. Then, for each user sumption but pay an increased storage requirement price
U,itgeneratestwomorekeysfortheproxyPandtheuser becausetheuserFneedstostoreonekeyfor eachuserin
F. ThegeneraluserssignmessagesusingtheUniSigalgo- the system. In both cases, the proxy P has the increased
rithmandverifythemusingtheUniVeralgorithm. When- space problem because it needs to save one key for everyBidirectional Unidirectional
U(cid:13)(DK(cid:13) )(cid:13)
U(cid:13)
U((cid:13)sk(cid:13) )(cid:13) P( )(cid:13)(cid:13) F(sk(cid:13) )(cid:13)
U(cid:13) F(cid:13) P(DK(cid:13) )(cid:13) F(DK(cid:13) )(cid:13)
P(cid:13) F(cid:13)
Encryption e=Enc U(cid:13) (cid:13)(m)(cid:13) e'= (e)(cid:13) e'=Enc F(cid:13) (cid:13)(m)(cid:13) e=Enc U(cid:13) (cid:13)(m)(cid:13) PDec(e)(cid:13) FDec(PDec(e))=m(cid:13)
U(cid:13)(sk)(cid:13)
F(sk(cid:13) )(cid:13) P( )(cid:13)(cid:13) U(cid:13)(sk(cid:13) )(cid:13)
F(cid:13) U(cid:13)
F(sk(cid:13) )(cid:13) P(sk(cid:13) )(cid:13)
Signature s'=Sig F(cid:13)( (cid:13)m)(cid:13) s'= (s)(cid:13) s=Sig U(cid:13) ( (cid:13)m)(cid:13) m(cid:13) F(cid:13) FSig(m)(cid:13) P(cid:13) s=Psig(FSig(m))(cid:13)
Table1.Unidirectionalvs. Bidirectionaltechniques
user. Thisproblemcanbeveryimportantinsystemswhere 4 Unidirectional EncryptionPrimitives
the number of general users is extremely large. A solu-
tion is offered by the identity-based primitives [5], where Definition1 Aunidirectional encryptionschemeconsists
the proxy needs to save only a share of the master secret offivealgorithms,E = (UniGen, UniEnc, UniDec, PDec,
key. Third, inbothcases,revocationiseasilyachievedby FDec).
havingthethirdpartyPrefusetohelp.
Theunidirectionalandbidirectionalschemesdescribed ThegenerationalgorithmUniGen(1k)outputsatupleof
inthispaperrequiretheproxyagentPtocontinuouslyas- keys(EK,DK)foreachgeneraluserU.EKistheencryption
sistthelawenforcementagencyFwhendecryptingcipher- keyandDKisthedecryptionkey.ForeachsecretkeyDK,
textorgeneratingvalidsignaturesonbehalfofauser. The thekeygenerationalgorithmcreatestwosecret keysDK P
key-insulatedmodelpresentedin [9,10]canbeeasilyex- andDK F fortheproxyP,andrespectivelytheuserF. For
tendedsuch thatthe proxyagentPhelpsthe lawenforce- simplicity,thedefinitionsgivenintable2showthatthekey
mentagencyonlyonce,atthebeginningofitswarrant.The generation algorithm outputs only user keys, even though
key-insulatedmodelhastwoactors,theproxyagentPand italsobuiltsthekeysfortheproxyPandtheuserF.
the user U. The user U updates its secret key using the
UniEnc is the encryption algorithm and encrypts a
indexofthecurrenttimeperiodandsomeinformationpro- EK
messagemfromthecorrespondingmessagespaceM (e.g.,
videdbyathirdparty(P). Ourmodeladdsanotherplayer,
f0;1gk) as e = UniEnc (m). The decryption algo-
thelawenforcementagencyF,thatreceivesfromtheproxy EK
rithm UniDec is a deterministic decryption algorithm
Pthe user’skeyfor an unused periodoftime T . Similar DK
0 that takes the ciphertext e, the secret key DK, and out-
to theoriginalkey-insulatedmodel, theproxyPhelpsthe
puts m 2 M (or invalid in case e was an improper ci-
user to update its key. In addition, the proxy P helps the
phertext). The correctness property of encryption states
law enforcement agency F to compute the user’s key for
that UniDec(UniEnc(m)) = m, for any message m and
timeperiodT ifpresentedwithanwarrantforthetimeT .
i i pair of keys (EK;DK). The function PDec uses the se-
All primitivespresented in [9, 10] can be easily extended
cret key of the proxy P, DK , to transform a ciphertext
forourofflinemodel. P
e into ciphertext e0. The FDec function takes this cipher-
Withthismodel inmind, we introducein thenextsec- texte0 andthe secretkeyDK F oftheuserFandproduces
tionstheunidirectional andbidirectional encryptionand the original message m 2 M or invalid if the ciphertext
signatureschemes. Foreachscheme, we giveformaldef- e0 wasnotcorrect. Thecorrectnesspropertyspecifiesthat
initions, present one generic scheme and several specific FDec(PDec(UniEnc(m)))=m,foranymand(EK;DK).
schemes,andprovetheirsecurityguarantees. Forsimplic-
Informally, a unidirectional encryption scheme is con-
ity, all general definitions will be given in the context of
sidered to be secure if none of the participating entities
public-keycryptography.
(user F, proxy P, user U) can break it even if they hold
extrasecrets.Forsimplicity,thedefinitionspresentedinta-
ble2willbespecificto theCCA2 securityfor publickey
encryption2.Inourdefinitions,theproxyagentPgetsonly
2CPAandONE-WAYsecuritydefinitionsaregivenwhennecessary.Definition2 LetE =(UniGen,UniEnc,UniDec,PDec,FDec)beanunidirectionalencryptionscheme.
1. E isCCA2secureagainsttheproxyPifjSucc P;E(1k)(cid:0)1=2jisnegligible,Succ P;E isdefinedasbelow,PDec
isadeterministicalgorithm,andtheproxyPneversubmitsPDec(UniEnc (m ))totheFDecoracle.
EK b
(EK;DK) UniGen(1k);(m ;m ) PFDec(EK;DK );
Succ P;E d =ef Pr b=~b b f0;1g;~b PFDec(EK0 ;DK1 ;UniEnc (m )) P
h (cid:12) P EK b i
(cid:12)
(cid:12)
2. E isCCA2secureagainsttheuserFifjSucc F;E(1k)(cid:0)1=2jisnegligible,Succ F;E isdefinedasbelow,andthe
userFcannotsubmitthechallengeUniEnc (m )tothePDecoracle.
EK b
(EK;DK) UniGen(1k);(m ;m ) FPDec(EK;DK );
Succ F;E d =ef Pr b=~b b f0;1g;~b FPDec(EK0 ;DK1 ;UniEnc (m )) F
h (cid:12) F EK b i
(cid:12)
(cid:12)
3. E isCCA2secureagainstanyuserUifj Succ U;E(1k)(cid:0)1=2jisnegligible,Succ U;E isdefinedasbelow,and
theuserUcannotsubmitthechallengeUniEnc (m )tothedecryptionoracleUniDec.
EK b
(EK;DK) UniGen(1k);(m ;m ) UUniDec(EK);
Succ U;E d =ef Pr b=~b b f0;1g;~b UUniDec(E0 K;U1 niEnc (m ))
h (cid:12) EK b i
(cid:12)
(cid:12)
Table2.Onlineencryptiondefinitions.
oracleaccesstotheFDec.Infact,Pdoesnotneedaccessto totransformtheciphertexteintociphertexte0 bydecrypt-
UniDecbecauseitcansimulateitbyitself.Theonlycondi- ing once with its key DK = DK : e0 = Dec (e). The
P 1 1
tionsnecessaryarethatPDecisadeterministicalgorithm, userFusesFDectotransformtheciphertexte0intotheini-
and the proxy P never submits PDec(UniEnc (m )) to tialmessagem(orinvalid)bydecryptingoncewithitskey
EK b
theFDecoracle. DK =DK : m=Dec (e0).
F 2 2
For each of the unidirectional schemes described next, Thedoubleencryptioncanbealsodefinedusingtwodif-
we will prove that they are secure according to all three ferent encryption schemes E = (Enc-Gen ;Enc ;Dec ),
1 1 1 1
definitions. E = (Enc-Gen Enc ;Dec ). In this case, the unidirec-
2 2 2 2
tionalencryptionschemeE0 = (UniGen,UniEnc,UniDec,
PDec,FDec)isdefinedas:
4.1 UnidirectionalGenericEncryptionScheme
(cid:15) UniGen(1k)=(Enc-GenE1(1k);Enc-GenE2(1k))
We first present a unidirectional generic technique
that transforms a general encryption scheme E = (cid:15) UniEnc(m)=EncE1(EncE2(m))
(Enc-Gen;Enc;Dec) into an unidirectional encryption
scheme E0 = (UniGen, UniEnc, UniDec, PDec, FDec).
(cid:15) UniDec(e)=DecE2(DecE1(e))
ThekeygenerationalgorithmUniGengenerates twopairs (cid:15) PDec(e)=DecE1(e)
of keys (EK ;DK ;EK ;DK ) by running the Enc-Gen
algorithm tw1 ice. 1 The2 user2 U keeps both keys, while (cid:15) FDec(e0)=DecE2(e0)
proxy P and the user F get (EK ;EK ;DK ), respec-
1 2 1
tively (EK ;EK ;DK ). We define DK = DK and Forsimplicity,weassumethatbothencryptionschemes
1 2 2 P 1
DK = DK . TheencryptionalgorithmUniEncisequiva- areidentical.Next,weprovethatthegenericunidirectional
F 2
lenttoencryptingthemessagewiththetwokeysEK and encryption scheme is secure according to our definitions.
1
EK : UniEnc(m) = Enc (Enc (m)) = e. The unidirec- Wemaketheassumptionthattheinitialencryptionscheme
2 1 2
tionaldecryptionalgorithmUniDecdecryptstheciphertext westartedfromisCCA2 andshowthatthenewunidirec-
ebyapplyingtheoriginaldecryptionalgorithmDectwice: tionalencryptionschemeisalsoCCA2. Theproofsarein
m=Dec (Dec (e)). TheproxyPusesthefunctionPDec theAppendixA.1.
2 1Theorem1 Let’s consider a standard encryption scheme 4.3 UnidirectionalRSAEncryptionScheme
E = (Enc-Gen;Enc;Dec). Based on E, we build an uni-
directional encryption scheme E0 = (UniGen, UniEnc, Let’sassumewehavetheRSAencryptionschemeE =
UniDec, PDec, FDec). If E is CCA2 secure, than E0 is (Enc-Gen;Enc;Dec). The RSA key generation algorithm
alsoCCA2 secureagainst(1)theproxyP,(2)theuserF, outputs the public key EK = (e;N) and the secret key
and(3)anyuserU. SK=(d;N;’(N)),whereed=1mod’(N),N =pq,p,
q aretwolargeprimesand’isthe Eulertotientfunction.
TheencryptionisdefinedasEnc (m)=memodN =c.
EK
The generic scheme is twice slower than the original ThedecryptionalgorithmisDec (c)=cd modN =m.
EK
scheme it started from. In order to eliminate this slow-
The unidirectional key generation algorithm E0 =
down, we developeda fewspecific unidirectional encryp-
(UniGen, UniEnc, UniDec, PDec, FDec). For each user
tionfunctionsbasedonElGamal,RSA,andIBE.
U, the key generation algorithm UniGen(1k) generates a
public-keypair(EK;DK)andsplitsthesecretkeyintotwo
4.2 UnidirectionalElGamalEncryptionScheme partsd 1 andd 2 suchthatd=d 1d 2 mod’(N). Theproxy
P gets DK = d and the user F gets DK = d . The
P 1 F 2
encryption UniEnc and the UniDec algorithms are iden-
Let’s assume that we have an El Gamal encryption tical to the original algorithms Enc and Dec. The trans-
schemeE = (Enc-Gen;Enc;Dec). Thekeygenerational- formation functions PDec and FDec execute the Dec de-
gorithm outputs the public key EK = (g;p;q;y) and the cryptionalgorithm with keys d and respectivelyd . The
1 2
secret key DK = (x), where p is a prime number, g is a correctnessofunidirectionalRSAisgivenbytheequality
generator for the Z(cid:3), x is randomly chosen from Z , and FDec (PDec (Enc (m)))=m.
p q d2 d1 e
y = gx mod p. The encryption algorithm is defined as
The original RSA scheme is OW-CPA secure. Thus,
e = Enc (m) = (gr mod p;mgxr mod p), where r is
EK
chosenatrandomfromZ .Thedecryptionalgorithmcom- wewillproveinthenexttheoremthatunidirectionalRSA
q
isalsoOW-CPAsecure. TheproofsareinAppendixA.3.
putes the message m from e by dividing mgxr to (gr)x
modp.
Theorem3 Let E0 = (UniGen, UniEnc, UniDec, PDec,
The unidirectional El Gamal encryption scheme is de- FDec)be anunidirectionalRSAencryption scheme. E0 is
fined as E0 = (UniGen, UniEnc, UniDec, PDec, FDec). ONE-WAY secureagainst(1)theproxyP,(2)theuserF,
ForeachuserU,thekeygenerationalgorithmUniGen(1k) and(3)anyuserU.
generates a public-keypair (EK;DK) and splits the secret
key DK = x into two parts x 1 and = x 2 such that x = 4.4 Unidirectional Identity-Based Encryption
x 1+x 2. TheproxyPreceivesDK P =x 1andtheuserFre- Scheme
ceivesDK =x . TheencryptionUniEncandthedecryp-
F 2
tion UniDecalgorithms are identical to the standard algo-
OurspecificIBEschemeisaslightlymodificationofthe
rithms: EncandDec. ThetransformationalgorithmsPDec
original IBE scheme introduced by [5]. The original IBE
andFDecareequivalenttoDecunderx 1,respectivelyx 2. schemeusesabilinearmape^definedase^:G (cid:2)G !G ,
1 1 2
The unidirectional encryption scheme is correct because whereG andG aretwogroupsoforderqandqisalarge
FDec (PDec (Enc (m))) = FDec (mgxr=(gr)x1) = 1 2
x2 x1 y x2 primenumber. Thismeansthate^(aP;bQ)=e^(aQ;bP)=
mgx2r=(gr)x2 =m. e^(P;Q)ab, where P;Q 2 G and a;b 2 Z . The origi-
1 q
According to our definitions, the next theorem proves nalschemebasesitssecurityonthecomputationalBilinear
thattheunidirectionalElGamalisassecureastheoriginal Diffie-Hellman problem. In order to obtain a homomor-
El Gamal scheme. The proofs are presented in Appendix phic scheme, we make a stronger assumption (decisional
A.2. Bilinear Diffie-Hellman problem), eliminate the use of a
hashfunction,requirethatthemessagesarem 2 G , and
2
replacetheXORoperationbymultiplication.
Theorem2 Let E0 = (UniGen, UniEnc, UniDec, PDec, Our scheme is defined as the tuple E =
FDec) be an unidirectional El Gamal encryption scheme. (Enc-Gen;Extract;Enc;Dec). The key generation al-
E0 is CPA secure against (1) the proxy P, (2) the user F, gorithm creates the master secret key s and the master
and(3)anyuserU. public key P = sP. For every user U, the Extract
pubalgorithmtakesasinputtheuser’sIDandreturnsasecret of keys (SK,VK) for each user U. VK is the verification
key DK = sID and a public key equal to the ID. The key and SK is the signing key. SK is used to generate
user’s ID is actually defined to be the hash value of the the keys SK and SK given to the proxy P, respectively
P F
“real”ID.TheencryptionalgorithmEnctakesthemessage the user F. The signature algorithm UniSig signs a mes-
m and the public key ID as the input and creates the sage m 2 M (e.g. f1;0gk), s = UniSig (m) using
SK
ciphertexthU;Vi =hrP;me^(rID;sP))i. Thedecryption the secret key SK. The signature is formed by the tuple
algorithm Dec computes V=e^(sID;U)) = m. The IBE (m;s). The verification algorithm UniVer uses the pub-
scheme is CPA secure if the Bilinear Diffie-Hellman lic key to verify that a signature (m;s) is valid. The ver-
(BDH)problemishard. ification algorithm output succeed if the signature is cor-
rect andfail otherwise. Thecorrectnessproperty requires
Decisional Bilinear Diffie-Hellam Problem (dBDH).
thatUniVer(UniSig(m))=succeed.TheproxyPusesthe
LetG andG betwogroupsofprimeorderq.Lete^:G (cid:2)
1 2 1 functionPSig togenerate apartialsignature ofamessage
G ! G be a bilinear map and let P be a generator for
1 2 m 2 M based onSK . Theuser F usesFSig to generate
G . The decisional BDH problem hG ;G ;e^i is defined P
1 1 2 a partial signature of a message m 2 M based on SK .
as follows: Given hP;aP;bP;cPi for some a;b;c 2 Z(cid:3), F
q PSig(FSig(m))forma completesignatureofthemessage
itis hardto differentiatee^(P;P)abc 2 G 2 froma random m.
g 2G .
2
Wedefinetheunidirectionalsignatureschemetobesafe
Based on our specific IBE scheme E, we will build
ifneitherentity(proxyP,userF,userU)cangeneratealone
an unidirectional IBE scheme E0 = (UniGen, UniEnc, valid signatures under key SK, even if they knowSK or
P
UniDec, PDec, FDec). The key generation algo-
SK andanyoftheavailablepublicinformation. Thefor-
F
rithm UniGen uses the original key generation algorithm
maldefinitionsaregivenintable3.
Enc-Gen to create the master secret key s and the master
public key P = sP. The master secret key is split in
pub
twopartss ands , andeachpartisgiventothe proxyP 5.1 UnidirectionalGenericSignatureScheme
1 2
andtheuserF. Theencryptionanddecryptionalgorithms
are identical with the original ones. PDec is defined as
This generic scheme transforms any given signature
PDec(U;V) = hU;V=e^(rP;s ID)i = (U;V0). The user
1 primitive into a unidirectional generic signature scheme.
F uses the ciphertextgenerated by PDec and the function
Let’s assume that S = (Sig-Gen;Sig;Ver) is a standard
FDec to compute the cleartext message m by computing
signature scheme. The new unidirectional generic sig-
V0=e^(rP;s 2ID). nature scheme is S0 = (UniGen, UniSig, UniVer, PSig,
Theorem4 Let E0 = (UniGen, UniEnc, UniDec, PDec,
FSig). The generation algorithm UniGen generates two
FDec) be an unidirectional IBE encryption scheme. E0 is
pairsof keys(SK 1;VK 1;SK 2;VK 2)for each userU. The
secretkeyfortheunidirectionalsignatureschemeisSK=
CPAsecureagainst(1)theproxyP,(2)theuserF,and(3)
(SK ;SK ). The proxy P gets (VK ;VK ;SK = SK )
anyuserU. 1 2 1 2 P 1
and the user F gets (VK ;VK ;SK = SK ). The sig-
1 2 F 2
nature algorithm UniSig generates a valid signature for a
In all the other unidirectional schemes, the proxy P
message m 2 M by applying the signature Sig twice:
has the increased space problem because it needs to save
s = (s ;s ) = Sig (m)Sig (m). Similarly, the verifica-
one key for every user. Our modified homomorphic IBE 1 2 1 2
tionalgorithmUniVerverifieswhetherthesignaturesgen-
schemesolvesthisproblembyallowingtheproxyagentP
erated by UniSig are valid by applyingthe original verifi-
tosaveonlyasingleshareofthemasterkeyfortheentire
cation algorithm Ver algorithm twice: Ver (s )Ver (s ).
1 1 2 2
system.
The proxy P uses PSig to generate part of the total
unidirectionalsignature: Sig (m), whiletheuserFuses
1
5 Unidirectional Signature Primitives FSig = Sig 2(m) to generate the entire signature together
withPSig.
Definition3 A unidirectional signature scheme consists Accordingtoourdefinitions, thegenericunidirectional
of five algorithms: S = (UniGen, UniSig, UniVer, PSig, signature scheme is secure if the following theorem is
FSig). provedto be true. Theactual proofs are containedin Ap-
pendixB.1.
The generation algorithm UniGen(1k) outputs a tupleDefinition4 LetS =(UniGen,UniSig,UniVer,PSig,FSig)beanunidirectionalsignaturescheme.
1. S isUF-CMAagainsttheproxyPifjSucc P;S(1k)jisnegligible,Succ P;S isdefinedasbelow,andtheproxyP
isnotallowedtoasktheFSigoracleforUniSig(m).
Succ P;S d =ef Pr UniVer(m;s)=succeed (SK;VK) UniGen(1k);(m;s) PFSig(SK P;VK)
h (cid:12) i
(cid:12)
(cid:12)
2. S isUF-CMAagainsttheuserFifjSucc F;S(1k)jisnegligible,Succ F;S isdefinedasbelow,andtheuserFis
notallowedtoaskthesignatureoracleforUniSig(m).
Succ F;S d =ef Pr UniVer(m;s)=succeed (SK;VK) UniGen(1k);(m;s) FUniSig(SK F;VK)
h (cid:12) i
(cid:12)
(cid:12)
3. S isUF-CMA againstanyuserUifjSucc U;S(1k)jisnegligibleforanyPPTadversaryU, Succ U;S isdefined
asbelow,andtheuserUisnotallowedtoaskthesignatureoracleforUniSig(m).
Succ U;S d =ef Pr UniVer(m;s)=succeed (SK;VK) UniGen(1k);(m;s) UUniSig(VK)
h (cid:12) i
(cid:12)
(cid:12)
Table3.Onlinesignaturedefinitions.
Theorem5 Let S = (Sig-Gen;Sig;Ver) be a standard for all users U by executing Sig-Gen and then splits each
signature scheme. Let’s consider S0 = (UniGen, UniSig, secret key d in two parts d = d +d mod’(n). d be-
1 2 1
UniVer, PSig, FSig) a unidirectional signature scheme comes the key SK of the proxy P and d becomes the
P 2
constructed as described above, based on S. If S is UF- key SK of the user F. The signature and verification al-
F
CMA,thanS0isUF-CMAagainst(1)theproxyP,(2)the gorithmsUniSigandUniVerareidenticalwiththeoriginal
userF,and(3)anyuserU. algorithmsSigandVer. TheuserFusestheFSigfunction
to generate one part of the unidirectional RSA-Hash sig-
nature by computing s0 = Sig (m). The proxy P uses
The unidirectional generic signature scheme has two d2
the PSig function to generate the other part of the unidi-
mainperformancedisadvantages. First,thesizeofthese-
rectionalRSAsignaturebycomputings=Sig (m). The
cret key increases. Each user no longer has one, but two d1
signatureisformedbysands0.
keys. Second, the number of operations performed when
signing and verifying doubles. In order to improve these The standard RSA-Hash signature scheme is existen-
numbers, we developed an efficient unidirectional signa- tially unforgeable against chosen message attacks. Thus,
tureschemebasedonRSA-Hash. we formally prove in the next theorem that the unidirec-
tionalRSA-Hashschemeholdsthesamelevelofsecurity.
TheactualproofsareinAppendixB.2.
5.2 UnidirectionalRSA-HashSignatureScheme
Let’s assume that we have S = (Sig-Gen;Sig;Ver)
Theorem6 Let S = (Sig-Gen;Sig;Ver;) be a classic
a standard RSA-Hash(Full Domain Hash) [1] signature.
RSA-Hash signature scheme. Let’s consider that S0 =
Sig-Gen generates the public key VK = (e;N) and the
(UniGen,UniSig,UniVer,PSig,FSig)isanunidirectional
secretkeySK = (d;’(N)). Thesignaturefunctionisde-
RSA-Hash signature scheme constructed as above. S0 is
fined as Sig = hash(m)d mod N = s, where hash is a
UF-CMA against (1) the proxy P, (2) the user F, and (3)
hashfunctionassociatedwithSig. Theverificationreturns
allusersU.
succeed if se = hash(m) mod N. Otherwise, it returns
fail.
The standard RSA-Hash signature scheme S is trans- TheprobabilisticRSA-Hashdescribedby[7]hasbetter
formed into a unidirectional signature scheme S0 = security that the RSA-Hash function used above, and can
(UniGen, UniSig, UniVer, PSig, FSig) by the following betransformedintoanunidirectionalprimitiveifweallow
steps.ThekeygenerationalgorithmUniGengenerateskeys theuserFtogeneratethenecessaryrandomness.6 Bidirectional Encryption Primitives For example, the keys of user U are EK = (EK ;EK ),
U 1 2
DK = (DK ;DK ), the keys of proxy P are EK =
U 1 2 P
(EK ;EK ), DK = (DK ;DK ), and the keys of user F
Definition5 Abidirectional encryptionschemeconsistsof 2 3 P 2 3
areEK = (EK ;EK ), DK = (DK ;DK ). Inthecon-
fouralgorithms: E =(BiGen,BiEnc,BiDec,(cid:5)). F 1 3 F 1 3
text of bidirectional encryption, we say that both users U
andFhaveprivatekeys,whiletheproxyPhasthebidirec-
ThekeygenerationalgorithmBiGenoutputsonepairof tional key (cid:25). The encryption algorithm BiEnc performs
keys(EK U,DK U)foreachuserU. Inaddition,itgenerates double encryption e = BiEnc U(m) = Enc 1(Enc 2(m)).
keys for the user F, (EK F,DK F). After that, it creates one Similarly,thedecryptionalgorithm(cid:5)isdefinedasdouble
bidirectionalkey(cid:25)foreachuserU. Thebidirectionalkeys decryptionm = BiDec (e) = Dec (Dec (e)). Theproxy
U 2 1
(cid:25)aregiventoproxyP. TheencryptionalgorithmBiEnc EK function (cid:5) transforms the ciphertext encrypted with the
takesasinputamessagemtobeencryptedandapublickey userU’skeyintociphertextencryptedwiththeuserF’skey.
EKandoutputstheciphertexte= BiEnc EK(m). BiDec DK Thefirststepistodecrypttheciphertexte=BiEnc U(m)=
isthedeterministicdecryptionalgorithmthattakestheci- Enc (Enc (m)) by executing e0 = Dec (e). Then, it en-
1 2 1
phertext e, the secret key DK corresponding to the pub- cryptse0 withtheotherhalfofthekeye00 =Enc (e0). The
3
lic key, and produces m 2 M (or invalid in case e was resultise00 =BiEnc (m).
F
an improper ciphertext). The correctness property of en-
cryptionstatesthatBiDec(BiEnc(m))=m,foranymand The generic bidirectional encryption scheme described
(EK;DK). (cid:5) is the bidirectional function and transforms above is secure if no adversary (proxy P, user F, userU)
ciphertextsencryptedwith onekey(EK )intociphertexts isabletobreakit. Let’sassumethattheinitialencryption
U
encryptedwithanotherkey(EK ). schemeisCCA2secure.Wewillshowthatinthiscase,the
F
bidirectionalencryptionisalso CCA2 secure. Theproofs
We define the bidirectional encryption schemes to be areinAppendixC.1.
secure if neither the third party (proxy P) nor the users
(U, F) can attack the scheme. For simplicity, the defini-
Theorem7 Let’s consider a standard encryption scheme
tion presented in table 4 uses the CCA2 levelof security.
E = (Enc-Gen;Enc;Dec). Based on E, we build an uni-
For technicalreasons, we assume that thereexists an effi- directional encryption scheme E0 = (UniGen, UniEnc,
cientalgorithmthatevaluatestherelationR (cid:25)(e;e0)totrue UniDec, PDec, FDec). If E is CCA2 secure, than E0 is
or false, where e = BiEnc(m) is the original chiphertext
alsoCCA2 secureagainst(1)theproxyP,(2)theuserF,
ande0 = (cid:5)(e)isthemodifiedciphertextcomputedbythe
and(3)anyuserU.
proxyP. Theoutputofthealgorithmistrue,itmustbethe
casethatDec (e) = Dec (e0). Havingsuchanalgo-
EKU EKF
rithm, we allow the proxy P has oracle access to BiDec 6.2 BidirectionalElGamalEncryptionScheme
F
because it can simulate oracle access to BiDec by itself.
U
Inaddition,werestrictitsaccesstotheBiDec bynotlet-
F Let’sassumewehavetheElGamalencryptionscheme
tingtheproxyPtosubmittotheoracleaciphertexte0such
E = (Enc-Gen;Enc;Dec). The key generation algorithm
thatR (e;e0)=true.
(cid:25) of the original El Gamal encryption scheme outputs the
public key EK = (g;p;q;y) and the secret key DK = x,
6.1 BidirectionalGenericEncryptionScheme and the public key is y = gx mod p. The encryption al-
gorithmis definedase = Enc (m) = (gr modp;mgxr
EK
modp),whererischosenatrandomfromZ . Thedecryp-
q
Inthissection,wepresentagenericimplementationof
tionalgorithmcomputesthemessagemfromebydividing
a bidirectional encryption scheme based on standard en-
mgxr to(gr)x modp.
cryption schemes. Let’s assume that we have an encryp-
tion scheme E = (Enc-Gen;Enc;Dec). We transform Based on E, we will build the bidirectional El Gamal
E into a bidirectional encryption scheme E0 = (BiGen, encryptionschemeE0 =(BiGen,BiEnc,BiDec,(cid:5))byfol-
BiEnc, BiDec, (cid:5)) by following the next steps. For every lowing the next steps. The generation algorithm BiGen
userU, the generationalgorithmBiGen executestheorig- generates the keys for all users U and F by executing
inal generation algorithm Enc-Gen to generate three pairs Enc-Gen twice. Let’s assume that the generated keys
of keys (k ;k ;k ), where each k = (EK ;DK ). The are (DK = x ;EK = gx1), (DK = x ;EK =
1 2 3 i i i U 1 U F 2 F
usersU,P, andFreceiveeachtwopairsofkeyssuchthat gx2). After this, it computes one proxy key (cid:25) for ev-
any two entities have only one pair of keys in common. ery user U: (cid:25) = x (cid:0) x . The encryption algorithm
2 1Definition6 LetE =(BiGen,BiEnc,BiDec,(cid:5))beabidirectionalencryptionscheme.
1. E isCCA2 secureagainsttheproxyPifjSucc P;E(1k)(cid:0)1=2jisnegligible,Succ P;E isdefinedasbelow, and
BiEnc(m )isneversubmittedtothedecryptionoracleBiDec.
b
(EK ;DK ;EK ;DK ;(cid:25)) BiGen(1k);(m ;m ) PBiDec(EK ;EK ;(cid:25));
Succ P;E d =ef Pr b=~b U U b F f0;F 1g;~b PBiDec(EK ;EK0 ;(cid:25)1 ;BiEnc(m )) U F
h (cid:12) U F b i
(cid:12)
(cid:12)
2. E is CCA2 secure against the user F if jSucc F;E(1k)(cid:0)1=2j is negligible, Succ F;E is defined as below, and
BiEnc(m )wasneversubmittedtothePoracle.
b
(EK ;DK ;EK ;DK ;(cid:25)) BiGen(1k);(m ;m ) F(cid:5)(EK ;EK ;DK );
Succ F;E d =ef Pr b=~b U U b F f0;F 1g;~b F(cid:5)(EK ;EK ;0 DK1 ;BiEnc(m ))U F F
h (cid:12) U F F b i
(cid:12)
(cid:12)
3. E isCCA2secureagainstanyuserUifjSucc U;E(1k)(cid:0)1=2jisnegligible,foranyPPTadversaryA,wedefine
Succ U;E asbelow,andBiEnc(m b)wasneversubmittedtothedecryptionoracleBiDec.
(EK ;DK ;EK ;DK ;(cid:25)) BiGen(1k);(m ;m ) ABiDec(EK ;EK );
SuccA;E d =ef Pr b=~b U U
b
F f0;F
1g;~b ABiDec(EK
;E0
K
;B1
iEnc(m ))
U F
h (cid:12) U F b i
(cid:12)
(cid:12)
Table4.Bidirectionalencryptiondefinitions.
BiEnc encrypts messages m 2 M by executing Enc: The key generation algorithm BiGen(1k), where k is
e = BiEnc(m) = Enc(m). The decryption algorithm thesecurityparameter,generateskeysforallusers,includ-
BiDec uses Dec to decrypt the ciphertext e: BiDec(e) = ing the user F. For example, the user U gets the keys
Dec(e). The proxy function (cid:5) transforms messages en- (SK ;VK ) and the user F gets (SK ;VK ). The gener-
U U F F
cryptedwiththesecretkeyoftheuserU(DK )intomes- ation algorithm is also computing one bidirectional key(cid:25)
U
sage encrypted with the secret key of the user F (DK ). for every user and gives it to proxy P. The signature al-
F
Wedefine(cid:5)tobe(cid:5)(BiEnc (m);(cid:25)) =(gr;grxm(gr)(cid:25)). gorithm BiSig signs a message m 2 M (e.g. f1;0gk),
x1
The function is correct because (cid:5)(BiEnc (m);(cid:25)) = s = BiSig (m) using a secret key SK. The signature
x1 SK
(gr;grxmgr(x2(cid:0)x1))=(gr;grx2m)=BiEnc (m). is formed by the tuple (m;s). The signature (m;s) is
x2
verifiedbythe verificationalgorithm BiVer. Theverifica-
Theproxyfunctiondescribedaboveissecureifneither
tion algorithm outputs succeed if the signature is correct
theproxyPnortheuserFcandistinguishbetweenencryp-
and fail otherwise. The correctness property requires that
tionsoftwomessagesevenifprovidedwiththeproxykey.
BiVer(BiSig(m)) = succeed. The proxyfunction(cid:5)uses
Inaddition,itshouldretainthesamelevelofsecurityasthe
the bidirectional key (cid:25) to transform a signature generated
original El Gamal scheme against all other users U. The
with a secret key into a signature generated with another
proofsaredescribedinAppendixC.2.
secretkey.
A bidirectional encryption scheme defined as above is
Theorem8 LetE =(BiGen,BiEnc,BiDec,(cid:5))beanbidi-
consideredtobesafeifitcannotbesuccessfullyattacked
rectional El Gamal encryption scheme. E is CPA secure
by any user (U, F) or by the third party (P). The formal
against(1)theproxyP,(2)theuserF,and(3)anyuserU.
definitionsarepresentedintable5. Weassumethatpartial
signaturecontainsthemessage.
7 Bidirectional Signature Primitives Next,wepresentafewbidirectionalsignatureschemes
thatrespecttheabovedefinitionofsecurity.
Definition7 Abidirectional signatureschemeconsistsof
fouralgorithms: S =(BiGen,BiSig,BiVer,(cid:5)).Definition8 LetS =(BiGen,BiSig,BiVer,(cid:5))beanbidirectionalsignaturescheme.
1. S is UF against the proxy P if jSucc P;S(1k)j is negligible, where Succ P;Sj is defined as below and P is not
allowedtoaskthesignatureoracleforBiSig(m).
Succ P;S d =ef Pr hBiVer(m;s)=succeed
(cid:12)
(SK U (m;V ;K s)U; SK PF B; iSV igK FF (V;(cid:25) K)
U
;VKB FiG ;e (cid:25)n )(1k)
i
(cid:12)
(cid:12)
2. S isUF againsttheuserFifjSucc F;S(1k)jisnegligible,Succ F;SjisdefinedasbelowandFisnotallowedto
askPfor(cid:5)(m).
Succ F;S d =ef Pr BiVer(m;s)=succeed (SK U (; mV ;K sU ); SK FF (cid:5);V (VK KF;(cid:25) ;V)
K
;B Si KGe )n(1k)
h (cid:12) U F F i
(cid:12)
(cid:12)
3. S isUF againstanyuserUforanyPPTadversaryU,ifjSucc U;S(1k)jisnegligible,whereSucc U;S isdefined
asbelow,andUisnotallowedtoaskthesignatureoracleforBiSig(m).
SuccA;S d =ef Pr hBiVer(m;s)=succeed
(cid:12)
(SK U (; mVK ;sU ); SK F A; BV iSK igF U; ((cid:25) V)
K
U;VB KiG Fe )n(1k)
i
(cid:12)
(cid:12)
Table5.Bidirectionalsignaturedefinitions.
7.1 BidirectionalGenericSignatureScheme Theorem9 Let’s consider a standard signature scheme
S = (Sig-Gen;Sig;Ver). Based on S, we build an bidi-
rectionalsignatureschemeS0 =(BiGen,BiSig,BiVer,(cid:5)).
First, let’s consider a standard signature scheme S =
If S is UF than S0 is UF against (1) the proxy P, (2) the
(Sig-Gen;Sig;Ver). The next paragraph explains how
to build an bidirectional generic signature scheme S0 = userF,and(3)allusersU.
(BiGen, BiSig, BiVer, (cid:5)) from the original scheme S.
The key generation algorithm BiGen uses the original
8 Unidirectional and Bidirectional Private
key generation algorithm Sig-Gen to generate three keys
KeyPrimitives
(k ;k ;k ), where k = (SK ;VK ), and gives them to
1 2 3 i i i
the users U, F, and P, such that they have in common
only one key. For example, the user U gets VK =
U Unidirectional and bidirectional private key schemes
(VK ;VK ), SK = (SK ;SK ), the user F gets VK =
1 2 U 1 2 F for encrypting and signing messages (MAC) can be eas-
(VK ;VK ), SK = (SK ;SK ), and the proxy P gets
1 3 F 1 3 ily build on top of pseudo-random functions (PRF).Thus,
VK =(VK ;VK ),SK =(SK ;SK ).Thesignatureal-
P 2 3 U 2 3 it suffices to build unidirectional and bidirectional PRF
gorithmBiSigcomputesthesignatureofamessagem2M
functions. The encryption can be defined as Enc(m) =
by applying the standard signature algorithm twice, once
hr;f(r) (cid:8) mi, where r is chosen at random, and f is a
foreachkey.Forexample,theuserUsignsamessagemas
PRF.ThesignatureisdefinedasSig(m)=f(m),whichin
(s ;s ) = Sig (m)Sig (m). BiVer verifiesif a signature
1 2 1 2 factismessageautheticationcode(MAC).
generatedwith BiSigis correct, by executingthe standard
verification algorithm twice Ver (s ) and Ver (s ). The
1 1 2 2
proxyfunction(cid:5)transformsavalidsignaturegeneratedby 8.1 UnidirectionalPRFFunctions
BiSigforapairofkeysintoavalidsignaturegeneratedwith
anotherpairofkeys:(cid:5)(BiSig (m))=BiSig (m).
U F Informally, a unidirectional PRF function allows two
The generic bidirectional signature scheme is secure if users P and F to compute its value in any given point x,
thenexttheoremistrue.TheproofsareinAppendixD.1. even if none of them knows the entire description of the
function.Definition9 A PRF function f is a unidirectional PRF 9 Conclusions
function if there exist f and f two PRF functions such
1 2
thatthevaluef(x)canbecomputedasf 1(f 2(x)). Atthebeginningofthepaperwestarteddescribingthe
forunidirectionalfunctions. Theunidirectionalnotationis
Basedontheabovedefinition,weconstructthefollow- justifiedbythefactthattheproxyPneedstohelpthelaw
enforcementagency(userF)foreverymessagethatneeds
ingunidirectionalPRF. Let’sconsiderF = f afamilyof
s
pseudo random function with seed s. We define UniPRF tobedecryptedorsigned. Thereisalsoanofflineversion
such that the value of the unidirectional PRF in a given oftheunidirectionalproxyfunction.Becauseofspacecon-
pointxisdefinedasUniPRF(x)=g (x)(cid:8)g (x),where sideration,weshortlydescribeitaspartoftheconclusions.
s1 s2
g 2 F. The proxy P and the user F are both given one Theofflineproxyfunctionsarebasedonthekey-insulated
ofthetwoseeds. Forexample,theproxyPreceivess and encryption and signature primitivescreated by [9, 10]. In
1
theuserFgetss . Inthisway,theycancooperateandcom-
theofflinescheme,usersUprotecttheirsecretsbyperiod-
2
puteUniPRF(x)byfirstcomputingg (x)andg (x)and ically updating their secret keys. The user U updates its
s1 s2
secret key using the index of the current time period and
applyingtheXORoperation.
someinformationprovidedbyathirdparty(P). Thesame
thirdpartyPcanhelpthelawenforcementagencyFtode-
Theorem10 The unidirectional PRF function defined as
cryptorsignmessagesonbehalfofotherusersU,bypro-
UniPRF(x) = f (x) (cid:8)f (x), where f and f are two
1 2 1 2 vidingspecialpiecesofinformationatthebeginningofthe
PRFfunctions,isaPRFfunction.
time period. There is one main difference betweenunidi-
rectionalandofflineproxyfunctions: intheunidirectional
8.2 BidirectionalPRFFunctions
case,thelawenforcementagencyFisstrictlycontrolledby
theproxyPandcannotdecryptorsignamessagewithout
itshelp;intheofflinecase,thelawenforcementagencycan
In a similar way, we can informally define a bidirec- misbehave3 for onetimeperiodonceithas thenecessary
tional PRF function as a PRF function that can be trans-
information.
formedintoanewPRFfunction. Thismeansthatonecan
computethevaluef (x),givenaninitialvaluef (x)anda The main contribution of this paper is the formalized
2 1
simpletransformation(cid:5). definitions of the bidirectional and unidirectional proxy
functions for encryption and signatures and their security
guarantees. In addition, for each class of proxy func-
Definition10 A PRF function f is a bidirectional PRF
1 tions,thepaperdescribesonegenerictechniqueandseveral
function if for any PRF function f , there exists a trans-
2 specific techniques to transform a standard cryptographic
formation(cid:5)suchthatthevaluef (x)canbecomputedas
2 primitiveintoaproxyfunction.
(cid:5)(f (x)).
1
Let’s consider F = f a family of PRF functions References
s
with seed s. We construct a PRF function BiPRF (x) =
1
[1] M.BellareandP.Rogaway. Randomoraclesarepractical:
g (x) (cid:8) g (x), where g 2 F is a PRF function.
s1 s2
Aparadigmfordesigningefficientprotocols. InACMCon-
The function BiPRF is bidirectional because from any
ferenceonComputerandCommunicationsSecurity,pages
value BiPRF (x), one can easily obtain the value of
1 62–73,1993.
BiPRF 2(x)=g s1(x)(cid:8)g s3(x)bycomputingBiPRF 1(x)(cid:8) [2] M. Bellare and P. Rogaway. The exact security of digital
(g s2(x)(cid:8)g s3(x)). Thetransformationfunctionisdefined signatures — how to sign with RSA and Rabin. Lecture
as(cid:5)(x) = g s2(x)(cid:8)g s3(x). Theobviouswaytosplitthe NotesinComputerScience,1070,1996.
keysbetweenF,P,anduseristogive2keystoeachone [3] M.BellareandR.Sandhu. TheSecurityofPracticalTwo-
such that any two users have only 1 key in common. For partyRSASignatureSchemes. CryptologyePrintArchive,
Report2001/060,2001.
example,theuserUgets(s ;s ),theproxyPgets(s ;s ),
1 2 2 3 [4] M.BlazeandM.Strauss. AtomicProxyCryptography. Eu-
andtheuserFreceives(s ;s ).
1 3 rocrypt,1998.
[5] D.BonehandM.Franklin.Identity-BasedEncryptionfrom
the Weil Pairing. Proceedings of Crypto ’2001, Lecture
Theorem11 The bidirectional PRF function defined as
NotesinComputerScience,2139:213–229,2001.
BiPRF(x)=f (x)(cid:8)f (x),wheref andf aretwoPRF
1 2 1 2
functions,isaPRFfunction. 3Misbehavei.e.decryptorsignmessagesitisnotsupposedto[6] C. Boyd. Digital Multisignatures, volume Cryptography A Unidirectional EncryptionScheme
andCoding,pages241–246. ClaredonPress,1986.
[7] J.-S. Coron. On theExactSecurityofFull Domain Hash.
A.1 UnidirectionalGenericEncryptionScheme
AdvancesinCryptology -CRYPTO2000, 20thAnnual In-
ternationalCryptologyConference,pages229–235,2000.
[8] Y.DesmedtandY.Frankel. ThresholdCryptosystems. Ad-
Theorem 1 Let’s consider a standard encryption
vancesinCryptology–Crypto’89,pages307–315,1989.
schemeE =(Enc-Gen;Enc;Dec). BasedonE,webuildan
[9] Y.Dodis,J.Katz,S.Xu,andM.Yung.Key-InsulatedPublic
unidirectionalencryptionscheme E0 = (UniGen, UniEnc,
KeyCryptosystems. Eurocrypt,2002.
[10] Y.Dodis,J.Katz,S.Xu,andM.Yung.StrongKey-Insulated UniDec, PDec, FDec). If E is CCA2 secure, than E0 is
SignatureSchemes. PKC,2002. alsoCCA2 secureagainst(1)theproxyP,(2)theuserF,
[11] A.FiatandA.Shamir.HowtoProveYourself:PracticalSo-
and (3) all users U, where the success of the adversaryis
lutiontoIdentificationandSignatureProblems. CRYPTO,
definedintable6.
263:186–194,1987.
[12] T.E.Gamal. APublicKeyCryptosystemandaSignature
Proof
SchemeBasedontheDiscreteLogarithm. IEEETransac-
tionsofInformationTheory,pages31(4):469–472,1985.
[13] B. Horne, B.Pinkas, and T.Sander. EscrowServicesand 1. Let’s assume that E0 is not CCA2 secure against the
IncentivesinPeer-to-PeerNetworks. 3rdACMConference proxy P. This means that the proxy P can break E0
onElectronicCommerce,2001.
with probability of success greater than 1/2. We as-
[14] J.KilianandF.T.Leighton. FairCryptosystems,Revisited.
sume that PDec is a deterministic algorithm and the
AdvancesofCryptology-CRYPTO’95Proceedings,Berlin:
Springer-Verlag,1995. proxy P never submits PDec(UniEnc EK(m b)) to the
[15] H. Kim, J. Baek, B. Lee, and K. Kim. Computing with FDec oracle. Based on P, we build an adversary B
SecretsforMobileAgentUsingOne-timeProxySignature. capable of breaking the original encryption scheme
SCIS2001,vol2/2,pages845–850,2001. E. The adversary B receives as input the public key
[16] B.Lee,H.Kim,andK.Kim. StrongProxySignatureand
EK oftheoriginalencryptionschemeE. Bsimulates
itsApplications. SCIS2001,vol2/2,pages603–608,2001. 2
[17] F. T. Leighton. Failsafe Key Escrow Systems. Technical theconditionsnecessaryfortheproxyPtobreakthe
Memo483,MITLab.forComputerScience,1994. unidirectional encryptionE0 byrandomly choosing a
[18] A. K. Lenstra, P. Winkler, and Y. Yacobi. A Key Escrow public/privatekeypair(EK ;DK )andforwardingit
1 1
System with Warrant Bounds. Advances in Cryptology - to the proxy P together with EK . The adversary B
2
CRYPTO,pages197–207,1995.
starts running the proxy P. Whenever the proxy P
[19] P. MacKenzie. An Efficient Two-Party Public Key Cryp-
needs to make a query to the FDec oracle, B simu-
tosystem Secure Against Adaptive Chosen Ciphertext At-
lates the FDec oracle by taking the P’s query q, and
tack. PKC,2003.
[20] P.MacKenzie and M.Reiter. Delegationofcryptographic forwards it to its own Dec oracle access. B sends
serversforcapture-resilientdevices. CCS,2001. to the proxy P the output of the Dec oracle. At one
[21] P.MacKenzieandM.K.Reiter. NetworkedCryptographic
moment, P challenges the unidirectional encryption
DevicesResilient toCapture. EighthACMConferenceon scheme E0 by choosing two messages (m ;m ) and
ComputerandCommunicationsSecurity(CCS-8),2001. 0 1
[22] P.MacKenzie andM.K.Reiter. Two-PartyGenerationof sending them to B. B chooses the same two mes-
DSASignatures. AdvancesinCryptology-CRYPTO2001 sages to challenge the original encryption scheme E.
(LectureNotesinComputerScience2139),2001. When B is presented with the challenge Enc 2(m b),
[23] S. Micali. Fair Public-Key Cryptosystems. Advances in wherem ischosenatrandomfromthetwomessages
b
Cryptology -CRYPTO’92 Proceedings, Berlin: Springer- (m ;m ), B applies Enc (Enc (m)) and sends the
0 1 1 2
Verlag,1993.
challengeasUniEnc(m )totheproxyP. Weassumed
[24] A.Nicolosi,M.Krohn,Y.Dodis,andD.Mazieres. Proac- b
thattheproxyPcanbreaktheunidirectionalencryp-
tiveSignaturesforUserAuthentication. NDSS,2003.
[25] R. L. Rivest, A. Shamir, and L. M. Adelman. A Method tionschemewithprobabilitygreaterthan1/2.Thus,B
forObtainingDigitalSignaturesandPublic-KeyCryptosys- canbreakthestandardencryptionschemewithprob-
tems. TechnicalReportMIT/LCS/TM-82,1977. abilitygreaterthan1/2.
[26] A. Shamir. Identity-Based Cryptosystems and Signa-
ture Schemes. Advances in Cryptology: Proceedings of 2. Let’s assume that E0 is not CCA2 secure against the
CRYPTO84,LectureNotesinComputerScience,7:47–53, userF. ThismeansthattheuserF canbreakE0 with
1984.
probabilityofsuccessgreaterthan1/2. Basedonthe
[27] Y.Frankel and M.Yung. Escrow Encryption Systems Vis-
ited: Attacks, Analysis and Designs. Advances in Cryp- user F, we build an adversaryB capable of breaking
tology-CRYPTO’95Proceedings,Berlin:Springer-Verlag, the orginal encryption scheme E. The adversary B
1995. receives as input the public key EK of the original
1Generic
Succ P;E0 d =ef Pr (cid:20)b=~b (cid:12)
(cid:12)
(EK 1;DK 1; bE K 2; fD 0;K 12 g) ;~ b Un Pi FG De en c(( E1 Kk) 1; ;( Em K0 2; ;m D1 K) 1 ;UnP iF ED nec c( (E mK b1 ); )EK 2;DK 1); (cid:21)
(cid:12)
(cid:12)
Succ F;E0 d =ef Pr (cid:20)b=~b (cid:12)
(cid:12)
(EK 1;DK 1; bE K 2; fD 0;K 12 g) ;~ b Un Fi PG De en c(( E1 Kk) 1; ;( Em K0 2; ;m D1 K) 2 ;UnF iP ED ne cc( (E mK b1 ); )EK 2;DK 2); (cid:21)
(cid:12)
El-Gamal
Succ P;E0 d =ef (cid:12) Pr (cid:20)b=~b (cid:12)
(cid:12)
(EK b;D K) f0 ;1U g;n ~biG en P(1 (k E) K; ;(m DK0; Pm ;U1 n) i EncP E( KE (K m; bD ))K P); (cid:21)
(cid:12)
(cid:12)
Succ F;E0 d =ef Pr (cid:20)b=~b
(cid:12) (cid:12)
(EK b;D K)
f0
;1U g;n ~biG en F(1 Pk De) c; (cid:3)( (m EK0; ;m D1 K)
F
;UnF iP ED ne cc(cid:3) E( KE (K m; bD ))K F);
(cid:21)
(cid:12)
RSA Succ P;E d =ef Pr (cid:20)m0 =m
(cid:12)
(EK(cid:12) ;DK) UniGen(1k);m M;m0 P(EK;DK P;UniEnc EK(m))
(cid:21)
(cid:12)
(cid:12)
IBE
Succ P;E0 d =ef Pr (cid:20)b(cid:12) =~b (cid:12)
(cid:12)
(s=(s1 b;s 2) f;s 0P ;1) g ;~b Uni PG (e sn 1( ;1 sk P) ;; U(m ni0 E; nm c I1 D) ( m bP )( )s1;sP); (cid:21)
(cid:12)
(cid:12)
Succ F;E0 d =ef Pr (cid:20)b=~b (cid:12)
(cid:12)
(s=(s1 b;s 2); fs 0P ;1) g ;~b Uni FG Pe Dn e( c(cid:3)1 (k E) K;( ;m D0 K; Fm ;U1) n iEnF c EP KDe (c m(cid:3)( bE )K );DK F); (cid:21)
(cid:12)
(cid:12)
Table6.Onlinegenericencryptiondefinitionsforadversary’ssuccess.
encryption scheme E. First, B simulates the condi- A.2 UnidirectionalElGamalEncryptionScheme
tions necessary for the user F to break the unidirec-
tional encryption E0 by choosing at random a pub- Theorem2LetE0 = (UniGen,UniEnc,UniDec,PDec,
lic/private key pair (EK 2;DK 2) and forwarding it to FDec) be an unidirectional El Gamal encryption scheme.
FtogetherwiththeEK 1. TheadversaryB startsrun- E0isCPAsecureagainst(1)theproxyP,(2)theuserF,and
ning the user F. When the user F makes a query (3)allusersU,wheretheadversary’ssuccessisdefinedin
q = Enc 1(Enc 2(m)) to thePDecoracle, B takesthe table6.
querye, forwardsitto itsownDecoracle, andsends
the answer Enc (m) directly to F. When the user F Proof
2
challenges the adversaryB, it chooses two messages
(m ;m )andsendsthemtoB. Bencryptsthosetwo 1. Let’sassume thatPis capable ofbreaking theunidi-
0 1
messages usingthe keyEK andsendsthemto chal- rectional El-Gamal encryption scheme. This means
2
lenge the standard encryption. When B is presented that j Succ P;E0(1k)(cid:0)1=2 j is notnegligible. Based
with thechallenge Enc (m ), wherem ischosen at on P, we will build an adversary B that breaks the
1 b b
random from two messages (Enc (m );Enc (m )), original El-Gamal scheme with non-negligible prob-
2 0 2 1
BsendsthechallengetoF. Weassumedthattheuser ability. Initially, B is giventhe public key EK of the
Fcanbreaktheunidirectionalencryptionschemewith original EL-Gamal scheme. Based on EK, B simu-
probability greater than 1/2. Thus, B can break the latesthe conditionsnecessaryfor Pto breakthe uni-
standard encryption scheme with probability greater directional ElGamal. For this, B chooses a random
than1/2. numberasx 1andgivesittoP.Aspartoftheunidirec-
tional challenge, P chooses two messages (m ;m )
0 1
and forwards them to B. B uses the same two mes-
sagestochallengethestandardEl-Gamal. WhenBis
3. Thispartisimpliedbythetwopreviousparts.
giventheencryptionofm ,whereb f0;1g,itfor-
b
wards Enc(m ) to P. We assumed that P is capable
b
of breaking the unidirectional El-Gamal and by defi-
nition,UniEnc(m ) = Enc(m ). Thus,ifPdecrypts
b bUniEnc(m )withprobabilitygreaterthan1/2,thenB willshowthat basedonPwe canbuildanadversary
b
decryptsEnc(m )withprobabilitygreaterthan1/2. BthatbreakstheoriginalRSAencryptionscheme. B
b
isgiventhepublickeyEKandbasedonitcreatesthe
2. Let’s assume that F is capable of breaking the unidi-
conditionsnecessaryforPtobreaktheunidirectional
rectional El-Gamal encryption scheme. This means
RSA. B chooses a random number d and forwards
that j Succ F;E0(1k) (cid:0) 1=2 j is not negligible. We
it to P as its part of the secret key.
T1
he goal of the
use the notation FP(cid:3) to indicate that the user F can adversary B is to find m0 such that m0 = m when
have honest access to the PDec function. Based on
givenEnc(m). B forwardsthe ciphertextEnc(m) =
F,wewillbuildanadversaryBthatbreakstheorigi-
UniEnc(m) to P. We assumed that P is able to find
nalEl-Gamalschemewithnon-negligibleprobability. m0 = mwhengivenUniEnc(m)withnon-negligible
Initially, B is given the public key EK of the origi- probability.Thus,Bisabletofindm0.
nalEL-Gamalscheme. BasedonEK,Bsimulatesthe
conditionsnecessaryforFtobreaktheunidirectional 2. Thisproofissimilartothepreviousone.
ElGamal. For this, B chooses a random number as
3. Thispartisimpliedbythetwopreviousparts.
x and gives it to F. The adversary B simulates the
2
honest access of F to PDec and the encryption ora-
cle UniEnc by taking the query message m and re-
turning mgex2 and Enc(m). As part of the unidirec- A.4 UnidirectionalIBEEncryptionScheme
tional challenge, F chooses two messages (m ;m )
0 1
and forwards them to B. B uses the same two mes- Theorem4LetE0 = (UniGen,UniEnc,UniDec,PDec,
sagestochallengethestandardEl-Gamal. WhenBis FDec) be an unidirectional IBE encryption scheme. E0 is
giventheencryptionofm ,whereb f0;1g,itfor-
b CPAsecureagainst(1)theproxyP,(2)theuserF,and(3)
wards Enc(m ) to F. We assumed that F is capable
b all users U, where the success of the adversary is defined
of breaking the unidirectional El-Gamal and by defi-
intable6.
nition, UniEnc(m ) = Enc(m ). Thus, ifFdecrypts
b b
UniEnc(m )withprobabilitygreaterthan1/2,thenB Proof
b
decryptsEnc(m )withprobabilitygreaterthan1/2.
b
1. Let’s assume that P is capable of breaking the uni-
3. Thispartisimpliedbythetwopreviousparts.
directional IBE encryption scheme. This means that
jSucc P;E0(1k)(cid:0)1=2jisnotnegligible. BasedonP,
we will buildan adversaryB that breaksthe original
A.3 UnidirectionalRSAEncryptionScheme IBEschemewithnon-negligibleprobability.Initially,
B is given the public key P = sP of the original
pub
Definition11 A function f : f0;1g(cid:3) ! f0;1g(cid:3) is ONE- IBEscheme.BasedonsP,Bsimulatestheconditions
WAYifitsatisfiestwoconditions: necessary for P to break the unidirectional IBE. For
this,Bchoosesarandomnumberass andgivesitto
1
1. Thereexistsapoly-timealgorithmthatcorrectlycom- P. Aspartoftheunidirectionalchallenge,Pchooses
putesf(x)foranyx2f0;1g(cid:3). two messages (m 0;m 1) and forwards them to B. B
usesthesametwomessagestochallengethestandard
2. For any PPT adversary A, Pr(f(z) = y j x IBE. When B is given the encryption of m , where
b
f0;1gk;y=f(x);z A(y;1k))(cid:20)negl(k).
b f0;1g, it forwards Enc(m ) to P. We assumed
b
that P is capable of breaking the unidirectional IBE
Theorem 3 Let E0 = (UniGen, UniEnc, UniDec, PDec, andbydefinition, UniEnc(m ) = Enc(m ). Thus,if
b b
FDec) bean unidirectionalRSAencryption scheme. E0 is PdecryptsUniEnc(m )withprobabilitygreaterthan
b
ONE-WAY secureagainst(1)theproxyP,(2)theuserF, 1/2,thenBdecryptsEnc(m )withprobabilitygreater
b
and (3) all users U, where the success of the adversaryis than1/2.
definedintable6.
2. Let’s assume that F is capable of breaking the uni-
Proof directional IBE encryption scheme. This means that
j Succ F;E0(1k) (cid:0) 1=2 j is not negligible. We use
1. Let’s assume that P breaks the unidirectional RSA. the notation FP(cid:3) to indicate that the user F can have
This means that Succ P;E(1k) is not negligible. We honest access to the PDec function. Based on F, wewillbuildanadversaryBthatbreakstheoriginalIBE askstheFSigoracletoproduceasignatureforames-
scheme with non-negligible probability. Initially, B sage m0, B asks its own signature oracle to produce
is given the public key P = sP of the original a signature for m0 under SK and sends the result to
pub 2
IBE scheme. B simulates the conditions necessary theproxyP. Atonemoment,theproxyPgeneratesa
for F to break the unidirectional IBE by choosing a validunidirectionalsignatureforamessagemwitha
random number as s and giving it to F. The adver- non-negligible probability, where m is a completely
2
sary B simulatesthe honestaccess of Fto PDecand new message. B takes the unidirectional signature
theencryptionoracleUniEncbytakingthequerymes- UniSig(m)=Sig (m)Sig (m),removesthefirstpart
1 2
sage m and returning e^(rID;s P) andEnc(m) =< andoutputsSig (m)asavalidsignatureofm.
1 2
rID;m (cid:8) e^(rID;sP) >. As part of the unidirec-
tional challenge, F chooses two messages (m ;m )
2. Let’sassumethatS0 isnotUF-CMA againstF. This
0 1
and forwards them to B. B uses the same two mes-
means that jSucc F;S0(1k)j is not negligible. We as-
sumethatFisnotallowedtoaskthePSigoracleabout
sagestochallengethestandardIBE.WhenBisgiven
m. BasedonS0 webuildaforgerBcapabletobreak
the encryption ofm , whereb f0;1g,it forwards
b
theoriginalsignatureschemeS.TheforgerBreceives
Enc(m ) to F. We assumed that F is capable of
b
as input the public key VK and tries to generate a
breaking the unidirectional El-Gamal and by defini- 1
tion, UniEnc(m ) = Enc(m ). Thus, if F decrypts valid signature of a message m under the secret key
b b
SK . TheforgerBchoosesatrandomapublic/private
UniEnc(m )withprobabilitygreaterthan1/2,thenB 1
b
decryptsEnc(m )withprobabilitygreaterthan1/2.
keypair(VK 2;SK 2)andforwardsittotheuserFto-
b
getherwithVK .TheforgerBstartsrunningF.When
1
3. Thispartisimpliedbythetwopreviousparts. theuserFmakesaqueryonthehashoracleforames-
sagem0, theforgerB forwardstherequesttoitsown
hashoracleandsendstheanswerbacktoF. WhenF
asks the PSig oracle to produce part of the signature
B Unidirectional Signature Scheme
for a message m0, B asks its own signature oracle to
produce a signature for m0 under SK . After that, B
1
B.1 UnidirectionalGenericSignatureScheme sends to F Sig (m0). At one moment, F generates a
1
validunidirectionalsignatureforamessagemwitha
Theorem5LetS = (Sig-Gen;Sig;Ver)bea standard non-negligible probability, where m is a completely
signature scheme. Let’s consider S0 = (UniGen, UniSig, new message. B takes the unidirectional signature
UniVer, PSig, FSig) an unidirectional signature scheme UniSig(m) = Sig (m)Sig (m), removesthe second
1 2
constructed as described above, based on S. If S is UF- partandoutputsSig (m)asavalidsignatureofm.
CMA,thanS0isUF-CMAagainst(1)theproxyP,(2)the 1
userF,and(3)allusersU, wheretheadversary’ssuccess 3. Thispartisimpliedbytheprevioustwoparts.
isdefinedintable7.
Proof
B.2 UnidirectionalRSA-HashSignatureScheme
1. Let’sassumethatS0isnotUF-CMAagainsttheproxy
P. This means that jSucc P;S0(1k)j is not negligi- Theorem 6 Let S = (Sig-Gen;Sig;Ver) be a clas-
ble. We assume that the proxy P is not allowed to sic RSA-Hash signature scheme. Let’s consider S0 =
ask the FSig oracle for FSig(m). Based on S0 we (UniGen, UniSig, UniVer, PSig, FSig) an unidirectional
build a forger B capable to break the original signa- RSA-Hash signature scheme constructed as described
ture scheme S. The forger B receives as input the above.S0 isUF-CMAagainst(1)theproxyP,(2)theuser
public key VK and tries to generate a valid signa- F, and (3) all users U, where the adversary’s success is
2
ture of a message m under the secret key SK . The definedintable7.
2
forgerB chooses at randoma public/privatekey pair
Proof
(VK ;SK ) and forwards it to P together with VK .
1 1 2
The forger B starts running the proxy P. When P
makes a query on the hash oracle for a message m0, 1. Let’sassumethatPcanbreaktheunidirectionalRSA-
the forgerB forwardsthe requestto its own hash or- Hash scheme. This means that jSucc P;S(1k)j is not
acle and sends the answer to the proxy P. When P negligible. BasedontheproxyP,webuildaforgerBSucc P;S0 d =ef Pr (cid:20)UniVer(m;s)=succeed
(cid:12)
(VK (m1; ;S sK )1 ;V PK F2 S; igS (K V2 K)
1
;VKU 2n ;iG SKen 1( )1k)
(cid:21)
Generic (cid:12)
(cid:12)
(cid:12)
Succ F;S0 d =ef Pr (cid:20)UniVer(m;s)=succeed
(cid:12)
(VK (m1; ;S sK )1 ;V FK P2 S; igS (K V2 K)
1
;VKU 2n ;iG SKen 2( )1k)
(cid:21)
(cid:12)
(cid:12)
(cid:12)
RSA-Hash
Succ P;S d =ef Pr (cid:20)UniVer(m;s)=succeed
(cid:12)
(SK;VK) UniGen(1k);(m;s) PFSig(SK P;VK)]
(cid:21)
(cid:12)
(cid:12)
(cid:12)
Succ F;S d =ef Pr (cid:20)UniVer(m;s)=succeed
(cid:12)
(SK;VK) UniGen(1k);(m;s) FPSig(SK F;VK)
(cid:21)
(cid:12)
(cid:12)
(cid:12)
Table7.Onlinegenericsignaturedefinitionsforadversary’ssuccess.
capableofbreakingtheRSAencryptionscheme. The versarycomputesitshasvalue.Ifh(m)=y(cid:3)xe,then
i
forgerBreceivesasinputapublickey(N;e)andtries theadversaryreturnsyd = s=xe asthex = f(cid:0)1(y).
i
to invert x = f(cid:0)1(y), where f is the RSA function Otherwise,itfails.
defined by N and e. The adversaryB starts running
3. Thispartisimpliedbytheprevioustwoparts.
theproxyPforthispublickeyandarandomlychosen
number d given as a secret key. When the proxy P
1
makesthei-thhashquery,theadversarylookstosee
if themessagem wasalreadyasked. If not,it picks
i
C Bidirectional EncryptionScheme
arandomx ,setsh(m ) = xe withprobabilitypand
i i i
h(m ) = y(cid:3)xe with probability1(cid:0)p. Iftheproxy
i i
P makes a query to FSig for a message m , the ad- C.1 BidirectionalGenericEncryptionScheme
i
versaryreturnsx ifm wasaskedbefore. Otherwise
i i
itfails. Eventually,Poutputsacorrectunidirectional Theorem 7 Let’s consider a standard encryption
RSA-Hashsignature(m;s)forabrandnewmessage scheme E = (Enc-Gen;Enc;Dec). Based on E, we build
m. If the message m was not hashed before, the ad- an bidirectional encryption scheme E0 = (BiGen, BiEnc,
versarycomputesitshasvalue.Ifh(m)=y(cid:3)xe i,then BiDec,PDec,FDec). IfE isCCA2secure,thanE0 isalso
theadversaryreturnsyd = s=xe i asthex = f(cid:0)1(y). CCA2 secureagainst(1) theproxyP, (2) theuserF, and
Otherwise,itfails. (3)allusersU,wheretheadversary’ssuccessisdefinedin
table8.
2. Let’sassumethatFcanbreaktheunidirectionalRSA-
Hash scheme. This means that jSucc F;S(1k)j is not For technical reasons, we assume that there exists an
negligible. Based on the user F, we build a forgerB efficient algorithm that evaluates the relation R (e;e0) to
(cid:25)
capableofbreakingtheRSAencryptionscheme. The trueorfalse,wheree = BiEnc(m)istheoriginalchipher-
forgerBreceivesasinputapublickey(N;e)andtries textande0 =(cid:5)(e)isthemodifiedciphertextcomputedby
to invert x = f(cid:0)1(y), where f is the RSA function the proxy P. The output of the algorithm is true, it must
defined by N and e. The adversaryB starts running be the case that Dec (e) = Dec (e0). Having such
EKU EKF
theuserF forthispublickeyandarandomlychosen an algorithm, we allow the proxy P has oracle access to
number d
2
given as a secret key. When the user F BiDecbecauseitcanneversubmitaciphertexte0 suchthat
makesthei-thhashquery,theadversarylookstosee R (e;e0)=true.
(cid:25)
if themessagem wasalreadyasked. If not,it picks
i
arandomx ,setsh(m ) = xe withprobabilitypand Proof
i i i
h(m ) = y (cid:3)xe with probability 1(cid:0)p. If the user
i i
F makes a query to PSig for a message m , the ad- 1. Let’s assume that E0 is not CCA2 secure against P.
i
versaryreturnsx ifm wasaskedbefore. Otherwise This means that jSucc(P;E0)(cid:0) 1=2j is not negligi-
i i
itfails. Eventually,Foutputsacorrectunidirectional ble. Based on P, we will build an adversary B that
RSA-Hashsignature(m;s)forabrandnewmessage breaks the standard encryption scheme E for the key
m. If the message m was not hashed before, the ad- k = (EK ;DK ). The adversary B tries to decrypt
2 2 2Succ P;E d =ef Pr (cid:20)b=~b (cid:12)
(cid:12)
(m0;m1)( EK PU B; iD DeK c(U E; KEK U;F E; KD FK ;F (cid:25); )(cid:25) ;) ~b B Pi BG iDe en c( (1 Ek K) U;b ;E K Ff ;0 (cid:25); ;1 Bg i; Enc(m b)) (cid:21)
(cid:12)
(cid:12)
Generic Succ F;E d =ef Pr (cid:20)b=~b (cid:12) (cid:12) (m0;m1)( EK FU P;D (EK KU U; ;E EK KF F; ;D DK KF F; )(cid:25) ;) ~b B Fi PG (e En K( U1 ;k E); Kb F ;Df K0 F; ;1 Bg i; Enc(m b)) (cid:21)
(cid:12)
(cid:12)
SuccA;E d =ef Pr (cid:20)b=~b
(cid:12)
(cid:12)
(m0;m( 1E )K U; AD BK iDU e; c(E EK KF U; ;D EK KF F; )(cid:25) ;)
~b
B AiG BiDen ec( (1 Ek K); Ub
;E K
Ff ;0 B;1 iEg n;
c(m b)) (cid:21)
(cid:12)
Succ P;E d =ef Pr (cid:20)b=~b(cid:12)
(cid:12)
(cid:12)
(m0;m( 1E )K U; PD (K EU K; UE ;K EF K; FD ;K (cid:25)F );; ~b(cid:25)) PB (EiG Ke Un ;( E1 Kk) F; ;b
(cid:25)
;Bif E0 n; c1 Eg K;
U(m b)) (cid:21)
(cid:12)
(cid:12)
ElGamal Succ F;E d =ef Pr (cid:20)b=~b (cid:12)
(cid:12)
(m0;m1)( EK FU (; ED KK UU ;; EE KK FF ;; DD KK FF );; ~b(cid:25)) F(B EiG Ke Un ;( E1 Kk) F; ;b D K F;f B0; iE1 ng; c EKU(m b)) (cid:21)
(cid:12)
(cid:12)
SuccA;E d =ef Pr (cid:20)b=~b
(cid:12)
(cid:12)
(m0;m1)
(E AK U (E;D KK U;U E; KEK AA ;D;D KK AA );; ~b(cid:25) ) A(B EiG Ke Un ;( E1 Kk A); ;b
D K
Af ;0 B;1 iEg n;
c EKU(m b)) (cid:21)
(cid:12)
(cid:12)
Table8.Bidirectionalencryptiondefinitionsforadversary’ssuccess.
theciphertextEnc (m). Bchoosestwopairsofkeys challenge the standard encryption scheme E. When
2
(k ;k ), givesthemto P, andthenstarts P. B simu- B is presented with the challenge Enc (m ), where
1 3 k1 b
latesP’saccesstothedecryptionoracleBiDecbytak- m 2 (Enc (m );Enc (m )), B sends to F the
b k2 0 k2 1
ingeachqueryeofP,andsendingDec (e)toitsown challenge Enc (m ). We assumed that F is able to
k1 k1 b
decryption oracle. The message received as the an- break the bidirectional encryption scheme with non-
swerissenttotheproxy]proxy. Pchoosestwomes- negligible probability. Thus, B breaks the standard
sages(m ;m )tochallengethebidirectionalencryp- encryptionschemewithnon-negligibleprobability.
0 1
tionschemeE0 andsendsthemtoB. Busesthesame
two messages to challenge the standard encryption 3. Let’s assume that E0 is not CCA2 secure. This
scheme E. When B is presented with the challenge means that there is a PPT adversary A such that
Enc k2(m b), where m b 2 (m 0;m 1), B sends to P jSucc(A;E0)(cid:0)1=2j is not negligible. Based on A,
BiEnc(m b) = Enc k1(Enc k2(m b)). We assumed that wewillbuildanadversaryBthatbreaksthestandard
Pisabletobreakthebidirectionalencryptionscheme encryption scheme E for the key (EK ;DK ). The
2 2
with non-negligible probability. Thus, B breaks the adversary B tries to decrypt the ciphertext Enc (m).
2
standardencryptionschemewithnon-negligibleprob- B starts A. B simulates A’s access to the decryp-
ability. tion oracle BiDec by taking each query e of A, and
sending Dec (e) to its own decryption oracle. A
2. Let’s assume that E0 is not CCA2 secure against F.
choosestwomk1
essages(m ;m )tochallengethebidi-
This means that jSucc(F;E0) (cid:0)1=2j is not negligi- rectionalencryption schem0 eE1 0 andsends themto B.
ble. Based on P, we will build an algorithm B that B usesthe same two messages to challengethe stan-
breaksthe standard encryptionschemeE for encryp- dardencryptionschemeE. WhenBispresentedwith
tionkeyk 1. B choosestworandomnumbersaskeys the challenge Enc k2(m b), where m
b
2 (m 0;m 1), B
(k 2;k 3) and gives them to F. In addition, B simu- sendstoABiEnc(m b)=Enc k1(Enc k2(m b)). Weas-
lates oracle access to P by taking each query e of F, sumedthatPisabletobreakthebidirectionalencryp-
forwarding it to its own decryption oracle and send- tion scheme with non-begligible probability. Thus,
ing backto FEnc k3(Dec k1(e)). F choosestwo mes- B breaks the standard encryption scheme with non-
sages(m 0;m 1)tochallengethebidirectionalencryp- negligibleprobability.
tion scheme E0 and sends them to B. B encrypts the
two messages and uses (Enc (m );Enc (m )) to
k2 0 k2 1Generic
Succ P;S d =ef Pr (cid:20)BiVer(m;s)=succeed (cid:12)
(cid:12)
(SK U (; mV ;K sU ); SK PF; BV iSiK g(F V; K(cid:25)) U; VKB FiG ;(cid:25)e )n(1k) (cid:21)
(cid:12)
(cid:12)
Succ F;S d =ef Pr (cid:20)BiVer(m;s)=succeed (cid:12)
(cid:12)
(SK U (; mV ;K sU ); SK FF; PV (VK KF; U(cid:25) ;V) K F;B Si KG Fe )n(1k) (cid:21)
(cid:12)
(cid:12)
Table9.Bidirectionalsignaturedefinitionsforadversary’ssuccess.
C.2 BidirectionalElGamalEncryptionScheme D Bidirectional Signature Scheme
Theorem8 Let E0 = (BiGen, BiEnc, BiDec, (cid:5)) be an D.1 BidirectionalGenericSignatureScheme
bidirectionalEl Gamalencryptionscheme. E0 isCPA se-
cureagainst(1)theproxyP,(2)theuserF,and(3)allusers
Theorem9Let’sconsiderastandardsignaturescheme
U,wheretheadversary’ssuccessisdefinedintable8.
S = (Sig-Gen;Sig;Ver). Based on S, we build an bidi-
Proof rectionalsignatureschemeS0 =(BiGen,BiSig,BiVer,(cid:5)).
If S is UF than S0 is UF against (1) the proxy P, (2) the
userF, and(3)allusersU,wheretheadversary’ssuccess
1. Let’s assume that P can break the bidirectional
isdefinedintable9.
El Gamal encryption scheme. This means that
jSucc P;E(1k)(cid:0)1=2jisnotnegligible.BasedonP,we Proof
willbuildanalgorithmB thatcanbreakthestandard
ElGamalencryption. Forthis,Bsimulatesthecondi-
1. Let’sassumethatS0 isnotUFagainstP. Thismeans
tionsrequiredbyP. Initially,Bknowsthepublickey
of U (EK = gx1). B pick a random number (cid:25) and
thatjSucc P;S(1k)jisnotnegligible. BasedonP, we
U build a forger B able to break the original signature
forwardsittoP,togetherwithEK .FromEK =gx1
U U S. BtriestogenerateavalidsignatureSig (m)fora
and (cid:25), B calculates gx2 = gx1g(cid:25) and forwards gx2 1
messagem. BreceivesVK asinput.Bgeneratestwo
to P as the secret key of F. P chooses two mes- 1
randomnumbers(SK ;SK ) andsends themto Pas
sages (m ;m ) to challenge the security of the bidi- 2 3
0 1 thebidirectionalkey(cid:25). TheforgerBstartsP.
rectional El Gamal and forwards them to B. B con-
siders the same two messages to challenge the stan- When proxy makes a query for a message m to the
dardElGamalandreceivesthechallengeEnc (m ), hash oracle, B forwards the request to its own hash
x1 b
where m 2 (m ;m ). B forwards the challenge oracle and returns the answer h(m) to P. When P
b 0 1
Enc (m )=BiEnc (m )toP. Weconsideredthat makes a query to the (cid:25) signature oracle, B makes a
x1 b x1 b
PcanbreakthebidirectionalElGamalwithprobabil- query to the Sig signature oracle for the same mes-
ityofsuccessSucc P;E(1k)greaterthan1/2. Thus,B sagem. B receivesSig 1(m), computesSig 3(m) and
isabletobreakthestandardElGamalwithprobability sendstoPBiSig(m)=Sig (m)Sig (m). Atonemo-
1 3
ofsuccessgreaterthan1/2. ment, P generates a valid signature BiSig(m) for a
new message m, with non-negligible probability. B
2. Let’s assume that F can break E0. This means that takesBiSig(m) = Sig (m)Sig (m), ignoresthesec-
1 3
jSucc F;E(1k)(cid:0)1=2j is not negligible. The proof is ondpartandoutputsSig (m). WeassumedthatPcan
1
similartothepreviousone. Theonlydifferenceisthat breakthebidirectionalsignatureschemeS0. Thus,B
Bchoosesatrandomx 2 andcomputesgx2 forF. canbreaktheoriginalsignatureschemeS.
3. Let’s assume that E is not CPA secure. This 2. Let’sassumethatS0 isnotUFagainstF. Thismeans
jm Se ua cn cs At ;h Ea (t 1kt )he (cid:0)re 1=e 2x jis it ss na on
t
na ed gv le igrs ibar ley
.
A Thesu pc rh oot fha ist t bh ua it ldjS au fc oc rF g; eS r(1 Bk) aj bi ls en toot bn re eg al kig ti hb ele o. rB iga inse ad
l
so in gnF a, tuw ree
similar to the previous one. The only difference is
S. BtriestogenerateavalidsignatureSig (m)fora
that B chooses at random DKA = y and computes
messagem. BreceivesVK
asinput.Bgen2
eratestwo
EKA =gy forA.
pairs of random numbers
(2
VK ;SK ;VK ;SK ) and
1 1 3 3
sends to F as its keys. The forger B starts F. Whenfbi makes a query for a message m to the hash or- anewmessagem,withnon-negligibleprobability. B
acle, B forwards the request to its own hash oracle takesBiSig(m) = Sig (m)Sig (m), ignores thefirst
1 2
and returns the answer h(m) to F. When F makes part and outputs Sig (m). We assumed that F can
2
a query to the P signature oracle, B makes a query breakthebidirectionalsignatureschemeS0. Thus,B
to the Sig signature oracle for the same message m. canbreaktheoriginalsignatureschemeS.
B receivesSig (m), computes Sig (m) and sends to
2 1
3. Thispartisimpliedbythetwopreviousparts.
F BiSig(m) = Sig (m)Sig (m). At one moment, F
1 2
generatesavalidsignatureBiSig(m)for