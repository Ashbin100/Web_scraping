E(cid:14)cient Distribution of Key Chain Commitments for Broadcast
Authentication in Distributed Sensor Networks(cid:3)
Donggang Liu Peng Ning
Department of Computer Science
North Carolina State University
Raleigh, NC 27695-7534
Emails: dliu@unity.ncsu.edu,ning@csc.ncsu.edu
Abstract bandwidth. Distributed sensor networks have exten-
sive applicationsin military aswell ascivilian opera-
tions, in which it is necessaryto deploy sensor nodes
Broadcast authentication is a fundamental security dynamically.
service in distributed sensor networks. A scheme Broadcast authentication is an essential service in
named(cid:22)TESLAhasbeenproposedfore(cid:14)cientbroad- distributed sensor networks. Because of the large
cast authentication in such networks. However, amount of sensor nodes and the broadcast nature of
(cid:22)TESLA requires initial distribution of certain in- the communicationin distributed sensornetworks,it
formation based on unicast between the base sta- is usuallydesirableforthe basestationsto broadcast
tion and each sensor node before the actual authen- commands and data to the sensor nodes. In hostile
tication of broadcast messages. Due to the limited environments (e.g., battle (cid:12)eld, anti-terroristsopera-
bandwidth in wireless sensor networks, this initial tions),itisnecessarytoenablethesensornodestoau-
unicast-based distribution severely limits the applica- thenticate the broadcast messages received from the
tionof (cid:22)TESLAinlarge sensornetworks. This paper base station.
presentsanoveltechniquetoreplacetheunicast-based Aprotocolnamed(cid:22)TESLA[13]hasbeenproposed
initialization with a broadcast-based one. As a result, for broadcast authentication in distributed sensor
(cid:22)TESLAcanbeusedinasensornetworkwith alarge networks,whichisadaptedfromastreamauthentica-
amount of sensors, as long as the message from the tionprotocolcalledTESLA[10]. (cid:22)TESLAemploysa
base station can reach these sensor nodes. This pa- chain of authentication keys linked to each other by
per further explores several techniques that improve a pseudo random function, which is by de(cid:12)nition a
the performance, the robustness, as well as the secu- one way function. Each key in the key chain is the
rity of the proposed method. The resulting protocol imageofthenextkeyunderthepseudorandomfunc-
satis(cid:12)es several nice properties, including low over- tion. The e(cid:14)ciency of (cid:22)TESLA is based on the fact
head, tolerance of message loss, scalability to large that once a sensor node has an authenticated key in
networks, and resistance to replay attacks as well as a keychain, onlypseudorandom function operations
some known Denial of Service (DOS) attacks. are needed to authenticate the subsequent broadcast
messages.
The original TESLA uses broadcast to distribute
1. Introduction the initial parametersrequired forbroadcastauthen-
tication. The authenticity of these parameters are
Adistributedsensornetworkusuallyconsistsofone guaranteed by digital signature generated by the
orseveralcomputationallypowerfulnodescalledbase sender. However, due to the low bandwidth of a sen-
stationsandalargeamountofinexpensive,lowcapac- sor network and the low computational resources at
itynodescalledsensors(orsensornodes). Thenodes each sensor node, (cid:22)TESLA cannot distribute these
inadistributedsensornetworkcommunicatethrough initial parametersusingpublic keycryptography. In-
wireless communication, which is usually limited in stead, the base station has to unicast the initial pa-
rameters to the sensor nodes individually. This fea-
(cid:3)This work is partially supported by the U.S. Army Re- ture severely limits the application of (cid:22)TESLA in
searchO(cid:14)ceundergrantDAAD19-02-1-0219.
1large sensor networks. For example, The implemen- high communication, computation and storage over-
tation of (cid:22)TESLA in [13] has 10Kbps bandwidth head of the asymmetric cryptographic mechanisms,
and supports 30 bytes messages. To bootstrap 2000 it is impractical to implement them in resource con-
nodes, the base station has to send or receive at strained sensor networks.
least4000packetstodistributetheinitialparameters, (cid:22)TESLA introduced asymmetry by delaying the
whichtakesatleast4000(cid:2)30(cid:2)8
=93:75secondsevenif disclosure of symmetric keys [13]. A sender broad-
10240
thechannelutilizationisperfect. Suchamethodcer- castsamessagewith aMessageAuthenticationCode
tainly cannot scale up to very large sensor networks, (MAC) generated with a secret key K, which will be
which may have thousands of nodes. disclosed after a certain period of time. When a re-
Inthispaper,weproposeanextensionto(cid:22)TESLA ceiver receives this message, if it can ensure that the
to address the above limitation. The basic idea is to packet was sent before the key was disclosed, the re-
predetermine and broadcast the initial parametersre- ceivercanbu(cid:11)erthispacketandauthenticateitwhen
quired by (cid:22)TESLA instead of unicast-based message itreceivesthecorrespondingdisclosedkey. Tocontin-
transmission. Inthesimplestform,ourextensiondis- uously authenticate the broadcast packets, (cid:22)TESLA
tributes the (cid:22)TESLA parameters during the initial- divides the time period for broadcasting into multi-
ization of the sensornodes (e.g., alongwith the mas- pletimeintervals,assigningdi(cid:11)erentkeystodi(cid:11)erent
ter key sharedbetween eachsensorand the base sta- time intervals. All packets broadcasted in a particu-
tion). To provide more (cid:13)exibility, especially to pro- lartime intervalareauthenticatedwith thesamekey
longthelifetimeof(cid:22)TESLAwithoutrequiringavery assigned to that time interval.
long key chain, we introduce a multi-level key chain To authenticate the broadcastmessages,a receiver
scheme,in which the higher-levelkeychainsareused (cid:12)rst authenticates the disclosed keys. (cid:22)TESLA uses
to authenticate the commitments of lower-levelones. a one-way key chain for this purpose. The sender
To further improve the survivability of the scheme selects a random value K as the last key for the
n
againstmessagelossandDenial of Service(DOS) at- key chain and repeatedly performs a pseudo random
tacks, we use redundant message transmission and function F to compute all the other keys: K =
i
randomselectionstrategiestodealwiththemessages F(K );0(cid:20)i(cid:20)n(cid:0)1,wherethesecretkeyK isas-
i+1 i
thatdistributekeychaincommitments. Theresulting signed to the ith time interval. With the pseudo ran-
schemeremovestherequirementofunicast-basedini- dom function F, given K in the key chain, anybody
j
tial communication between base station and sensor can compute all the previous keys K ;0(cid:20)i(cid:20)j, but
i
nodes while keeping the nice properties of (cid:22)TESLA nobodycancomputeanyofthelaterkeysK ;j+1(cid:20)
i
(e.g., tolerance of message loss, resistance to replay i (cid:20) n. Thus, with the knowledge of the initial key
attacks). Our implementation and experiments fur- K , the receiver can authenticate any key in the key
0
ther demonstrate that our scheme can tolerate high chain by merely performing pseudo random function
channel loss rate and is resistant to certain known operations. Whenabroadcastmessageisavailablein
DOS attacks to a certain degree. ith time interval, the sender generates MAC for this
The rest of this paper is organized as follows. The messagewith a keyderivedfrom K and then broad-
i
next section gives a brief overview of (cid:22)TESLA and casts this message along with its MAC and discloses
its extensions. Section 3 presents the development thekeyK i(cid:0)dassignedtothetimeintervalI i(cid:0)d,where
of our multi-level key chain scheme. Section 4 de- disthedisclosurelagoftheauthenticationkeys. The
scribestheimplementationandexperimentswithour senderprefersalongdelayinordertomakesurethat
scheme. Section5discussestherelatedwork,andsec- all or most of the receivers can receive its broadcast
tion6concludesthepaperandpointsoutsomefuture messages. But,forthereceiver,alongdelaycouldre-
research directions. Appendix A presents the details sult in high storageoverhead to bu(cid:11)er the messages.
of the two-level key chain scheme, from which the Each key in the key chain will be disclosed after
multi-level key chain is extended. some delay. As a result, the attacker can forge a
broadcastpacketbyusingthedisclosedkey. (cid:22)TESLA
2. An Overview of (cid:22)TESLA uses a security condition to prevent a receiver from
accepting any broadcastpacket authenticated with a
Authentication of broadcastmessages is an impor-
disclosed key. When a receiver receives an incoming
tantsecurityissueinwiredorwirelessnetworks. Gen-
broadcastpacket in time interval I , it checksthe se-
i
erally, an asymmetric mechanism, such as public key
curityconditionb(T +(cid:1)(cid:0)T )=T c<I +d,where
c 0 int i
cryptography, is required to authenticate broadcast
T is the local time when the packet is received, T
c 0
messages. Otherwise, a malicious receiver can easily
is the start time of the time interval 0, T is the
int
forgeanypacketfromthesender. However,duetotheduration of each time interval, and (cid:1) is the maxi- Weassumeeachbroadcastmessageisfromthebase
mum clock di(cid:11)erence between the sender and itself. stationtothesensornodes. Broadcastmessagesfrom
If the security condition is satis(cid:12)ed, i.e., the sender asensornodetothesensornetworkcanbehandledas
hasnotdisclosedthe keyK yet, the receiveraccepts suggested in [13]. That is, the sensor node unicasts
i
this packet. Otherwise, the receiver simply drops it. the message to the base station, which then broad-
When the receiver receives the disclosed key K , it casts the message to the other sensor nodes. The
i
canauthenticateitwithapreviouslyreceivedkeyK messages transmitted in a sensor network may reach
j
by checking whether K = Fi(cid:0)j(K ), and then au- the destinationdirectly, ormayhavetobeforwarded
j i
thenticate the bu(cid:11)ered packetsthat weresent during by some intermediate nodes; however,we do not dis-
time interval I . tinguish between them in our schemes.
i
(cid:22)TESLA is an extension to TESLA [10]. The For the sake of presentation, we denote the key
only di(cid:11)erence between TESLA and (cid:22)TESLA is in chain with commitment K as hK i throughout this
0 0
their key commitment distribution schemes. TESLA paper.
uses asymmetric cryptography to bootstrap new re-
ceivers, which is impractical for current sensor net- 3.1. Scheme I: Predetermined Key Chain Com-
works due to its high computation and storage over- mitment
head. (cid:22)TESLA depends on symmetric cryptography
A simple solution to bypass the unicast-based dis-
with the master key shared between the sender and
tribution of key chain commitments is to predeter-
eachreceivertobootstrapthenewreceiversindividu-
minethe commitments,thestartingtimes, andother
ally. In this scheme,the receiver(cid:12)rst sendsarequest
parameters of key chains to the sensor nodes during
to the sender, and then the sender replies a packet
the initialization of the sensor nodes, possibly along
containingthe currenttime T (fortime synchroniza-
c
withthemasterkeyssharedbetweenthesensornodes
tion), a key K of one way key chain used in a past
i
andthe basestation. (Unlike themasterkeys,whose
intervali,the starttime T of intervali,the duration
i
con(cid:12)dentialityandintegrityarebothimportant,only
T of each time interval and the disclosure lag d.
int
the integrity of the key chain commitments needs to
TESLAwaslaterextendedtoincludeanimmediate
be ensured.) As a result, all the sensor nodes have
authentication mechanism [11]. The basic idea is to
the key chain commitments and other necessary pa-
include an image under a pseudo random function of
rameters once they are initialized, and are ready to
a late message content in an earlier message so that
use (cid:22)TESLA as long as the starting time is passed.
once the earlier message is authenticated, the later
Thissimpleschemecangreatlyreducetheoverhead
message content can be authenticated immediately
involvedin distribution of keychain commitments in
afteritisreceived. Thisextensioncanalsobeapplied
(cid:22)TESLA,sinceunicast-basedmessagetransmissionis
to (cid:22)TESLA protocol in the same way.
notrequiredanymore. However,thissimplesolution
3. E(cid:14)cient Distribution of Key Chain also introduces several problems.
First, a key chain in this scheme can only cover
Commitments for (cid:22)TESLA
a (cid:12)xed period of time. To cover a long period of
The major barrier of using (cid:22)TESLA in large sen- time, we need either a long key chain, or a large in-
sornetworkslies in its di(cid:14)culty todistribute the key terval to divide the time period. If a long key chain
chaincommitmentstoalargenumberofsensornodes. isused, the basestationwill havetoprecomputeand
Inotherwords,themethodforbootstrappingnewre- store this key chain. In addition, the receivers will
ceiversin (cid:22)TESLA doesnot scale toa largegroupof havetoperformintensivecomputationofpseudoran-
newreceivers,thoughitisokaytobootstraponeora dom functions if there is a long delay (which covers
few. Theessentialreasonforthisdi(cid:14)cultyisthemis- a large number of intervals) between broadcast mes-
match between the unicast-based distribution of key sages. If a long interval is used, there will be a long
chain commitments and the authentication of broad- delay before the authentication of a message after it
cast messages. is received, and it requires larger bu(cid:11)er at the sen-
In this section, we present our method to address sornodes. Thoughthe extensionstoTESLA[11]can
thelimitationof(cid:22)TESLA.Thebasicideaistoprede- remove this delay and the bu(cid:11)er requirement at the
termineandbroadcastthekeychaincommitmentsin- sensor nodes, the messages will have to be bu(cid:11)ered
stead of unicast-based message transmissions. In the longer at the base station.
following, we present a series of schemes; each later Second, it is di(cid:14)cult to predict the starting time
schemeimprovesoverthe previousonebyaddressing of a key chain when the sensor nodes are initialized.
some of its limitations. If the starting time is set too early, the sensor nodeswillhavetoperformalargenumberofpseudorandom level key chain for each time interval I by randomly
i
function operations in order to authenticate the (cid:12)rst picking K and computing K = F (K ) for
i;m i;j 1 i;j+1
broadcast message. In addition, the key chain must j = 0;:::;m(cid:0)1, where F is a pseudo random func-
1
be fairly long so that it does not run out before the tion. ThekeyK isintendedforauthenticatingmes-
i;j
sensor nodes’ life time ends. If the starting time is sages broadcasted during the time interval I . The
i;j
set too late, messages broadcasted before it cannot startingtimeofthekeychainhK iispredetermined
i;0
be authenticated via (cid:22)TESLA. as T . The disclosure lag for the low-level key chains
i
These problems make this simple scheme not a can be determined in the same way as (cid:22)TESLA and
practical one. In the following, we propose several TESLA[10,13]. Forsimplicity,weassumeallthelow-
additional techniques so that we not only avoid the level key chains use the same disclosure lag d. Fur-
problems of unicast-based distribution of key com- therassumethatmessagesbroadcastedduringI are
i;j
mitment, but also those of the simple scheme. indexed as (i;j). Thus, the security condition for a
messageauthenticatedwithK andreceivedattime
i;j
3.2.SchemeII:NaiveTwo-LevelKeyChains tis: i0 <(i(cid:0)1)(cid:3)m+j+d,wherei0 =bt(cid:0)T1+(cid:14)Maxc+1,
(cid:1)1
and(cid:14) isthemaximumclockdiscrepancybetween
Max
The essential problem of scheme I lies in the fact
the base station and the sensor node.
thatitisimpossibletousebothashortkeychainand
When sensor nodes are initialized, their clocks are
short time intervals to cover a long period of time.
synchronized with the base station. In addition, the
This con(cid:13)ict can be mitigated by using two levels of
startingtimeT ,thecommitmentK ofthehigh-level
1 0
key chains.
keychain,theduration(cid:1) ofeachhigh-leveltimein-
0
The two-levelkeychainsconsist of ahigh-levelkey
terval, the duration (cid:1) of each low-level time inter-
1
chainandmultiplelow-levelkeychains. Thelow-level
val, the disclosure lag d for the low-level key chains,
key chains are intended for authenticating broadcast
and the maximum clock discrepancy (cid:14) between
Max
messages, while the high-level key chain is used to
the basestationandthe sensornodesthroughoutthe
distribute and authenticate commitments of the low-
life time of the sensor network are distributed to the
levelkeychains. The high-levelkeychainusesalong
sensors.
enough interval to divide the time line so that it can
In order for the sensors to use the low-level key
cover the life time of a sensor network without hav-
chainhK iduringthetimeintervalI ,theymustau-
i;0 i
ing too many keys. The low-level key chains have
thenticate the commitment K . We propose to use
i;0
short enough intervals so that the delay between the
the immediate authentication extension to TESLA
receipt of broadcast messages and the veri(cid:12)cation of
[11]toachievethispurpose. Speci(cid:12)cally,thebasesta-
the messages is tolerable.
tion broadcasts a commitment distribution message,
The life time of a sensor network is divided into n
denotedasCDM ,duringeachtimeintervalI . This
i i
(long) intervals of duration (cid:1) , denoted as I , I , ...,
0 1 2 message consists of the commitment K of the
i+1;0
and I . The high-level key chain has n+1 elements
n low-level key chain hK i, the image H(K ) of
i+1;0 i+2;0
K , K , ..., K , which are generated by randomly
0 1 n the commitment K , where H is a pseudo ran-
i+2;0
picking K and computing K = F (K ) for i =
n i 0 i+1 dom function, andthe keyK i(cid:0)1 in the high-levelkey
0;1;:::;n(cid:0)1, where F is a pseudo random function.
0 chain.
The key K is associated with each time interval I .
i i
We denote the starting time of I i as T i. Thus, the Base Station ! Sensors : CDM i =
starting time of the high-level key chain is T 1. ijK i+1;0jH(K i+2;0)jMAC K0(ijK i+1;0jH(K i+2;0))
Sincethedurationofthehigh-leveltimeintervalsis jK i(cid:0)1,where\j"denotesmi essageconcatenation,
usuallyverylongcomparedtothe networkdelayand andK0 isderivedfromK withapseudorandom
i i
clockdiscrepancies,wechoosetodiscloseahigh-level function other than F and F .
0 1
keyK used forI in the followingtime intervalI .
i i i+1
Thus,weusethefollowingsecurityconditiontocheck Thus, to use a low-level key chain hK i during
i;0
whether the base station has disclosed the key K I , the base station needs to generate the key chain
i i
when asensornode receivesamessageauthenticated during I i(cid:0)2 and distribute H(K i;0) in CDM i(cid:0)2, and
withK
i
attimet: t+(cid:14)
Max
<T i+1,where(cid:14)
Max
isthe further distribute K
i;0
in CDM i(cid:0)1.
maximumclockdiscrepancybetweenthebasestation Since K is disclosed in CDM during the time
i i+1
and the sensor node. interval I , each sensor needs to store CDM until
i+1 i
Each time interval I is further divided into m it receives CDM . Each sensor also stores a key
i i+1
(short) intervals of duration (cid:1) 1, denoted as I i;1, I i;2, K j, which is initially K 0. After receiving K i(cid:0)1 in
..., I . If needed, the base station generates a low- CDM , the sensor authenticates it by verifying that
i;m iF
1i(cid:0)1(cid:0)j(K
i(cid:0)1) = K j. Then the sensor replaces the cate a stored message as long as it receives a later
current K j with K i(cid:0)1. key. Second, if CDM i(cid:0)1 does not reachasensor,the
Assume a sensor can receive all the commitment sensor will not be able to use the key chain hK i
i;0
distribution messages. The sensor can authenticate for authentication during the entire time interval I ,
i
the commitment K
i;0
during I i(cid:0)1, once it receives which is usually verylong to makethe high-level key
CDM i(cid:0)1. Suppose a sensor has received CDM i(cid:0)2. chain short.
UponreceivingCDM i(cid:0)1,thesensorcanauthenticate Toaddressthe (cid:12)rstproblem,weproposetofurther
CDM i(cid:0)2 with K i(cid:0)1 disclosedin CDM i(cid:0)1. Then the connectthelow-levelkeychainstothehigh-levelone.
sensorcanimmediatelyauthenticateK byverifying Speci(cid:12)cally, instead of choosingeach K randomly,
i;0 i;m
that applying H to K i;0 in CDM i(cid:0)1 results in the wederiveeachK i;mfromahigh-levelkeyK i+1,which
same H(K i;0) included in CDM i(cid:0)2. As a result, the is to be used in the next high-level time interval,
sensor can authenticate broadcast messages sent by through another pseudo random function F . That
01
the base station using the (cid:22)TESLA key chain hK i is, K = F (K ). As a result, a sensor can re-
i;0 i;m 01 i+1
during the time interval I . coveranyauthenticationkeyK aslongasitreceives
i i;j
This scheme uses (cid:22)TESLA in two di(cid:11)erent lev- acommitmentdistributionmessagethatdisclosesK i0
els. The high-level key chain relies on the initial- with i0 >=i+1, even if it does not receive any later
ization phase of the sensor nodes to distribute the low-levelkeyK i;j0 withj0 >=j. Thus,the(cid:12)rstprob-
key chain commitment, and it only has a single key lem can be resolved. Figure 3 illustrates this idea.
chain throughout the life time of the sensor network. The second problem does not have an ultimate so-
Thelow-levelkeychainsdependonthehigh-levelkey lution; if the base station cannot reach a sensor at
chain to distribute the commitments. Figure 1 illus- allduringatime interval I ,CDM willnotbedeliv-
i i
tratesthe two-levelkeychains,andFigure2displays eredtothesensor. However,theimpactoftemporary
the key disclosure schedule for the keys in these key communication failures can be reduced by standard
chains. fault tolerant approaches.
Thetwo-levelkeychainsschememitigatestheprob- Tomitigatethesecondproblem,weproposetohave
lem encountered in scheme I. On the one hand, by the base station periodically broadcast the commit-
having long time intervals, the high-level key chain ment distribution message during each time interval.
cancoveralongperiodoftimewithouthavingavery Assuming that the frequency of this broadcast is F,
long key chain. On the other hand, the low-level key each commitment distribution message is therefore
chain has short time intervals so that authentication broadcasted F (cid:2)(cid:1) times. To simplify the analysis,
0
of broadcastmessagesdoesn’thavetobedelayedtoo we assume the probability that a sensor cannot re-
much. ceive a broadcastof a commitment distribution mes-
Similar to (cid:22)TESLA and TESLA, a sensor can de- sageisp . Thus,theprobabilitythatasensorcannot
f
tect forged messages by verifying the MAC with the receiveanycopyofthecommitmentdistributionmes-
corresponding authentication key once the sensor re- sage is reduced to
pF(cid:2)(cid:1)0.
f
ceives it. In addition, replay attacks can be easily Note that even if a sensor cannot receive any com-
defeatedifasequencenumberisincludedineachmes- mitment distribution message during a time interval
sage. I , it still has the opportunity to authenticate broad-
i
cast messages in time intervals later than I . Not
i+1
3.3. Scheme III: Fault Tolerant Two-Level Key havingthe commitment distribution messagein time
Chains intervalI onlypreventsasensorfromauthenticating
i
broadcast messages during I . As long as the sen-
i+1
Scheme II does not toleratemessageloss as well as
sor gets a commitment distribution message, it can
(cid:22)TESLAandTESLA.Therearetwotypesofmessage
derive all the low-level keys in the previous time in-
losses: the loss of normal messages, and the loss of
tervals.
commitment distribution messages. Both may cause
By periodically broadcasting commitment distri-
problems for scheme II. First, the low-level keys are
bution messages, scheme III introduces more over-
not entirely chained together. Thus, loss of key dis-
head than scheme II. Let’s consider the overhead on
closuremessagesforlaterkeysinalow-levelkeychain
the basestation,the sensors,andthe communication
cannotberecoveredevenifthesensorcanreceivekeys
channel,respectively. ComparedwithSchemeII,this
in somelaterlow-levelkeychains. As aresult, asen-
scheme increases the overhead of the base station by
sormaynotbeabletoauthenticateastoredmessage
F (cid:2)(cid:1) times. Base stations in a sensor network are
0
evenif itreceivessomekeydisclosuremessageslater.
usually much more powerful than the sensor nodes.
In contrast, with (cid:22)TESLA a receiver can authenti-(cid:0)
(cid:0)(cid:2)
(cid:1)(cid:3)
(cid:11)(cid:15)(cid:10)(cid:12)
(cid:1)(cid:3)(cid:9)(cid:4) (cid:17)
(cid:10)
(cid:16)(cid:18)
(cid:16)
(cid:17)
(cid:0)
(cid:4)
(cid:1)(cid:3)(cid:9)(cid:4) (cid:4)
(cid:10)
(cid:16) (cid:4)
(cid:0) (cid:1)(cid:3)(cid:5)(cid:4)
(cid:10)(cid:11)
(cid:16)
(cid:0)(cid:2)
(cid:4)
(cid:1)(cid:3)(cid:5)(cid:4)
(cid:8)(cid:8)(cid:8)
(cid:8)(cid:8)(cid:8)
(cid:16) (cid:4)
(cid:0)(cid:2)
(cid:0) (cid:1)(cid:3)(cid:5)(cid:4)
(cid:10)(cid:12)
(cid:1) (cid:17)
(cid:10)
(cid:16)(cid:18)
(cid:16)
(cid:17)
(cid:0)
(cid:4)
(cid:1) (cid:4)
(cid:10)
(cid:16) (cid:4)
(cid:0) (cid:1)
(cid:10)(cid:11)
(cid:19)(cid:21)
(cid:0)(cid:2)
(cid:16)
(cid:20)(cid:22)(cid:24)
(cid:1)
(cid:4)
(cid:23)
(cid:8)(cid:8)(cid:8)
(cid:8)(cid:8)(cid:8)
(cid:16) (cid:4)
(cid:0)
(cid:0)(cid:2)
(cid:1)
(cid:10)(cid:12)
(cid:1)(cid:13)(cid:14) (cid:4) (cid:17)
(cid:10)
(cid:16)(cid:18)
(cid:16)
(cid:17)
(cid:0)
(cid:4)
(cid:1)(cid:13)(cid:14)
(cid:16)
(cid:4) (cid:4)
(cid:10)
(cid:4)
(cid:0) (cid:1)(cid:13)(cid:14) (cid:4)
(cid:10)(cid:11)
(cid:0)(cid:2)
(cid:16)
(cid:1)(cid:6)(cid:7)
(cid:4)
(cid:4)
(cid:8)(cid:8)(cid:8)
(cid:8)(cid:8)(cid:8)
(cid:16) (cid:4)
(cid:0)
(cid:0)(cid:2)
(cid:1)(cid:13)(cid:14)
(cid:1)(cid:13)(cid:26)
(cid:16)(cid:18)
(cid:4)
(cid:10)(cid:12)
(cid:25) (cid:17)
(cid:10)
(cid:17)
(cid:16)(cid:27) (cid:4)
Figure 1. The two levels of key chains in Scheme II. Each key K is used for the high-level time interval I ,
i i
andeachkeyK isusedforthelow-leveltimeintervalI . F andF aredi(cid:11)erentpseudorandomfunctions.
i;j i;j 0 1
Each commitment K
i;0
is distributed during the time interval I i(cid:0)1.
?%@I HK
9: 4<;> =(cid:7) ?%@A ;C B1 DC 7E @G F
?%@I HK J<?(cid:5)7M LN 7O ?/ PA 7M QN ;
9: 4(cid:15);W V(cid:15)D, 4XY B/ V%4%@/ Z[ @G F
J(cid:15)?(cid:5)7 LN 7(cid:7) ?A =O @/ 6(cid:24) 6\ 4(cid:5)V%6(cid:24)
9: 4<;> =(cid:7) ?%@A ;C B1 DC 7E @G F
R R4(cid:5)S J(cid:15)?(cid:5)7 LT 7O ?2 P1 7(cid:26) QU ;
7O ZI V, ;
*
(cid:28)(cid:26) (cid:29)
(cid:30)(cid:31)
(cid:29)- )
(cid:31)&(cid:30)#/ .0 (cid:31)
*
(cid:29)(cid:28)
(cid:28) (cid:29) ((cid:9)((
(cid:30)!
((cid:9)((
(cid:29)- ) ((cid:9)((
(cid:31)%(cid:30)#1 .0 !
*(cid:27) (cid:29))
(cid:31)%(cid:30)+
(cid:29)-*
(cid:31)
(cid:28)"
*
(cid:29)
(cid:30)#
(cid:29)
(cid:30)#2 .0
*
(cid:28)" (cid:29)$
(cid:29)
(cid:30)#2
(cid:31)%(cid:30)(cid:31)
)
.0 (cid:31)
*
(cid:28) (cid:29)$
(cid:29)
(cid:30)#/
(cid:28)
(cid:31)&(cid:30)!
)
.0
*(cid:27)
(cid:29))
(cid:31)
!
(cid:29))
!, (cid:30)+
(cid:29)*
(((cid:5)(
(((cid:5)(
(((cid:5)( *
(cid:28) (cid:29)$
(cid:31)’(cid:30)#
(cid:29))
(cid:31)%(cid:30)#/ .0
35 4(cid:5)68 7
Figure 2. Key disclosure schedule in Scheme II
Thus, the increased overhead on base stations may receive any of the 10 commitment distribution mes-
notbeabigproblemaslongasF(cid:2)(cid:1) isreasonable. sages is
pF(cid:2)(cid:1)0
<0:1%. Further assume that (cid:1) is 1
0 f 0
The sensors are a(cid:11)ected much less than the base minutes,whichisquiteshortastheintervallengthfor
station in a benign environment, since each sensor the high-level key chain. Thus, there is one commit-
only needs to process one commitment distribution mentdistributionmessageper6seconds. Assumethe
messageforeachtimeinterval. Thus,thesensorshave bandwidthis10Kbpsandeachcommitmentdistribu-
roughlythe sameoverheadasin schemeII. However, tion messageis 41bytes = 328 bits, as in ourexperi-
we will show that a sensor has to take a di(cid:11)erent ments (Section 4). Then the relative communication
strategy in a hostile environment in which there are overhead is 328 = 0:53%. Therefore, scheme III
10240(cid:2)6
DOSattacks. Wewilldelaythediscussionofsensors’ introduces very reasonable communication overhead
overheaduntil we introduce our counter measures. in typical sensor networks.
The overheadon the communication channel is in- One limitation of Scheme III is that if a sensor
creased by F (cid:2)(cid:1) times, since the commitment dis- missesallcopiesofCDM duringthetimeintervalI ,
0 i i
tribution message for each time interval is repeated itcannotauthenticateanydatapacketsreceiveddur-
F (cid:2)(cid:1) times. Assume the probability that a sensor ing I before it receivesan authentic K , j >i+1.
0 i+1 j
cannotreceivea commitment distribution messageis (Note thatthe sensordoesnothavetoreceiveanau-
p = 1=2 and F (cid:2)(cid:1) = 10. Under our simpli(cid:12)ed thentic CDM message. As long as the sensor can
f 0
assumption, the probability that the sensor cannot authenticate a high-level key K with j > i+1, it
j(cid:0)
(cid:0)
(cid:1)(cid:3)
(cid:11)(cid:16)(cid:10)(cid:12)
(cid:1)(cid:3)(cid:5)(cid:4) (cid:18)
(cid:10)
(cid:17)(cid:19) (cid:18)
(cid:17) (cid:18)(cid:20) (cid:4)
(cid:0) (cid:1)(cid:3)(cid:9)(cid:4) (cid:4)
(cid:10)
(cid:17) (cid:4)
(cid:17) (cid:4)
(cid:0) (cid:1)(cid:3)(cid:5)(cid:4)
(cid:10)(cid:11)
(cid:17)
(cid:0)(cid:2)
(cid:4)
(cid:1)(cid:3)(cid:5)(cid:4)
(cid:8)(cid:8)(cid:8)
(cid:8)(cid:8)(cid:8)
(cid:17) (cid:4)
(cid:0)(cid:2)
(cid:0) (cid:1)(cid:3)(cid:5)(cid:4)
(cid:10)(cid:12)
(cid:1) (cid:18)
(cid:10)
(cid:17)(cid:19) (cid:18)
(cid:17) (cid:18)(cid:20)
(cid:0)
(cid:17) (cid:4)
(cid:4)
(cid:1) (cid:4)
(cid:10)
(cid:17) (cid:4)
(cid:0) (cid:1)
(cid:10)(cid:11)
(cid:21)(cid:23)
(cid:0)(cid:2)
(cid:17)
(cid:22)(cid:24)(cid:26)
(cid:1)
(cid:4)
(cid:25)
(cid:8)(cid:8)(cid:8)
(cid:8)(cid:8)(cid:8)
(cid:17) (cid:4)
(cid:0)
(cid:0)
(cid:1)
(cid:10)(cid:12)
(cid:1)(cid:13)(cid:14) (cid:4) (cid:18)
(cid:10)
(cid:17)(cid:19)
(cid:17)
(cid:17)
(cid:18)
(cid:18)(cid:20)
(cid:0)
(cid:4)
(cid:4)
(cid:1)(cid:13)(cid:14)
(cid:17)
(cid:4) (cid:4)
(cid:10)
(cid:4)
(cid:0) (cid:1)(cid:13)(cid:14) (cid:4)
(cid:10)(cid:11)
(cid:0)(cid:2)
(cid:17)
(cid:1)(cid:6)(cid:7)
(cid:4)
(cid:4)
(cid:8)(cid:8)(cid:8)
(cid:8)(cid:8)(cid:8)
(cid:17) (cid:4)
(cid:0)
(cid:0)
(cid:1)(cid:13)(cid:15)
(cid:1)(cid:13)(cid:28)
(cid:17)(cid:19)
(cid:4)
(cid:10)(cid:12)
(cid:27) (cid:18)
(cid:10)
(cid:18)
(cid:17)
(cid:17)
(cid:18)(cid:20)
(cid:4)
(cid:4)
Figure 3. The two levels of key chains in Scheme III. It di(cid:11)ers from Figure 1 in that each K is derived from
i;m
K using an additional pseudo random function F .
i+1 01
can derive the low-level keys through the pseudoran- niquessuchasfrequencyhoppingiftheattackercom-
dom function F .) Since the earliest high-level key pletely jam the communication channel. This is out
01
K that satis(cid:12)es j > i+1 is K , and K is dis- of the scope of this paper. The attacker may also
j i+2 i+2
closed during I , the sensor has to bu(cid:11)er the data jam the communication channel only when the com-
i+3
packetsreceivedduringI forat least the duration mitmentdistributionmessagesarebeingtransmitted.
i+1
of one high-level time interval. If the attacker can predict the schedule of such mes-
sages, it would be much easier for the attacker to
3.4.SchemeIV:(Final)Two-LevelKeyChains
disrupt such message transmissions. Thus, the base
In schemeIII, the usabilityof alow-levelkeychain station needs to send the commitment distribution
depends on the authentication of the key chain com- messages randomly or in a pseudo random manner
mitmentcontainedinthecorrespondingcommitment that cannot be predicted by an attacker that is un-
distribution message. A sensor cannot use the low- aware of the random seed. For simplicity, we assume
levelkeychainhK iforauthenticationbeforeitcan thatthebasestationsendsthecommitmentdistribu-
i;0
authenticateK
j;0
withj (cid:21)idistributedinCDM j(cid:0)1. tion messages randomly.
This makes the commitment distribution messages An attacker may forge commitment distribution
attractive targets for attackers. An attacker may message to confuse the sensors. If a sensor does not
disrupt the distribution of commitment distribution have a copy of the actual CDM i, it will not be able
messages, and thus prevent the sensors from authen- to get the correct K i+1;0, and cannot use the low-
ticating broadcast messages during the correspond- levelkeychainhK i+1;0iduringthetimeintervalI i+1.
ing high-leveltime intervals. Although the high-level Although the immediate authentication extension to
keychainandthelow-levelonesarechainedtogether, TESLA proposed in [11] is intended to deter a sim-
and such sensors may store the broadcast messages ilar DOS attack, it cannot defeat the above attack
andauthenticatethemoncetheyreceivealatercom- completely.
mitment distribution message,the delaybetweenthe Consider a commitment dis-
receipt and the authentication of the messages may tribution message: CDM i =
introduceaproblem: Indeed,anattackermaysenda ijK i+1;0jH(K i+2;0)jMAC K0(ijK i+1;0jH(K i+2;0))jK i(cid:0)1.
i
large amount of forged messages to exhaust the sen- Once seeing such a message, the attacker
sors’bu(cid:11)erbeforethey canauthenticatethe bu(cid:11)ered learns K i(cid:0)1 and K i+1;0. Then the at-
messages, and force them to drop some authentic tacker can replace the actual H(K i+2;0) with
messages. H(K i0 +2;0), and forge another message: CDM i0 =
The simplest way for an attacker to disrupt the ijK i+1;0jH(K i0 +2)jMAC K i0(ijK i+1;0jH(K i+2;0))jK i(cid:0)1.
commitmentdistributionmessagesistojamthecom- Assume a sensor has an authentic copy of CDM i(cid:0)1.
munication channel. We may have to resort to tech- The sensor can verify K i(cid:0)1 and K i+1;0 with K i(cid:0)2and H(K i+1;0), respectively, since both K i(cid:0)2 and timeintervalI ibyusingtheaforementionedtwotests.
H(K i+1;0) are included in CDM i(cid:0)1. However, the
sensor has no way to verify the authenticity of 3.4.1 Single Bu(cid:11)er Random Selection
H(K0 ). If the sensor does not save an authentic
i+2
copy of CDM that contains the correct H(K ), Let us (cid:12)rst look at a simple strategy: single bu(cid:11)er
i i+2;0
it cannotauthenticate K in CDM duringthe randomselection. Assumethateachsensornodeonly
i+2;0 i+1
time interval I . If the sensor node further misses has one bu(cid:11)er for the commitment distribution mes-
i+1
the chance to get a copy of CDM that contains sage broadcasted in each time interval. In a time in-
i+1
the authentic K i+2;0, then it cannot use the key tervalI i,eachsensornoderandomlyselectsonemes-
chain hK i+2;0i during the time interval I i+2. sagefromallthecopiesofCDM i. Thekeyissuehere
One possible counter measure is to distribute each is to make sure all copies of CDM i have equal prob-
K
i;0
in some earlier time intervals than I i(cid:0)1. The ability to be selected. Otherwise, an attacker who
bene(cid:12)t is that before the time interval I , a sensor knows the protocol may take advantage of the un-
i
thathasreceivedthecorrespondingcommitmentdis- equal probabilities and make a forged commitment
tribution message can authenticate K even if it distribution message be selected.
i;0
doesn’t have H(K i;0). However, this doesn’t solve To achieve this goal, for the kth copy of CDM i a
alltheproblem. Ifasensordoesn’thaveanauthentic sensor node receives during the time interval I i, the
copy of the commitment distribution message, it can sensor node savesit in the bu(cid:11)er with probability 1.
k
nevergetthe correctK i;0. Totakeadvantageof this, Thus, asensornodewill savethe(cid:12)rstcopyofCDM i
anattackercansimplyforgecommitmentdistribution inthebu(cid:11)er,substitutethesecondcopyforthebu(cid:11)er
messages as discussed earlier. withprobability1=2,substitutethethirdcopyforthe
We proposearandom selectionmethod toimprove bu(cid:11)er with probability 1=3, and so on. It is easy to
the reliable broadcast of the commitment distribu- verifythatifasensornodereceivesncopiesofCDM i,
tionmessages. FortheCDM messagesreceiveddur- all copies have the same probability 1=n to be kept
i
ing each time interval I , each sensor (cid:12)rst tries to in the bu(cid:11)er.
i
discard as many forged messages as possible. There Theprobabilitythatasensornodehasanauthentic
are two ways for a sensor to identify forged CDM i copyofCDM i canbeestimatedasP(CDM i)=1(cid:0)p,
message during I i. First, the sensor can verify if wherep= # #f to or tg ae ld coco pp iei ses. Tomaximizehisattack,an
F 0i(cid:0)1(cid:0)j(K i(cid:0)1) = K j, where K i(cid:0)1 is the high-level attackerhastosendasmanyforgedcopiesaspossible.
key disclosed in CDM and K is a previously dis-
i j
closed high-level key. Messages that fail this test are 3.4.2 Multiple Bu(cid:11)er Random Selection
certainly forged and should be discarded. Second, if
The single bu(cid:11)er random selection can be easily im-
a CDM passesthe (cid:12)rst test, the sensoruses the key
i
provedbyhavingsomeadditionalbu(cid:11)ersforthecom-
K i(cid:0)1 disclosed in CDM i to authenticate a CDM i(cid:0)1
mitment distribution messages. Assume there are m
message it has received during I i(cid:0)1. If the sensor
bu(cid:11)ers. During each time interval I , a sensor node
can authenticate CDM i(cid:0)1, it can further authenti- i
can save the (cid:12)rst m copies of CDM . For the kth
cate K in CDM with H(K ) contained in i
i+1;0 i i+1;0
copywithk >m,the sensornodekeepsitwith prob-
CDM i(cid:0)1. The sensor can discard the CDM
i
mes-
ability m. If a copy is to be kept, the sensor node
sage if it fails this test. k
randomly selects one of the m bu(cid:11)ers and replaces
Thesetwotestscan(cid:12)lteroutsomeforgedmessages;
the corresponding copy. It is easy to verify that if
however, they do not rule out all forged messages,as
a sensor node receives n copies of CDM , all copies
discussed earlier. To further improve the possibility i
havethe same probability m to be kept in one ofthe
thatthe sensorhasanauthenticCDM i message,the n
bu(cid:11)ers.
basestationuses arandomselection method tostore
During the time interval I , the sensor node can
the CDM messages that pass the above two tests. i+1
i
verify if it has an authentic copy of CDM once it
Our goal is to make the DOS attack so di(cid:14)cult that i
receivesandweaklyauthenticatesacopyofCDM .
the attacker would rather use constant signal jam- i+1
Speci(cid:12)cally,thesensornodeusesthekeyK disclosed
ming instead to attack the sensor network. Some of i
in CDM to verifythe MAC of the bu(cid:11)ered copies
the strategiesare also applicable to the low-level key i+1
ofCDM . Onceit(cid:12)ndsanauthenticcopy,thesensor
chainsaswellasthe(extended)TESLAand(cid:22)TESLA i
node can discard all the other bu(cid:11)ers. Note that if
protocols.
this happens, the sensor node can authenticate the
Without loss of generality, we assume that each
content of CDM immediately.
copy of CDM has been weakly authenticated in the i+1
i
If the sensornode cannot(cid:12)nd anauthenticcopyofCDM after the above veri(cid:12)cation, it can conclude ferent levels of key chains so as to reduce the com-
i
that all bu(cid:11)ered copies of CDM are forged and dis- munication cost. Nevertheless, having more levels of
i
card all of them. The sensor node then needs to re- key chains does increase the overhead at both the
peat the random selection process for the copies of base station and the sensor nodes. Though devot-
CDM . Thus, a sensor node needs at most m+1 ingmoreresourcesformulti-levelkeychainsmaynot
i+1
bu(cid:11)ers for commitment distribution messages with be a problem for the base station, the resource con-
this strategy: m bu(cid:11)ers for copies of CDM , and strained sensor nodes have to maintain more bu(cid:11)ers
i
one bu(cid:11)er for the (cid:12)rst weakly authenticated copy of for the key chain commitments as well as CDM mes-
CDM . sages at di(cid:11)erent levels. In addition, the more levels
i+1
Withmbu(cid:11)errandomselectionstrategy,theprob- we have, the morebandwidth is required to transmit
ability that a sensor node has an authentic copy of the CDM messages. Thus, we want as few levels as
CDM can be estimated as P(CDM ) = 1 (cid:0) pm, possible to cover the life time of a sensor network.
i i
where p= #forged copies.
#total copies
4. Experiments
3.5.SchemeV:Multi-LevelKeyChains
We have done a proof-of-concept implementation
SchemeIVcanbeeasilyextendedtoanm-levelkey of the multi-level key chain scheme. (Note that the
chain scheme. The m-level key chains are arranged two-level key chain scheme is a special case of the
from level 0 to level m(cid:0)1 from top down. The keys multi-level one.) To save development time, we im-
in the (m(cid:0)1)-level key chains are used for authen- plementedtheschemeinJavaonthebasisofabroad-
ticating data packets. Each higher-level key chain is cast channelemulated with IP multicast. The imple-
used to distributed the commitments of the immedi- mentation involves a base station and multiple sen-
ately lower-level key chains. Only the last key of the sor nodes. The broadcast channel has a (cid:12)xed band-
top-level(level 0) keychain needs to be selected ran- width shared by all the components. This is im-
domly; all the other keys in the top-level key chain plemented by having all the components check the
canbegeneratedfromthiskey,andallthekeychains channel availability before they send a message. The
in level i, 1 < i (cid:20) m (cid:0) 1 are generated from the broadcast channel is lossy with a message loss rate
keysinlevel i(cid:0)1,in the samewaythat the low-level r . Thisissimulatedbyhavingeachsensornodedrop
l
key chains are generated from the high-level keys in the received messages with probability r . Following
l
thetwo-levelkeychainscheme. Eachhigher-levelkey [13], we implemented pseudo random functions with
chainisresponsibleforbroadcastingcommitmentdis- a Message Authentication Code (MAC), which was
tributionmessagestodistributethecommitmentsfor implemented using the CBC-MAC [17] with RC5 as
the immediately lower-level key chains. For security the blockcipher [14]. Ourexperiments useRC5with
concern, we need a family of pseudo random func- 32 bit words, 12 rounds, and 8 byte keys.
tions. Thepseudorandomfunctionforeachleveland In ourexperiments, we assumed a separatescheme
betweenadjacentlevelsshouldbedi(cid:11)erentfromeach to ensure the maximum time di(cid:11)erence between the
other. Sucha familyof pseudorandom functions has base station and the sensorsas in [13]. Moreover,we
been proposed in [10]. Similar to scheme IV, we also did notattempt tocontrolthenetworkdelay,though
use multiple bu(cid:11)er random selection mechanism for network delay is indeed introduced by IP multicast,
the bu(cid:11)ering of CDM packets. which was used to simulate the broadcast media. In
The bene(cid:12)t of havingmulti-levelkeychains isthat a typical sensor network, we believe the network de-
it requires less number of keys in each key chain, or lay will be larger than what we encountered in our
equivalently,shorterdurationateachkeychainlevel, experiments, and thus will reduce the number of safe
compared with the two-level key chain scheme. As a packets.
result, scheme V can scale up to long period of time. To further study the performance of the scheme
Compared with scheme IV, the multi-level key in presence of attacks, we also implemented an at-
chain scheme is not more vulnerable to the DOS at- tacker component, which listens to the CDM mes-
tacks. The success of the DOS attacks depends on sages broadcasted by the base station and inserts
percentage of forged CDM messages and the bu(cid:11)er forged CDM messages into the broadcast channel
capacity in sensor node. As long as the base sta- to disrupt the broadcast authentication. We assume
tionmaintainsacertainauthenticCDMmessagerate, that the attacker is intelligent in that it uses every
scheme V will not have higher percentage of forged pieceofauthenticinformationthatasensornodecan
CDM messages than scheme IV. The base station determine in the forged messages. That is, it only
can further piggy-back the CDM messages for dif- modi(cid:12)es the image H(K ) in a CDM message,
i+2 isince any other modi(cid:12)cation can be detected by a the following parameters on these performance met-
sensor node immediately. There are other attacks rics: sensor node’s bu(cid:11)er size for data and CDM
against the scheme. Since they are either defeatable messages,percentageofforgedCDM packetsandthe
by the scheme (e.g., reply attacks, modi(cid:12)cation of packet loss rate.
data packets), or not speci(cid:12)c to our extension (e.g., Becauseof the extremelylimited memoryavailable
DOS attacks against the data packets), we do not onsensornodes,thebu(cid:11)erallocationfordatapackets
consider them in our implementation. and CDM messages becomes a major concern when
We haveperformed aseriesof experimentsto eval- we deploy a real sensor network. We evaluate the
uate the performance of the scheme when there are performance of di(cid:11)erent memory allocation schemes
packetlossandDOSattacksagainstCDM messages. with a memory constraint. In our implementation,
The focus of the evaluation is on the overall e(cid:11)ec- a data packet consists of 65 bytes, which includes a
tivenessoftheproposedtechniques(e.g.,multi-bu(cid:11)er packet header (1 bytes), an index (8 bytes), data (40
random selection) in tolerating packet loss and DOS bytes), MAC (8 bytes) and a disclosed key (8 bytes).
attacks, and the impact of di(cid:11)erent choices of cer- A CDM packet is 41 bytes long, which includes a
i
tainparameters(e.g.,bu(cid:11)ersize,percentageofforged packet header (1 byte), a level number and an in-
CDM packets). dex (8 bytes together), next commitment K (8
i+1;0
To concentrate on the design decisions we made in bytes), H(K ) (8 bytes), a MAC (8 bytes), and a
i+2;0
our schemes, we (cid:12)x the following parameters in all disclosedkey(8bytes). However,whenasensornode
the experiments. We assume the bandwidth of the receives a data packet, it does not need to bu(cid:11)er the
broadcast channel is 10Kbps, according to [13]. We header and the disclosed key for future authentica-
only performed the experiments with the two-level tion; only the other 56 bytes need to be stored. For
key chain scheme, since multi-level key chain scheme CDM packets, all copies of the same CDM message
is a direct extension to two-level key chain, and its havethesamevaluesforthe(cid:12)eldsotherthantheim-
onlypurposeistoscaleuptolongperiodoftime. We age of commitment (i.e., H(K ) in CDM ), since
i+2;0 i
assumethe durationof eachlow-leveltime intervalis all forged messages without these values can be (cid:12)l-
100 ms, and each low-level key chain consists of 600 tered out by the weak authentication. As a result,
keys. Thus,the durationofeachtime intervalforthe exceptforthe (cid:12)rstcopyofCDM ,the only(cid:12)eldthat
i
high-levelkeychainis60seconds. Weput200keysin needs saving is H(K ). Therefore, if we already
i+2;0
the high-levelkeychain,whichcoversupto200min- hasone copyof CDM (in which40 bytes need tobe
i
utes in time. We let the base station send 20 CDM saved),weonlyneedtosavethe8bytesofH(K )
i+2;0
messagesperhigh-leveltime intervalwheneverpossi- for the other copies. Assuming the totally available
ble1. Wealsosetthedatapacketsrateatbasestation memory for data and CDM packets is C bytes, and
to100datapacketsperminute. Ouranalysisandex- the sensor node can store up to x data packets, then
perimentsindicatethatthenumberofhigh-levelkeys wecanhavey
=1+bC(cid:0)40(cid:0)56(cid:2)xcforCDM
messages.
8
does not havean obviousimpact on the performance Figure 4 shows the performanceof di(cid:11)erent alloca-
measures. Nevertheless, the life time of the two-level tionschemesundersevereDOSattacksagainstCDM
key chains can be extended by having more keys in messages (95% forged CDM packets). In these ex-
thehigh-levelkeychainoranotherhigherlevelofkey periments, we have total memory of 512 bytes or 1K
chain. Since ourpurposeistostudythe performance bytes. As in Figure 4, three data bu(cid:11)ers (168 bytes)
of the scheme w.r.t. to packet loss and DOS attacks, are enough to authenticate over 95% of the received
we did not do so in our evaluation. data packets. The (cid:12)gure also shows that if the num-
The performance of scheme is evaluated with the ber of data bu(cid:11)ers is too many, having more data
following metrics: average percentage of authenti- bu(cid:11)ers does not increase the performance. Instead,
cateddatapackets(i.e., #authenticated data packets av- it may decrease the performance, since less memory
#received data packets
eragedoverthesensornodes)andaveragedatapacket is left for bu(cid:11)ering the CDM messages.
authentication delay (i.e., the average time between To measure the performance under DOS attacks,
the receipt and the authentication of a data packet). we assume that each sensor node has 512 bytes for
In these experiments, we focused on the impact of bothdataandCDMpackets. Accordingtotheprevi-
ousresult,weallocate168bytesfordatapacketsand
344 bytes for CDM packets so that the sensor node
1We can maintain 20 CDMpackets per high-leveltime in-
canstoreupto3datapacketsand39CDM packets.
tervalwhenthepercentageofforgedCDMmessagesislessthan
orequalto95%. However,whenthispercentage reaches99%, The experimental results are shown in Figures 5(a)
the base station can only send 5 CDM packets per high-level and5(b). Figure5(a)showsthatourschemecantol-
timeintervalonaverage.%Authenticated Data Packets vs. Buffer Allocation Scheme
120
100
80
60
40
20
0
0 2 4 6 8 10 12 14 16 18
#Data Buffers
ataD
detacitnehtuA%
stekcaP
512 Bytes
1024 Bytes
Figure4.Theperformancewithdi(cid:11)erentbu(cid:11)erallocationschemefortotalmemorysizeof512and1024bytes.
Assume 95% of CDM packets are forged.
erateDOSattackstoacertaindegree;however,when at sensor nodes, asymmetric cryptography based so-
there areextremely severeDOS attacks(over95% of lutions [8, 15, 18] are usually impractical for sensor
forgedCDMpackets),theperformancedecreasesdra- networks. In the following, we only review authenti-
matically. This result is reasonable; a sensor node is cation schemes based on symmetric cryptography.
certainlynotabletogetanauthenticCDMmessageif Cheung proposed a scheme (OLSV) based on de-
all of the CDM messages it receives are forged. Nev- layed disclosure of keys by the sender to authenti-
ertheless, an attacker has to make sure he/she sends cate the link-state routing updates between routers
much more forged CDM packets than the authentic [7]. Anderson et al. used the same technique in their
ones to increase his/her chance of success. GuyFawkesprotocoltoauthenticatethemessagebe-
Figure 5(a) also shows that if the base station re- tweentwoparties[1]. However,theirprotocolcannot
broadcast su(cid:14)cient CDM messages so that on aver- tolerate packet loss. Briscoe proposed the FLAMeS
age, at least one copy of such authentic CDM mes- protocol [4], and Bergadano et al. presented an au-
sagecanreachsensornodeinthecorrespondinghigh- thentication protocolformulticast [3]. Both aresim-
level time interval (e.g., when loss rate (cid:20) 70%), the ilartotheOLSVprotocol[7]. Canettietal.proposed
channel loss rate does not a(cid:11)ect our scheme much. to use k di(cid:11)erent keys to authenticate the multicast
When the loss rate is large (e.g., 90% as in Figure messageswithkdi(cid:11)erentMAC’sforsenderauthenti-
5(a)), we can observe the drop of data packet au- cation[5]. But,theirschemehashighcommunication
thenticationratewhenthepercentageofforgedCDM overhead because of the k MAC’s for each message.
packets is low. An interesting result is that the data Perrig[9] introduced a veri(cid:12)cation e(cid:14)cient signature
packet authentication rate begins to increase when schemenamedBiBabasedonone-wayhashfunctions
thepercentageofforgedCDMpacketsincreases. This without trapdoors. The drawback of this scheme is
is because the sensor nodes can get the disclosed key its high signature generation and large communica-
from forged CDM packets when they cannot get it tion overheadfor public key distribution.
from the authentic ones. Perrig et al. proposed two schemes (TESLA and
The channel loss rate does a(cid:11)ect the average au- EMSS) for e(cid:14)cient multicast authentication over
thentication delay, which can be seen in Figure 5(b). lossy channels [10]. TESLA requires loose time syn-
Thereasonisthatasensornodeneedstowaitlonger chronization between sender and receiver, and does
time to get the disclosed key. In addition, the (cid:12)g- not provide non-repudiation. In contrast, EMSS
ure also shows that the percentage of forged CDM doesnotrequiretimesynchronization,butintroduces
message does not have an signi(cid:12)cant impact on the more signatures and communication overhead. Sev-
average data packet authentication delay. eralextensionstoTESLA,suchasimmediateauthen-
tication, multiple concurrent TESLA instances, were
5. Related Work later proposed in [11]. TESLA requires a digital sig-
natureoperationtobootstrapitself, whichisimprac-
Security issues such as broadcastauthentication in ticalinresourceconstrainedsensornetworks. Instead
sensor networks have been investigated by many re- of adigitalsignature,(cid:22)TESLA[13]simply usessym-
searchers [16, 6, 13]. Due to the limited resources%Authenticated Data Packets vs. %Forged CDM Packets
120
100
80
60
40
20
0
0 20 40 60 80 100
%Forged CDM Packets
ataD
detacitnehtuA% stekcaP
Average Data Packet Authentication Delay vs. Channel Loss
Rate 0.1 Loss Rate 0.3 Loss Rate
0.5 Loss Rate 0.7 Loss Rate
0.9 Loss Rate
12
10
8
6
4
2
0
0 0.2 0.4 0.6 0.8 1
Channel Loss Rate
(a)Percentage ofauthenticated data packets
tekcaP
ataD
egarevA
yaleD
noitacitnehtuA )sdnoces(
20% Forged CDM Packets
50% Forged CDM Packets
99% Forged CDM Packets
(b)Averagedatapacket authentication delay
Figure 5. Experimental results under di(cid:11)erent channel loss rate and percentage of forged CDM packets. As-
suming 3 data packet bu(cid:11)ers, 39 CDM bu(cid:11)ers and (cid:12)xed data rate (100 data packets=minute).
metric cryptography to distribute initial parameters 6. Conclusion and Future Work
tothesensornodesindividually. Thedrawbackofthis
solutionisitshighcommunicationoverheadwhenthe
In this paper, we presented a multi-level key chain
number of sensor nodes is large.
scheme to e(cid:14)ciently distribute the key chain com-
Perrigetal.proposedtouseanearlierkeychainto
mitments for the broadcast authentication scheme
distribute the commitments of next one [12]. Multi-
named (cid:22)TESLA. By using pre-determination and
ple early TESLA packets are used to tolerate packet
broadcast, our scheme removed (cid:22)TESLA’s require-
loss. However,sincereliabledistributionoflatercom-
ment of a unicast-based distribution of initial key
mitmentcannotbefullyguaranteed,ifallthepackets
chaincommitments,whichintroduceshighcommuni-
used to distribute commitments are lost (e.g., due to
cation overheadin largedistributed sensornetworks.
temporary network partition), a receiver cannot re-
We also proposed several techniques, including peri-
cover the commitment of the later key chain. As a
odic broadcast of commitment distribution messages
result, the sender and the receivers will have to re-
and random selection strategies, to improve the sur-
peat the costly bootstrap process. In contrast, our
vivability of our scheme and defeat some DOS at-
multi-level commitment distribution scheme allows a
tacks. Ourexperimentsandanalysisshowedthatthe
receivertorecoverthe keychainsevenif allthe com-
resulting scheme satis(cid:12)es several nice properties, in-
mitment distribution messages during one high-level
cluding low overhead,toleranceof messageloss, scal-
time interval are lost, due to the connection between
ability tolargenetworks,and resistanceto replayat-
the higher- and lower-levelkeys.
tacks as well as some known DOS attacks.
(cid:22)TESLA and our proposed scheme do not assume
The limitation of ourscheme is that when asensor
tamper-resistanthardware,anddonotguaranteethe
node doesn’t get a commitment during a time inter-
con(cid:12)dentialityofthebroadcastpackets. Basedonthe
val, it must wait for a long period of time to recover
assumptionof tamper-resistanthardware,Basagniet
from this failure. We will seeksolutionsto this prob-
al. presented a key management scheme to periodi-
leminourfutureresearch. Inaddition,we willstudy
cally update the symmetric keys shared by all sen-
broadcastauthenticationinvolvingmultiplebasesta-
sor nodes [2]. With this key shared among all sen-
tions and the implementation of our scheme in real
sor nodes, authenticated broadcast can be easily im-
sensor networks.
plemented. However, this scheme cannot prevent a
(compromised)sensornodefromsendingforgedmes-
sages if an attacker can reuse the tamper-resistant 7. Acknowledgement
hardware.
The authors would like to thank the anonymous
reviewers for their valuable comments.References [16] F.StajanoandR.Anderson. Theresurrectingduck-
ling: security issues for ad hoc networks. In Proc.
[1] R. Anderson, F. Bergadano, B. Crispo, J.-H. Lee, of Security Protocols: 7th International Workshop,
C. Manifavas, and R. Needham. A new family of
pages 172{194, 1999.
authentication protocols. In Operating Systems Re- [17] U.S.NationalInstituteofStandardsandTechnology.
view, October1998. DES modes of operation. Federal Information Pro-
[2] S.Basagni, K.Herrin,D.Bruschi,andE.Rosti. Se- cessing Standards Publication 81 (FIPS PUB 4-3),
cure pebblenets. In Proceedings of ACM Interna- December 1980.
tional Symposium on Mobile ad hoc networking and [18] C.WongandS.S.Lam. Digital signatures for(cid:13)ows
computing, pages 156{163, 2001. andmulticasts. In Proc. IEEE ICNP’98,1998.
[3] F. Bergadano, D. Cavagnino, and B. Crispo. Indi-
vidualsinglesourceauthenticationonthembone. In A. A Detailed Description of Scheme IV
ICME 2000, August2000.
Initialization
[4] B. Briscoe. Flames: Fast, loss-tolerant authentica-
tion of multicast stream. Technical report, BT Re- Duringtheinitializationphase,allthesensornodes
search, 2000. synchronize their clocks with the base station. (Al-
[5] R. Canetti, J. Garay, G. Itkis, D. Micciancio, ternatively, the base station and all the sensor nodes
M. Naor, and B. Pinkas. Multicast security: A maysynchronizetheir clockswith atime service.) In
taxonomy and some e(cid:14)cient constructions. In In- addition, the basestationgeneratesthefollowingpa-
focom’99, 1999. rameters: (1)the initialrandomkeyK forthehigh-
n
[6] D.Carman,P.Kruus,andB.J.Matt. Constrainsand
levelkeychain;(2)asequenceofkeysK =F (K )
i 0 i+1
approaches for distributed sensor network security.
in the high-level key chain, where i = 0;1;:::;n(cid:0)1,
Technical report, NAILabs, 2000.
andF isapseudorandomfunction; (3)theduration
0
[7] S. Cheung. An e(cid:14)cient message authentication
(cid:1) of each time interval for the high-level key chain;
scheme for link state routing. In 13th Annual Com- 0
(4) the starting time T for the high-level key chain;
puter Security Applications conference, San Diego, 1
(5) duration (cid:1) of the low-level time intervals; (6)
Calif, December1997. 1
the disclosure lag d for the low-level key chains; (7)
[8] R. Gennaro and P. Rohatgi. How to sign digital
streams. Technical report, IBM T.J.Watson Re- the the maximum clock discrepancy(cid:14) Max duringthe
search Center, 1997. life time of the sensor network.
[9] A. Perrig. The biba one-time signature and broad- A constraintfor these parametersis that (cid:1) 1(cid:2)d+
cast authentication protocol. In Proceedings of the (cid:14) <thedurationofthetimeintervalforthehigh-
Max
ACMConferenceonComputerandCommunications level key chain. Otherwise, the disclosure of a high-
Security, November2001. levelkeymaydisclosealow-levelkeythatshouldnot
[10] A. Perrig, R. Canetti, D. Song, and D. Tygar. E(cid:14)- be disclosed.
cientauthenticationandsigningofmulticaststreams
The base station distributes the following parame-
over lossy channels. In Proc. of IEEE Security and
ters to the sensor nodes: (1) K , (2) (cid:1) , (3) T , (4)
Privacy Symposium, May 2000. 0 0 1
(cid:1) ,(5)d,and(6)(cid:14) . Herewepredetermineallthe
[11] A. Perrig, R. Canetti, D. Song, and D. Tygar. E(cid:14)- 1 Max
parametersforthelow-levelkeychainsexceptforthe
cientandsecuresourceauthenticationformulticast.
commitments. Alternatively, we may allow the base
In Proceedings of Network and Distributed System
Security Symposium, February2001. station to dynamically choose these parameters and
[12] A. Perrig and J. T. D. S. R. Canetti, Briscoe. distributethemtothesensorsinthecommitmentdis-
TESLA: Multicast source authentication transform. tribution messages. In this case, the authentication
IRTF draft, draft-irtf-smug-tesla-00.txt, November procedure below should be changed slightly.
2000. Note that the initialization phase does not intro-
[13] A. Perrig, R. Szewczyk, V. Wen, D. Culler, and duce signi(cid:12)cantly more overhead than the original
J. Tygar. Spins: Security protocols for sensor net- (cid:22)TESLA.Intheoriginal(cid:22)TESLA,itisatleastneces-
works. In Proceedings of Seventh Annual Interna-
sarytodistributethemasterkeystothesensornodes
tional Conference on Mobile Computing and Net-
so that the base station shares some common keying
works, July2001.
material with each sensor node. The aforementioned
[14] R. Rivest. The rc5 encryption algorithm. In Pro-
parameters can be distributed to the sensor nodes
ceedings of the 1st International Workshop on Fast
along with the master keys.
SoftwareEncryption,volume809,pages86{96,1994.
Broadcast of Commitment Distribution Mes-
[15] P. Rohatgi. A compact and fast hybrid signature
scheme for multicat packet authentication. In 6th sages
ACMConferenceonComputerandCommunications When the base station needs to broadcast authen-
Security, November1999. ticated messages to the sensors, it generates param-eters for each low-level key chain in a similar way to 4. For each copy c of CDM i(cid:0)1, S authenticates
TESLA and (cid:22)TESLA [10, 11, 13]. Assume the base c by verifying its MAC with K i(cid:0)1 disclosed in
station decides to divide each time interval I into m CDM . Ifthisveri(cid:12)cationfails,S discardscand
i i
smallerintervals,denotedI ,I ,...,I . Thebase continues the veri(cid:12)cation for the next copy of
i;1 i;2 i;m
station generates the low-level key chain by comput- CDM i(cid:0)1. Otherwise, S discards all the other
ing K
i;m
=F 01(K i+1), and K
i;j
=F 1(K i;j+1), where copiesofCDM i(cid:0)1andmakesctheauthenticated
j = 0;1;:::;m(cid:0)1 and F
1
is a pseudo random func- copy of CDM i(cid:0)1.
tion. Thus, the base station has the low-level key
chain hK i. The base station distributes the rele-
5. If S has an authenticated copy of CDM i(cid:0)1, it
i;0
then further authenticates K enclosed in
vantinformationaboutthe low-levelkeychainhK i i+1;0
i;0
CDM by verifying that applying H to K
inCDM i(cid:0)1 duringthetimeintervalI i(cid:0)1,andtheim- i i+1;0
ageof this informationunder a pseudo random func-
results in H(K i+1;0) included in CDM i(cid:0)1. If
this veri(cid:12)cationfails, S simply dropsthe copyof
tion H in CDM i(cid:0)2 during I i(cid:0)2.
CDM andstops. Otherwise,SsavesH(K ).
Each commitment distribution message CDM i i+1;0
i
containsthe index of the high-leveltime interval,the
6. S uses the random selection strategy discussed
commitment of the low-level key chain hK i, the
i+1;0 in3.4todecidewhethertosavethecurrentcopy
image under H of the commitment of hK i, and
i+2;0 ofCDM ornot. (Notethatifthecurrentstepis
i
the high-level authentication key K i(cid:0)1.
beingexecuted,allthecopiesofCDM i(cid:0)1 should
BS ! S : CDM =
i have been discarded.) Further assume the cur-
ijK i+1;0jH(K i+2;0)jMAC
K
i0(ijK i+1;0jH(K i+2;0))jK i(cid:0)1.
rent copy of CDM
i
is the jth copy. If j < m,
The base station randomly chooses F (cid:2)(cid:1) points
0 S still has free bu(cid:11)ers available, and S saves it
during each time interval I , and broadcasts CDM
i i in one of the empty bu(cid:11)ers. Otherwise, S keeps
at these time points.
this copy with the probability m=j, and places
Optionally, the base station may distribute K
1;0 it in a randomly selected bu(cid:11)er (among the m
and H(K ) to the sensors during the initialization
2;0 occupied bu(cid:11)ers).
phase so that the sensors can use the low-level key
chain hK i in the time interval I and authenticate Note that the immediate authentication of K
1;0 1 i+1;0
K upon receiving CDM . inCDM doesnotimplytheauthenticationofCDM
2;0 1 i i
Authentication of Commitment Distribution itself. An attacker can replace H(K ) in CDM
i+2;0 i
Messages and still have the resulting message pass the veri-
Assume that a sensornode S hasm+1 bu(cid:11)ers for (cid:12)cation. Thus, S has to use the random selection
commitment distribution messages. When S receives strategy to save the copies of CDM .
i
a copy of CDM at time t during the time interval Broadcast andAuthentication ofNormalMes-
i i
I ,itprocessesthismessageaccordingtothefollowing sages
i
procedure. Broadcast and authentication of normal messages
are performed in the same way as in the extended
1. S checks the security condition for CDM i, i.e., TESLA [11], except for the distribution of the key
t i +(cid:14) Max < T i+1. S discards the packet and chaincommitments,whichishandledinthedistribu-
stops if the security condition is not held. tion and authentication of commitment distribution
messages.
2. If S has an authenticated copy of CDM i(cid:0)1, S
musthavereceivedapreviouscopyofCDM and
i
saved K i(cid:0)1 and H(K i+1;0). Check whether the
K i(cid:0)1 and H(K i+1;0) in the current CDM i are
the sameasthosesavedcopies. Ifyes, gotostep
6. Otherwise, S discards the messageand stops.
3. S authenticates K i(cid:0)1 against a previously dis-
closed key K j by verifying that K i(cid:0)1 =
Fi(cid:0)1(cid:0)j(K ). (Note that K always exists since
j j
K was distributed to each sensor node during
0
initialization.) Ifthisveri(cid:12)cationfails,Sdiscards
themessageandstops. Otherwise,S replacesK
j
with K i(cid:0)1.