SNDSS ‘98
The Multilayer
Firewall
R
Dan Nessett
Technology Development Center
3Com Corporation
Polar Humenn
BlackWatch TechnologyUsual Disclaimer
This talk describes a prototype
• No commitment by 3Com to turn it into
product.
• No commitment by 3Com to do anything
with technology described in this talk.
Dnessett June 97
2Motivation
Partnering arrangements are a problem
• Survey of 35 fortune 1000 companies
shows 46% give business partners
corporate intranet access
(Forrester Report -
Partners on the Internet).
• Ineffective controls for containing partner
accesses.
Dnessett June 97
3Hypothetical Example
Transmissions Mazda
Ford
Improper
Access
Arvin
Mufflers
Dnessett June 97
4Motivation
Another problem is insider threat
• Estimate 50-70% of security incidents are
by insiders (FBI/CSI report; ASIS
Intellectual Property Report).
• Insiders may violate security for
various reasons:
– Disgruntled employee
– Criminal activity
– The “thrill of hacking”
Dnessett June 97
5What to do?
Need a set of tools :
• Application level - GSSAPI mechanisms,
CORBAsec, PKI (credentials
management), ...
• Session level - TLS (protection of legacy
apps/systems)
• Network level - IPSEC, Firewalls, Routing
security (traffic containment/protection)
Dnessett June 97
6Part of the solution
Extend notion of Firewall into network
• Control traffic in network with network
device (router, switch) filtering.
• Create filter information on central
management system.
• Distribute to network (enforcement)
devices.
Dnessett June 97
7Multilayer Firewall (MLF)
MLF
Management
System
R
Router
Layer 2
Switch
Layer 3
Switch
Layer 2
(QIRUFHPHQW Switch
App-level
’HYLFH
Firewall
Layer 3
Layer 2
Switch
Switch App-level
Firewall Router
Dnessett June 97
8System Architecture
Enforcement devices :
• Filters must have sufficient reach (e.g., at
least to TCP/UDP port information).
• Should support “fast” filtering (e.g., tens
to hunderds of thousands of packets/sec).
• Need not support same filtering
“language”.
Dnessett June 97
9System Architecture
Enforcement devices :
• Routers (NB2)
> 85K pps (no filtering);
47K pps (filtering)
• Switch (CB 2500 - 1/3 cost of NB2)
> 148K pps (no filtering);
75K pps (filtering)
• Switch (CB 3500 L3 switch - 1/2 cost)
> 4 Mpps (no filtering);
not yet released (filtering)
Dnessett June 97
10System Architecture
MLF Management Station :
• Groups hosts according to administrative
view, not physical connectivity.
• Define firewall rules between host groups
(e.g., src/dst/protocol/allow:disallow).
• For each rule, compute which enforcement
devices get filters.
• Compile high-level rule into low-level
filtering commands based on device type.
Dnessett June 97
11Filter Rule Generation
Key idea in MLF:
• Use the physical topology of the network
to drive filter rule computation.
• Each end system is “behind” one or more
enforcement devices.
• For each firewall rule, compute a cut-
vertex set (of enforcement devices) that
isolates the src hosts from the dst hosts.
Dnessett June 97
12Filter Rule Generation
Host Group 1
A Cut-set of
Host Group 2
HG 1 and
Host Group 3
HG 3
Another
One
Dnessett June 97
13Filter Rule Generation
Some details
• Cut-set need not be minimum.
• There may be different device types in
cut-set, each with own filtering language.
• Translate firewall rule into filters
expressed in each filtering language
• Download filters to enforcement devices
in cut-set. Iterate over all firewall rules.
Dnessett June 97
14Prototype Implementation
Architecture
• Host groups defined by ‘traffix’ - RMON2
monitor app.
• Once src & dst host groups are selected,
policy editor called.
• Policy editor works on rule table (similar
to traditional FW table).
Dnessett June 97
15Traffix Console
Dnessett June 97
16Policy Editor
Dnessett June 97
17Backup
Slides
Dnessett June 97
18Traditional Firewall
Firewall
Management
R
Border No protection
Firewall
against insider
threat
Border
Firewall
Dnessett June 97
19Internal Threats
Traffic should
be heavily
controlled
Sales
Marketing
Engineering
Dnessett June 97
20Multilayer Firewall Architecture
Persistent Store
Update Policy 1 3 Request New Policy
4
Policy
Returned
R 2 Signal Device
Managed Device
Web Based Network
Management Station
Dnessett June 97
21Multilayer Firewall Architecture
Special Case
R Update Policy
Managed Device
with Persistent
Web Based Storage (e.g., NB 2)
Network Management Station
Dnessett June 97
22