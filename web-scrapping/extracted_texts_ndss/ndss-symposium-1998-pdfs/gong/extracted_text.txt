I m p l e m e n t i n g P r o t e c t i o n D o m a i n s
L i G o n g a n d R
J a v a S o f t , S u n M
g o n g , s c h e m e rf
A b s t r a c t
T M
T h e f o r t h c o m i n g J a v a D e v e lo p m e n t K i t ( J D K 1 . 2 )
p r o v i d e s (cid:12) n e - g r a i n e d a c c e s s c o n t r o l v i a a n e a s i ly c o n -
(cid:12) g u r a b le s e c u r i t y p o li c y . I n t h i s p a p e r , w e d e s c r i b e t h e
d e s i g n a n d i m p le m e n t a t i o n i n J D K 1 . 2 o f t h e c o n c e p t
o f p r o t e c t io n d o m a in , w h i c h i s a c o r n e r s t o n e o f t h e
n e w s e c u r i t y a r c h i t e c t u r e . W e p r e s e n t d e s i g n r a t i o -
n a le s , i m p le m e n t a t i o n d e t a i ls , a n d p e r f o r m a n c e d a t a ,
w h i c h d e m o n s t r a t e t h e u t i li t y a n d e (cid:14) c i e n c y o f t h e n e w
s e c u r i t y a r c h i t e c t u r e .
1 I n t r o d u c t i o n
T h e o r ig in a l J a v a s e c u r it y m o d e l [5 , 7 ], k n o w n a s
t h e s a n d b o x m o d e l, p r o v id e s a v e r y r e s t r ic t e d e n v ir o n -
m e n t in w h ic h t o r u n u n t r u s t e d c o d e ( c a lle d a p p le t )
o b t a in e d f r o m t h e o p e n n e t w o r k . O v e r a ll s e c u r it y is
e n f o r c e d t h r o u g h a n u m b e r o f m e c h a n is m s , in c lu d in g
la n g u a g e t y p e - s a f e t y , b y t e c o d e v e r i(cid:12) c a t io n , r u n t im e
t y p e c h e c k in g , n a m e s p a c e s e p a r a t io n v ia c la s s lo a d -
in g , a n d a c c e s s c o n t r o l v ia a s e c u r it y m a n a g e r .
T h e e s s e n c e o f t h e s a n d b o x m o d e l is t h a t lo c a l a p -
p lic a t io n is t r u s t e d t o h a v e f u ll a c c e s s t o s y s t e m r e -
s o u r c e s w h ile a p p le t is n o t t r u s t e d a n d c a n a c c e s s
o n ly t h e lim it e d r e s o u r c e s p r o v id e d in s id e t h e s a n d -
b o x . J D K 1 .1 in t r o d u c e d t h e c o n c e p t o f s ig n e d a p p le t .
A d ig it a lly s ig n e d a p p le t is t r e a t e d a s if it is t r u s t e d
lo c a l c o d e if t h e s ig n a t u r e k e y is r e c o g n iz e d a s t r u s t e d
b y t h e e n d s y s t e m t h a t r e c e iv e s t h e a p p le t .
T h e n e w s e c u r it y a r c h it e c t u r e in J D K 1 .2 p r o v id e s
(cid:12) n e - g r a in e d a c c e s s c o n t r o l, e a s ily c o n (cid:12) g u r a b le s e c u r it y
p o lic y , e a s ily e x t e n s ib le a c c e s s c o n t r o l s t r u c t u r e , a n d
e x t e n s io n o f s e c u r it y c h e c k s t o a ll J a v a p r o g r a m s , in -
c lu d in g a p p le t s a s w e ll a s a p p lic a t io n s . I n o t h e r w o r d s ,
t h e r e is n o lo n g e r a b u ilt - in , h a r d w ir e d n o t io n o f w h ic h
c o d e is t r u s t e d . I n p a r t ic u la r , n o t a ll s ig n e d c o d e a r e
e q u a lly t r u s t e d . M o r e o v e r , t h e o r ig in a l b in a r y t r u s t
m o d e l is e x t e n d e d s o t h a t a ll c o d e ( r e m o t e o r lo c a l,
s ig n e d o r n o t ) r u n s u n d e r a s e c u r it y p o lic y t h a t p o -
1 o
i n
o l a
i c r
s @g
f 1 0
T M
t h e J a v a D e v e l o p m e n t K i t 1 . 2
n d S c h e m e r s
o s y s t e m s , I n c .
e n g . s u n . c o m
t e n t ia lly g r a n t s d i(cid:11) e r e n t p e r m is s io n s t o d i(cid:11) e r e n t p r o -
g r a m s , a n d t h e s e s e t s o f p e r m is s io n s m a y o r m a y n o t
1
o v e r la p , a s s h o w n in F ig u r e 1 .
F ig u r e 1 : J D K 1 .2 S e c u r it y M o d e l
T h e c o n c e p t o f a p r o t e c t io n d o m a in [9 ] is a v it a l
c o m p o n e n t o f t h e n e w a r c h it e c t u r e in t h a t it is t h e
b a s is f o r m a k in g a c c e s s c o n t r o l d e c is io n s . M o r e o v e r ,
it s d e s ig n a n d im p le m e n t a t io n m u s t b e e (cid:14) c ie n t t o
m e e t t h e s t r in g e n t s t a n d a r d r e q u ir e d b y c e r t a in a p -
p lic a t io n s .
I n t h e r e s t o f t h is p a p e r , w e (cid:12) r s t g iv e a q u ic k
o v e r v ie w o f t h e n e w s e c u r it y a r c h it e c t u r e in J D K 1 .2 .
T h e n w e p r e s e n t d e t a ils o f a lg o r it h m s , im p le m e n t a -
t io n , a n d p e r f o r m a n c e d a t a . W e a ls o e x p la in h o w p r o -
t e c t io n d o m a in is u t iliz e d , a n d c o m p a r e it w it h e x is t -
in g w o r k .
2 O v e r v i e w o f S e c u r i t y A r c h i t e c t u r e
L o o k in g f r o m a h ig h le v e l, t h e n e w a r c h it e c t u r e is
s y m b o liz e d b y s e c u r it y p o lic y , a c c e s s p e r m is s io n , r u n -
1 F o r a b r o a d e r o v e r v ie w o f t h e a r c h it e c t u r e a n d it s m o t iv a -
t io n , p le a s e r e fe r t o [3 , 4 ].n in g c o d e t h a t is g r a n t e d ( s o m e ) p e r m is s io n s , a n d a c -
c e s s c o n t r o l c h e c k in g .
F ir s t , t h e r e is a s y s t e m s e c u r it y p o lic y , s e t b y t h e
u s e r o r b y a s y s t e m a d m in is t r a t o r , t h a t is r e p r e s e n t e d
b y a p o lic y o b j e c t , w h ic h is in s t a n t ia t e d f r o m t h e c la s s
j a v a . s e c u r i t y . P o l i c y .
I n a b s t r a c t t e r m s , t h e s e c u r it y p o lic y is a m a p p in g
f r o m a s e t o f p r o p e r t ie s t h a t c h a r a c t e r iz e r u n n in g c o d e
t o a s e t o f a c c e s s p e r m is s io n s t h a t is g r a n t e d t o t h e
c o n c e r n e d c o d e .
A p ie c e o f c o d e is f u lly c h a r a c t e r iz e d b y it s o r ig in
( it s lo c a t io n a s s p e c i(cid:12) e d b y a U R L ) a n d t h e s e t o f p u b -
lic k e y s t h a t c o r r e s p o n d t o t h e s e t o f p r iv a t e k e y s t h a t
h a v e b e e n u s e d t o s ig n t h e c o d e u s in g d ig it a l s ig n a -
t u r e a lg o r it h m s . W ild c a r d s a r e u s e d t o d e n o t e \ a n y
lo c a t io n " o r \ u n s ig n e d " .
S e c o n d , w e in t r o d u c e d a n e w h ie r a r c h y o f t y p e d a n d
p a r a m e t e r iz e d a c c e s s p e r m is s io n s . T h e r o o t c la s s is
j a v a . s e c u r i t y . P e r m i s s i o na n a b s t r a c t c la s s . O t h e r
p e r m is s io n s a r e s u b c la s s e d e it h e r f r o m t h e r o o t c la s s
o r o n e o f it s s u b c la s s e s . G e n e r a lly , a p e r m is s io n c la s s
b e lo n g s t o t h e p a c k a g e in w h ic h it is m o s t ly u s e d . F o r
e x a m p le , t h e p e r m is s io n r e p r e s e n t in g (cid:12) le s y s t e m a c -
F i l e P e r m i s s i o n j a v a . i oc e s s , , is f o u n d in t h e p a c k -
a g e .
T y p ic a lly , e a c h p e r m is s io n c o n s is t s o f a t a r g e t a n d
a n a c t io n , a lt h o u g h e it h e r c a n b e o m it t e d . F o r (cid:12) le a c -
c e s s , a t a r g e t c a n b e a d ir e c t o r y o r a (cid:12) le . T h e a c t io n s
r e a d w r i t e e x e c u t e d e l e t ein c lu d e , , , a n d . A (cid:12) le
p a t h p a t h / f i l e p a t h / *t a r g e t c a n b e e x p r e s s e d a s , ,
( w h ic h d e n o t e s a ll (cid:12) le s a n d d ir e c t o r ie s in t h e d ir e c t o r y
p a t h p a t h / -) , o r ( w h ic h d e n o t e s a ll (cid:12) le s a n d d ir e c t o -
r ie s u n d e r t h e s u b t r e e o f t h e (cid:12) le s y s t e m s t a r t in g a t
p a t h ) .
j a v a . s e c u r i t yW e a ls o c r e a t e d , in s id e t h e p a c k -
P e r m i s s i o n C o l l e c t i o na g e , a b s t r a c t c la s s e s a n d
j a v a . s e c u r i t y . P e r m i s s i o n s , w h e r e t h e f o r m e r is a
P e r m i s s i o nh o m o g e n e o u s c o lle c t io n o f o b j e c t s a n d
t h e la t t e r is a h e t e r o g e n e o u s c o lle c t io n o f c o lle c t io n s
P e r m i s s i o no f o b j e c t s .
F in a lly , b e f o r e a c o n t r o lle d r e s o u r c e is t o b e a c -
c e s s e d , a n a c c e s s c o n t r o l d e c is io n is m a d e , b a s e d o n
t h e p e r m is s io n s t h e e x e c u t in g c o d e h a s . N o t e t h a t
a n y o n e c a n c r e a t e a n y n u m b e r o f p e r m is s io n o b j e c t s ,
b u t h o ld in g s u c h o b j e c t s d o n o t im p ly h a v in g g a in e d
t h e c o r r e s p o n d in g a c c e s s r ig h t s . O n ly t h o s e p e r m is -
s io n o b j e c t s t h a t t h e J a v a r u n t im e s y s t e m m a n a g e s
s ig n i(cid:12) e s g r a n t e d p e r m is s io n s .
T o f u lly u n d e r s t a n d t h e n e w s e c u r it y a r c h it e c t u r e ,
it is c r it ic a l t o k n o w w h a t a lg o r it h m s a r e u s e d f o r
g r a n t in g p e r m is s io n s , h o w t h e p e r m is s io n s a r e s t o r e d
in t e r n a lly t o t h e J a v a r u n t im e s y s t e m , w h a t a lg o -
2 o f 1 0
r it h m s a r e u s e d f o r a c c e s s c o n t r o l, a n d h o w s u c h a lg o -
r it h m s a r e im p le m e n t e d e (cid:14) c ie n t ly . W e a n s w e r t h e s e
q u e s t io n s in t h e r e s t o f t h is p a p e r .
3 P r o t e c t i o n D o m a i n
A c c o r d in g t o t h e c la s s ic a l d e (cid:12) n it io n o f a p r o t e c t io n
d o m a in [9 ], a d o m a in is s c o p e d b y t h e s e t o f o b j e c t s
t h a t a r e c u r r e n t ly d ir e c t ly a c c e s s ib le b y a p r in c ip a l,
w h e r e a p r in c ip a l is a n e n t it y in t h e c o m p u t e r s y s t e m
t o w h ic h a u t h o r iz a t io n s ( a n d a s a r e s u lt , a c c o u n t a b il-
it y ) a r e g r a n t e d . T h e J a v a s a n d b o x in J D K 1 .0 is in a
s e n s e a p r o t e c t io n d o m a in w it h a (cid:12) x e d b o u n d a r y .
I n J D K 1 .2 , p e r m is s io n s a r e g r a n t e d t o p r o t e c t io n
d o m a in s , a n d c la s s e s a n d o b j e c t s b e lo n g t o p r o t e c t io n
d o m a in s . T h is in d ir e c t io n , w h e r e p e r m is s io n s a r e n o t
g r a n t e d t o c la s s e s a n d o b j e c t s d ir e c t ly , is b y d e s ig n b e -
c a u s e , in t h e f u t u r e , p r o t e c t io n d o m a in s c a n b e f u r t h e r
c h a r a c t e r iz e d b y u s e r a u t h e n t ic a t io n a n d d e le g a t io n s o
t h a t t h e s a m e c o d e c o u ld o b t a in d i(cid:11) e r e n t p e r m is s io n s
w h e n r u n n in g \ o n b e h a lf o f " d i(cid:11) e r e n t u s e r s o r p r in c i-
p a ls .
j a v a . s e c u r i t y . P r o t e c t i o n D o m a i nT h e n e w c la s s
is p a c k a g e - p r iv a t e , a n d is t r a n s p a r e n t t o m o s t J a v a
d e v e lo p e r s .
3 . 1 C r e a t i n g D o m a i n a n d I t s P e r m i s s i o n s
I n J D K 1 .2 , p r o t e c t io n d o m a in s a r e c r e a t e d \ o n d e -
m a n d " , b a s e d o n c o d e s o u r c e { t h e c o d e b a s e w h e r e
t h e c o d e o r ig in a t e d f r o m a n d t h e s e t o f p u b lic k e y s
t h a t a r e u s e d t o s ig n t h e c o d e .
F o r e x a m p le , s u p p o s e t h e f o llo w in g s e c u r it y p o lic y ,
g iv e n in it s A S C I I r e p r e s e n t a t io n , is in f o r c e .
g r a n t C o d e B a s e
‘ ‘ h t t p : / / j a v a . s u n . c o m / p e o p l e / g o n g / ’ ’ ,
S i g n e d B y ‘ ‘ * ’ ’ {
p e r m i s s i o n j a v a . i o . F i l e P e r m i s s i o n
‘ ‘ r e a d , w r i t e ’ ’ , ‘ ‘ / t m p / * ’ ’ ;
p e r m i s s i o n j a v a . n e t . S o c k e t P e r m i s s i o n
‘ ‘ c o n n e c t ’ ’ , ‘ ‘ * . s u n . c o m ’ ’ ;
} ;
g r a n t C o d e B a s e ‘ ‘ / h o m e / g o n g / b i n ’ ’ ,
S i g n e d B y ‘ ‘ s e l f ’ ’ {
p e r m i s s i o n j a v a . i o . F i l e P e r m i s s i o n
‘ ‘ r e a d , w r i t e , d e l e t e ’ ’ , ‘ ‘ / h o m e / g o n g / - ’ ’ ,
} ;
T h e (cid:12) r s t e n t r y in t h is s im p le p o lic y s a y s
t h a t a n y a p p le t t h a t is lo a d e d f r o m t h e w e b
h t t p : / / j a v a . s u n . c o m / p e o p l e / g o n g /p a g e , w h e t h e r/ t m ps ig n e d o r n o t , c a n r e a d a n d w r it e a n y (cid:12) le in t h e
d ir e c t o r y , a n d c a n c o n n e c t t o a n y h o s t w it h in t h e D N S
d o m a in s u n .c o m .
T h e s e c o n d e n t r y s a y s t h a t a n y a p p le t lo a d e d
f r o m t h e lo c a l (cid:12) le s y s t e m u n d e r t h e d ir e c t o r y
/ h o m e / g o n g / b i n , s ig n e d b y a k e y t h a t is r e f e r e n c e d
s e l ft h r o u g h a n a lia s , c a n r e a d a n d w r it e a n y (cid:12) le in
/ h o m e / g o n gt h e h o m e d ir e c t o r y r o o t e d a t .
W h e n a n a p p le t c la s s (cid:12) le in J a v a b y t e c o d e f o r m a t ,
h t t p : / / j a v a . s u n . c o m / p e o p l e / g o n g / d e m o . c l a s s , is
(cid:12) r s t lo a d e d , t h e c la s s lo a d e r c o n s u lt s t h e p o lic y o b j e c t
( w h o s e c o n t e n t is a n in t e r n a l r e p r e s e n t a t io n o f t h e p o l-
ic y e a r lie r g iv e n in A S C I I f o r m ) , s e e s t h a t a m a t c h in g
e n t r y is f o u n d b u t t h e r e is n o p r o t e c t io n d o m a in t h a t
c o r r e s p o n d s t o t h is s e t o f p e r m is s io n s , a n d p r o c e e d s
t o c r e a t e a n e w d o m a in o b j e c t . T h is n e w o b j e c t h a s
r e f e r e n c e t o t h e p e r m is s io n s g r a n t e d t o it .
W h e n a n o t h e r a p p le t t h a t (cid:12) t s t h e s a m e p r o (cid:12) le is
lo a d e d la t e r , t h a t a p p le t w ill b e g r a n t e d t h e s a m e s e t
o f p e r m is s io n s , a n d n o n e w p r o t e c t io n d o m a in n e e d s
t o b e c r e a t e d . N o t e t h a t if a t h ir d a p p le t t h a t d o e s
n o t (cid:12) t t h e p r o (cid:12) le b u t e n d s u p o b t a in in g t h e s a m e s e t
2
o f p e r m is s io n s , a n e w d o m a in w ill b e c r e a t e d .
A p o lic y e n t r y is m a t c h e d if b o t h t h e c o d e b a s e a n d
t h e s ig n e r ( s ) o f t h e a p p le t ( o r a p p lic a t io n ) c o d e m a t c h
t h e e n t r y . T o b e m o r e p r e c is e , t h e a c t u a l c o d e b a s e o f
a n a p p le t m a t c h e s a p o lic y e n t r y if t h e la t t e r U R L is a
p r e (cid:12) x o f t h e f o r m e r . T h e s ig n e r o f a n a p p le t m a t c h e s
a p o lic y e n t r y if t h e p u b lic k e y u s e d t o v e r if y t h e s ig -
n a t u r e m a t c h e s t h e k e y t h a t c o r r e s p o n d s t o t h e a lia s
g iv e n in t h e p o lic y e n t r y . ( T h e m a p p in g f r o m a n a lia s
t o a n a c t u a l k e y o r c e r t i(cid:12) c a t e is m a in t a in e d , f o r e x -
a m p le , v ia a lo c a l k e y s t o r e .)
I f a n a p p le t m a t c h e s m u lt ip le e n t r ie s in t h e p o lic y ,
t h e a p p le t o b t a in s a ll p e r m is s io n s g r a n t e d in t h o s e e n -
t r ie s . S p e c i(cid:12) c a lly , f o r c o d e s ig n e d w it h m u lt ip le s ig -
n a t u r e s , p e r m is s io n s g r a n t e d a r e a ls o a d d it iv e . F o r
a xe x a m p le , if c o d e s ig n e d w it h k e y g e t s p e r m is s io n
b ya n d c o d e s ig n e d b y k e y g e t s p e r m is s io n , t h e n c o d e
a b x ys ig n e d b y b o t h a n d g e t s b o t h p e r m is s io n s a n d .
N o t e t h a t o f t e n a c la s s m a y r e f e r t o a n a n o t h e r
c la s s a n d t h u s c a u s e t h e s e c o n d c la s s t o b e lo a d e d
t h a t b e lo n g s t o a n o t h e r d o m a in . T y p ic a lly t h e s e c o n d
c la s s is lo a d e d b y t h e s a m e c la s s lo a d e r t h a t lo a d e d t h e
(cid:12) r s t c la s s , e x c e p t w h e n e it h e r c la s s is a s y s t e m c la s s ,
in w h ic h c a s e t h e s y s t e m c la s s is lo a d e d w it h a n u ll
n u l lc la s s lo a d e r [5 ]. T h e s p e c ia l s y s t e m c la s s lo a d e r is
a h is t o r ic a l f e a t u r e { s y s t e m c la s s e s ( i.e ., t h o s e c la s s e s
2
T h e c u r r e n t im p le m e n t a t io n m a y c r e a t e m o r e d o m a in s
t h a n a b s o lu t e ly n e c e s s a r y . T h is d o e s n o t c o m p r o m is e s e c u -
r it y , a n d fu r t h e r o p t im iz a t io n s h o u ld r e d u c e u n n e c e s s a r y d o -
m a in c r e a t io n .
3 o f 1 0
o n C L A S S P A T H ) a r e lo a d e d v ia a m e c h a n is m im p le -
m e n t e d in C .
3 . 2 M a p p i n g O b j e c t s t o D o m a i n s
E a c h o b j e c t o r c la s s b e lo n g s t o o n e a n d o n ly o n e
d o m a in . O t h e r w is e , t h e s e c u r it y d e c is io n is h a r d t o
m a k e . I f t h e s a m e c la s s ( r e p r e s e n t e d b y a p ie c e o f J a v a
b y t e c o d e ) is r e u s e d a s p a r t o f t w o a p p le t s t h a t b e lo n g
t o t w o d i(cid:11) e r e n t d o m a in s , a n d if t h e s a m e c la s s lo a d e r
is lo a d in g b o t h a p p le t s , t h e n t h e c la s s is d e (cid:12) n e d o n ly
o n c e a n d is s h a r e d b y t h e t w o d o m a in s .
H o w e v e r , if t w o d i(cid:11) e r e n t c la s s lo a d e r s a r e lo a d in g
t h e a p p le t s , t h e n e (cid:11) e c t iv e ly e a c h d o m a in w ill c o n t a in
a d is t in c t c o p y o f t h e c la s s , u n le s s t h e c la s s is a s y s -
t e m c la s s , in w h ic h c a s e o n ly o n e c o p y is d e (cid:12) n e d b e -
n u l lc a u s e a s y s t e m c la s s is a lw a y s d e (cid:12) n e d b y t h e
c la s s lo a d e r . F o r e x a m p le , s u p p o s e t h e s a m e w e b p a g e
a . c l a s s b . c l a s s c . c l a s sc o n t a in s , , a n d . F u r t h e r a s -
a . c l a s s b . c l a s ss u m e t h a t a n d a r e s ig n e d w it h d if -
c . c l a s sf e r e n t k e y s b u t b o t h r e f e r t o . I n t h is c a s e , t w o
a . c l a s sp r o t e c t io n d o m a in s w ill b e c r e a t e d t o r u n a n d
b . c l a s s c . c l a s ss e p a r a t e ly , a n d t w o c o p ie s o f w ill b e
d e (cid:12) n e d .
T h e J a v a r u n t im e m a in t a in s t h e m a p p in g f r o m c o d e
( c la s s e s a n d o b j e c t s ) t o t h e ir p r o t e c t io n d o m a in s a n d
t h e n t o t h e ir p e r m is s io n s , a s s h o w n in F ig u r e 2 .
F ig u r e 2 : M a p p in g A C la s s t o I t s P r o t e c t io n D o m a in
T h is m a p p in g f r o m a c la s s t o it s p r o t e c t io n
d o m a in is (cid:12) r s t r e g is t e r e d w h e n t h e c la s s is d e -
(cid:12) n e d . T h is is d o n e b y c a llin g a p r iv a t e m e t h o d
s e t P r o t e c t i o n D o m a i n ( C l a s s , P r o t e c t i o n D o m a i n )
P r o t e c t i o n D o m a i no n c la s s . O b v io u s ly t h is m e t h o d
is s e c u r it y s e n s it iv e ; in f a c t it is n o t p u b lic ly c a lla b le
j a v a . s e c u r i t yf r o m o u t s id e t h e p a c k a g e .F r o m w it h in J a v a c o d e , t h e p r o t e c t io n d o m a in o f a
g iv e n c la s s is o b t a in e d b y in v o k in g t h e s t a t ic m e t h o d
g e t P r o t e c t i o n D o m a i n ( C o d e S o u r c e ) , a g a in a p r iv a t e
m e t h o d w it h in t h e p a c k a g e . F o r e a c h c la s s , it s p r o t e c -
t io n d o m a in is s e t o n ly o n c e , a n d w ill n o t c h a n g e u n t il
t h e c la s s o b j e c t is g a r b a g e c o lle c t e d .
O n c e a d o m a in is c r e a t e d , t h e p e r m is s io n s e t
it is g r a n t e d is m a d e r e a d o n ly , s o t h a t f u r t h e r
t a m p e r in g is im p o s s ib le . T h is is a c h ie v e d b y c a ll-
s e t R e a d O n l y ( )in g t h e m e t h o d d e (cid:12) n e d in c la s s
j a v a . s e c u r i t y . P e r m i s s i o n s .
3 . 3 S y s t e m D o m a i n
O n e p r o t e c t io n d o m a in is s p e c ia l: t h e s y s t e m d o -
m a in c o n s is t s o f s y s t e m c o d e t h a t is lo a d e d w it h a
n u l l C L A S S P A T Hc la s s lo a d e r ( i.e ., e v e r y t h in g o n ) a n d
t h a t is g iv e n s p e c ia l p r iv ile g e s . I t is c o m m o n ( b u t
n u l lp r o b a b ly n o t w is e ) t o u s e t h e c la s s lo a d e r t o id e n -
t if y s y s t e m c o d e :
i f ( x . g e t C l a s s ( ) . g e t C l a s s L o a d e r ( ) = = n u l l ) {
( o b j e c t x i s a n i n s t a n c e o f s y s t e m c o d e )
}
I t is im p o r t a n t t h a t a ll p r o t e c t e d e x t e r n a l r e s o u r c e s ,
s u c h a s t h e (cid:12) le s y s t e m , t h e n e t w o r k in g f a c ilit y , a n d t h e
s c r e e n a n d k e y b o a r d , a r e o n ly a c c e s s ib le v ia s y s t e m
c o d e .
P r io r t o J D K 1 .2 , a ll lo c a l a p p lic a t io n s h a d t o b e
C L A S S P A T Hin s t a lle d o n in o r d e r t o b e lo c a t e d a n d r u n .
T h is a r r a n g e m e n t m a n d a t e s t h a t a n y lo c a l a p p lic a t io n
is t r e a t e d a s s y s t e m c o d e a n d b y d e f a u lt e n j o y s s p e c ia l
p r iv ile g e s .
T o a p p ly t h e s a m e s e c u r it y p o lic y t o a p p lic a t io n s
f o u n d o n t h e lo c a l (cid:12) le s y s t e m , in J D K 1 .2 w e p r o v id e a
n e w c la s s p a t h , w h ic h is s p e c i(cid:12) e d a s a J a v a p r o p e r t y
j a v a . a p p . c l a s s . p a t hn a m e d . F o r e x a m p le , o n e c a n
s e t t h e p a t h a s t h e f o llo w in g :
j a v a . a p p . c l a s s . p a t h = / u s r / c l a s s e s : / u s r / b i n
N o n - s y s t e m c la s s e s t h a t a r e s t o r e d o n t h e lo -
c a l (cid:12) le s y s t e m s h o u ld a ll b e o n t h is p a t h , n o t
C L A S S P A T Ho n t h e . W e a ls o p r o v id e a c la s s c a lle d
j a v a . s e c u r i t y . M a i n , w h ic h c a n b e u s e d in t h e f o l-
lo w in g f a s h io n in p la c e o f t h e t r a d it io n a l c o m m a n d
j a v a a p p l i c a t i o n t o in v o k e a lo c a l a p p lic a t io n :
j a v a j a v a . s e c u r i t y . M a i n y o u r _ a p p l i c a t i o n
T h is u s a g e e n s u r e s t h a t a n y lo c a l a p p lic a t io n
j a v a . a p p . c l a s s . p a t ho n t h e is lo a d e d w it h a
S e c u r e C l a s s L o a d e r a n d t h e r e f o r e is s u b j e c t e d t o t h e
4 o f 1 0
s e c u r it y p o lic y ( e .g ., t h e s e c o n d e n t r y in t h e e x a m p le
p o lic y w e g iv e e a r lie r ) t h a t is b e in g e n f o r c e d . S e p a r a t e
p r o t e c t io n d o m a in s a r e c r e a t e d f o r s u c h lo c a l a p p lic a -
t io n s .
4 A c c e s s C o n t r o l o n R e s o u r c e s
T h e d e c is io n o f g r a n t in g a c c e s s t o c o n t r o lle d r e -
s o u r c e s c a n o n ly b e m a d e w it h in t h e r ig h t c o n t e x t ,
w h ic h m u s t p r o v id e a n s w e r s t o q u e s t io n s s u c h a s \ w h o
is r e q u e s t in g w h a t , o n w h o s e b e h a lf " . I n J D K 1 .2 , t h e
d e c is io n is b a s e d o n t h e p r o t e c t io n d o m a in s in v o lv e d
in a n y c o m p u t a t io n .
F o r e x a m p le , w h e n a n a c c e s s r e q u e s t is m a d e , if
c o d e in v o lv e d in t h e e x e c u t io n a ll b e lo n g t o t h e s a m e
p r o t e c t io n d o m a in , t h e n t h e d e c is io n is t r iv ia l. I f t h e
p r o t e c t io n d o m a in h a s b e e n g r a n t e d t h e s a id p e r m is -
s io n , t h e r e q u e s t s h o u ld s u c c e e d . O t h e r w is e , it m u s t
f a il. H o w e v e r , in m o s t c a s e s t h in g s a r e n o t s o s t r a ig h t -
f o r w a r d a n d m a y in v o lv e m u lt ip le d o m a in s a n d v a r io u s
t y p e s o f p e r m is s io n s .
I n t h e r e s t o f t h is s e c t io n , w e (cid:12) r s t d e s c r ib e h o w c o m -
p a r is o n s a r e m a d e b e t w e e n p e r m is s io n s . W e t h e n g iv e
t h e a lg o r it h m f o r m a k in g a c c e s s c o n t r o l d e c is io n s . W e
a ls o r e p o r t im p le m e n t a t io n d e t a ils a n d p e r f o r m a n c e
d a t a .
4 . 1 C o m p a r i n g P e r m i s s i o n s
T h e p r o t e c t io n d o m a in d o e s n o t h a v e t o b e g r a n t e d
t h e id e n t ic a l p e r m is s io n a s r e q u e s t e d , b u t o n ly o n e o r
m o r e p e r m is s io n s t h a t im p ly t h e s a id p e r m is s io n . F o r
e x a m p le , if t h e p r o t e c t io n d o m a in is g r a n t e d a p e r m is -
/ t m ps io n t o r e a d a ll (cid:12) le s in d ir e c t o r y , t h e n a r e q u e s t
/ t m p / R E A D M E . t x tt o r e a d (cid:12) le s h o u ld s u c c e e d . M o r e -
o v e r , t w o s e p a r a t e p e r m is s io n s , o n e f o r \ r e a d " a n d o n e
f o r \ w r it e " , s h o u ld im p ly a c o m b in e d p e r m is s io n f o r
\ r e a d ,w r it e " .
S u c h im p lic a t io n r e a s o n in g is e n c a p s u la t e d in
i m p l i e s ( P e r m i s s i o n )t h e im p le m e n t a t io n o f t h e
m e t h o d t h a t is d e (cid:12) n e d in t h e a b s t r a c t b a s e c la s s
j a v a . s e c u r i t y . P e r m i s s i o n a n d m u s t h a v e a c o n -
c r e t e im p le m e n t a t io n f o r e a c h t y p e o f p e r m is s io n
c la s s e s .
j a v a . i o . F i l e P e r m i s s i o nF o r e x a m p le , t h e c la s s
i m p l i e s ( )im p le m e n t s t h e m e t h o d s u c h t h a t it c o r -
r e c t ly in t e r p r e t s w ild c a r d f o r (cid:12) le n a m e s , w h e r e a s
j a v a . n e t . S o c k e t P e r m i s s i o n i m p l i e s ( )t h e c la s s ’s
m e t h o d u n d e r s t a n d s I P a d d r e s s e s a n d D N S n a m e s .
i m p l i e s ( P e r m i s s i o n )T h e m e t h o d m u s t b e im -
p le m e n t e d c a r e f u lly , a s it c a n c o m p r o m is e s e c u r it y .
F o r e x a m p le , t h e m e t h o d s h o u ld a lw a y s c h e c k t h a tt h e p e r m is s io n it is c h e c k in g a g a in s t ( t h e p e r m is -
s io n p a s s e d in a s a p a r a m e t e r ) m u s t b e o f t h e s a m e
3
t y p e a s it s e lf , a s in t h e f o llo w in g c o d e f r a g m e n t f r o m
j a v a . i o . F i l e P e r m i s s i o n c la s s :
p u b l i c b o o l e a n i m p l i e s ( P e r m i s s i o n p ) {
i f ( ! ( p i n s t a n c e o f F i l e P e r m i s s i o n ) )
r e t u r n f a l s e ;
F i l e P e r m i s s i o n f p = ( F i l e P e r m i s s i o n ) p ;
. . . ( c o n t i n u e c h e c k i n g o t h e r t h i n g s )
}
S u p p o s e w e h a v e t h e f o llo w in g p e r m is s io n s :
F i l e P e r m i s s i o n p 1 =
n e w F i l e P e r m i s s i o n ( ‘ ‘ / t m p / * ’ ’ , ‘ ‘ r e a d ’ ’ ) ;
F i l e P e r m i s s i o n p 2 =
n e w F i l e P e r m i s s i o n ( ‘ ‘ / t m p / x . t x t ’ ’ , ‘ ‘ r e a d ’ ’ ) ;
F i l e P e r m i s s i o n p 3 =
n e w F i l e P e r m i s s i o n ( ‘ ‘ / u s r / b i n ’ ’ , ‘ ‘ r e a d ’ ’ ) ;
S o c k e t P e r m i s s i o n p 4 =
n e w S o c k e t P e r m i s s i o n ( ‘ ‘ * ’ ’ , ‘ ‘ a c c e p t ’ ’ ) ;
p 1 . i m p l i e s ( p 2 ) p 1 . i m p l i e s ( p 3 )T h e n is t r u e , is
p 4 . i m p l i e s ( p 2 )n o t t r u e , a n d is n o t t r u e .
N o t e t h a t a lt h o u g h it m a y b e c o n v e n ie n t t o h a v e a
c a t c h - a ll p e r m is s io n t h a t \ im p lie s " o t h e r p e r m is s io n s
o f d i(cid:11) e r e n t t y p e s , s u c h s u p e r p e r m is s io n s , if e v e r c r e -
a t e d , m u s t b e h a n d le d v e r y c a u t io u s ly , a s t h e y a r e
r is k y t o g iv e o u t .
W h e n a n a c c e s s c o n t r o l p e r m is s io n is r e q u e s t e d , t h e
A c c e s s C o n t r o l l e r . c h e c k P e r m i s s i o n ( ) m e t h o d w ill
g o t h r o u g h a ll t h e p e r m is s io n s t h a t t h e p r o t e c t io n d o -
m a in h a s , id e n t if y p e r m is s io n o b j e c t s o f t h e a p p r o -
p r ia t e t y p e s , a n d t h e n c o m p a r e t h e m w it h t h e s a id
p e r m is s io n t o s e e if t h e la t t e r is im p lie d b y a n y o f t h e
f o r m e r .
p 1M o r e o v e r , w h e n c o m p a r in g t w o p e r m is s io n s
( w h ic h is c r e a t e d a s p a r t o f t h e a c c e s s r e q u e s t )
p 2a n d ( w h ic h is s t o r e d w it h t h e p r o t e c t io n d o -
m a in o b j e c t ) , w e a lw a y s in v o k e c h e c k in g in t h e
i f ( p 2 . i m p l i e s ( p 1 ) = = t r u e )f o r m o f a n d n o t
i f ( p 1 . i m p l i e s ( p 2 ) = = t r u e ) , a s t h e im p le m e n t a -
p 2t io n o f ( w h ic h is c o n t r o lle d b y s y s t e m c o d e ) is n o t
p 1le s s d e p e n d a b le t h a n t h a t o f , w h ic h is c o n t r o lle d
b y t h e c a llin g a p p lic a t io n .
4 . 2 A c c e s s C o n t r o l A l g o r i t h m s
T h e r ig h t c o n t e x t f o r a c c e s s c o n t r o l is a t h r e a d o f
c o m p u t a t io n , w h ic h m a y in v o lv e o n e o r m o r e J a v a
3
T h is p a r t ic u la r r u le u s u a lly a p p lie s o n ly w h e n c o m p a r in g
in d iv id u a l p e r m is s io n o b je c t s . W h e n c o m p a r in g s e t s o f p e r m is -
s io n o b je c t s o f m ix e d t y p e s , s im ila r p r e c a u t io n m u s t b e t a k e n .
5 o f 1 0
t h r e a d s , f o r e x a m p le , w h e n c h ild t h r e a d s a r e c r e a t e d .
A t h r e a d o f c o m p u t a t io n m a y o c c u r w it h in a s in g le
p r o t e c t io n d o m a in ( i.e ., a ll c la s s e s a n d o b j e c t s in -
v o lv e d in t h e t h r e a d b e lo n g t o t h e id e n t ic a l p r o t e c t io n
d o m a in ) o r m a y in v o lv e m u lt ip le d o m a in s .
F o r e x a m p le , a n a p p lic a t io n t h a t r e a d s a (cid:12) le v ia
F i l e I n p u t S t r e a ma is in e (cid:11) e c t in t e r a c t in g w it h t h e
s y s t e m d o m a in t h a t m e d ia t e s a c c e s s t o t h e u n d e r ly -
in g (cid:12) le s y s t e m . I n t h is c a s e , t h e a p p lic a t io n d o m a in
m u s t n o t g a in a d d it io n a l p e r m is s io n s b y m e r e ly c a ll-
in g t h e s y s t e m d o m a in . O t h e r w is e , s e c u r it y c a n b e
c o m p r o m is e d .
A s a n o t h e r e x a m p le , s u p p o s e t h a t a s y s t e m d o m a in
in v o k e s a m e t h o d f r o m a n a p p lic a t io n d o m a in , s u c h a s
in a c a ll- b a c k s it u a t io n , a g a in t h e a p p lic a t io n d o m a in
m u s t n o t g a in a d d it io n a l p e r m is s io n s m e r e ly b e c a u s e
it is b e in g c a lle d b y t h e s y s t e m d o m a in .
T h e a b o v e o b s e r v a t io n a p p lie s t o a t h r e a d t h a t t r a -
v e r s e s m u lt ip le p r o t e c t io n d o m a in s . T h e r e f o r e , f o r s e -
c u r it y r e a s o n s , a d o m a in c a n n o t g a in a d d it io n a l p e r -
m is s io n s a s a r e s u lt o f c a llin g a m o r e \ p o w e r f u l" d o -
m a in , w h ile a m o r e p o w e r f u l d o m a in m u s t lo s e it s
p o w e r w h e n c a llin g a le s s p o w e r f u l d o m a in .
P r io r t o J D K 1 .2 , a n y c o d e t h a t p e r f o r m s a n a c c e s s
c o n t r o l d e c is io n r e lie s o n e x p lic it ly k n o w in g it s c a lle r ’s
s t a t u s ( i.e ., b e in g s y s t e m c o d e o r a p p le t c o d e ) . T h is is
f r a g ile in t h a t it is o f t e n in s u (cid:14) c ie n t ly s e c u r e t o k n o w
o n ly t h e c a lle r ’s s t a t u s b u t a ls o t h e c a lle r ’s c a lle r ’s s t a -
t u s a n d s o o n . M o r e o v e r , h a v in g o n ly a b r o a d d is t in c -
t io n b e t w e e n s y s t e m c o d e a n d a p p le t c o d e lim it s u s t o
s u p p o r t in g a b in a r y , a ll- o r - n o t h in g a c c e s s c o n t r o l p o l-
ic y . F in a lly , p la c in g t h is d is c o v e r y p r o c e s s e x p lic it ly
o n t h e t y p ic a l p r o g r a m m e r b e c o m e s a s e r io u s b u r d e n ,
a n d c a n b e e r r o r - p r o n e .
T o r e lie v e t h is b u r d e n , w e a u t o m a t e t h e m o s t
c o m m o n s c e n a r io f o r c h e c k in g a c c e s s in a n e w c la s s
j a v a . s e c u r i t y . A c c e s s C o n t r o l l e r . I n s t e a d o f t r y -
in g t o d is c o v e r t h e h is t o r y o f c a lle r s a n d t h e ir s t a -
t u s w it h in a t h r e a d , a n y c o d e c a n q u e r y t h e a c -
c e s s c o n t r o lle r a s t o w h e t h e r a p e r m is s io n w o u ld
s u c c e e d if p e r f o r m e d r ig h t n o w . T h is is d o n e
c h e c k P e r m i s s i o n ( )b y c a llin g t h e m e t h o d o f t h e
A c c e s s C o n t r o l l e r P e r m i s s i o nc la s s w it h a o b j e c t
t h a t r e p r e s e n t s t h e p e r m is s io n in q u e s t io n . B e lo w is a
s m a ll c o d e e x a m p le f o r c h e c k in g (cid:12) le a c c e s s .
F i l e P e r m i s s i o n p =
n e w F i l e P e r m i s s i o n ( " p a t h / f i l e " , " r e a d " ) ;
A c c e s s C o n t r o l l e r . c h e c k P e r m i s s i o n ( p ) ;
T h e a c c e s s c o n t r o lle r w ill, a s a d e f a u lt , r e -
t u r n s ile n t ly o n ly if a ll c a lle r s in t h e t h r e a d c u r -
r e n t h is t o r y b e lo n g t o d o m a in s t h a t h a v e b e e ng r a n t e d t h e s a id p e r m is s io n . O t h e r w is e , it t h r o w s a
j a v a . s e c u r i t y . A c c e s s C o n t r o l E x c e p t i o n t h a t is a
j a v a . l a n g . S e c u r i t y E x c e p t i o ns u b c la s s o f .
N o t e t h a t t h e h is t o r y o f a t h r e a d in c lu d e s n o t o n ly
a ll c la s s e s o n t h e c u r r e n t c a ll s t a c k b u t a ls o a ll c la s s e s
in it s p a r e n t t h r e a d w h e n t h e c u r r e n t t h r e a d is c r e a t e d .
T h is in h e r it a n c e is t r a n s it iv e , a n d is n a t u r a l in t h a t a
c h ild t h r e a d is s im p ly a c o n t in u a t io n o f t h e p a r e n t
t h r e a d . I f w e d o n o t e n f o r c e t h is in h e r it a n c e , a c h ild
t h r e a d c a n u n e x p e c t e d ly g a in a d d it io n a l a c c e s s t h a t is
n o t p e r m it t e d in it s p a r e n t . T h is p h e n o m e n o n w o u ld
r e q u ir e a p r o g r a m m e r b e e x t r a c a r e f u l w h e n c r e a t in g
t h r e a d s , w h ic h is a n u n d e s ir a b le b u r d e n .
T h e d e f a u lt b e h a v io r t o g r a n t a p e r m is s io n o n ly
w h e n a ll p r o t e c t io n d o m a in s in v o lv e d h a v e t h a t p e r -
m is s io n , a lt h o u g h t h e m o s t s e c u r e , is lim it in g in s o m e
c a s e s w h e r e a p ie c e o f c o d e w a n t s t o t e m p o r a r ily e x e r -
c is e it s o w n p e r m is s io n s t h a t a r e n o t a v a ila b le d ir e c t ly
t o it s c a lle r s . F o r e x a m p le , a n a p p le t m a y n o t h a v e
d ir e c t a c c e s s t o c e r t a in s y s t e m p r o p e r t ie s , b u t t h e s y s -
t e m c o d e s e r v ic in g t h e a p p le t m a y n e e d t o o b t a in t h e s e
p r o p e r t ie s in o r d e r t o c o m p le t e it s t a s k s . T h e d e f a u lt
m o d e w ill p r e v e n t t h is f r o m h a p p e n in g , a s t h e s y s t e m
c o d e c a lle d b y t h e a p p le t c o d e w o u ld lo s e it s s y s t e m
p r iv ile g e s .
F o r s u c h e x c e p t io n a l c a s e s , w e p r o v id e a n o v e r -
A c c e s s C o n t r o l l e rr id in g p r im it iv e , in t h e c la s s , in
b e g i n P r i v i l e g e d ( )t h e f o r m o f s t a t ic m e t h o d s a n d
e n d P r i v i l e g e d ( ) b e g i n P r i v i l e g e d. B y c a llin g , a
p ie c e o f c o d e is t e llin g t h e J a v a r u n t im e s y s t e m t o
ig n o r e t h e p e r m is s io n s o f it s c a lle r s a n d t h a t it it s e lf
is t a k in g r e s p o n s ib ilit y in e x e r c is in g it s p e r m is s io n s .
N o t e t h a t t h e p r o t e c t io n d o m a in s o f t h e c o d e t h a t is
s u b s e q u e n t ly c a lle d b y t h e \ p r iv ile g e d " c o d e a r e s t ill
c o n s id e r e d w h e n d e c id in g w h e t h e r t o g r a n t p e r m is -
s io n s .
L o o k in g f r o m a n o t h e r a n g le , t h e p e r m is s io n o f a n
e x e c u t io n t h r e a d is t h e in t e r s e c t io n o f t h e p e r m is s io n s
o f a ll p r o t e c t io n d o m a in s t r a v e r s e d b y t h e e x e c u t io n
t h r e a d , e x c e p t t h a t , w h e n a p ie c e o f c o d e c a lls t h e
b e g i n P r i v i l e g e d ( ) p r im it iv e , t h e in t e r s e c t io n is p e r -
f o r m e d o n ly o n t h e p r o t e c t io n d o m a in o f t h e p r iv ile g e d
c o d e a n d t h e d o m a in s o f it s s u b s e q u e n t c a lle e s . T h is
is illu s t r a t e d in F ig u r e 3 . T h e a c t u a l im p le m e n t a t io n
o f t h e a c c e s s c o n t r o lle r c a n t a k e v a r io u s s h a p e s , b u t it
m u s t f o llo w t h e a b o v e b a s ic p r in c ip le .
4 . 3 I m p l e m e n t a t i o n o f A c c e s s C o n t r o l l e r
T h e m o s t im p o r t a n t m e t h o d in
A c c e s s C o n t r o l l e r c h e c k P e r m i s s i o n ( )t h e c la s s is ,
a n d t h e r e a r e a t le a s t t w o s t r a t e g ie s f o r im p le m e n t in g
it . I n a n \ e a g e r e v a lu a t io n " im p le m e n t a t io n , w h e n -
6 o f 1 0
F ig u r e 3 : M a k in g A c c e s s C o n t r o l D e c is io n s
e v e r a t h r e a d e n t e r s a n e w p r o t e c t io n d o m a in o r e x it s
f r o m o n e , t h e s e t o f e (cid:11) e c t iv e p e r m is s io n s is c o m p u t e d
d y n a m ic a lly . T h e b e n e (cid:12) t is t h a t c h e c k in g w h e t h e r a
p e r m is s io n is a llo w e d is s im p li(cid:12) e d a n d c a n b e f a s t e r
in m a n y c a s e s . T h e d is a d v a n t a g e is t h a t , b e c a u s e
p e r m is s io n c h e c k in g o c c u r s m u c h le s s f r e q u e n t ly t h a n
c r o s s - d o m a in c a lls , a la r g e p e r c e n t a g e o f p e r m is s io n
u p d a t e s w ill b e u s e le s s e (cid:11) o r t . T h is o b s e r v a t io n is c r it -
ic a l a s e v e r y m e t h o d c a ll in J a v a c a n p o t e n t ia lly b e a
c r o s s - d o m a in c a ll, a n d c o m p u t in g t h e in t e r s e c t io n o f
p e r m is s io n s c a n b e e x p e n s iv e .
J D K 1 .2 u s e s \ la z y e v a lu a t io n " . W h e n e v e r a p e r -
m is s io n c h e c k in g is r e q u e s t e d , t h e in t e r s e c t io n is c o m -
p u t e d w it h r e g a r d t o t h e t h r e a d c u r r e n t s t a t e a s r e p -
r e s e n t e d in t h e f o r m o r t h e e q u iv a le n t o f t h e c u r r e n t
s t a c k p lu s it s p a r e n t a l h is t o r y . I n f a c t , t h e in t e r s e c t io n
o f a ll p e r m is s io n s e t s is n o t lit e r a lly im p le m e n t e d .
mM o r e p r e c is e ly , s u p p o s e t h e t h r e a d t r a v e r s e s
nc a lle r s b e lo n g in g t o d i(cid:11) e r e n t p r o t e c t io n d o m a in s , in
nt h e o r d e r o f d o m a in 1 t o d o m a in 2 t o d o m a in . D o -
n c h e c k P e r m i s s i o n ( )m a in t h e n in v o k e s t h e m e t h o d .
T h e la z y e v a lu a t io n im p le m e n t s t h e f o llo w a lg o r it h m :
i = n ;
w h i l e ( i > 0 ) {
i f ( d o m a i n i d o e s n o t h a v e p e r m i s s i o n )
t h r o w A c c e s s C o n t r o l E x c e p t i o n ;
e l s e i f ( d o m a i n i i s p r i v i l e g e d ) r e t u r n ;
i = i - 1 ;
} r e t u r n ;
O n e p o t e n t ia l d o w n s id e o f t h is a p p r o a c h is p e r f o r -
m a n c e p e n a lt y a t a c t u a l t im e o f p e r m is s io n c h e c k in g ,
a lt h o u g h t h is p e n a lt y w o u ld h a v e b e e n in c u r r e d a n y -
w a y in t h e \ e a g e r e v a lu a t io n " a p p r o a c h , a lb e it a t e a r -
lie r t im e s a n d s p r e a d o u t a m o n g e a c h c r o s s - d o m a inc a ll. P e r f o r m a n c e d a t a w ill s h o w la t e r t h a t la z y e v a l-
u a t io n is e (cid:14) c ie n t in p r a c t ic e .
4 . 4 M o r e o n P r i v i l e g e d C o d e
T h e c o r r e c t u s a g e o f t h e p r iv ile g e p r im it iv e is t h e
f o llo w in g :
t r y {
A c c e s s C o n t r o l l e r . b e g i n P r i v i l e g e d ( ) ;
s o m e s e n s i t i v e c o d e
} f i n a l l y {
A c c e s s C o n t r o l l e r . e n d P r i v i l e g e d ( ) ;
}
T h e c o n c e p t o f b e in g p r iv ile g e d is s c o p e d b y t h e
t h r e a d w it h in w h ic h t h e c a ll t o b e c o m e p r iv ile g e d is
m a d e . T h e s a m e p r o t e c t io n d o m a in in o t h e r t h r e a d s
a r e n o t a (cid:11) e c t e d . A ls o , t h e p r iv ile g e p r im it iv e c a n b e
n e s t e d . M o r e o v e r , a lt h o u g h t h e c o d e in s id e t r y - (cid:12) n a lly
is p r iv ile g e d , it w ill lo s e it s p r iv ile g e if it c a lls c o d e
t h a t is le s s p r iv ile g e d .
F in a lly , a lt h o u g h it is a g o o d id e a t o u s e
b e g i n P r i v i l e g e d ( ) e n d P r i v i l e g e d ( )a n d in p a ir s
a s t h is c le a r ly s c o p e s t h e p r iv ile g e d c o d e , s o m e
p r o g r a m m e r s m a y c a ll a n e x t r a o r f o r g e t t o c a ll
e n d P r i v i l e g e d ( ) . W e h a v e p r o v id e d e x t r a p r o t e c -
t io n t o r e d u c e t h e r is k in s u c h a s it u a t io n . F o r
e x a m p le , t o m o u n t a n a t t a c k t h r o u g h a f o r g o t t e n
e n d P r i v i l e g e d ( ) c a ll, t h e a t t a c k in g c o d e m u s t b e
a b le t o r e c r e a t e t h e s t a c k h is t o r y , w it h t h e c o r r e c t
f r a m e d e p t h a n d f r a m e n u m b e r t h a t is a r b it r a r ily c h o -
s e n b y t h e J a v a v ir t u a l m a c h in e f r o m a p o o l o f a v a il-
a b le n u m b e r s .
4 . 5 P e r f o r m a n c e
B e c a u s e e a r lie r J D K im p le m e n t a t io n s d id e x -
a m in e s t a c k c o n t e x t t o lo o k f o r t h e p r e s e n c e o f
A c c e s s C o n t r o l l e ra p p le t s , h a v in g t h e lo o k o v e r
t h e s t a c k h is t o r y is n o t in t r in s ic ly s lo w e r . T h e
A c c e s s C o n t r o l l e r . c h e c k P e r m i s s i o n ( ) m e t h o d is
im p le m e n t e d a s f o llo w s ( p s e u d o c o d e ) .
v o i d c h e c k P e r m i s s i o n ( P e r m i s s i o n p e r m )
t h r o w s A c c e s s C o n t r o l E x c e p t i o n {
g e t P r o t e c t i o n D o m a i n C o n t e x t ( ) ;
f o r e a c h d o m a i n i n c o n t e x t {
g e t t h e p e r m i s s i o n _ s e t o f t h e d o m a i n ;
i f ( p e r m i s s i o n _ s e t . i m p l i e s ( p e r m ) = = f a l s e )
t h r o w n e w A c c e s s C o n t r o l E x c e p t i o n ( ) ;
}
}
7 o f 1 0
N o t e t h a t a n o p t im iz a t io n t e c h n iq u e , e x p la in e d
la t e r , e lim in a t e s t h e n e e d t o d e a l w it h p r iv ile g e d c o d e
i m p l i e s ( )h e r e . A ls o , t h e m e t h o d c a n b e e x p e n s iv e
b e c a u s e it g o e s t h r o u g h a ll p e r m is s io n s ( g r a n t e d t o t h e
d o m a in ) t h a t a r e o f t h e a p p r o p r ia t e t y p e a n d c h e c k s
if a n y o f t h o s e im p lie s t h e r e q u e s t e d p e r m is s io n .
W e d e p lo y e d a f e w o p t im iz a t io n t e c h n iq u e s in
g e t P r o t e c t i o n D o m a i n C o n t e x t ( ) t o m a k e a c c e s s c o n -
t r o l g o f a s t , m a in ly b y r e d u c in g t h e s iz e o f t h e c o n t e x t
a s it im p a c t s t h e f o r lo o p . O b v io u s ly s o m e o f t h e s e
t e c h n iq u e s n e e d t o b e c h a n g e d if t h e b a s ic a lg o r it h m
is c h a n g e d .
(cid:15)
I n t h e p r o t e c t io n d o m a in c o n t e x t t h a t is r e t u r n e d
A c c e s s C o n t r o l l e rt o , w e r e t u r n o n ly t h e d o -
m a in s u p t o ( a n d in c lu d e ) t h e (cid:12) r s t p r iv ile g e d d o -
m a in , b e c a u s e o u r a lg o r it h m s a y s t h a t if a p r iv -
ile g e d c la s s b e lo n g s t o a p r o t e c t io n d o m a in t h a t
h a s t h e r e q u e s t e d p e r m is s io n , t h e c h e c k s h o u ld g o
4
t h r o u g h ; o t h e r w is e , t h e c h e c k s h o u ld f a il.
(cid:15)
W e e lim in a t e s y s t e m d o m a in s f r o m t h e r e t u r n e d
p r o t e c t io n d o m a in c o n t e x t , b e c a u s e t h e s y s t e m
d o m a in b y d e f a u lt h a s a ll p e r m is s io n s .
(cid:15)
W e r e t u r n o n ly d i s t i n c t d o m a in s . F o r e x a m p le , if
t h e r e a r e m a n y c la s s e s t h a t a ll b e lo n g t o o n e p r o -
t e c t io n d o m a in , t h e n t h e r e t u r n e d c o n t e x t c o n -
t a in s o n ly o n e s u c h d o m a in . T h e o r d e r o f d o m a in s
d o e s n o t m a t t e r f o r s e c u r it y .
(cid:15)
A ll a b o v e o p t im iz a t io n s a r e a p p lie d t o t h e c u r -
r e n t t h r e a d c o n t e x t a s w e ll a s t h e in h e r it e d p a r e n t
t h r e a d c o n t e x t .
W e t e s t e d o u r im p le m e n t a t io n o n a S u n S p a r c
U lt r a - 1 r u n n in g S o la r is 2 .5 .1 w it h t h e la t e s t in - h o u s e
b u ild o f J D K 1 .2 , b u t w it h o u t a J I T c o m p ile r . W e
u s e d lo o p s w it h 1 0 ,0 0 0 it e r a t io n s , a n d u s e d t h e s im p le
S y s t e m . c u r r e n t T i m e M i l l i s ( ) m e t h o d c a ll t o o b t a in
t im e in m illis e c o n d s .
W e (cid:12) r s t c r e a t e d c a ll c h a in s o f t h e f o llo w in g s t r u c -
2 n
t u r e , w h ic h w e u s e S A ( B C ) B t o d e n o t e , w h e r e t h e
c h a in s t a r t s w it h t w o c la s s e s o f t h e s y s t e m d o m a in
n( S ) a n d a n a p p lic a t io n d o m a in ( A ) , it e r a t io n s o f
t h e t w o a p p lic a t io n s d o m a in s ( B a n d C ) c a llin g e a c h
o t h e r , a n d e n d s w it h d o m a in B in v o k in g t h e c a ll
A c c e s s C o n t r o l l e r . c h e c k P e r m i s s i o n ( ) . W e c o n (cid:12) g -
u r e d t h e s e c u r it y p o lic y t o g r a n t t h e r e q u e s t e d p e r m is -
s io n t o a ll a p p lic a t io n d o m a in s , w h ic h e n s u r e s t h a t a ll
4
T h is o p t im iz a t io n is a ls o c o n v e n ie n t , b e c a u s e in fo r m a t io n
a b o u t p r iv ile g e s t a t u s is s t o r e d in a C s t r u c t u r e . I f w e h a v e t o
r e t u r n d o m a in s b e y o n d t h e (cid:12) r s t p r iv ile g e d o n e , w e w o u ld c r e a t e
a d d it io n a l s t o r a g e a n d p r o c e s s in g o v e r h e a d in J a v a , n o t o n ly fo r
t h e e x t r a d o m a in s b u t a ls o t h e ir p r iv ile g e s t a t u s .a p p lic a t io n d o m a in s a r e c h e c k e d . F o r c o m p a r is o n , w e
a ls o m e a s u r e d t im e w it h o u t o p t im iz a t io n ( b y r e m o v -
in g t h o s e t e c h n iq u e s f r o m t h e c o d e ) . T h e r e s u lt s a r e
r e p o r t e d in t h e le f t h a lf o f T a b le 1 .
d o m a in s c h e c k in g t im e c h e c k in g t im e
n ( 2 n + 4 ) ( o p t im iz e d ) ( n o n - o p t im iz e d )
u s e c u s e c0 4 1 7 4 .6 1 7 7 .8
u s e c u s e c1 6 2 5 2 .2 3 0 8 .0
u s e c u s e c2 8 2 6 1 .6 4 4 4 .3
u s e c u s e c3 1 0 2 7 0 .7 5 8 0 .2
u s e c u s e c4 1 2 2 8 3 .7 7 3 0 .4
u s e c u s e c5 1 4 2 9 7 .5 8 7 8 .7
u s e c u s e c6 1 6 3 0 2 .9 1 0 0 1 .8
u s e c u s e c7 1 8 3 1 2 .2 1 1 5 1 .6
u s e c u s e c8 2 0 3 2 4 .9 1 2 7 0 .4
u s e c u s e c9 2 2 3 3 3 .7 1 4 0 3 .2
T a b le 1 : P e r f o r m a n c e o f c h e c k P e r m is s io n ( 0 8 / 0 1 / 9 7 )
W e c a n s e e t h a t f o r e v e r y t w o a d d it io n a l d o m a in s ,
u s e ca b o u t a n e x t r a 1 0 is u s e d . W e a ls o im a g in e d
t h a t , if w e h a v e a la r g e n u m b e r o f d is t in c t p r o -
t e c t io n d o m a in s , t h e c h e c k in g t im e s h o u ld in c r e a s e
r o u g h ly lin e a r ly . F o r v a lid a t io n , w e r e p e a t e d t h e
s a m e e x p e r im e n t s , e x c e p t t h a t w e r e m o v e d t h e o p -
t im iz a t io n t e c h n iq u e t h a t c a c h e s a lr e a d y - c h e c k e d d o -
m a in s . T h is m e a n s t h a t n o n e o f t h e a p p lic a t io n d o -
m a in s a r e c o lla p s e d o r c a c h e d , s o t h a t a s t a c k o f t h e
2 n
nf o r m S A ( B C ) B is e q u iv a le n t t o h a v in g 2 + 2 d is -
t in c t a p p lic a t io n d o m a in s . T h e r e s u lt s a r e r e p o r t e d
in t h e r ig h t h a lf o f T a b le 1 b e lo w . W e c a n s e e t h a t
u s e cf o r e a c h a d d it io n a l d o m a in , a b o u t 7 0 m o r e t im e
is r e q u ir e d . F ig u r e 4 illu s t r a t e s t h e n u m b e r s r e p o r t e d
in T a b le 1 .
T h e a b o v e e x p e r im e n t s w e r e p e r f o r m e d w h e r e e a c h
p r o t e c t io n h a s 4 o r 5 d i(cid:11) e r e n t p e r m is s io n s . W h e n t h e
n u m b e r o f p e r m is s io n s in c r e a s e , w e e x p e c t t h e c h e c k -
in g t im e t o in c r e a s e t o o , a lt h o u g h w e u s e a v a r ie t y o f
o p t im iz a t io n t e c h n iq u e s t h e r e . W e c u r r e n t ly d o n o t
h a v e a n y p e r f o r m a n c e n u m b e r s in t h is r e g a r d . W e
a ls o d o n o t r e p o r t e x p e r im e n t r e s u lt s w it h m o r e t h a n
2 0 d is t in c t a p p lic a t io n d o m a in s , a s w e d o n o t e n v is io n
t h e n u m b e r b e in g s ig n i(cid:12) c a n t ly la r g e r in r e a l- w o r ld a p -
p lic a t io n s .
W e f a c e d m o r e p r o b le m s w it h t h e p r iv ile g e d
c o n s t r u c t . W e s t a r t e d o (cid:11) b y im p le m e n t in g t h e
p r iv ile g e d m e c h a n is m in J a v a c o d e . T h is im p le -
m e n t a t io n in c lu d e d a h a s h t a b le in d e x e d o n t h e
t h r e a d o b j e c t , a n d s t o r e d in f o r m a t io n t h a t c o r r e s p o n d
b e g i n P r i v i l e g e d ( ) e n d P r i v i l e g e d ( )t o a n d c a lls .
8 o f 1 0
F ig u r e 4 : P e r f o r m a n c e o f c h e c k P e r m is s io n ( 0 8 / 0 1 / 9 7 )
T h is w a s f a ir ly e (cid:14) c ie n t f o r t h e s o r t o f a c c e s s c o n t r o l
c h e c k in g w e e n v is io n e d , s u c h a s c h e c k in g f o r (cid:12) le a c c e s s .
H o w e v e r , s o o n t h e s e c u r it y m o d e l b e c a m e w id e ly
u s e d t h r o u g h o u t t h e J D K c o d e b a s e it s e lf , a n d p a c k -
a g e s f o r d e b u g g in g a n d r e (cid:13) e c t io n ( a m o n g o t h e r s ) d e -
m a n d e d s u p e r f a s t s p e e d . T h e e a r lie r p u r e J a v a im -
p le m e n t a t io n b e c a m e s o m e w h a t p r o b le m a t ic f o r t h e s e
n e w a r e a s o f a p p lic a t io n s , b e c a u s e t h e y w o u ld h a v e
t o o r ig in a t e c a lls f r o m C in t o J a v a a n d t h e n b a c k t o
C , w h e r e t h e r o u n d t r ip c o s t is t o o h ig h , a n d b e c a u s e
h a v in g t o m a n a g e a h a s h t a b le f o r e v e r y p r iv ile g e c a ll
w a s r e la t iv e ly e x p e n s iv e .
W e s u b s e q u e n t ly c h a n g e d o u r im p le m e n t a t io n t o
m a in t a in a n d m a n ip u la t e a r e c o r d o f p r iv ile g e d f r a m e s
in a p e r - t h r e a d e n v ir o n m e n t in C . A f t e r o t h e r v a r io u s
t u n in g , w e o b t a in e d t h e f o llo w in g r o u g h e s t im a t e , o n
t h e s a m e t e s t p la t f o r m d e s c r ib e d e a r lie r , e x c e p t t h a t
w e u s e d lo o p s w it h 1 0 0 ,0 0 0 it e r a t io n s . W e r a n t e s t s
o v e r s e v e r a l m e t h o d c a lls ( in c lu d in g a v o id c a ll t h a t
d o e s n o t h in g ) a n d t h e r e s u lt s f o r c o m p a r is o n , in m i-
u s e cc r o s e c o n d s ( ) , a r e in T a b le 2 .
p la in p r iv ile g e d in c r e a s e
c a ll c a ll
u s e c u s e c u s e cm 1 0 .8 6 2 .9 6 2 .1 0 ( 2 4 4 % )
u s e c u s e c u s e cm 2 2 .7 2 4 .9 2 2 .2 0 ( 8 1 % )
u s e c u s e c u s e cm 3 5 .8 3 7 .9 6 2 .1 3 ( 3 7 ) %
u s e c u s e c u s e cm 4 3 1 .0 3 3 3 .9 8 2 .9 5 ( 1 0 % )
u s e c u s e c u s e c <m 5 8 1 5 .2 0 8 1 6 .9 4 1 .7 4 ( 0 .3 % )
T a b le 2 : P e r f o r m a n c e o f P r iv ile g e d B lo c k s ( 0 7 / 3 0 / 9 7 )
T h is t a b le s h o w s t h a t t h e e x t r a e (cid:11) o r t f o r c r e a t in ga
n
n
m
m
m
m
m
5
w
n
p
c
t
n
c
t
c
o
o
t
n
a
p
t
J
w
a
O
n
s
t
e
d
t
o
d
m
h
F
t
}
}
n d d is m a n t lin g a p r iv ile g e d b lo c k is c o n s is t e n t ly a t
u s e co t m o r e t h a n 2 o r 3 . H e r e , w e u s e t h e f o llo w in g
o t a t io n s .
1 = v o id m e t h o d
2 = F ile ( \ / t m p / a " )
3 = D a t e ( )
4 = S y s t e m .g e t P r o p e r t y ( u s e r .h o m e )
5 = D a t e ( 1 , 2 , 3 )
D i s c u s s i o n a n d F u t u r e W o r k
T o p r o v id e a r o u g h s e n s e o f t h e s c a le o f t h e w o r k ,
e c o u n t e d t h e n u m b e r o f lin e s o f J a v a s o u r c e c o d e in
e w ly in t r o d u c e d c la s s e s t h a t r e la t e d d ir e c t ly t o t h e
r o t e c t io n c o n c e p t a n d it s u s a g e . W e d id n o t c o u n t
la s s e s t h a t e x is t e d in J D K 1 .1 , s o m e o f w h ic h a r e e x -
e n s iv e ly m o d i(cid:12) e d , a n d t h e r e la t iv e ly s m a ll a m o u n t o f
e w C c o d e . T h e t o t a l n u m b e r o f lin e s o f c o d e in n e w ly
r e a t e d c la s s e s e x c lu d in g t h e c o p y r ig h t n o t ic e s c o m e s
o a b o u t 5 0 0 0 . T h e t o t a l f o o t p r in t ( i.e ., s iz e o f b y t e -
o d e ) o f t h e s e c la s s e s is a b o u t 4 8 .5 K b y t e s . N u m e r -
u s e x is t in g c la s s e s ( p e r h a p s w it h a n o t h e r 5 0 0 0 lin e s
f c o d e ) h a v e b e e n c h a n g e d , s o t h e t o t a l im p le m e n -
a t io n e (cid:11) o r t w e n t m u c h b e y o n d c r e a t in g t h e c o u n t e d
e w c la s s e s . F o r e x a m p le , s u p p o r t in g p a c k a g e s , s u c h
j a v a . s e c u r i t y . c e r ts a n d t h e e n t ir e ly X .5 0 9 v 3 im -
le m e n t a t io n , h a v e b e e n a d d e d f o r t h e (cid:12) r s t t im e .
I t is w o r t h n o t in g t h a t w e h a v e b e e n a b le t o e v o lv e
h e e x is t in g s e c u r it y m e c h a n is m s in J D K 1 .0 .x a n d
D K 1 .1 .x t o im p le m e n t t h e n e w s e c u r it y a r c h it e c t u r e
it h o u t c h a n g in g t h e u n d e r ly in g J a v a v ir t u a l m a c h in e
n d w it h o u t c a u s in g a n y in c o m p a t ib le A P I c h a n g e s .
u r d e s ig n a n d im p le m e n t a t io n f o llo w s t r ic t ly t h e b i-
a r y c o m p a t ib ilit y r u le s g iv e n in t h e J a v a la n g u a g e
p e c i(cid:12) c a t io n .
W e c a n im a g in e s e v e r a l r e (cid:12) n e m e n t s . F o r e x a m p le ,
h e p r iv ile g e d p r im it iv e a s c u r r e n t ly d e s ig n e d w o u ld
n a b le p r iv ile g e f o r a ll t h e p e r m is s io n s g r a n t e d t o a
o m a in . W e c a n e x t e n d t h e p r im it iv e s o t h a t a p r o -
e c t io n d o m a in c a n r e q u e s t p r iv ile g e f o r o n ly a s u b s e t
f a ll it s g r a n t e d p e r m is s io n s . T h is c o u ld f u r t h e r r e -
u c e t h e s e c u r it y im p a c t o f m a k in g a p r o g r a m m in g
is t a k e . T h e p s e u d o c o d e s e g m e n t b e lo w illu s t r a t e s
o w t o r e q u e s t p r iv ile g e o f r e a d in g o n e (cid:12) le .
i l e P e r m i s s i o n p =
n e w F i l e P e r m i s s i o n ( " / t m p / x . t x t " , " r e a d " ) ;
r y {
A c c e s s C o n t r o l l e r . b e g i n P r i v i l e g e d ( p ) ;
s o m e s e n s i t i v e c o d e
f i n a l l y {
A c c e s s C o n t r o l l e r . e n d P r i v i l e g e d ( p ) ;
9 o f 1 0
M o r e o v e r , w e t e n d t o t h in k o f t h e s y s t e m d o m a in
a s a s in g le c o lle c t io n t h a t in c lu d e s a ll s y s t e m c o d e .
I t is p o s s ib le t o a r r a n g e s o t h a t s y s t e m c o d e r u n in
m u lt ip le s y s t e m d o m a in s , w h e r e e a c h d o m a in p r o t e c t s
a p a r t ic u la r t y p e o f r e s o u r c e a n d is g iv e n a s p e c ia l s e t
o f p e r m is s io n s . F o r e x a m p le , w e c a n g r a n t (cid:12) le s y s t e m
c o d e o n ly a c c e s s p e r m is s io n s t o (cid:12) le s y s t e m r e s o u r c e s ,
a n d n e t w o r k s y s t e m c o d e o n ly a c c e s s p e r m is s io n s t o
n e t w o r k r e s o u r c e s . T h is w o u ld b e o n e s t e p c lo s e r t o
t h e le a s t - p r iv ile g e p r in c ip le , a n d t h e c o n s e q u e n c e o f
a n e r r o r o r s e c u r it y (cid:13) a w in o n e s y s t e m d o m a in is m o r e
lik e ly t o b e c o n (cid:12) n e d w it h in it s s m a lle r b o u n d a r y .
F in a lly , p r o t e c t io n d o m a in a ls o s e r v e s a s a c o n v e -
n ie n t p o in t f o r g r o u p in g a n d is o la t io n b e t w e e n u n it s
o f p r o t e c t io n w it h in t h e J a v a r u n t im e . F o r e x a m p le ,
A p p l e t C l a s s L o a d e ra lt h o u g h t h e c la s s u s e d b y t h e
a p p l e t v i e w e r in J D K 1 .2 w ill lo a d c la s s e s f r o m d i(cid:11) e r -
e n t d o m a in s , it is p o s s ib le t o c u s t o m iz e a c la s s lo a d e r
t h a t w ill c r e a t e d i(cid:11) e r e n t d o m a in s s u c h t h a t t h e y a r e
s e p a r a t e d f r o m in t e r a c t in g w it h e a c h o t h e r . I n t h is
c a s e , a n y p e r m it t e d in t e r a c t io n m u s t b e e it h e r t h r o u g h
t r u s t e d s y s t e m c o d e o r e x p lic it ly a llo w e d b y t h e d o -
m a in s c o n c e r n e d .
N o t e t h a t , in J D K 1 .2 a r c h it e c t u r e , t h e is s u e o f a c -
c e s s ib ilit y is o r t h o g o n a l t o s e c u r it y . I n t h e J a v a v ir t u a l
m a c h in e , a c la s s is d is t in g u is h e d b y it s e lf p lu s t h e c la s s
lo a d e r in s t a n c e t h a t lo a d e d t h e c la s s . C la s s e s lo a d e d
b y d i(cid:11) e r e n t c la s s lo a d e r s liv e in d i(cid:11) e r e n t n a m e s p a c e s .
T h u s a c la s s lo a d e r c a n b e u s e d t o is o la t e a n d p r o -
t e c t c o d e w it h in o n e p r o t e c t io n d o m a in if t h e lo a d e r
r e f u s e s t o lo a d c o d e f r o m d i(cid:11) e r e n t d o m a in s . O n t h e
o t h e r h a n d , if o n e w is h e s t o a llo w c o d e f r o m d i(cid:11) e r e n t
d o m a in s t o in t e r a c t w it h e a c h o t h e r , o n e c o u ld u s e
A p p l e t C l a s s L o a d e ra c la s s lo a d e r , s u c h a s t h e , t h a t
d e (cid:12) n e s c la s s e s in d i(cid:11) e r e n t d o m a in s .
6 R e l a t e d W o r k
T h e f u n d a m e n t a l id e a s a d o p t e d in t h e n e w J D K 1 .2
s e c u r it y a r c h it e c t u r e h a v e r o o t s in t h e la s t 4 0 y e a r s
o f c o m p u t e r s e c u r it y r e s e a r c h . S ig n i(cid:12) c a n t ly , o u r d e -
s ig n h a s b e e n in s p ir e d b y t h e c o n c e p t o f p r o t e c t io n d o -
m a in s a n d t h e w o r k d e a lin g w it h m u t u a lly s u s p ic io u s
p r o g r a m s in M u lt ic s [1 0 , 8 ], a n d r ig h t a m p li(cid:12) c a t io n in
H y d r a [6 , 1 2 ].
O n e f e a t u r e t h a t is n o t p r e s e n t in o p e r a t in g s y s t e m s
s u c h a s U n ix o r M S - D O S , is t h a t w e im p le m e n t t h e
le a s t - p r iv ile g e p r in c ip le b y a u t o m a t i c a l ly in t e r s e c t in g
t h e s e t s o f p e r m is s io n s g r a n t e d t o p r o t e c t io n d o m a in s
t h a t a r e in v o lv e d in a c a ll s e q u e n c e . T h is w a y , a p r o -
g r a m m in g e r r o r in s y s t e m o r a p p lic a t io n s o f t w a r e isle s s lik e ly t o b e e x p lo it a b le a s a s e c u r it y h o le . D u r -
in g t h e c o u r s e o f J D K 1 .2 im p le m e n t a t io n , f r o m t im e
t o t im e , s o m e ( n o n - s e c u r it y ) f e a t u r e w o u ld n o lo n g e r
w o r k d u e t o t h e m o r e r e s t r ic t e d s e c u r it y m o d e l t h a t
h a s b e e n p u t in p la c e . S u c h e v e n t s h a v e p u s h e d t h e
d e v e lo p e r s t o t a k e a c lo s e r lo o k a t t h e ir c o d e t o m a k e
s u r e t h a t n e c e s s a r y s e c u r it y c h e c k s a r e in v o k e d a n d
t h a t t h e p r iv ile g e p r im it iv e is u s e d o n ly s c a r c e ly a n d
o n ly u n d e r t h e a p p r o p r ia t e c ir c u m s t a n c e s .
A n o t h e r c h a r a c t e r o f J a v a is t h a t it s p r o t e c t io n
m e c h a n is m s a r e la n g u a g e - b a s e d , w it h in a s in g le a d -
d r e s s s p a c e . T h is f e a t u r e is a m a j o r d is t in c t io n f r o m
m o r e t r a d it io n a l o p e r a t in g s y s t e m s , b u t is v e r y m u c h
r e la t e d t o r e c e n t w o r k s o n s o f t w a r e - b a s e d p r o t e c t io n
a n d s a f e k e r n e l e x t e n s io n s ( e .g ., [2 , 1 , 1 1 ]) , w h e r e v a r -
io u s r e s e a r c h t e a m s h a v e la t e ly a im e d f o r s o m e o f t h e
s a m e g o a ls w it h d i(cid:11) e r e n t p r o g r a m m in g t e c h n iq u e s .
7 C o n c l u s i o n
T h is p a p e r d e s c r ib e s in d e t a il t h e d e s ig n a n d im p le -
m e n t a t io n o f t h e c o n c e p t o f p r o t e c t io n d o m a in s , w h ic h
is a n im p o r t a n t f o u n d a t io n o f t h e n e w s e c u r it y a r c h i-
T M
t e c t u r e d e liv e r e d in t h e u p c o m in g J a v a D e v e lo p m e n t
K it ( J D K 1 .2 .) f r o m J a v a S o f t , S u n M ic r o s y s t e m s .
O u r c o n t r ib u t io n is t o a d a p t w e ll- e s t a b lis h e d c o n -
c e p t s f r o m y e a r s o f c o m p u t e r s e c u r it y r e s e a r c h t o a
d e s ig n a n d im p le m e n t a t io n t h a t s u it s p a r t ic u la r ly w e ll
f o r t h e J a v a e n v ir o n m e n t . O u r e n g in e e r in g e (cid:11) o r t h a s
c le a r ly d e m o n s t r a t e d t h e (cid:13) e x ib ilit y a n d e v o lv e a b ilit y
o f J a v a a n d h a s p r o v e n t h a t p o lic y - b a s e d , e a s ily c o n -
(cid:12) g u r a b le , (cid:12) n e - g r a in e d a c c e s s c o n t r o l c a n b e a c h ie v e d
e (cid:14) c ie n t ly o n t h e J a v a p la t f o r m .
A c k n o w l e d g m e n t s
M e m b e r s o f t h e J a v a S o f t c o m m u n it y , in c lu d in g
J o s h B lo c h , S h e n g L ia n g , M a r ia n n e M u e lle r , H e m m a
P r a f u llc h a n d r a , N a k u l S a r a iy a , a n d B ill S h a n n o n , p r o -
v id e d v a lu a b le a s s is t a n c e in d e s ig n r e v ie w s a n d im p le -
m e n t a t io n .
R e f e r e n c e s
[1 ] B . N . B e r s h a d , S . S a v a g e , P . P a r d y a k , E . G .
S ir e r , M . F iu c h y n s k i, D . B e c k e r , S . E g g e r s , a n d
C . C h a m b e r s . E x t e n s ib ilit y , S a f e t y , a n d P e r f o r -
m a n c e in t h e S P I N O p e r a t in g S y s t e m . I n P r o -
c e e d i n g s o f t h e 1 5 t h A C M S y m p o s i u m o n O p e r a t -
i n g S y s t e m s P r i n c i p le s , p a g e s 2 5 1 { 2 6 6 , C o lo r a d o ,
1 0 o f 1
[2
[3
[4
[5
[6
[7
[8
[9
[1 0
[1 1
[1 2
0
]
]
]
]
]
]
]
]
]
]
]
D e c e m b e r 1 9 9 5 . P u b lis h e d a s A C M O p e r a t in g
S y s t e m R e v ie w 2 9 ( 5 ) :2 5 1 { 2 6 6 , 1 9 9 5 .
J .S . C h a s e , H .M . L e v y , M .J . F e e le y , a n d E .D .
L a z o w s k a . S h a r in g a n d P r o t e c t io n in a S in g le -
A d d r e s s - S p a c e O p e r a t in g S y s t e m . A C M T r a n s -
a c t i o n s o n C o m p u t e r S y s t e m s , 1 2 ( 4 ) :2 7 1 { 3 0 7 ,
N o v e m b e r 1 9 9 4 .
L . G o n g . J a v a S e c u r it y : P r e s e n t a n d N e a r F u t u r e .
I E E E M i c r o , 1 7 ( 3 ) :1 4 { 1 9 , M a y / J u n e 1 9 9 7 .
L . G o n g , M . M u e lle r , H . P r a f u llc h a n d r a , a n d
R . S c h e m e r s . G o in g B e y o n d t h e S a n d b o x : A n
O v e r v ie w o f t h e N e w S e c u r it y A r c h it e c t u r e in t h e
T M
J a v a D e v e lo p m e n t K it 1 .2 . I n P r o c e e d i n g s o f
t h e U S E N I X S y m p o s i u m o n I n t e r n e t T e c h n o lo -
g i e s a n d S y s t e m s , p a g e s 1 0 3 { 1 1 2 , M o n t e r e y , C a l-
if o r n ia , D e c e m b e r 1 9 9 7 .
J . G o s lin g , B ill J o y , a n d G u y S t e e le . T h e J a v a
L a n g u a g e S p e c i (cid:12) c a t i o n . A d d is o n - W e s le y , M e n lo
P a r k , C a lif o r n ia , A u g u s t 1 9 9 6 .
A .K . J o n e s . P r o t e c t i o n i n P r o g r a m m e d S y s t e m s .
P h .D . d is s e r t a t io n , C a r n e g ie - M e llo n U n iv e r s it y ,
P it t s b u r g h , P A 1 5 2 1 3 , J u n e 1 9 7 3 .
T . L in d h o lm a n d F . Y e llin . T h e J a v a V i r t u a l M a -
c h i n e S p e c i (cid:12) c a t i o n . A d d is o n - W e s le y , M e n lo P a r k ,
C a lif o r n ia , 1 9 9 7 .
J .H . S a lt z e r . P r o t e c t io n a n d t h e C o n t r o l o f I n f o r -
m a t io n S h a r in g in M u lt ic s . C o m m u n i c a t i o n s o f
t h e A C M , 1 7 ( 7 ) :3 8 8 { 4 0 2 , J u ly 1 9 7 4 .
J .H . S a lt z e r a n d M .D . S c h r o e d e r . T h e P r o t e c t io n
o f I n f o r m a t io n in C o m p u t e r S y s t e m s . P r o c e e d i n g s
o f t h e I E E E , 6 3 ( 9 ) :1 2 7 8 { 1 3 0 8 , S e p t e m b e r 1 9 7 5 .
M .D . S c h r o e d e r . C o o p e r a t i o n o f M u t u a l ly S u s p i -
c i o u s S u b s y s t e m s i n a C o m p u t e r U t i li t y . P h .D .
d is s e r t a t io n , M a s s a c h u s e t t s I n s t it u t e o f T e c h n o l-
o g y , C a m b r id g e , M A 0 2 1 3 9 , S e p t e m b e r 1 9 7 2 .
M . I . S e lt z e r , Y . E n d o , C . S m a ll, a n d K . A .
S m it h . D e a lin g w it h D is a s t e r : S u r v iv in g M is -
b e h a v e d K e r n e l E x t e n s io n s . I n P r o c e e d i n g s o f
t h e 2 n d U S E N I X S y m p o s i u m o n O p e r a t i n g S y s -
t e m s D e s i g n a n d I m p le m e n t a t i o n , p a g e s 2 1 3 { 2 2 7 ,
S e a t t le , W a s h in g t o n , O c t o b e r 1 9 9 6 . P u b lis h e d a s
A C M O p e r a t i n g S y s t e m s R e v i e w , 3 0 , s p e c ia l w in -
t e r is s u e , 1 9 9 6 .
W .A . W u lf , R . L e v in , a n d S .P . H a r b is o n . H Y -
D R A / C . m m p { A n E x p e r i m e n t a l C o m p u t e r S y s -
t e m . M c G r a w - H ill, 1 9 8 1 .