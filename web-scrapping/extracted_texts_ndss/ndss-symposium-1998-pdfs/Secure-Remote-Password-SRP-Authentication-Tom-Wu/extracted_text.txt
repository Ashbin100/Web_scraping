Secure Remote Password (SRP)
Authentication
Tom Wu
Stanford University
tjw@cs.Stanford.EDUAuthentication in General
u What you are
– Fingerprints, retinal scans, voiceprints
u What you have
– Token cards, smart cards
u What you know
– Passwords, PINs
2Password Authentication
u Concentrates on “what you know”
u No long-term client-side storage
u Advantages
– Convenience and portability
– Low cost
u Disadvantages
– People pick “bad” passwords
– Most password methods are weak
3Problems and Issues
u Dictionary attacks
u Plaintext-equivalence
u Forward secrecy
4Dictionary Attacks
u An off-line, brute force guessing attack
conducted by an attacker on the network
u Attacker usually has a “dictionary” of
commonly-used passwords to try
u People pick easily remembered passwords
u “Easy-to-remember” is also “easy-to-guess”
u Can be either passive or active
5Passwords in the Real World
u Entropy is less than most people think
u Dictionary words, e.g. “pudding”, “plan9”
– Entropy: 20 bits or less
u Word pairs or phrases, e.g. “hate2die”
– Represents average password quality
– Entropy: around 30 bits
u Random printable text, e.g. “nDz2\u>O”
– Entropy: slightly over 50 bits
6Plaintext-equivalence
u Any piece of data that can be used in place
of the actual password is “plaintext-
equivalent”
u Applies to:
– Password databases and files
– Authentication servers (Kerberos KDC)
u One compromise brings entire system down
7Forward Secrecy
u Prevents one compromise from causing
further damage
Compromising Should Not Compromise
Current password Future passwords
Old password Current password
Current password Current or past session keys
Current session key Current password
8In The Beginning...
u Plaintext passwords
– e.g. unauthenticated Telnet, rlogin, ftp
– Still most common method in use
u “Encoded” passwords
– e.g. HTTP Basic authentication
u Using password to encrypt verifiable text
– e.g. Kerberos
– vulnerable to dictionary attack
9More Weak Authentication
u Challenge-Response authentication
– e.g. S/Key, OPIE, CRAM
– User receives C, responds with f(C, P)
– Susceptible to passive dictionary attack
u “Public-Key-Assisted” Login
– e.g. stel, SRA Telnet
– Uses plain Diffie-Hellman or ephemeral RSA
– Susceptible to active attacks
10Augmenting Weak Methods
u Iterated hashing
– Increases amount of time required for attack
– Also slows down legitimate authentication
– Maximum improvement is less than 10 bits
u Computer-generated passwords
– Have higher entropy
– Easy to forget, and are more likely to be
written down (a security problem in itself)
11The Empire Strikes Back
u 20-25 bits can be attacked easily today
u Even one successful password guess
(weakest link in chain) lets an intruder in
u Attacks are easily parallelizable
u Moore’s law constantly erodes security of
weak methods
– Lose 2 bits of strength every three years
12Better Weapons
u EKE
– Bellovin & Merritt: 1992
u “Secret public-key”
– Gong, Lomas, Needham, Saltzer: 1993
u SPEKE
– Jablon: 1996
u OKE
– Lucks: 1997
13Advantages of Strong Methods
u Attacker must solve at least one “hard”
public-key problem first
u Key exchange after successful login
u Some also offer:
– Resistance to active attacks
– Forward secrecy
u But these are still plaintext-equivalent...
14Return of the Jedi
u A-EKE
– Bellovin & Merritt: 1994
u B-SPEKE
– Jablon: 1997
u SRP
– Wu: 1997
u All are verifier-based
15History of SRP
u Originally designed to handle
authentication between Java applet and
Java-based server at Stanford
u Widespread applicability and interest led to
development of software suite
u Discussions on led to final
sci.crypt
version, sometimes called SRP-3
16The SRP Protocol
m = large safe prime (2q+1, q prime)
g = primitive root mod m
P = plaintext password
Carol knows the password, x = H(P)
Steve knows the verifier, v = gx (mod m)
Carol (the client) Steve (the server)
Generates random a Generates random b, u
A = ga (mod m) B = v + gb (mod m), u
K = (B - gx)a+ux (mod m) K = (Avu)b (mod m)
Each side then proves it knows K
17Security Analysis
u g must be primitive root to avoid leaking
information about v
u Carol must be first to issue proof of K
u u must not be revealed before A
u Random numbers a, b must be discarded
when protocol finishes
u Check for invalid inputs, e.g. A, B == 0
18Protocol Families
u A- and B- protocols sometimes called
“extended” methods
– Two key-exchange rounds
– A-EKE: extra digital signature
– B-SPEKE: extra El Gamal key exchange
u SRP is part of a third family (AKE)
– Password and verifier are integrated into a
single key-exchange round
19How They Stack Up
Cleartext Challenge- Strong Verifier-
Password Response Password based
(SPEKE) (SRP)
Does not reveal No Yes Yes Yes
password
Resists No No Yes Yes
dictionary attack
Not plaintext- Yes No No Yes
equivalent
Provides forward No No Yes Yes
secrecy
20Some Scary Trends
u Inexpensive PCs can exceed 10K crypts/sec
u No Moore’s Law for human memory
u Increased size of Internet means more
access to free CPU cycles
u Even forcing “good” password choices only
delays inevitable
u “Bad guys” have caught up and taken the
lead (CERT Advisory 94:01)...
21Strong vs. Weak Methods
Effort needed to crack an average password
1E+12
1E+9
1E+6
1E+3
1E+0
1E-3
1995 2000 2005 2010 2015 2020 2025
22
)sruoh
*
CP(
kcatta
fo
tsoC
SRP
Iterated Hash
C-R
(safe)Impact of Strong Authentication
u Best known algorithms for compromising
SRP (discrete log) not easily parallelizable
u Places off-line attack against even short
passwords out of reach
u “Infinitely” stronger than weak methods
u Designed as drop-in replacements
u Low cost and socially acceptable
23Applications
u Remote login/access (Telnet, FTP)
u E-mail (POP, IMAP)
u World Wide Web
u Firewalls
u Network computers
u Any situation where an actual person needs
to be authenticated
24The SRP Project
u Freeware API library in both C and Java
u Telnet and FTP for Unix and Windows
u Distributed architecture being developed
u Public collaboration w/Internet community
u Drafts submitted to IETF, IEEE P1363
u Help always appreciated
– Join the mailing list
25Looking Ahead
u Increase awareness of “broken” systems
– Kerberos V4, V5, Windows NT, S/Key, ...
u Fix these systems where possible
– Jaspan, 1996 describes Kerberos fix
u Strong authentication mechanisms have
become “Best Current Practice”
– No excuse to use broken methods anymore
– Good guys are winning again...
26For More Information
u SRP Web Site
– http://srp.stanford.edu/srp/
– Contains links to download source code and
information about mailing list
u E-mail
– tjw@cs.Stanford.EDU
27