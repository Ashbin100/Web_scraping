Distributed Algorithms for Attack Localization in All-Optical Networks
RuthBergman MurielMe´dard Serena Chan
MassachusettsInstituteofTechnology
LincolnLaboratory
E-mail:ruth@ll.mit.edu, medard@ll.mit.edu, chans@mit.edu
Abstract Inthispaperwepresentanalgorithmthatfindstheorigin
oftheattackingsignal.Bylocalizingtheattackthenetwork
All-Optical Networks provide ultra-fast data rates, but maintains quality of service whereas an algorithm that lo-
present a new set of challenges for network security. We calizescomponentfailureswouldresultinservicedegrada-
presentanewalgorithmforattacklocalizationinnetworks. tion or denial(for exampleseesections 1.3and 4). While
The algorithmis distributed and requires onlylocal infor- thealgorithmwepresentisparticularlynecessaryforlocal-
mation. Thealgorithmcanlocalizeattacksforavarietyof izationof propagatingattacks, itwill also localizecompo-
network applications. This algorithm is particularly well nentfailureswhichwecanviewasnon-propagatingattacks.
suitedtotherequirementsofAll-OpticalNetworksbecause Intheremainderofthissection,wemotivatetheneedto
it provides fast, reliable response to attacks. In particular providealgorithmsforattacklocalizationinAONs,present
we applyitto two commonformsofrapidopticalnetwork a model of our problem and give an overviewof previous
restoration:automaticprotectionswitchingandloopback. researchonattacklocalizationinnetworks,inparticularre-
search that applies to AONs. In section 2, we present our
algorithm.Insection3,wediscussapplicationsofthealgo-
1.Introduction rithmtoattacklocalization. Insection4,weshowhowour
algorithmcanbeusedforservicerestorationafteranattack
for two important types of preplanned recovery schemes:
All-optical networks (AONs) are emerging as the net-
automaticpathprotectionswitchingandloopback. Finally,
works of choice for ultrafast (over 1 terabit per second
insection5, wepresentourconclusionsanddirectionsfor
[15]) communications and are being demonstrated in sev-
furtherresearch.
eral testbeds [19, 50, 16, 4, 5, 1, 10]. While the architec-
tures and implementations of AON testbeds vary, they all
1.1.AONVulnerabilitytoattack
share certain commonhardwarebuildingblocksand func-
tionalcharacteristics. Asthenameindicates,AONsdonot
containelectronicprocessingcomponents,therebyavoiding One of the main security issues for optical networks is
electronicbottlenecks.SignalswhichflowthroughanAON that service disruption attacks can spread through a net-
undergoonly all-opticalswitching(which affordsnetwork work. Weneedtobeabletodifferentiatebetweenafailure
functionality)andall-opticalamplification(whichcounter- andanattackandwemustbeabletolocatethesourceofan
actsattenuationoftheopticalsignalsthroughthenetwork). attack. Anoverviewofculnerabilitiesisgivenin[30]. For
Thedeviceswhichperformswitchingandamplification instance, at an amplifier, a user with a particularly strong
arerapidlymaturingbuthavecertaindrawbacks. Inpartic- signal can rob other users’ signals of power. Such a ne-
ular, they exhibit “crosstalk” characteristics, so that a ne- farioususercan disruptseveraluserswhoshareamplifiers
farious user on one channel can, by exploiting the physi- with him. We term this type of attack a gain competition
calpropertiesofswitchesandamplifiers,affectotherchan- attack.Inanotherexampleofmalicioususeofthenetwork,
nels whose routes share devices with the nefarious user’s a switching device can be used to insert a portion of one
channel. Sincethenefarioususer’ssignalflowsunchecked channel’ssignalontoanotherchannel’ssignal. Thetwoat-
throughtheAON,anattackermayusealegitimatemeansof tacks may be combined as shown on figure 1. Channel 1
accessingthenetworktoeffectaservicedisruptionattack, uses crosstalk at the switch to rob channel 3 of its power
causingaqualityofservicedegradationoroutrightservice at the amplifier. Note that channel1 can be used to affect
denial. TheoperationofAONcomponentshaveimportant channel3,eventhoughchannels1and3areroutedthrough
securityramifications[30]. distinctcomponents.
1of17Crosstalk from Channel 1 superimposed on Channel 2
Channel 1 (Blue)
Channel 1 (Blue)
Channel 2 (Blue) Switch
Channel 2 + Channel 1 Crosstalk (Blue)
Channel 3 (Red) Channel 3 (Red)
Amplifier
Figure1.Combinedswitchandamplifierattack.
In circuit-basednetworkswith veryhighrates, ultrafast
restorationispreplannedandbaseduponlocalinformation,
in order to avoid the delays associated with software pro-
cessing. In orderto allow the networkto recoverfrom at-
tacks, we must be able to identify attacks carried out by
networktrafficandtolocalizetheseattacks. Ifwewereto
applyidentificationandlocalizationmethodswhicharede-
signedfornaturallyoccurringfailurestothecaseofservice
disruptionattacksinAONs,anattackatasinglepointmight
leadtowidespreadfailures.
Letusillustratewhyitisimportanttobeabletoidentify
an attack caused by the traffic itself from a failure which
occurs because of natural fatigue of components or phys-
ical sabotage of the network. For instance, let us con-
siderthecasewhererecoveryofanodefailureisperformed
by rerouting traffic away from that node. An example of
suchanodefailurerecoveryschemeistheSONET/SDHbi-
directionalself-healingring. Ifthetrafficitselfisthecause
ofthefailure, as isthe case intheamplifierandswitch at-
tacksdiscussedabove,thenfailureswillbecausedthrough-
outthenetworkwithoutanyrestoration.Consideranattack
on node
i
, which carries channels 1, 2 and 3, from chan-
nel1. Ifthenetworkmanagementdealswithallfailuresas
thoughtheywerebenignfailures,thenitassumesthatnode
i
failedofitsownaccordandreroutesthethreechannelsto
someothernode,say
j
. Afterthatrerouting,
j
willappear
as having failed because channel2 will attack
j
. Thenet-
workmaythenrerouteallthreechannelstonode
k
,andso
on. Therefore,itisimportantfornode
i
underattacktobe
abletoidentifyanattackcomingfromitstrafficstreamand
todifferentiateitfromaphysicalhardwarefailurewhichis
notduetothetrafficstreamstraversing
i
ure 2 illustrates. In this example, Channel 1 is attacking
thenetworkbysendinganexcessivelypowerfulsignal. Let
us supposethat each nodeguardsagainstjammingattacks
bydisconnectingachannelwhichisidentifiedasbeingtoo
powerful. As shown in figure 2, channel 1 and channel 2
both share the same node
.
Itis insufficienttodifferentiatean attackcarriedoutby
thenetworktrafficfromaphysicalfailure.Wemustbeable
to identify the source of the attack, as the example in fig-
i
, in this case a switch, and are
bothcarriedonabluewavelength. Crosstalkfromchannel
1issuperimposeduponchannel2atnode
i
. Channel2,in
turn,maybecometoopowerfulanddisruptchannel3,also
on blue, at node
j
, which is also a switch. Nodes
i
and
j may both correctly identify the failure as a crosstalk jam-
ming attack. Node
i
will correctly identify the offending
channelaschannel1butnode
j
willidentifytheoffending
channelaschannel2. Ifthenetworkhasnomeansoflocal-
izing the source of the attack, then node
i
will disconnect
channel1andnode
j
willdisconnectchannel2. Channel2
willthereforehavebeenerroneouslydisconnected.
1.2.Exampleofservicedenialduetoattack
We now illustrate how an attack of the type discussed
intheabovesectioncouldleadtoservicedenial. Theabil-
ity to use attacks to deny service stems from the fact that
attacks spread, causing malfunctions at several locations,
whereas failures generally do not disrupt the operation of
severaldevices. Thus,whileasinglenetworkelementfail-
uremaycauseseveralnetworkelementsto havecorrupted
inputsandoutputs,thefailurewillnotgenerallycauseother
network elements to be defective in their operation. Be-
cause of transparency we do not have an absolute metric
to determinewhether an inputis faulty or not. Instead we
lookattheoperationofanode,i.e.,therelationbetweenthe
inputandtheoutput. Anattackwillleadtoincorrectoper-
ation of the node. An attack, as illustrated in the previous
section, can cause network elements not only to have cor-
2of17Crosstalk from Channel 1 superimposed on Channel 2
Channel 1 (Blue) node i ( a switch)
Channel 1 (Blue)
Channel 2 (Blue) Switch
node j (a switch)
Channel 2 + Channel 1 Crosstalk (Blue)
Channel 3 (Blue)
Channel 3 + Crosstalk from (Channel 2 + Channel 1 Crosstalk) (Blue)
Crosstalk from Channel 2 + Channel 1 Crosstalk
is superimposed on Channel 3
Figure2.Attackthroughtwoswitches.
ruptedinputsandoutputs,butthenatureofthosecorrrupted
inputs can lead to improper operation of the network ele-
ments. Hence, if alarms are raised at individual network
elementsby improperoperationof the networkelement, a
failurewill lead to a single alarm. An attack, onthe other
hand, may lead to several alarms downstream (in the flow
ofcommunications)ofthefirstpointwhichisattacked.
If aschemeispreparedtorecoverfromfailuresbuten-
counters instead an attack, it may malfunction and cause
failures. A common recovery scheme is based on rings.
We considerthe two typesof networkrestorationused for
SONET/SDH,themostcommonstandardsinuseforhigh-
speedopticalcommunications[55].NotethatSONET/SDH
arenotall-opticalstandards,buttheratestheysupportmake
theirneedforrapidservicerestorationcommensuratewith
that of AONs. Speed of recovery with opto-mechanical
switchesisinthetensofmillisecondsandnanosecondsfor
acousto-opticalswitches. SONET/SDH allow for network
restorationafterfailureintwoways:
(cid:15)
By having two streams traverse physically node (or
link)disjointpathsbetweenasourceandadestination,
asintheSONETUPSR(unidirectionalpathswitched
ring)approach.Incaseoffailureofanode(link)along
onestream,thereceivingnodelistenstotheredundant,
backup, stream. We term this approachan automatic
protectionswitching(APS)approach.
(cid:15)
The fact that, for any node (edge) redundant graph,
there exists a pair of node (edge)-disjoint paths, that can
be used for APS, between any two nodes is a conse-
quence of Menger’s theorem [44, 31]. There have been
a variety of proposed path rerouting schemes based on
Menger’s theorem, e.g. SNCP and different variants of
it [2, 39, 45, 59, 53, 27]. Automatic protection switch-
ing over arbitrary redundantnetworks need not restrict it-
self to two paths between every pair of nodes, but can in-
stead be performed with trees, which are more bandwidth
efficient for multicast traffic [29, 11, 52, 18]. For loop-
back protection, mostof the schemes have relied on inter-
connection of rings or on finding ring covers in networks
[57,51,56,42,43,40,41,12,58,47,54]and[55,pp.315–
325]. Loopbackcanalsobeperformedonarbitraryredun-
dantnetworks[28].
Letusshowhowasingleattackmayleadtoafailurein
thecaseofloopbackrecovery. Figure4illustratesourdis-
cussion. Letusdenoteby
By having a single stream being rerouted onto a
backupchannelincase of a failure,as inthe SONET
BLSR(bidirectionallineswitchedring)approach.We
termthisapproachtheloopbackapproach.
Figure3showsthetwoapproaches.
j
the attack source. Thus, node
j
is attacked, for instance by a nefarious user who uses
j asapointofentryintothenetworkforinsertionofaspuri-
ousjammingsignal. Thejammingsignalcausesthenodes
adjacent to
j
to infer that
j
has failed, or is “down”. The
same jamming signal, upon travelling to k, will cause the
nodesadjacentto
k
toinferthat
k
hasfailed. Ifboth
j
and
k
areconsideredasindividualfailuresbythenetworkman-
agement,thenloopbakwillbeperformedtobypassboth
j and
k
inaring. Thus,alltrafficwhichpassedthroughboth
j
and
k
willbedisrupted,asshowninfigure4.If,instead,
j iscorrectlyidentifiedasthesourceoftheattack,thenloop-
back effected to bypass
j
will lead to correct operationof
the network, with only the inevitable loss of traffic which
3of17Figure 3. Automatic protection switching and loopback protection. Black nodes show operational
nodes,whitenodesshowfailednodes,thinlinesshowprimaryroutes,andthicklinesshowback-up
orrestorationroutes.
had
j
asitsdestinationororigination.
Insection4weshowhowtoapplytheattacklocalization
algorithmto loopbackrecoveryto avoid such unnecessary
servicedenial.
1.3.ProblemStatement
We have seen the need to identify and localize attacks.
We do notexaminehere the meansavailable for detection
and identification of attacks. Instead, we consider that at-
tackscan bedetected and identified with satisfactory false
positiveandfalse negativeprobabilities. Recall thatan at-
tackisamalfunctionwhichaffectstheinputtooutputrela-
tionatthenode. Weseektocreateanalgorithmwhichcan
rapidlyidentifythesourceofanattack. Forinstance,inthe
exampledepicted in figure 2, if node
j
knows that node
i also had a crosstalk jammingattack on blue, it allows
i
to
disconnecttheattacker.Oncenode
i
disconnectschannel1,
channel2ceasestoappearasanoffendingchannelatnode
j
. Ifnode
j
doesnothaveinformationfromnode
i
indicat-
ingthatchannel1isanattackerat
i
thennode
j
infersthat
channel2istheattackeratnode
j
. Node
j
thendisconnects
channel2. Notethatnode
j
seesnodifferencebetweenthe
caseswherechannel1istheattackerat
i
andwherechannel
2 is the attacker at
j
. In both cases, channel 2 appears as
the attacker at
j
. By using knowledgefrom the operation
of node
i
upstream of
j
,
j
Eachnodehandlesacertainnumberofchannels. Channels
may terminateor originateat certain nodes. Each channel
hasaspecificdirectionandwemaythereforespeakofnodes
beingupstreamordownstreamofoneanotherforacertain
channel. Each node is able to detect and identify attacks
beingleviedagainstit,receiveandprocessmessagesarriv-
ingtoitandgenerateandtransmitmessagestonodeswhich
areupstreamordownstreamofitoncertainchannels.Note
thatanodeinourmodelmaynotcorrespondto anetwork
component.Forinstance,wecanmodelaswitchasseveral
nodes, one for each switching plane and component am-
plifier. Conversely, a cascade of in-line amplifiers may be
modeledas asinglenodebecausetheyhaveasingleinput
andasingleoutput.
We must explicitly take into account the time taken by
thedifferentprocessesinvolvedintheidentificationandlo-
calizationofattacks.Theidentificationofanattackrequires
timefor detectionof the inputandoutputsignals andpro-
cessingoftheresultsofthatdetection. Thereisalsodelay
involvedingeneratingmessagestoupstreamand/ordown-
stream nodes. We denote all the time required by all of
the above processes executed in sequence as the process-
ing time
can deduce whether the attack
originatedwithchannel1orchannel2.
We consider a network composed of nodes and links.
(cid:28)
m
i
e a s
at node
i
. Messages from node
i
to node
j
taketime
T ij
to transmit. Message transmission follows
thetransmissionofthedataitself,anddoesnotusuallyadd
to the overall time of localizing the attack. Lastly, there
aredelaysduetothetimeforcapturingmessagesfromup-
streamand/ordownstreamnodes,thetimetoprocessthese
messages together with local information and the time to
4of17Node j: Node k:
first node to be second node to be
disabled by attack disabled by attack
j k
Traffic which traversed k to j
is lost
Node k:
second node to be
Node j: disabled by attack is not
first node to be disabled after loopback at j
disabled by attack
j k
Traffic which traversed k to j
is backhauled through k
Figure 4. The top figure shows loopback recovery when both nodes
j
and
k
detect an attack and
bothnodesarebelievedtobefaulty. Thebottomfigureshowsthemoreappropriaterecoverscheme
foran attack at
j
whichpropagatesto
k
. Here onlynode
j
isrerouted and trafficcan reach thenow
unaffectednode
k
.
generate new messages. We denote the time required by
thislastsetofeventsas
(cid:28)
p
i
r o c
thrustofthisworktotheexistingliterature.Wegiveabrief
. overview of three different sets of fault diagnosis frame-
Ourgoalsare: works: faultdiagnosisforcomputingnetworks,probabilis-
ticfaultdiagnosisby alarm correlationandfaultdiagnosis
Localization Localizationofthesourceofanattacktoen-
methodsspecifictoAONs.
ableautomaticrecovery.
Thefirsttopiccoversthecasewherewehaveunitswhich
communicatewith subsets of other unitsfor testing. Each
Speed Very fast operation (implying near constant opera-
unitispermanentlyeitherfaultyoroperational.Theteston
tionalcomplexity).
aunittodeterminewhetheritisfaultyoroperationalisreli-
Scalability Thedelaymust notincrease with the size and ableonlyforoperationalunits. Theproblemofdiagnosing
spanofthenetwork. such systems was introduced in [37]. Necessary and suf-
ficient conditions for the testing structure for establishing
Robustness Valid operation under any attack scenario in-
eachunitasfaultyoroperationalaslongasthetotalnumber
cludingsporadicattacks.
offaultyelementsisundersomeboundwerefoundin[14].
Polynomial-time algorithms for identifying faults in diag-
We nowconsiderknownmethodsof faultlocalizationand
nosablesystemshavebeenfound[7,8,13].Insteadofbeing
determinetheirapplicabilitytoourproblem.
abletodetermineexactlythefaultyunits,anotherapproach
hasbeentodeterminethemostlikelyfaultset[26,6].Allof
1.4.RelatedWork
theaboveapproacheshaveseveraldrawbackswithrespect
tothegoalsweseektoachieve:
Therehasbeenmuchworkintheareaoffaultlocaliza-
tion in current data networks, which are often packet data
networks, but not all of those results are applicableto op-
tical networks. We do not seek to provide an exhaustive
overview of the subject, but simply to compare the main
(cid:15)
They require each unit to be fixed as either faulty or
operational. Hence, sporadicattacks whichmay only
temporarily disable a unit cannot be handled by the
aboveapproaches.Thusrobustnessisnotachieved.
5of17(cid:15)
They require tests to be carefully designed and se-
quentially applied [48, 49, 22, 32]. The number of
testsrequired,moreover,riseswith thepossiblenum-
berof faults[23, 14]. Thusthescalabilitygoalisnot
achieved.
(cid:15)
Thetestsdonotestablishanytypeofcausalityamong
failures,hencecannotestablishthesourceofanattack
byobservingotherattacks.Thusthefirstgoaloflocal-
izationisnotachieved.
(cid:15)
toswitchfromonefibertoanother,anapproachisgivenin
[46]. Whenafailureoccurs,thealarmduetothefailureis
generatedbythein-linerepeaterimmediatelyafterthelink
failure.Thefailurealarmthentravelsdowntoanodewhich
can perform failure diagnostic. The failure alarms gener-
ateddownstreamofthefirstfailurearemaskedbyusingup-
streamprecedence.Failurelocalizationcanthenbedoneby
havingthe nodecapableof diagnosticsend messages over
asupervisorychanneltowardsthesourceofthefailureun-
til the failure is localized and an alarm is generated at the
Fault diagnosis by many successive test experiments firstrepeaterafterafailure. Weusetheideaofprecedence
maynotberapidenoughtoperformautomaticrecov- ofupstreamfailureattacksbutwedonotrequirediagnostic
ery,thusviolatingourspeedgoal. tobeperfomedbyremotenodesandtohavetwo-waycom-
municationsbetween nodes. In the followingsections, we
Another approach is related to Baysian analysis of
discuss our schemeand show the benefitsof notrequiring
alarms in networks. Alarms from differentnetwork nodes
two-waycommunications.
arecollectedcentrallyandanalyzedto determinethemost
probablefailurescenario. Unliketheschemesdiscussesin
2.AttackIdentificationandLocalizationAlgo-
thepreviousparagraph,thistypeofanalysiscanbeusedto
rithm
discover the source(s) of attacks thus complying with the
first goal. Moreover, it can analyze a wide range of time-
varyingattacksin accordancewith the robustnessgoal. A Thealgorithmwedevelopforattacklocalizationisdis-
good treatment of alarm correlation for diagnostic of fail- tributed,anduseslocalcommunicationbetweennodesup-
ures and of related work can be found in [21]. A general anddown-stream. Eachnodein the networkdeterminesif
treatment of the Bayesian analysis involved in diagnostic itdetectsanattack. Itthenprocessesmessagesfromneigh-
problemsolvingisgivenin[34,35].Alloftheaboveresults boringnodesto determineif the attack was passedto itor
assume some degree of centralized processing of alarms, ifitis thefirstnodetosustain anattackonacertainchan-
usuallyatthenetworkandsubnetworklevel.Thetimecom- nel. We denote the first node affected by an attack as the
plexity of the software processing grows in some fashion sourceoftheattack,eventhoughtheattackmayhavebeen
withthesizeofthenetwork.Moreover,therearedelaysin- launchedelsewhere.Theglobalsuccessoflocalizingtheat-
volvedwithpropagationofthemessagestotheprocessing tackdependsuponcorrectmessagepassingandprocessing
locations. Hence, the solutions may not scale well as the atthelocalnodes.
dataratesincreasesorthesizeofthenetworkgrowsviolat- Themainthrustofouralgorithmistherecognitionthat,
ing the scalability and speed goals. If either the data rate in order for a node to determine whether or not it is the
orthespanofnetworkincrease,thereisagrowthinthela- sourceofanattack, itneedonlyknowwhethera nodeup-
tencyofthenetwork,i.e. thenumberofbitsinflightinthe streamofitalsohadthesametypeofattack. Supposethat
network.Thecombinedincreaseinprocessingdelayandin node
latencyimpliesthatmanybitsmaybebeyondthereachof
correctivemeasuresbythetimeattacksaredetected.There-
fore,anincreaseinnetworkspananddataratewouldlead
toanexacerbationoftheproblemofinsufficientlyrapidde-
tection.
For AONs, fault diagnosis [20, 9, 38, 24] and related
network management issues [25, 3] have been consid-
ered. Someofthemanagementissuesforotherhigh-speed
electro-optic networks are also applicable [33, 36]. The
problemofspreadingoffaultalarms,whichexistsforsev-
eral types of communication networks, is exacerbated in
AONs by thefact thatsignals flowthroughAONs without
beingprocessed[25]. Ifweareonlyconcernedaboutfiber
failure,thenonlythenodesadjacenttothefailedfiberneed
to find out about the failure and a node need only switch
fromonefibertoanother[17]. Forfailureswhichoccurin
achainofin-linerepeaterswhichdonothavethecapability
i
isupstreamof
j
onacertainchannelwhichisiden-
tified as being an attacking channel and that both
i
and
j identify the attacking channel. Suppose that both
i
and
j have processing times
(cid:28)
m e a s
and
(cid:28)
p r o c
. If
i
transmits to
j
its finding that the channel is nefarious, then the inter-
val between the time when the attack hits
j
and
j
hears
from
i
that the attack also hit
i
is at most
(cid:28)
m e a s
. Indeed,
theattackandthemessageconcerningtheattacktravelto-
gether. Moreover, the detection and identification of the
attack commences at
j
as soon at the attack hits. Hence,
theelapsedtimeuntil
j
identifiestheattackanddetermines
whether
i
alsosawthatattackis
(cid:28)
m e a s
+ (cid:28)
p r o c
. Notethat
thisisindependentofthedelayinthecommunicationsbe-
tween
i
and
j
becausetheattackandthemessageconcern-
ing the attack travel together, separated by a fixed delay.
If the attack hits severalnodes, each nodeonly waits time
(cid:28)
m e a s
+ (cid:28)
p r o c
to determine whether or not it is the first
nodetodetectthatattack,i.e. whetheritisthesourceofthe
6of17attack.
To illustrate the main points of the algorithm we first
considera simpleattack localization problem. In this net-
worknodescaneitherhaveastatusof
1
(O.K.)or
0
(alarm).
Nodesmonitormessages from upstream. Let the message
be the status of the node. When an attack occurs in this
network, the goal of this algorithm is that the node under
attack respond with an alarm and all other nodes respond
withO.K.
Each node in the network repeats the following algo-
rithmcontinuallyandrespondsaccordingly.
Algorithm1 BasicNodeProtocol
Computethestatus,
s
ofthenodeatthistime,
t Transmitmessage
s
toalltheadjacentnodesdownstream
If
s 6= 1
then
Let
I n M e s s a g e s
=allmessagesarrivinginthetime
interval
t[ ; t + (cid:28)
m e a s
] Ifanymessagein
I n M e s s a g e s 6= 1
then
thenset
s = 1 elseset
s = 0
We can immediately see that no node will generate an
alarmuntilatleast oneattack is detected. When an attack
occurs only the first node experiencing the attack will re-
spondwithanalarm.Allnodesdownstreamfromthisnode
receivemessageswhichindicatethatanodeupstreamexpe-
riencedanattack. Thus,nodesdownstreamfromtheattack
willrespondwithO.K.Thisnetworkresponseachievesour
statedattacklocalizationgoal. Insection3.1werevisitthis
simple network problem with a more rigorous algorithm
statement. We then show that attacks do not propagatein
thisnetwork.
Wenowturntothetaskofrigorouslydefiningageneral
formofthenetworklocalizationalgorithm.
2.1.Definitions
Thissectionprovidesthedefinitionsandnotationthatwe
willuseintheremainderofthispaper.
NetworkDefinition
A network has nodes
1 ; 2 ; :::; n
. Each node has inputs
I ij
andoutputs
O ij
. Wesaythenetworkhasdirectedcon-
nection
( i ; j )
when the is aconnectinfromnode
i
to node
j
byalink. Wewillrefertotheundirectedconnectionbe-
tweennodes
i
and
j
as
i[ ; j ]
. Weassumethatthenetworkis
acyclic.
TimeDelays
Recallthatwedefinethetimedelaysfortheprocessing
andtransmissionasfollows:
(cid:28)
m
i
e a s
=
measurement time for node
i
including time to
formatandsendmessages.
(cid:28)
p
i
r o c
=
processingtimefornodes
i
includingtimeto for-
matandsendmessages.
T ij =
time to transmit on arc
( i ; j )
. Assume wlog that
T ij = T j i
.
In manyoftheexampleswediscuss, thetimedelaysat
all nodes are identical. We then refer to the measurement
andprocessingtimeas
(cid:28)
m e a s
and
(cid:28)
p r o c
withoutsubscripts.
MessagesandFaults
We assume that each nodecan detect an attack or fault
withinacceptableerrorlevels. Letthefaulttypesbeinthe
set
F
. One of the fault types in
F
is always the no fault
case.
Thestatusofanodeattime
t
is
S t ( i ) 2 F
. Wewilluse
S ( i )
toindicatethecurrentstatusofnode
i
.
Letusconsiderconnection
( i ; j )
. Amessagefromnode
i
tonode
j
attime
t
isdenoted
M t (
(cid:0)
i
!
; j )
. Messagescanbe
sentup-ordown-streaminthenetwork.Theupstreammes-
sagefromnode
j
tonode
i
attime
t
isdenoted
M t ( i
(cid:0)
; j )
. For
particularnetworkapplicationstheinformationencodedin
messages varies. However, messages should remain small
for fast transmission and processing such as the messages
passed by algorithm 1. For example, a node can transmit
itsstatusup-anddown-streamviathemessages
S t ( i )
M t (
(cid:0)
i
!
; j ) =
and
M t ( i
(cid:0)
; j ) = S t ( j )
. Message
M t (
(cid:0)
i
!
; j )
arrives at
node
j
at time
t + T ij
and likewise message
M t ( i
(cid:0)
; j )
ar-
rivesatnode
i
attime
t + T ij
. Again,wewillwrite
M (
(cid:0)
i
!
; j )
and
M ( i
(cid:0)
; j )
toindicatethecurrentmessagefromnode
i
to
j
andfromnode
j
tonode
i
,respectively.
ResponseFunction
Thecruxofthealgorithmliesbytheresponsefunction,
R
. This function processes incoming messages and local
status information to determine the response of the node.
Wewilldiscussthisfunctionisthecontextofthealgorithm
inthefollowingsection.
2.2. The General Algorithm for Attack Identifica-
tionandLocalization
Thegeneralalgorithm,likethesimpleexampleofattack
localizationwediscussedearlier,isadistributedalgorithm
thatachievesitsgoalthroughlocalprocessingandmessage
passing. The goal of the algorithm can vary for different
network examples. For example, the goal may be to raise
analarmasinalgorithm1.Amorecomplexgoalmaybeto
reroutethenodeimmediatelybeforeandaftertheattacked
node in the network. The following statement of the al-
gorithm is general enough to be suitable for a wide range
of network goals. The algorithm achieves this generality
by leaving many of the details of the algorithm (such as
the set of faults, the format of the messages and the node
response to input messages) unspecified in the general al-
7of17gorithmstatement. Thesespecificsmustbedefinedforthe
particularnetworkapplication.
Algorithm2 GeneralNodeProtocol
Compute
S t ( i ) = f i Forall
( i ; j )
transmitmessages
R i ( S ( i ) ; ; ) Let
I n M e s s a g e s =
allmessagesarrivinginthe
interval
t[ (cid:0) T
w
i
a it1
; t + T
w
i
a it2
] Transmit
R i ( S ( i ) ; I n M e s s a g e s )
Thisalgorithmascertainsthe faulttypeandtransmitsit
to adjacentnodesin the network. It then monitorsincom-
ing messages for a specified (bounded) time interval and
respondstothesemessages.Theresponseofthenetworkis
unspecified in the above statement. For generality, we re-
placedtheprocessingandresponsewiththeresponsefunc-
tion,
R
,whichwewilldiscussshortly. Toachieveapartic-
ularnetworkapplication,thefollowingmustbeset:
(cid:15)
Thefaultset,
F
.
(cid:15)
Thewaitingtimeintervalformessages,i.e.
T
w a it1
and
T
w a it2
.
(cid:15)
Theformatofmessages.
(cid:15)
Theresponsefunction,
R
.
(cid:15)
Themodeofmessagepassing. The nodecan remove
messagesitreceivesfromthemessagestreamorpass
allmessagesinthemessagestream.
TheResponseFunction
R In the general algorithm the response function
R
is re-
sponsible for achieving the data transmission and security
goalsofthenetwork.
R
is a function:
M e s s a g e L i s t
S t a t u s (cid:2) M e s s a g e L i s t (cid:0) ! . Function
R
should be very fast to com-
puteinordertosatisfyourspeedgoal. Ideallythefunction
shouldconsistofafewcomparesandtablelookups. Thus
the delay in identifying faults and attacks is short and the
networkprovidesminimaldataloss.
Messagescanmoveup-ordown-streaminthenetwork.
The response function receives all the messages as input.
It processes these messages to generate the messages for
transmission from the node. The response function gen-
erates messages which the node transmits up- and down-
stream. As we will see in sections 3 and 4, the response
functioncan be defined to handlea variety of network re-
coveryapplications.
Inaddition,function
R
mayhaveasideeffectresponse,
suchasraisinganalarmorre-routingtrafficatanode.
Each node,
i
, in the network can have a different re-
sponse function,
R i
inraceconditionsinthenetwork. Ingeneralwecanavoid
timingproblemsduetodifferentresponsefunctionsbyforc-
ing all response functions in a network to operate in the
sameamountoftime. Wesettheprocessingtimetobethe
maximumtime required by any of the response functions.
Wethenaddawaittimetoeachresponsefunctionsuchthat
itsfinalprocessingtimeisequaltothemaximumtime.
Notethattheresponsefunctionmayreturnnomessage,
ortheemptyset,inwhichcasenomessagesaretransmitted.
3.Example Applications
3.1.BasicAttackIdentificationandLocalization
We now re-consider the problem of basic attack local-
izationofalgorithm1 andimplementthisalgorithminthe
framework described in the previous section. Recall that,
for this problem, the nodes have two fault types: no fault
andfault(i.e.
. The use of different response func-
tions, with varyingprocessingtimes, may, however, result
F = f 1 ; 0 g
),thestatusofanodeis
S ( i ) 2 F
,
andmessagesfromanynodeencodethestatusofthenode.
Thegoalfornode
i
istodeterminewhetheritisthesource
oftheattackoriftheattackisbeingcarriedbythedatafrom
asourceupstream.
We set, in the general algorithm, the waiting times
T
w a it1
= 0
and
T
w a it2
= m a x i ( (cid:28)
m
i
e a s
)
andthemessage
passing parameter to remove all messages received. The
responsefunction
R
isasfollows:
Algorithm3
R
forbasicattacklocalization
Input:
s
,
I n M e s s a g e s
If
I n M e s s a g e s = ;
thenreturn
s elseif
s 6= 1
then
If
9 M (
(cid:0)
j
!
; i ) 2 I n M e s s a g e s
s.t.
M (
(cid:0)
j
!
; i ) 6= 0 thenreturn
1 elsereturn
0
Wecanimmediatelyseethattheaboveresponsefunction
resultsinthebasicattacklocalizationalgorithm(algorithm
1).Wewillnowshowthatthisalgorithmachievesourstated
goal.
Inlocalizingtheattack,welookatthedynamicsbetween
two nodes and the connection between them. Each node
monitorseveryconnectionintoit. Forthesimplestcase,we
examineaconnectionbetweennodes
i
and
j
,withthedata
flowingfrom
i
to
j
.
i j
T
ij
t meas t meas
i j
8of17Let the time at which the data leaves node
i
be
0
. The
message from node
i
to node
j
about
i
’s failure is sent at
time
(cid:28)
m
i
e a s
. Node
j
receivesthedataattime
T ij
,andcom-
pletesmeasurementandsendsitsstatusattime
T ij + (cid:28)
m
j
e a s
.
Atthistimenode
j
hasdetectedanattackorithasdetected
noattack. Node
j
receivesthemessagefromnode
i
attime
T ij + (cid:28)
m
i
e a s
. Thus,node
j
canbegintoprocessthestatus
messagefrom
i
attime
T ij + m a x ( (cid:28)
m
j
e a s
; (cid:28)
m
i
e a s
)
. Atthis
time node
j
knows whether or not node
i
detected an at-
tack, and node
j
has enoughinformationto determinethe
whetherornotitisthesourceoftheattack. Processingat
j fallsintooneoffourcases.
Case1: If
j
hasadetectednoattack,then
j
concludesthat
itisnotthesourceofanattack.
Case 2: If
j
has detected an attack and
i
has detected no
attack,then
j
concludesthatitisthesourceoftheattack.
Case 3: If
j
has detected an attack and
i
has detected a
attack,then
j
concludesthatitisnotthesourceoftheattack.
Case4: If
j
hasdetectedanattackandhasnotheardfrom
i
attime
t = m a x ( (cid:28)
m
i
e a s
; (cid:28)
m
j
e a s
) + T ij
, then
j
concludes
thatitisthesourceoftheattack.
Node
j
completes processing at
T ij + m a x ( (cid:28)
m
j
e a s
; (cid:28)
m
i
e a s
) + (cid:28)
p
j
r o c
Wecanshow,byanexhaustiveenumerationofthepos-
sible timing constraints involving
(cid:28)
m
i
e a s
,
(cid:28)
m
j
e a s
,
(cid:28)
p
j
r o c
,
T ij
and the length of the attack
L
, that node
j
is
never in the wrong state, i.e. it concludes at time
m a x ( (cid:28)
m
j
e a s
; (cid:28)
m
i
e a s
) + (cid:28)
p
j
r o c
t + that it is the source of an at-
tackifandonlyifitisthesourceofanattackattime
t
.
3.2. Localization of Attacks that Affect Selected
NodesDownstream
Inthissectionweconsideraspecificattackscenariodue
tocrosstalk. Usually,inthecaseofanattackwhichiscar-
ried by the signal, we assume that all the nodes through
which the signal is transmitted will be affected by the at-
tack, i.e. they will suffer a fault. The basic attack local-
ization algorithm described in section 3.1 can localize the
sourceofsuchattacks.
Theproblemweconsidernowinvolvesanattackwhich
iscarriedbythesignal, butmaynotbedetectableinsome
nodes. As thesignaltraversesdownthenetworkitattacks
some nodes then reaches a node which it does attack and
continues on to attack downstream nodes. For example,
consider an attack of channel1 at node
i
, a switch, in the
networknodesoffigure5. Owingtocrosstalkat
i
,theout-
put of channel 2 at node
i
is affected by the attack. The
signal in channel 2 then transmits to node
j
, which is an
amplifier. Sincethissignalistheonlyinputtonode
j
,gain
competitionisnotpossibleso thisnodedoesnotdetectan
attack.Atnode
k
attackdoespropagate. Itisdetectedinnodes
,however,channel3isonceagainaffected
bycrosstalkfromtheattack,thusanalarmisgenerated.The
i
and
k
,butit
isnotdetectedatintermediatenode
j
.
Wewanttoapplytheattacklocalizationalgorithmtothis
problem. To isolate the salient issue we will consider the
simplest framework within which this problem can occur.
We therefore deviate as little as possible from the frame-
work in section 3.1. Nodes have two fault types, no fault
and fault, and the message simply contains a status: fault
or no fault. The goal of the algorithm is also unchanged,
node
i
mustdeterminewhetheritisthesourceoftheattack
or if the attack is being carried by the data from a source
upstream.
Thedifferencebetweenthisproblemandthebasicattack
localizationproblemisthateachnodemustknowofthesta-
tusatallthenodesupstreamfromitinthenetwork,whereas
in the basic attack localization problem we assumed that
whenanattackpropagateseverynodeinthenetworkdetects
afaultsothestatusfromthesingleprecedingnodecontains
sufficientinformationfromwhichtodrawconclusions. In-
stead of generatingmessagesat eachnode, thedatais fol-
lowedfromitsinceptionbyastatusmessagewhichlagsthe
databyaknowndelay.Thestatusmessageispostedbythe
nodeatwhichthecommunicationstarts. Onceanattackis
detectedthe status message is disabled. The lack of a sta-
tusmessageindicatesto allthenodesdownstreamthatthe
source of the attack is upstream of them. Note that such
astatusmessageis akinto apilottoneassociatedwith the
datastream.Thelackofapilottoneindicatesthatanattack
orfaulthasoccurred.
We can now define the response function,
R
, from the
generalalgorithm.
Algorithm4
R
forselectiveattacklocalization
Input:
s
,
I n M e s s a g e s
If
I n M e s s a g e s = ;
thenreturn
; elseif
s 6= 1
then
thendisablestatusmessage.
return
; return
;
Notethatthenodesin the networknevergeneratemes-
sage. Theycan,however,disablethestatusmessagewhen
theydetectanalarm. When thestatusmessageisdisabled
then any node downstream can conclude that it is not the
originoftheattack.
We set, in the general algorithm, the waiting times
T
w a it1
= 0
and
T
w a it2
= m a x i ( (cid:28)
m
i
e a s
)
andthemessage
passingmodeistotransmitallmessages.
Suppose a node
i
is attacked at time
t
. It will turn off
the status message at time
t + T
w a it2
+ (cid:28)
p r o c
. The next
node,
j
, receivesthedatastreamattime
t + T ij
andwaits
untiltime
t + T ij + T
w a it2
. Weimmediatelyseethatarace
conditionmayariseif
(cid:28)
p r o c
> T ij
. For anall-opticalnet-
work, switching off a channelcan be done in the order of
9of17Crosstalk from Channel 1 superimposed on Channel 2
Channel 1 (Blue) node i (a switch)
Channel 1 (Blue)
Channel 2 (Blue) Switch
node j
Channel 2 + Channel 1 Crosstalk (Blue)
Amplifier
node k ( a switch)
Channel 2 + Channel 1 Crosstalk (Blue)
Channel 3 (Blue)
Channel 3 (Blue)
Figure5.Apropagatingattackwhichdoesnotdisruptallnodes.
nanosecondswithanacousto-opticalswitch. Thedelaybe-
tweennodesinthenetworkwouldtypicallybelarger,sowe
donotbelievethisconditionwillbeproblematicinpractice.
Moreover,thenetworkcanbedesignedtoensurethiscondi-
tionismetbyintroducingdelayatthenodes. Suchadelay
is easily obtainedby circulating the data stream througha
lengthoffiber.
3.3.Multiplefaulttypes
Response to multiple fault types can be handled effi-
cientlywithalookuptable. Inthiscasetheresponsefunc-
tion
R
wouldhaveapre-storedtable
L
. Giventhe current
status,
s i
,andthestatusofthepreviousnode,
s j
,thelook-
uptableprovidestheappropriateresponseforthisnode,
r i (i.e.,
L : S t a t u s (cid:2) S t a t u s (cid:0) ! R e s p o n s e
.) Forsomeap-
plicationsitisusefultohavedifferentlookuptablesforthe
nextnodethenetwork,
L n
,andthepreviousnodeinthenet-
work,
L p
. Furthermore,thelook-uptablescanbeextended
tothedomainof
S t a t u s (cid:2) R e s p o n s e
whichgivesgreater
flexibility.
3.4.RepressingAlarmsforCorrectedSignals
Consider a nodewhich detectssignal degradation. The
signalmaybeamplifiedsufficientlybythenextnodedown-
streamtoremainvalidwhenitreachesthedestination. We
wouldnotwanttostoptransmittingthesignalortore-route
thenodethatdetectedthisproblem.Instead,networkopera-
tionshouldcontinueasusualandanalert,butnotanalarm,
shouldbegenerated. We havethreepossibleresponseval-
ues:
O :K :
,
a l a r m
and
a l e r t
. An
a l a r m
sourceofanattackwhichisnotcorrected,whereasan
isgeneratedbythe
a l e r t iscreatedbythesourceofacorrectedattack.
Ourattacklocalizationalgorithmcanachievethisbehav-
ior using upstream messages. Each nodemust send status
messagesupstreamaswellasdownstream. Upondetecting
an attack in a node downstream, messages are checked to
determineifthisnodeisthesourceoftheattack. Upstream
messagesarecheckedtodetermineiftheattackpersistsin
thenextnodedownstream.Whenanodedetectsanattackis
firstgeneratesanalarm.Ifitlaterfindsthattheproblemwas
correcteddownstreamitdowngradesitsalarmtoanalert.
Theresponsefunctionforthisnetworkisshowninfigure
6.
Upstreammessagesfollowthedatastream byasignifi-
cantly longer time than do downstreammessages. An up-
streammessagerequirestimeforthedatatotraversealink
( i ; j )
tothenextnode,
j
. Thestatusofnode
j
mustbemea-
sured,andthemessagefromnode
j
tonode
i
musttraverse
the link
( i ; j )
. Therefore the waiting time,
T
w a it 2
in the
attacklocalizationalgorithmislongerwhenupstreammes-
sagesaremonitored.Inparticular,forthisscenarioweneed
T
w a it2
= 2 (cid:3) m a x ( T ij ) + m a x i ( (cid:28)
p
i
r o c
)
.
4.ApplicationtoNetwork Restoration
Inthissection,wepresenthowouralgorithmcanbeused
fornetworkrestoration. We considerthetwotypesofnet-
workrestorationusedforSONET/SDH: automaticprotec-
tionswitchingandloopback(seediscussioninsection1.2).
Foreach networkrestorationschemewedescribehowour
algorithmcanbeusedtoperformrecoveryandprovidethe
algorithmthatachievestheattacklocalization.
10of17Algorithm5
R
forrepressingalerts
Input:
s
,
I n M e s s a g e s
If
I n M e s s a g e s = ;
then
if
s = 1 thenreturn
O :K : elsereturn
a l a r m elseif
s 6= 1
then
Let
D o w n s t r e a m M e s s a g e s = f m 2 I n M e s s a g e s
s.t.
m = M (
(cid:0)
j
!
; i ) g
Let
U p s t r e a m M e s s a g e s = f m 2 I n M e s s a g e s
s.t.
m = M ( i
(cid:0)
; j ) g
If
9 M (
(cid:0)
j
!
; i ) 2 D o w n s t r e a m M e s s a g e s
s.t.
M (
(cid:0)
j
!
; i ) 6= O :K : thenreturn
O :K :
elseIf
9 M ( i
(cid:0)
; j ) 2 U p s t r e a m M e s s a g e s
s.t.
M (
(cid:0)
j
!
; i ) 6= O :K : thenreturn
a l a r m elsereturn
a l e r t
Figure6.Responsefunction,
R
,forrepressingalerts
4.1.Applicationtoautomaticprotectionswitching.
APS allows the network to receive data on the backup
stream on the eventof a faulty node. In the case of an at-
tack,servicewouldbemaintainediftheattackisdetected.
Howeverthelocationoftheattackisunknownandrestoring
normalnetworkoperationmayrequireagreatdealoftime.
Theattacklocalizationalgorithm(algorithm3)fromsec-
tion3givesthenetworktherequiredinformationtoswitch
streams upon an attack or a fault. Furthermore, the at-
tackednodeisidentifiedsothattheattackcanbedealtwith
quickly.
Thebasicfaultlocalizationalgorithmcanbeusedtofind
out whether or not an attack took place along the primary
path. Figure7 shows theprimaryand the backuppaths in
anetwork. If an attack took placealongtheprimarypath,
therewillbeamessage indicatingthepresenceofsuch an
attackandlaggingtheattackby
(cid:28)
m e a s
travelingalongside
the primary path. The end node will therefore know that
therewasanattackupstreamandthatthedestinationnode,
d
, was not the source of the attack. The response of the
destinationnode,
d
,willbetolistentothebackupstream.
This network requires two response functions: one for
destinationnodes,
R d
,andoneforallothernodes,
R n
. We
can set
R n
to
R
in algorithm 3. The destination node re-
sponsefunctionis
Algorithm6
R d
fordestinationnodesinAPS
Input:
s
,
I n M e s s a g e s
If
I n M e s s a g e s = ;
thenreturn
s elseif
s 6= 1
Since the attack localization algorithm relies on mes-
sagesarrivingatnodesatspecifictimes, weareconcerned
that two different response functions may not obey these
timing conditions. Since all nodes in the network except
thedestinationnodesuse
then
Receivedataonbackupstream.
R n
,thetiminguptothedestina-
tion node will not result in race condition. Since no node
iswaitingformessagesfromthedestinationnodes,anydif-
ferencesintimewillnotaffectnodesinthenetwork.
Switchingroutescanentailcertainroutingproblems.We
can avoid such problems by delaying transmission on the
backuppath. We nowcomputethenecessarydelayonthe
backuppath. Letusdenoteby
(cid:28)
s w itc h
thetimeittakesfor
d
to switch from the primary path to the backup path af-
teranalarmontheprimarypathhasbeendiagnosedby
d
.
Let
(cid:1) (cid:28)
bethedifferenceintransmissiondelaybetweenthe
source,
s
, and the destination,
d
, between primary stream
and backup stream. We assume that the transmission de-
layisshorterontheprimarypathandlongeronthebackup
path. Regardlessofwherethefailurehappenedonthepri-
marypath,wemayseethatnodatawillbelostinthepro-
cess ofdetectingtheproblemandswitching to thebackup
streamaslongasthedataonthebackupstreamistransmit-
tedwithadelayofatleast
m a x
allnodesintheprimarypath
( (cid:28)
m
i
e a s
) + (cid:28)
s w itc h
(cid:0) (cid:1) (cid:28) :
Ifallnodeshavethesame
(cid:28)
m
i
e a s
,then,nomatterwhere
the failure occurs in the primary path, there is always the
samedelaybetweentheprimarydatastreamandthebackup
datastream afterAPS. Therefore,we donotneedthedes-
tinationnode,
d
,toadaptitsresponsetothelocationofthe
failure. Independence from the location of the failure is
11of17Message about attack travelling alongside primary stream
delay = t
meas
primary stream
attack travelling in
primary stream
source
destination
backup stream
Figure7.Exampleofautomaticprotectionswitching.
veryadvantageousforscalabilityofthenetwork.Moreover,
havingasingledelayforallnodesresultsinsimpleoptical
hardwareat
d
, sinceadaptingto differentdelaysonthefly
requiressignificantcomplexityatthenode.
4.2.ApplicationtoLoopback
Loopback restoration, in the case of a failure, is per-
formed by the two nodes adjacent to the failure. If node
j
experiencesafailurethedatastreamisre-routedatnode
i totravelonthebackupchannel.Simultaneously,node
k
re-
ceivesonthebackupstream(seefigure8). Thisrestoration
maintainstheconnectivityoftheringandallowsthedatato
reachthedestinationdespitethefailureat
j
.
Let us consider an attack at node
j
, as shown in figure
8. Node
i
is immediately upstream of node
j
, the source
oftheattack. Node
k
isimmediatelydownstreamof
j
. The
attackmayspreadsothatthenodeupstreamofthesourceof
theattackwilldetectanattackwhileitwillnotbeattacked
directly. If we wereto detectattacks as failures, loopback
mightnotofferrecoveryfromattackasdiscussedinsection
1.2.
We apply our algorithm to loopback in the following
way. In the event of an attack each node attempts to de-
terminewhetheritisimmediatelyupstreamorimmediately
downstream of the attacked node. In the example in fig-
ure 8, node
i
finds that node
j
is the source of an attack
(bymonitoringupstreammessages)andre-routes. Node
k finds that node
j
time
is the source of the attack and re-routes.
Allothernodesfindthattheyarenotimmediatelyupstream
or downstreamof theattack. Thus, thesenodesdonotre-
routedespitethedetectedattack.
We will use the attack localization algorithm with wait
T
w a it2
= 2 (cid:3) m a x ( T ij ) + m a x i ( (cid:28)
p
i
r o c
)
which
gives the nodetime to monitor backward messages. Mes-
sages will consist of the couple
h s ; f l a g i
where
s
is
the status of the node (one of
O :K :
or
A t t a c k
), and
f l a g 2 f D o n t K n o w ; M i n e ; N o t M i n e g
. The flags in-
dicatewhetherthe transmittingnodeis responsiblefor the
fault or not, or that the node does not yet knowif it is re-
sponsiblefor thefault. For thiscase we will removemes-
sages from the message stream when they are processed.
Theresponsefunction
R
isshowninfigure9.
Step1oftheresponsefunction
R
checksincomingmes-
sages. If therearenoneit simply poststhestatusmessage
witha
D o n t K n o w
flag
h s ; D o n t K n o w i
. Step4localizes
the source of the attack. It posts the flag
M i n e
when no
nodeupstreamdetectsanattack. Step5re-routesthenode
immediately downstream of the attacked node when an
h A t t a c k ; M i n e i
messageisreceivedfromthesourcenode.
Step 6 re-routesthe nodeimmediately upstream of the at-
tacked node when it receives an
h A t t a c k ; f l a g i
message.
Theupstreamnodesneednotwait for an
h A t t a c k ; M i n e i messagebecausetheattackdoesnotpropagateupstream.
Letustracethroughthemessagespostedatnodes
i
,
j
,
k and
l
,thenodedownstreamfrom
k
,whenanattackoccurs
at node
j
(see table 1). For simplicity let us assume that
all measurement are negligibly small and all transmission
times are equal so we can examine the nodes at discrete
timesteps. Lettheattackatnode
j
occurattime
t
. Atthis
time only node
j
detects an attack. At time
t + 1
node
j receives an
O :K :
message from node
i
and finds it is the
source (step 4). Node
k
detects an attack and receives an
attack message from
j
indicating that it is not the source
(step 4). Node
i
receives the attack message from node
j andre-routes(step6). Attime
t + 2
node
k
findsthatnode
12of17loopback
k
j
attack source
i
loopback
backup channel
Figure8.Exampleofloopbackprotection.
time nodei nodej nodek nodel
t
t + 1
h
h
O
O
:K
:K
:;
:;
D
N
o
o
n
t
t
M
K
i
n
n
o
e
w
i
i h A t t a c k ; D o n t K n o w i h O :K :; D o n t K n o w i h O :K :; D o n t K n o w i *
t + 2 h O :K :; N o t M i n e i
h A t t a c k ; M i n e i h A t t a c k ; N o t M i n e i h O :K :; D o n t K n o w i *
h A t t a c k ; M i n e i h A t t a c k ; N o t M i n e i
*
t + 3 h O :K :; N o t M i n e i
h A t t a c k ; N o t M i n e i *
h A t t a c k ; M i n e i h A t t a c k ; N o t M i n e i
*
h A t t a c k ; N o t M i n e i
Table 1. Messages and side-effectsof operating
R
in algorithm7 whenan attack occurs at time
t
at
node
j
. Adecisiontore-routeisindicatedwitha*.
j
isthesourceandnode
k
isthenextnodedownstreamand
re-routes (step 5). Node
l
also detects the attack at time
t + 2
and receivesthe
h A t t a c k ; N o t M i n e i
messagefrom
node
k
, therebyfindingthatit is notthe source. Sincethe
messageindicatesthatnode
k
isnotthesource,node
l
does
notre-route.
Thetimingissuesareimportant,since
i
and
k
actinde-
pendently. If
k
performsloopbackbeforethetrafficonthe
backupchannelhasreached
k
,therewillsimplybeadelay
inrestorationbutnodatawillbelost. Loopbackcouldfail,
however, if k performsloopbackafter the loopbacktraffic
from
i
hasarrivedat
k
. Therecouldbelossofdataonthe
backupchanneluponarrivalat
k
.Weshowthatthiseventu-
alitycannotoccur.Let
t
bethetimeatwhichtheattackhits
j
. Attime
t + m a x (cid:0) (cid:28) m i e a s ; (cid:28) m j e a s (cid:1) + (cid:28) p j r o c
,
j
willsenda
messageto
i
informingitthatthesourceoftheattackisat
j
.Node
i
willreceivethemessagethat
j
isthesourceofthe
attackattime
t + m a x (cid:0) (cid:28)
m
i
e a s
; (cid:28)
m
j
e a s
(cid:1) + T ij
andwillfinish
processingthemessage
(cid:28)
p
i
r o c
later. If it takes
i (cid:28)
lo
i
o p
time
to performloopback,then
i
will performloopbackat time
t + m a x (cid:0) (cid:28)
m
i
e a s
; (cid:28)
m
j
e a s
(cid:1) + (cid:28)
p
j
r o c
+ (cid:28)
p
i
r o c
+ T ij + (cid:28)
lo
i
o p
.
Node
k
will know that it is not the source of the attack
at time
t + m a x (cid:0) (cid:28)
m
j
e a s
; (cid:28)
m
k
e a s
(cid:1) + (cid:28)
p
k
r o c
+ + T j k
. How-
ever,theinformationthatisneededby
k
is whetherornot
j
is the source of the attack. Node
k
will know that
j is the source of the attack and perform loopback at time
t + m a x (cid:0) (cid:28)
m
i
e a s
; (cid:28)
m
j
e a s
(cid:1) + (cid:28)
p
j
r o c
+ T j k + (cid:28)
p
k
r o c
+ (cid:28)
lo
k
o p
.
Wemayassumethatallthe
(cid:28)
lo o p areequal,allofthe
(cid:28)
m e a s
areequalandallofthe
(cid:28)
p r o c
areequal.Suchanassumption
madebemadew.l.o.g.becausewecouldtakethemaximum
ofallthese
(cid:28)
sanddelaytheotherstomatchthemaximum.
Let us assume, as would be the case in AONs, that trans-
missiondelaysareproportionaltolength.Fromelementary
geometry, we know that
Tj ij (cid:0) T j k j (cid:20)
transmission time
from
i
to
k
. Therefore,notrafficfrom
i
to
k
placedonthe
backup channel by loopback will arrive at
k
before
k
has
performedloopback.
13of17Algorithm7
R
forloopback
Input:
s
,
I n M e s s a g e s
Step1: If
I n M e s s a g e s = ;
Step2: thenreturn
M (
(cid:0)
i
!
; j ) = h s ; D o n t K n o w i
and
M ( j
(cid:0)
; i ) = h s ; D o n t K n o w i else
Step3: Let
D o w n s t r e a m M e s s a g e s = f m 2 I n M e s s a g e s
s.t.
m = M (
(cid:0)
j
!
; i ) g
Let
U p s t r e a m M e s s a g e s = f m 2 I n M e s s a g e s
s.t.
m = M ( i
(cid:0)
; j ) g if
s = A t t a c k
then
Step4: If
9 M (
(cid:0)
j
!
; i ) 2 D o w n s t r e a m M e s s a g e s
s.t.
M (
(cid:0)
j
!
; i ) = h A t t a c k ; f l a g i
thenreturn
M (
(cid:0)
i
!
; j ) = h A t t a c k ; N o t M i n e i
elsereturn
M (
(cid:0)
i
!
; j ) = h A t t a c k ; M i n e i
Step5: If
9
M (
(cid:0) !
j ;i ) 2 D o w n s tr e a m M e s s a g e s
s.t.
M (
(cid:0)
j
!
; i ) = h A t t a c k ; M i n e i
thenReceivefromalternateroute.
return
M (
(cid:0)
i
!
; j ) = h A t t a c k ; N o t M i n e i
Step6: else If
9
M (
(cid:0)
i;j ) 2 U p s tr e a m M e s s a g e s
s.t.
M ( j
(cid:0)
; i ) = h A t t a c k ; f l a g i
thenTransmitdataonalternateroute.
return
M ( i
(cid:0)
; j ) = h O :K :; N o t M i n e i
Figure9.Responsefunction,
R
,forloopback
5.Conclusions andFuture Research thedata. Sinceouralgorithmhasnosuchdependenceitis
equallyapplicabletolocalareanetworks,metropolitanarea
Wehavepresentedandanalyzedanalgorithmforattack networks,orwideareanetworks.
localization.Thisalgorithmisparticularlywellsuitedtothe There are several open directions for future research.
problem of attack propagationwhich arises in AONs, and Subtle forms of attacks can cause cumulative data degra-
byitsdesignsatisfiesourlocalizationandrobustnessgoal. dationthroughanetwork. Anysingledegradationmaynot
Weappliedouralgorithmtotwocommonnetworkrestora- besevereenoughto forceanalarm, butthecumulativeef-
tion paradigms, automatic protection switching and loop- fectofsuchdegradationoverthenetworkmayresultinin-
back. Forbothparadigmsouralgorithmguaranteesproper validdata. Extendingourapproachtodetectingcumulative
networkoperation,nodatalossandboundeddelaytimere- degradationremainsanopenproblem. Anotherareaofin-
gardlessofthelocationoftheattackorthephysicalspanof terest is the evaluation of reliability afforded by our algo-
thenetwork. rithmforspecificfaultdetectionmethodsatthenodes,ex-
Thealgorithmisdistributedanditsassociateddelaysdo plicitlytakingfalsepositiveandfalsenegativeprobabilities
notdependonthenumberofnodesinthenetwork. Hence intoaccount..
this algorithm avoids the computationalcomplexity inher-
enttocentralizedapproaches. Itthusachievesthescalabil-
References
ity and speed goal. To be accuratewe must pointout that
whenwehavedownstreamandupstreammessagestheone
linktransitiondelayisafactor,thereforethealgorithmmay [1] R.A.Barryetal.,“All-OpticalNetworkConsortium-
notscalewithone-hopnodedistances. UltrafastTDMNetworks”,IEEEJournalonSelected
Moreover, the delays in attack detection do not depend Areas in Communications, vol. 14, no. 5, June 1996,
on the transmission delays in the network. The network pp.999–1013.
managementsystemcanthereforeofferhardupper-bounds
onthelossofdataduetofailuresorattacks. Faultlocaliza- [2] R. Bhandari, “Optimal Diverse Routing in Telecom-
tion with centralized algorithms depends on transmission municationFiberNetworks”,inIEEEINFOCOM’94,
delays,whichareproportionaltothedistancetraversedby vol.3,pp.11c.3.1–11.c.3.11.
14of17[3] M. Bischoff, M.H. Huber, O. Jahreis, S.A.F. Derr, F.
Ulm, “Operation and Maintenance for an All Opti-
calTransportNetwork,”IEEECommunicationsMag-
azine.November1996,pp.136-142.
[4] C.A. Brackett et al., “A Scaleable Multiwavelength
Multihop Optical Network: A Proposal for Research
onAll-opticalNetworks”,JournalofLightwaveTech-
nology,vol.11,no.5/6,June1993,pp.739–.
[5] G.-K.Changetal.,“MultiwavelengthReconfigurable
WDM/ATM/SONET Network Testbed”, Journal of
Lightwave Technology, vol. 14, no. 6, June 1996,
pp.1320–40.
[6] A.T. Dahbura, “An efficientalgorithmfor probabilis-
ticfaultdiagnosis”,ProceedingsoftheNineteenthAn-
nual Conference on Information Sciences and Sys-
tems,1983,JohnsHopkinsUniversity,pg.89.
[7] A.T.Dabhura,G.M.Masson,“AnEfficientDiagnosis
Algorithm for t-Diagnosable Systems”, Proceedings
oftheSeventeenthAnnualConferenceonInformation
Sciences and Systems, 1983, Johns Hopkins Univer-
sity,pp.456–459.
[8] A.T.Dabhura,G.M.Masson,“An
O (cid:0) n
2 :5
(cid:1)
TransactionsonComputers,vol.C-23,January1974,
pp.86–88.
[15] B.R. Hemenway et al., “Demonstration of a
re-configurable wavelength-routed nework at 1.14
terabits-per-second”,OFC97,PostdeadlinePaperPD-
26,February1997.
[16] G.R. Hill et al., “A Transport Network Layer Based
onOpticalNetworkElements”,JournalofLightwave
Technology,vol.11,no.5/6,June1993,pp.667-679.
[17] M.N. Huber, O. Jahreis, “Supervision and protection
concepts for an optical network”, in Proceedings of
OFC95,pp.167–168.
[18] Itai,Rodeh
[19] I.P. Kaminow et al., “A Precompetitive Consortium
on Wide-band All Optical Networks”, IEEE Journal
onSelectedAreasinCommunications,vol.14,no.5,
June1996,pp.780–799
[20] I.Katzela,G.Ellinas, T.E.Stern, “FaultDiagnosisin
the Linear Lightwave Networks,” IEEE/LEOS 1995
DigestoftheLEOSSummerTopicalMeetings,August
1995,pp.41-42.
faultiden-
tification algorithm for diagnosable systems”, IEEE [21] I.KatzelaamdM.Schwartz,“SchemesforFaultIden-
Transactions on Computers, vol. C-33, June 1984, tification in Communication Networks,” IEEE/ACM
pp.486–492. TransactionsonNetworking, vol.3, no.6,December
1995,pp.753-764.
[9] R.H.Eng,A.A.Lazar,W.Wang,“AProbabilisticAp-
proach to Fault Diagnosis in Linear Lightwave Net- [22] V.P.Krothapali,K.Nakajima,“Onfaultidentification
works,” IEEE Journal on Selected Areas in Commu- in t-fault diagnosable analog systems”, Proceedings
nications, vol. 11, no. 9, December 1993, pp. 1438- oftheSeventeenthAnnualConferenceonInformation
1448. Sciences and Systems, 1983, Johns Hopkins Univer-
sity,pp.450–454.
[10] S.G. Finn, R.A. Barry, “Optical Services in Fu-
ture Broadband Networks”, IEEE Network, Novem- [23] V.P.Krothapali,K.Nakajima,“Onadaptivefaultiden-
ber/December1996,vol.10,no.6,pp.7–13. tification forcertain classes of diagnosablesystems”,
ProceedingsoftheSeventeenthAnnualConferenceon
[11] S.G. Finn, M. Me´dard, R.A. Barry, “A Novel Ap- InformationSciencesandSystems, 1983,JohnsHop-
proach to Automatic Protection Switching Using kinsUniversity,pp.443–449.
Trees”,inProceedingsofICC’97.
[24] C.-S.Li,R.Ramaswami,“AutomaticFaultDetection,
[12] L.M. Gardner, M. Heydri, J. Shah, I.H. Sudborough, Isolation and Recovery in Transparent All-Optical
I.G. Trollis, C. Xia, “Techniques for Finding Ring Networks”, Journal of Lightwave Technology, Octo-
Covers in Survivable Networks” in Proceedings of ber1997,vol.15,no.10,pp.1784–1793.
GLOBECOM’94,vol.3,pp.1862–1866.
[25] M.W. Maeda, “Management of WDM Optical Net-
[13] R.W.Haddad,G.M.Masson,“FaultDiagnosisbyLin- works,”OpticalFiberCommunicationConference97
ear Programming”, Proceedings of the Seventeenth Tutorial,February1997,pp.141-166.
AnnualConferenceonInformationSciencesandSys-
[26] S.N. Maheshwari, S.L. Hakimi, “On models for di-
tems,1983,JohnsHopkinsUniversity,pp.460–463.
agnosablesystems and probabilistic fault diagnosis”,
[14] S.L.Hakimi,A.T.Amin,“Characterizationofthecon- IEEE Transactions on Computers, vol. C-25, March
nection assignment of diagnosable systems”, IEEE 1976,pp.228–236.
15of17[27] P. Mateti, N. Deo, “On Algorithms for Enumerating [39] S.Z.Shaikh,“Span-DisjointPathsforPhysicalDiver-
AllCircuitsofaGraph”,SIAMJ.Comput.,vol.5,no. sityinNetworks”,inProceedingsoftheIEEESympo-
1,March1976. sium on Computers and Communications, 1995, pp.
127–133.
[28] M. Me´dard, S.G. Finn, R.A. Barry, “Guaran-
teed Loopback Recovery over Arbitrary Redundant [40] J. Shi, J. Fonseka, “Interconnection of Self-Healing
Graphs”,submittedtoOFC98. Rings”,inProceedingsofICC’96.
[29] M.Me´dard,S.G.Finn,R.A.Barry,“AutomaticProtec- [41] C.-C.Shyur,S.-H,Tsao,Y.-M.Wu,“SurvivableNet-
tionSwitchingforMulticastinginOpticalMeshNet- work Planning Methodsand Tools in Taiwan”, IEEE
works”,inProceedingsofOpticalFiberCommunica- CommunicationsMagazine,September1995.
tionConference97.
[42] C.-C. Shyur, Y.-M. Wu, C.-H. Chen, “A Capac-
[30] M. Me´dard, D. Marquis, R.A. Barry, S.G. Finn, “Se- ity Comparison for SONET Self-Healing Ring Net-
curity Issues in All-Optical Networks”, IEEE Net- works”,inProceedingsofGLOBECOM’93,vol.3,pp.
work,May/June1997,vol.11,no.3,pp.42–48. 1574–1578.
[31] K.Menger,“ZurallgemeinenKurventheorie”,Funda- [43] J.B. Slevinsky, W.D. Grover, M.H. MacGregor, “An
mentaMathematicae,10:96–115,1927. Algorithm for Survivable Network Design Employ-
ing Multiple Self-Healing Rings”, in Proceedings of
[32] G.G.L. Meyer, “The PMC system level fault
GLOBECOM’93,vol.3,pp.1568–1573.
model:maximality properties of the implied faulty
set”, Proceedings of the Seventeenth Annual Con- [44] M. Stoer, Design of Survivable Networks, Springer-
ference on Information Sciences and Systems, 1983, Verlag,1992.
JohnsHopkinsUniversity,pp.443–449.
[45] J.W. Suurballe, “Disjoint Paths in a Network”, Net-
[33] T.Nishida,S.Hasegawa,A.Kanesama,“Architectural works,1974,pp.125–145.
Model for SONET End-to-End Management with
Object-orientedApproach,”IEEEGlobalTelecommu- [46] Y.Tada,Y.Kobayashi,Y.Yamabayashi,S.Matsuoka,
nicationsConference1989,pp.1500-1505. K. Hagimoto, “OA & M Framework for Multiwave-
lengthPhotonicTransportNetworks”, IEEE Selected
[34] Y.Peng,J.A.Reggia,“AProbabilisticCausalModel AreasinCommunications,vol.14,no.5,June1996.
for Diagnostic Problem Solving - Part I: Integrating
SymbolicCausal Inferencewith NumericProbabilis- [47] M. Tomizawa, Y. Yamabayashi, N. Kawase, Y.
tic Inference,” IEEE Transactions on Systems, Man, Kobayashi, “Self-healing algorithm for logical mesh
and Cybernetics,” vol. SMC-17, no. 2, March/April connection on ring networks”, Electronics letters,
1987,pp.146-162.
[35] Y.Peng,J.A.Reggia,“AProbabilisticCausalModel
for Diagnostic Problem Solving Part II: Diagnostic
Strategy,” IEEE Transactions on Systems, Man, and
Cybernetics,”vol.SMC-17,no.3,May/June1987,pp.
395-406.
[36] M. Piepers, “Management of a Fibre Transmission
System for Video, Audio and Auxiliary Data Sig-
nals,” IEEE International Broadcasting Convention,
September12-16,1996,pp.414-418.
[37] F.P. Preparata, G. Metze, R.T. Chien, “On the con-
nectionassignmentproblemofdiagnosablesystems”,
IEEETransactionsonElectronicComputing,vol.EC-
16,December1967,pp.848–854.
[38] N. Schroff, M.
Schwartz. “Fault Detection/Identification in the Lin-
earLightwaveNetwork,”ColumbiaUniversity,1991.
1 5
th
September1994,vol.30,no.19,pp.1615–1616.
[48] P.K. Varshney, C.R.P. Hartmann, J.M. de Faria, Jr.,
“Application of Information Theory to Sequential
Fault Diagnosis”, IEEE Transactions on Computers,
vol.C-31,February1982,pp.164–170.
[49] P.K. Varshney, C.R.P. Hartmann, “Sequential Fault
Diagnosis of Modular Systems”, Proceedings of the
1982 Conference on Information Sciences and Sys-
tems,Princeton,pg.377.
[50] R.S.Vodhaneletal.,“National-scaleWDMnetwork-
ing demonstration by the MONET consortium”, Op-
ticalFiber CommunicationConference, Postdeadline
PaperPD-27,February1997.
[51] O.J. Wasem, “Optimal Topologies for Survivable
Fiber Optic Networks Using SONET Self-healing
Rings”,inProceedingsofGLOBECOM’91,vol.3,pp.
57.5.1–57.5.7.
16of17[52] //www.ll.mit.edu/aon/
[53] J.S. Whalen, J. Kenney, “Finding Maximal Link
Disjoint Paths in a Multigraph”, in Proceedings of
GLOBECOM’90,pp.403.6.1-403.6.5.
[54] T.-H. Wu, “A Passive Protected Self-Healing Mesh
Network Architecture and Applications”, IEEE/ACM
Transactions on Networking, vol. 2, no. 1, February
1994,pp.40–52.
[55] T.-H.Wu,FiberNetworkServiceSurvivability,Artech
House,1992.
[56] T.-H. Wu, M.E. Burrows, “Feasibility Study of a
High-Speed SONET Self-Healing Ring Architecture
in Future Interoffice Networks”, IEEE Communica-
tionsMagazine,November1990,pp.33–51.
[57] T.-H. Wu, R.H. Caldwell, M. Boyden, “A Multi-
Period Design Model for SurvivableNetwork Archi-
tecture Selection for SDH/SONET Interoffice Net-
works”,IEEETransactionsonReliability,vol.40,no.
4,October1991,pp.417–432.
[58] T.-H. Wu, W.I. Way, “A Novel Passive Protected
SONET Bidirectional Self-Healing Ring Architec-
ture”,IEEEJournalofLightwaveTechnology,vol.10,
no.9,September1992.
[59] W.T.Zaumen,J.J.Garcia-LunaAceves,“Dynamicsof
Distributed Shortest-Path Routing Algorithms”, Pro-
cedings of the 21
s
t
SIGCOMM Conference, Septem-
ber3-6,1991,inComputerCommunicationsReview,
vol.21,no.4,ACMPress,pp.31–43.
17of17