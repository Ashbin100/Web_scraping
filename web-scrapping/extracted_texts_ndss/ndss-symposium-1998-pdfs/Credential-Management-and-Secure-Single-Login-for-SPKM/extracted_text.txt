Credential Management and Secure Single Login for SPKM se cu n e t
• C lien t-S erver
• G S S
eneric ecurity ervice
• S P K M
imple ublic ey echanism
• C red en tial M an ag em en t
• S ecu re S in g le L o g in
© Detlef Hühnlein, huehnlein@secunet.deCredential Management and Secure Single Login for SPKM se cu n e t
T h e P la y e rs
C lient S erver
M r. B adG uy
© Detlef Hühnlein, huehnlein@secunet.deCredential Management and Secure Single Login for SPKM se cu n e t
G S S
C S
lient erver
CS
CS
GSS_Init_sec_context
T
(...,Cred , S ,...)
C
GSS_Accept_sec_context
T
(..., , Cred )
T S
T GSS_Init_sec_context
(..., ,...)
T
© Detlef Hühnlein, huehnlein@secunet.deCredential Management and Secure Single Login for SPKM se cu n e t
K e rb e ro s
Authentication Ticket Granting
Server Service
S-req
TGS
TGS-req
TGS
S
Service-req S
Client Server
© Detlef Hühnlein, huehnlein@secunet.deCredential Management and Secure Single Login for SPKM se cu n e t
S P K M (3 -W a y -A u th )
Sc Pc Ss Ps
+ +
1. Rc, M=Rc|S|C, F=Sig(h(M),Sc)
2. M,F, Pc
3. Verify
4. Rs, Kcs, N=Rs|Rc|Kcs
5. G,H, Ps
G=Enc(N,Ps),
H=Sig(h(N),Ss)
6. Verify, decrypt G, I=Enc(Rs,Ps)
7. I
8. Rs‘=Enc(I,Ss)=Rs?
Kcs Kcs
© Detlef Hühnlein, huehnlein@secunet.deCredential Management and Secure Single Login for SPKM se cu n e t
C redential M an ag em ent fo r S P K M
„The key m anagem ent em ployed in SPKM
is intended to be as com patible as possible
with both X.509 and PEM, since these
represent large com m unities of interest
and show relative m aturity in standards.“
S P K M
© Detlef Hühnlein, huehnlein@secunet.deCredential Management and Secure Single Login for SPKM se cu n e t
C re d e n tia l M a n a g e m e n t
S
P
+
secunet
Michaela May
P S E X .500
or
SW -PSE
P P P P
© Detlef Hühnlein, huehnlein@secunet.deCredential Management and Secure Single Login for SPKM se cu n e t
M u ltip le C o n n e c tio n s
S
C re d e n tia l M a n a g e m e n t
Usability Security
Keep PSE accessible (for a long tim e)
Enter PIN to open PSE for every connection
Secure Single Login
© Detlef Hühnlein, huehnlein@secunet.deCredential Management and Secure Single Login for SPKM se cu n e t
S e c u re S in g le L o g in
K erberos SPK M
G enerate and (self) certify
G et TG S-Ticket
Public K ey Pair
w ith lim ited lifetim e
w ith lim ited lifetim e
to authenticate
to authenticate
© Detlef Hühnlein, huehnlein@secunet.deCredential Management and Secure Single Login for SPKM se cu n e t
X .509 v3 - C ertificates
version
serialN um ber
signature
signature
issuer
v3 algorithm
not before
validity
not after
subject
subjectPublicKeyInfo
... signature
extensions
© Detlef Hühnlein, huehnlein@secunet.deCredential Management and Secure Single Login for SPKM se cu n e t
X .509 v3 / P K IX - E xten sio n s
Extension
extnID OID
critical Boolean
extnValue OctetString
subjectAltName
issuerAltName
Name Constraints
basic Constraints
GenSubtree permittedSubtrees
Boolean cA GenSubtree excludedSubtrees
Integer PathLenConstraint ExtendedKeyUsage
Key usage
OID KeyPurposeId
BitString (0) digitalSignature
(1) nonRepudiation
(2) keyEncipherment
Examples:
(3) dataEncipherment
id-kp-serverAuth
(4) key Agreement
id-kp-clientAuth
(5) keyCertSign
(6) cRLSign id-kp-codeSigning
(7) encipherOnly id-kp-emailProtection
(8) decipherOnly
© Detlef Hühnlein, huehnlein@secunet.deCredential Management and Secure Single Login for SPKM se cu n e t
C redential M an ag em ent fo r S P K M
new Key Purposes:
:=PK IX+increm ental changes id-kp-SignTempCert
id-kp-Temporary
perm anent tem porary
Issuer CA Issuer User
validity u-notBefore validity t-notBefore
u-notAfter t-notAfter
subject User subject User
subjectAltName User-alt subjectAltName User-alt
issuerAltName CA-alt issuerAltName User-alt
Keyusage critical=TRUE Keyusage critical=TRUE
digitalSignature digitalSignature
nonRepudiation ExtKeyUsage critical=TRUE
ExtKeyUsage critical=FALSE id-kp-Temporary
(id-kp-SignTempCert) Basic Constraints critical=TRUE
Basic Constraints critical=TRUE cA=FALSE
cA=FALSE
© Detlef Hühnlein, huehnlein@secunet.deCredential Management and Secure Single Login for SPKM se cu n e t
V erificatio n P ro ced u re
1. PKIX conform not present
P RT ... P CA P U P T
2.
PKIX conform
Issuer = subject
issuerAlt= subjectAlt
validity.T-notBefore>validity.U-notBefore
validity.T-notAfter<validity.U-notAfter
KeyUsage critical=TRUE
KeyUsage critical=TRUE
nonRepudiation=FALSE
digitalSignature=TRUE
keyCertSign=FALSE
ExtKeyUsage (id-kp-SignTempCert)
cRLSign=FALSE
ExtKeyUsage critical=TRUE
id-kp-Temporary is present
Basic Constraints critical=TRUE
cA=FALSE
© Detlef Hühnlein, huehnlein@secunet.deCredential Management and Secure Single Login for SPKM se cu n e t
E fficien cy
(Estim ate)
Time Efficiency Space Efficiency
(1024 Bit Mult.) (Byte)
Security Usab. Once Session Context Secure Insecure
Single Login / / 5526 / /
Multiple Login / / 5526 / /
SSLogin - RSA / 108315 3758 / 740
SSLogin - DL (naive) 116000 1267 7236 20 1348
SSLogin - DL (prec.) 116517 675 6368 20 19780
© Detlef Hühnlein, huehnlein@secunet.deCredential Management and Secure Single Login for SPKM se cu n e t
... C o m m e n ts a p p re c ia te d
h ttp ://w w w .ie tf.o rg /in te rn e t-d ra fts /
d ra ft-h u e h n le in -c re d m a n -s p k m -0 0 .tx t
B y H ans Schupp, G M D , D arm stadt, G erm any
& m e
© Detlef Hühnlein, huehnlein@secunet.de