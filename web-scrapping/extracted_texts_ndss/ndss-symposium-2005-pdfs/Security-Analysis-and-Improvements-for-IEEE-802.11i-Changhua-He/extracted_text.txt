Security Analysis and Improvements for IEEE 802.11i
Changhua He John C Mitchell
Electrical Engineering and Computer Science Departments
Stanford University, Stanford CA 94305
Abstract authentication. RSNA provides two data confidentiality
protocols, called the Temporal Key Integrity Protocol
This paper analyzes the IEEE 802.11i wireless (TKIP) and the Counter-mode/CBC-MAC Protocol
networking standard with respect to data confidentiality, (CCMP), and the RSNA establishment procedure,
integrity, mutual authentication, and availability. Under including 802.1X authentication and key management
our threat model, 802.11i appears to provide effective protocols.
data confidentiality and integrity when CCMP is used. This paper analyzes security aspects of the 802.11i
Furthermore, 802.11i may provide satisfactory mutual specification, considering data confidentiality, integrity,
authentication and key management, although there are mutual authentication, and availability. Our analysis
some potential implementation oversights that may cause suggests that 802.11i is a well-designed standard for data
severe problems. Since the 802.11i design does not confidentiality, integrity, and mutual authentication,
emphasize availability, several DoS attacks are possible. promising to improve the security of wireless networks.
We review the known DoS attacks on unprotected At the same time, some vexing Denial-of-Service (DoS)
management frames and EAP frames, and discuss ways of attacks remain. We review the known DoS attacks and
mitigating them in 802.11i. The practicality of a DoS describe appropriate countermeasures. We also describe
attack against Michael MIC Failure countermeasure is two new DoS attacks – RSN Information Element (RSN
discussed and improvements are proposed. Two new DoS IE) Poisoning and 4-Way Handshake Blocking – and
attacks and possible repairs are identified: RSN IE present countermeasures for these. We also analyze the
Poisoning and 4-Way Handshake Blocking. Finally some failure-recovery strategy in 802.11i and discuss associated
tradeoffs in failure-recovery strategies are discussed and tradeoffs. Finally we outline an improved version of
an improved variant of 802.11i is proposed to address all 802.11i that addresses all the vulnerabilities discussed in
the discussed vulnerabilities. this paper.
In proceeding through the analysis of 802.11i, we
describe several implementation considerations and
1 Introduction suggest ways to avoid a range of security problems. Here
is a concise list of our primary recommendations: First,
CCMP should be used for data confidentiality whenever
As Wireless Local Area Networks (WLANs) become
possible because WEP and TKIP have inherent
more widely deployed, wireless security has become a
weaknesses. Second, mutual authentication must be
serious concern for an increasing number of organizations
implemented carefully to achieve security objectives, as
[15, 38]. A summary of relevant literature on wireless
elaborated in the next paragraph. Third, several
security research appears in the Appendix, including
implementation details are important for addressing DoS
review of standard definitions and acronyms. Generally,
vulnerabilities in the MAC layer. Finally, the efficiency of
the security requirements for a WLAN include data
failure recovery may be improved by using a modified
confidentiality, integrity, mutual authentication, and
strategy, subject to certain tradeoffs.
availability.
Strong mutual authentication may be achieved by a
IEEE 802.11i [21], an IEEE standard ratified June 24,
combination of mechanisms. First, an appropriate
2004, is designed to provide enhanced security in the
Extensible Authentication Protocol (EAP) [9] method,
Medium Access Control (MAC) layer for 802.11
such as EAP-TLS [2], should be used to prevent Man-in-
networks. The 802.11i specification defines two classes of
the-Middle (MitM) attacks. Second, the RADIUS [34]
security algorithms: Robust Security Network Association
secret and the passphrase for Pre-Shared Key (PSK)
(RSNA), and Pre-RSNA. Pre-RSNA security consists of
generation should be chosen carefully to defend against
Wired Equivalent Privacy (WEP) and 802.11 entity
dictionary attacks. Third, if Pre-RSNA and RSNAalgorithms are allowed to run simultaneously in a WLAN, predictable or redundant; further, encrypted messages
a user should have a chance to manually decide which to may be generated upon the requests from the adversary
use prior to opening a connection, and Access Points (APs) itself. In our analysis, we consider whether recorded
should impose different privilege policies for each. packets and/or knowledge of the plaintext can be used to
Otherwise, an adversary may compromise the security of reveal the encryption key, decrypt complete packets, or
the entire system through a Security Level Rollback gather other useful information through traffic analysis
Attack. Finally, in order to avoid reflection attacks, no techniques.
single device should serve as both the authenticator and
the supplicant when executing the 4-Way Handshake Threat 2. Message Injection/Active Eavesdropping
under the same Pairwise Master Key (PMK). This An adversary is capable of inserting a message into the
restriction is straightforward for standard infrastructure wireless network with moderate equipment, such as a
networks, but may have some impact on possible uses of station with a common wireless Network Interface Card
802.11i in combination with ad hoc networks. (NIC) and some relevant software. Although the firmware
A number of seemingly minor modifications make of most wireless NICs may limit the interface for
802.11i more robust against DoS attacks. First, 802.11i composing packets to the 802.11 standard, an adversary is
can eliminate known DoS attacks on the EAP packets by still able to control any field of a packet using known
simply ignoring certain packets. Second, when TKIP is techniques [8]. Hence, it is reasonable to assume that an
adopted, the Michael MIC (Message Integrity Code) adversary can generate any chosen packet, modify
Failure countermeasure could be implemented with contents of a packet, and completely control the
improved TKIP Sequence Counter (TSC) updating and transmission of the packet. If a packet is required to be
without re-keying in order to make the DoS attack more authenticated, the adversary may be able to break the data
difficult. Third, in the RSN IE confirmation mechanism, integrity algorithm to make a valid packet. The adversary
the verification condition should be relaxed to mitigate a can also insert a replayed packet, if there is no replay
potential DoS attack. Finally, in the 4-Way Handshake, it protection or the adversary is able to avoid it. Furthermore,
is better for a supplicant to re-use the same nonce until by inserting some well-chosen packets, the adversary
one instance is completed successfully. might be able to learn more information from the reaction
The paper is organized as follows. Section 2 describes of the system through active eavesdropping.
threats in wireless networks. Section 3 analyzes the data
confidentiality and integrity protocols of 802.11i. Section Threat 3. Message Deletion and Interception
4 analyzes the RSNA establishment procedure and We assume that an adversary is able to do message
indicates possible implementation mistakes. Section 5 deletion, which means that an adversary is capable of
discusses the practical DoS attacks and proposes an removing a packet from the network before it reaches its
improved version of 802.11i. Section 6 concludes the destination. This could be done by interfering with the
paper. packet reception process on the receiver’s antenna, for
example by causing CRC (Cyclic Redundancy Checksum)
errors so that the receiver drops the packet. This process
2 Wireless Threats is similar to ordinary packet errors due to noise, but may
be instigated by an adversary.
In order to analyze the 802.11i protocol, it is important Message interception means that an adversary is able
to characterize the likely capabilities of any adversary. to control a connection completely. In other words, the
From the Link Layer of a WLAN, there are three possible adversary can capture a packet before the receiver
types of frames: Management Frames, Control Frames, actually receives it, and decide whether to delete the
and Data Frames. Any manipulation of these frames that packet or forward it to the receiver. This is more
directly or potentially jeopardizes data confidentiality, dangerous than the eavesdropping and message deletion.
integrity, mutual authentication, and availability will be Furthermore, it differs from eavesdropping and replaying,
considered a threat. In this section, we outline some forms because the receiver does not get the packet before the
of attack that we consider and evaluate in our analysis. adversary forwards it. Message interception may seem
difficult in wireless LANs because the legitimate receiver
Threat 1. Passive Eavesdropping/Traffic Analysis might detect a message as soon as the adversary does so.
Due to the characteristics of wireless communication, However, a determined adversary does have some
an adversary can easily sniff and store all the traffic in a potential ways to achieve message interception. For
WLAN. Even when messages are encrypted, it is example, the adversary can use a directional antenna to
important to consider whether an adversary may learn delete a packet on the receiver side, while simultaneously
partial or complete information from certain messages. using another antenna to receive the packet itself. Since
This possibility exists if common message fields are message interception is relatively difficult to achieve, weonly consider this possibility when the damage caused is adversary must spoof the AP’s credentials. Another
relatively severe. Note that it is not necessary for the possible approach for the adversary to launch a MitM
adversary to perform a Man-in-the-Middle (MitM) attack attack is ARP cache poisoning, as in a wired LAN [17].
in order to intercept packets.
Threat 7. Denial-of-Service
Threat 4. Masquerading and Malicious AP WLAN systems are quite vulnerable to DoS attacks.
Because the plaintext MAC addresses are included in An adversary is capable of making the whole Basic
all packets transmitted through wireless links, an Service Set (BSS) unavailable, or disrupting the
adversary can learn valid MAC addresses by connection between legitimate peers. Using
eavesdropping. The adversary is also capable of characteristics of wireless networking, an adversary may
modifying its MAC address to any value because most launch DoS attacks in several ways. For example, forging
firmware provides the interface to do so. If a system uses the unprotected management frames (e.g.,
MAC address as the only identification of the wireless Deauthentication and Disassociation), exploiting some
devices, the adversary can masquerade as any wireless protocol weaknesses, or straightforward jamming of the
station by spoofing its MAC address; or can masquerade frequency band will deny service to legitimate users.
as an Access Point (AP) by spoofing its MAC address and However, we only consider DoS attacks that require
functioning appropriately through appropriate freeware reasonable effort on the part of the adversary. For
(e.g., HostAP). An adversary is also able to install his instance, deleting all packets, using the message deletion
own AP, with a forged MAC address and a spoofed SSID. techniques described in Threat 3, consumes considerable
Alternatively, without masquerading as others, it is resources and may not be considered a relevant DoS
possible for a malicious AP to provide a strong signal and attack because it is just like a frequency jamming.
attempt to fool a wireless station into associating with it
and leaking credentials or private data. Threats 1, 2, and 3 attack all three types of frames in
the Link Layer, possibly breaking data confidentiality and
Threat 5. Session Hijacking integrity of a WLAN. Threats 4, 5, and 6 defeat mutual
We consider that an adversary may be able to hijack a authentication; generally they arise from compositions of
legitimate session after the wireless devices have finished Threats 1, 2, and 3 on management frames. Threat 7
authenticating themselves successfully. Here is one interferes with availability, and could result from Threats
possible scenario for achieving this. First, the adversary 1, 2, and 3 on any type of frames. The following sections
disconnects a device from an existing session, and then will analyze the effectiveness of 802.11i for defending
masquerades as this device to obtain possible connections against these threats; appropriate suggestions or
without the attention of the other device. In this attack, the modifications are proposed if 802.11i cannot eliminate
adversary is able to receive all packets destined to the these threats.
hijacked device and send out packets on behalf of the
hijacked device. This attack could conceivably
circumvent any authentication mechanism in the system. 3 Data Confidentiality and Integrity
However, if data confidentiality and integrity protocols
are used, the adversary must break them in order to read IEEE 802.11i defines three data confidentiality
encrypted traffic and send out valid packets. Thus this protocols: Wired Equivalent Privacy (WEP), Temporal
attack against authentication can be prevented by Key Integrity Protocol (TKIP), and Counter-mode/CBC-
sufficiently powerful data confidentiality and integrity MAC Protocol (CCMP). The vulnerabilities of WEP and
mechanisms. TKIP have been studied extensively [4, 5, 10, 11, 18, 28,
33, 39, 40] (See the Appendix). Therefore, this section
Threat 6. Man-in-the-Middle will focus on analyzing CCMP. Note that a fresh
This attack is different from message interception Temporal Key (TK) is assumed to be shared between the
because the adversary must participate in communication peers before executing any data confidentiality protocols.
continuously. If there is already a connection between a Unlike the RC4 stream cipher used in WEP and TKIP,
wireless station and the AP, the adversary must break this CCMP uses the CCM (Counter with CBC-MAC)
connection first. Then, the adversary masquerades as the operation mode [41] of the AES encryption algorithm [31]
legitimate station to associate with the AP. If the AP with a 128-bit key and a 128-bit block size. CCMP
adopts any mechanisms to authenticate the station, the combines the counter mode (CTR) for data confidentiality
adversary must be able to spoof the authentication. And and the Cipher Block Chaining Message Authentication
finally, the adversary must masquerade as the AP to fool Code (CBC-MAC) for data integrity, using an 8-octet
the station to associate with it. Similarly, if the station MIC (Message Integrity Code) and a 2-octet Length field.
adopts some mechanism to authenticate the AP, the We assume that a 128-bit key is secure against brute-forceattacks on AES. With AES, it is possible to use a single without the knowledge of the key. Furthermore, an
128-bit key to encrypt all packets, eliminating the adversary cannot obtain useful information about the key
problems of key scheduling algorithms associated with through analyzing the cipher text even if the
WEP and TKIP. CCMP also provides MIC protection corresponding plaintext is known.
over both the frame body and nearly the entire header in a For completeness, we discuss the threats listed in
MAC frame, which prevents an adversary from exploiting Section 2 in order. With regard to Threat 1,
the MAC headers. In addition, CCMP uses a 48-bit eavesdropping and traffic analysis, an adversary may
Packet Number (PN) to prevent replay attacks and eavesdrop on traffic, but it cannot decrypt the packets
construct a fresh nonce for each packet. The sufficient because it has no way to discover the TK. Furthermore,
space of PN eliminates any worry about PN re-usage since the IP header of the messages is encrypted, the
during an association. adversary can only obtain limited information through
A possible vulnerability might arise from the fact that traffic analysis, compared to a higher layer encryption
CCM uses the same key for both confidentiality and method such as IPsec and SSL. However, the adversary
integrity. However, CCM appears unproblematic because does have some ways to discover useful information,
it guarantees that the space of the CTR never overlaps because the MAC header is not encrypted; the packet size
with the space of the CBC-MAC initialization vector. If and frequency are observable. Fortunately, in most
AES behaves like a pseudo-random permutation, which is scenarios such information leakage is not considered to be
a plausible assumption, and the cipher operates on two harmful.
separate spaces, which is guaranteed by CCM, then the Threat 2 on data frames is completely eliminated
outputs of the cipher will be independent. because a strong MIC prevents an adversary from
Another possibility is pre-computation attacks. While a inserting a forged data message. Data modifications are
128-bit key is considered secure against brute-force similarly prohibited by the MIC. Further, a replayed
attacks; CCMP uses an incremental PN to construct packet will be discarded silently because the
nonces, and the PN is initialized to one for every fresh TK. corresponding PN is out of order. For Threat 3, the
This allows a common pre-computation attack. An adversary is able to delete a packet in any case; however,
adversary might compute a table offline for one specific this can be handled by the retransmission mechanism or
nonce and 264 possible keys. Then the adversary starts to higher layer protocols. On the other hand, the adversary is
observe the online messages encrypted with this specific also able to intercept a packet and forward this packet to
nonce and an unknown key. On average the adversary the receiver later. The forwarded packet could have been
correctly encrypted with a valid MIC; however, the
could find an overlap of keys after observing 264
receiver is likely to recognize this as an out-of-order
messages with the specific nonce and different keys,
packet and discard it silently.
obtaining the TK for that session. This pre-computation
In summary, against Threats 1, 2, and 3, CCMP
attack reduces the key space from 2128 to 264, which is
appears to provide satisfactory data confidentiality,
possible to be broken practically for a block cipher.
integrity, and replay protection for data packets, as
However, since CCMP also includes the source MAC
intended. However, since management frames and control
address in constructing the nonce, once the adversary
frames are neither encrypted nor authenticated by the
chooses a specific value to build the offline table, the
Link Layer encryption algorithm, they are still vulnerable
same nonce will only appear for the specific station.
to these threats. In addition, not surprisingly, CCMP
Furthermore, since a PN will never repeat for the same
requires hardware upgrades and might have some impacts
TK, the adversary may need to wait for refreshed TKs,
on performance.
which means different sessions, in order to observe more
messages with the same nonce. Therefore, the
combination of the PN and the MAC address requires that
4 Authentication and Key Management
an adversary keep observing 264 different sessions for a
specific station in order to break one TK. Additionally,
Prior work has shown that 802.11 entity authentication
264 entries may consume significant resources to store (Open System Authentication and Shared Key
and search efficiently. Hence, this is not considered a Authentication) are completely insecure [4, 10]. Therefore,
practical attack. 802.11i defines the Robust Security Network Association
Although there has been some criticism [35], analysis (RSNA) establishment procedure to provide strong
suggests that CCM provides a level of confidentiality and mutual authentications and generate fresh TKs for the
authenticity comparable to other authenticated encryption data confidentiality protocols. This section will analyze
modes, such as OCB mode [23]. Hence, it is reasonable to the RSNA handshakes in details.
believe that, once CCMP is implemented, an adversary is
not able to break the data confidentiality and integrity4.1 RSNA Establishment Procedure (PMK); The AAA key material on the server side is
securely transferred to the authenticator, indicated by
802.11i RSNA establishment procedure consists of message (15). This allows the authenticator to derive the
802.1X authentication and key management protocols. same PMK. This stage might be skipped if the supplicant
Three entities are involved, called the Supplicant (the and the authenticator are configured using a static Pre-
wireless station), the Authenticator (the Access Point), Shared Key (PSK) as the PMK, or when a cached PMK is
and the Authentication Server (de facto a RADIUS server used during a Re-association.
[34]). Generally, a successful authentication means that
the supplicant and the authenticator verify each other’s Stage 4. 4-Way Handshake
identity and generate some shared secret for subsequent This stage consists of messages numbered (16) to (19).
key derivations. Based on this shared secret, the key Regardless of whether the PMK is derived from Stage 3,
management protocols compute and distribute usable keys configured using a PSK, or reused from a cached PMK,
for data communication sessions. The authentication the 4-Way Handshake must be executed for a successful
server can be implemented either in a single device with RSNA establishment. The supplicant and authenticator
the authenticator, or through a separate server, assuming use this handshake to confirm the existence of the PMK,
the link between the authentication server and the verify the selection of the cipher suite, and derive a fresh
authenticator is physically secure. The complete Pairwise Transient Key (PTK) for the following data
handshakes of establishing a RSNA are shown in Figure 1. session. Simultaneously, the authenticator might also
For the purpose of analysis, these steps can be divided distribute a Group Transient Key (GTK) in message (18).
into 6 stages as follows. After this stage, a fresh PTK (and maybe GTK) is shared
between the authenticator and the supplicant; the 802.1X
Stage 1. Network and Security Capability Discovery ports are unblocked for data packets.
This stage consists of messages numbered (1) to (3).
The AP (Access Point) either periodically broadcasts its Stage 5. Group Key Handshake
security capabilities, indicated by RSN IE (Robust This stage consists of messages numbered (20) and
Security Network Information Element), in a specific (21). In case of multicast applications, the authenticator
channel through the Beacon frame; or responds to a will generate a fresh GTK and distribute this GTK to the
station’s Probe Request through a Probe Response frame. supplicants. These handshakes might not be present if the
A wireless station may discover available access points fresh GTK has been distributed in Stage 4; this stage may
and corresponding security capabilities by either passively be repeated multiple times using the same PMK.
monitoring the Beacon frames or actively probing every
channel. Stage 6. Secure Data Communication
This stage is indicated by (22). Using the PTK (or
Stage 2. 802.11 Authentication and Association GTK) and the negotiated cipher suite from above stages,
This stage consists of messages numbered (4) to (7). the supplicant and the authenticator can exchange
The station chooses one AP from the list of available APs, protected data packets using data confidentiality protocols.
and tries to authenticate and associate with that AP. Note
that 802.11 Open System Authentication is included only Through these handshakes, the supplicant and the
for backward compatibility, and a station should indicate authenticator mutually authenticate each other and
its security capabilities in the Association Request. After establish a secure session for data transmissions.
this stage, the station and the AP are in authenticated and
associated state. However, the authentication achieved so 4.2 RSNA Security Analysis
far is weak, and will be supplemented by further steps. At
the end of this stage, the 802.1X ports remain blocked and Based on the complete RSNA establishment procedure,
no data packets can be exchanged. we will analyze the security of 802.11i considering each
possible threat separately. Since the management frames
Stage 3. EAP/802.1X/RADIUS Authentication are not protected in a WLAN, an adversary is capable of
This stage consists of messages numbered (8) to (14). interfering with Stages 1 and 2 of the RSNA
The supplicant and the authentication server execute a establishment. More specifically, Stages 1 and 2 are
mutual authentication protocol (de facto EAP-TLS [2]), vulnerable to Threats 1, 2, 3, and 4. An adversary can
with the authenticator acting as a relay. After this stage, send spoofed security capabilities and topological views
the supplicant and the authentication server have of the network to a supplicant on behalf of an
authenticated each other and generated some common authenticator. Once this occurs, the supplicant will be
secret, called the Master Session Key (MSK). The forced to use inappropriate security parameters to
supplicant uses the MSK to derive a Pairwise Master Key communicate with the legitimate authenticator, orSupplicant Authenticator Authentication
Unauthenticated Unauthenticated Server
Unassociated Unassociated ( RADIUS )
802.1X Blocked 802.1X Blocked
(1) Beacon + AA RSN IE
Stage 1:
Network and (2) Probe Request
Security
Capability (3) Probe Response + AA RSN IE
Discovery
(4) 802.11 Authentication Request
(5) 802.11 Authentication Response
Stage 2.
802.11 (6) Association Request + SPA RSN IE
Authentication
and Association (7) 802.11 Association Response
Authenticated Authenticated
Associated Associated
802.1X Blocked 802.1X Blocked
Security Params Security Params
(8) EAPOL-Start
(9) EAPOL-Request Identity
Stage 3. (10) EAPOL-Response Identity
EAP/802.1X (11) RADIUS Request
/RADIUS
(12) Mutual Authentication (de facto EAP-TLS)
Authentication
(13) RADIUS Accept
(14) EAPOL Success
Master Session (15) MSK Master Session
Key ( MSK ) Key ( MSK )
Pairwise Master Pairwise Master
Key ( PMK ) Key ( PMK )
(16) {AA, ANonce, sn, msg1}
Pairwise Transient
Key ( PTK )
Stage 4. (17) {SPA, SNonce, SPA RSN IE, sn, msg2, MIC}
4-Way
Handshake
PTK, Generate GTK
(18) {AA, ANonce, AA RSN IE, GTK, sn+1, msg3, MIC}
(19) {SPA, sn+1, msg4, MIC}
GTK, 802.1X Unblocked 802.1X Unblocked
Generate Rand GTK
(20) EAPOL-Key{Group, sn+2, GTK, Key ID, MIC}
Stage 5. Notes:
(21) EAPOL-Key{Group, sn+2, MIC}
Group Key Handshake 1. Dotted lines (1), (8), (20),
and (21) indicate optional
New GTK Obtained messages.
2. Bolded boxes show the
Stage 6. (22) Protected Data Packets states of the entities.
Secure Data Communication 3. Dashed boxes are optional.
Figure 1. RSNA Establishment Proceduresassociate with a malicious AP. Alternatively, an adversary appropriately implemented [6], the adversary will be able
can also forge Association Requests to the authenticator to launch a MitM attack and learn the PMK. Though this
with possibly weak security capabilities, which might vulnerability is considered as a weakness of the specific
cause problems if no further protections are adopted. mutual authentication protocol instead of 802.11i, any
Fortunately, these threats are eliminated in Stage 3 if a implementer of 802.11i should consider this problem
strong mutual authentication is implemented. The carefully.
authentication mechanism (e.g., EAP-TLS) should In summary, if the complete RSNA handshakes are
prevent an adversary from forging, modifying, and performed, the authentication and key management
replaying authentication packets, eliminating Threats 1, 2, process appear to be secure. However, since the adversary
and 3. In addition, since credentials other than MAC could interfere with Stage 1 and 2, it might be able to fool
addresses must be provided for successful mutual the authenticator and the supplicant, and prevent
authentication, Threat 4 is not possible. After the peers completion of the RSNA; this is described as a Security
have authenticated each other and exchanged some secret Level Rollback Attack in Section 4.3. In addition, some
after Stage 3, the subsequent handshakes are also resistant implementations might also allow a reflection attack in
to these threats. In the case that Stage 3 is omitted because Stage 4; the details are described in Section 4.4.
a PSK or a cached PMK is used, the peers can Furthermore, although we assume the link between the
authenticate each other by verifying possession of the authenticator and the authentication server is secure, an
shared key in Stage 4, again preventing Threats 1, 2, 3, adversary may still be able to discover the shared secret in
and 4. In addition, Stage 4 can also verify the security RADIUS by offline dictionary attacks [1]. When a 256-bit
capability negotiations. PSK is used as a PMK, this PSK might be derived from a
Threat 5 may exist even if a strong authentication passphrase [30], which makes the PSK vulnerable to
mechanism is implemented. After a legitimate station has dictionary attacks. An implementation should carefully
completed a successful authentication, the adversary choose a good passphrase or directly use a 256-bit
could disconnect a station by forging Deauthentication or random value to eliminate this vulnerability.
Disassociation messages, and resume the session with the
AP on behalf of the legitimate station. There are two 4.3 Security Level Rollback Attack
possibilities to consider. First, if the session allows the
adversary only to accept packets, this appears to be just When Pre-RSNA and RSNA algorithms are both used
eavesdropping, which is prevented by data confidentiality in a single WLAN, an adversary can launch a Security
mechanisms. Second, if the session requires the adversary Level Rollback Attack, avoiding authentication and
for interaction, the adversary will need to obtain the disclosing the default keys. Some might argue this is not a
authentication information, such as the PTK, in order to real vulnerability, because 802.11i explicitly disallows
generate acceptable traffic. On the whole, Threat 5 poses Pre-RSNA algorithms when RSNA is used. However,
no more danger than eavesdropping and DoS attacks on 802.11i does define a Transient Security Network (TSN)
the station. supporting both Pre-RSNA and RSNA algorithms, and
Threat 6 is possible in a WLAN if no authentication this situation might naturally appear in a WLAN
mechanisms are implemented. An adversary could implementation. In general, new WLAN implementations
establish two separate connections to the supplicant and may try to support Pre-RSNA algorithms in order to
the authenticator to construct a MitM attack [25]. First, support migration to RSNA. In other words, a supplicant
the adversary forges the Deauthentication frames to might enable accesses to both RSNA and Pre-RSNA
disconnect a station from a legitimate AP. Then, the capable networks to ensure Internet access under mobility;
victim station will automatically probe for a new AP after simultaneously, an authenticator might be configured in a
several failed retries, and eventually associate with the similar way to provide services to various supplicants.
malicious AP, maybe on a different channel. At last, the This hybrid configuration will degrade the security of the
adversary associates with the legitimate AP on behalf of entire system to the lowest level.
the legitimate station. However, when 802.11i is Figure 2 shows an attack to roll back the security level.
implemented with a strong mutual authentication In this figure, the solid lines represent legitimate message
mechanism, like EAP-TLS, the adversary might not be exchanges and the dashed lines indicate messages sent by
able to authenticate itself to the station or the AP because the adversary. In this attack, the adversary impersonates
it does not possess appropriate credentials. Of course the the authenticator, forging the Beacon or Probe Response
adversary can forward credentials between the AP and the frames to the supplicant, and indicating that only Pre-
station; but since the authentication packets cannot be RSNA (WEP) is supported. Alternatively, the adversary
modified or replayed, the adversary can only act as a relay, can impersonate the supplicant, forging the Association
which causes no more damage than eavesdropping. Request frame in a similar way. As a result, the supplicant
However, if the mutual authentication mechanism is not and the authenticator will establish a Pre-RSNAconnection, even though both of them could support configuration. The authenticator could limit Pre-RSNA
RSNA algorithms. Since there is no cipher suite connections to only insensitive data. While this policy
verification in Pre-RSNA, the supplicant and the might cause some inconvenience, it may be worth the
authenticator will not be able to detect the forgery and security it provides. It is absolutely unreliable to allow the
confirm the cipher suites. Even worse, the adversary is devices to choose a security level transparently, because
able to disclose the default keys by exploiting the the authenticator and supplicant have no knowledge of the
weakness of WEP, which then completely undermines the authenticity of Stages 1 and 2.
security. This attack is practically feasible because the
adversary could either perform as a MitM or forge the 4.4 Reflection Attack
beginning management frames in a timely way, that is,
Beacon or Probe Response frame to the supplicant and In Stage 4, the 4-Way Handshake uses symmetric
Association Request frame to the authenticator. cryptography to protect the integrity of the messages.
Since the authenticator and the supplicant both know the
shared PMK, they are the only two parties that are able to
calculate correct MICs and compose valid messages. This
Supplicant Authenticator
fact supports authentication. However, if a device is
RSNA enabled RSNA enabled
Pre-RSNA Pre-RSNA implemented to play the role of both the authenticator and
enabled enabled the supplicant under the same PMK, an adversary can
launch a common reflection attack to this device, as
Bogus Beacon (Pre-RSNA only)
shown in Figure 3. When the device initializes a 4-Way
Beacon + AA RSN IE Handshake as an authenticator, the adversary will
Probe Request initialize another 4-Way Handshake, with the same
parameters but with the victim device acting as the
Bogus Probe Response (Pre-RSNA only)
intended supplicant. Once the victim device is fooled to
compute messages as a supplicant, the adversary could
Probe Response + AA RSN IE
use these messages as valid responses to the 4-Way
802.11 Authentication Request Handshake initialized by the victim.
802.11 Authentication Response
Bogus Association Request (Pre-RSNA only)
Adversary Legitimate
Association Request + SPA RSN IE Impersonates Devices
Communicating Authenticator and
802.11 Association Response Peers Supplicant
Pre-RSNA Connections {A1, Nonce1, sn, msg1}
{A2, Nonce1, sn, msg1}
Figure 2. Security Level Rollback Attack
{A1, Nonce2, RSN IE, sn, msg2, MIC}
{A2, Nonce2, RSN IE, sn, msg2, MIC}
The solution is not complicated. In the simplest {A1, Nonce1, RSN IE, GTK, sn+1, msg3, MIC}
approach, both the authenticator and the supplicant could
{A2, Nonce1, RSN IE, GTK, sn+1, msg3, MIC}
allow only RSNA connections. However, this is only
acceptable when security is a strict requirement for the {A1, sn+1, msg4, MIC}
whole system. In most scenarios, TSN might be a better {SPA, sn+1, msg4, MIC}
choice to provide services to more supplicants. Therefore,
the supplicant and the authenticator could allow both Pre-
Bogus Authentication Peers Authenticated
RSNA and RSNA connections, but deploy appropriate
policies on the choice of the security level. Specifically,
Figure 3. Reflection Attack on the 4-Way Handshake
the supplicant should decide whether it wants a more
confidential connection (using RSNA), or it wants more
availability of Internet access (using Pre-RSNA). In any
Naturally this scenario will not appear in an
event, the supplicant should have a chance to deny the
infrastructure network, because a legitimate device will
Pre-RSNA algorithms, prior to initiating a connection,
never implement the role of both the authenticator and the
either manually or through some form of policysupplicant. However, in ad hoc networks, a possible use management frame attacks, the most efficient attack is to
of 802.11i could allow each device to serve both roles to forge and repeatedly send Deauthentication or
distribute their own GTKs. This makes a reflection attack Disassociation frames. In control frames, the most severe
possible. Some might argue that this is not a real problem lies in the virtual carrier-sense mechanism like
vulnerability because the adversary could not decrypt the RTS frame [8, 12]. Unfortunately, these attacks persist
following data packets without the appropriate key even if 802.11i is used to protect the WLAN. It might be
materials (like in Session Hijacking of Threat 5). possible to adopt a Central Manager to handle these
However, it is still valuable to point out the problem frames specifically and identify the forged frames by their
because the attack violates mutual authentication; abnormal behavior [14]. However, this requires extra
moreover, sometimes the adversary can store the functionality in the authentication server, and the server
encrypted data for further analysis. In order to eliminate needs to keep the state of all supplicants. This increases
this, the implementer should either limit a device to only the workload of the server and might be infeasible.
one role, or require separate roles to have different PMKs. Another approach is to respond to Deauthentication and
Disassociation frames by restarting a 4-Way Handshake,
with the result of the 4-Way Handshake indicating
5 Availability whether these frames are forged [29]. This method could
restrict the impact of forged Disassociation and
IEEE 802.11i appears not to emphasize availability as Deauthentication to the 802.11 MAC. However, this does
a primary objective, leaving many DoS vulnerabilities not prevent the attack because periodically forcing a 4-
even if the strongest data confidentiality and Way Handshake could be an effective DoS attack. Based
authentication protocols are used. Prior research has on these considerations, authenticating management
found numerous DoS attacks on a WLAN from the frames appears to be a better approach. This is also
Physical Layer to the Application Layer [4, 7, 8, 12, 17, described in Section 5.6 as an improvement to 802.11i.
24, 32, 42] (See Appendix). Compared to DoS attacks in On the other hand, authenticating control frames might be
the Physical Layer, DoS vulnerabilities in 802.11i appear inefficient and add too much overhead because the control
to be more severe for several reasons. First, an adversary frames could appear frequently; it might be better to
can launch an 802.11i attack much more easily than a handle forged control frames by checking the validity of
physical layer attack, with only moderate equipment. the virtual carrier-sense according to the knowledge of the
Second, it is much more difficult for a network specific frames.
administrator to detect and locate these attacks. There are several DoS attacks that exploit the
Furthermore, layer abstraction is a very important concept unprotected EAP messages in 802.1X authentication.
in networks, requiring each layer to provide independent Specifically, an adversary can forge EAPOL-Start
functionality separately. Therefore, it is appropriate for messages repeatedly to prevent the 802.1X authentication
802.11i to resist DoS attacks. Moreover, a more robust from succeeding, forge EAPOL-Success message to
802.11i could help migration to other Physical Layer maliciously bring up the 802.1X data port in the
specifications in the future, which might be secure against supplicant without authentication, and forge EAPOL-
DoS attacks. Therefore, it is valuable to strengthen Failure message and EAPOL-Logoff message to
802.11i against DoS vulnerabilities. disconnect the supplicant. Fortunately, these
Section 5.1 reviews known DoS attacks, analyzes their vulnerabilities can be eliminated in 802.11i by simply
effects on 802.11i, and proposes corresponding defenses. ignoring these messages. This does not affect the
Section 5.2 discusses the practicality of the DoS attack on functionality and logic of the protocol. The outcome of
the Michael algorithm countermeasure in TKIP. Section the subsequent 4-Way Handshake could take the role of
5.3 describes the RSN IE Poisoning attack and proposes a EAPOL-Success and EAPOL-Failure to indicate the
feasible repair with minor modifications to the algorithm. authentication result; EAPOL-Logoff could be replaced
Section 5.4 explains a DoS attack on Message 1 of the 4- by Deauthentication to disconnect a client; and EAPOL-
Way Handshake. Section 5.5 explores the efficiency of Start is not necessary for the protocol.
different failure-recovery strategies. Section 5.6 proposes An adversary can also launch a DoS attack on the AP
an improved version of 802.11i to address all of these by flooding forged Association Request frames. This will
vulnerabilities. exhaust the EAP Identifier space, which is only 8 bits
long (0-255). This vulnerability can be addressed by
5.1 Known DoS Attacks and Defenses careful consideration during implementation. Since an
EAP Identifier is only required to be unique within a
single 802.11 association, it is not necessary for the AP to
Since the management frames and control frames are
deny new connection requests when the EAP Identifier
unprotected in a WLAN, an adversary can easily forge
these frames to launch a DoS attack. Among thespace has been exhausted. Particularly, the AP can adopt protocol checks the FCS (Frame Check Sequence), ICV
a separate EAP Identifier counter for each association. (Integrity Check Value), TSC (TKIP Sequence Counter)
and MIC sequentially. A MIC failure is only logged when
5.2 Michael Algorithm Countermeasure the frame has been received with correct FCS, ICV, TSC
but an invalid MIC. Checking FCS and ICV can detect
In addition to these known DoS attacks, the packet errors caused by noise, while checking TSC can
countermeasure associated with the Michael algorithm detect replayed packets. Moreover, if the adversary
(discussed in the 802.11i standard) is also vulnerable to modifies the TSC, the per-packet key will be modified
DoS attacks. As a data confidentiality protocol, TKIP simultaneously, which causes packet decryption to fail
adopts the Michael algorithm to provide MIC protection before a log of MIC failure. Hence, checking FCS, ICV,
for every MSDU (MAC Service Data Unit). The TKIP TSC and MIC in a strict order could make DoS attacks
MPDU (MAC Protocol Data Unit) format is shown in more difficult. However, an adversary is still able to
Figure 4. The Michael algorithm is designed to provide launch such an attack through interception. Furthermore,
only 20 bits (or possible slightly more) of security due to the inappropriate TSC update strategy might make this
the limited computation power in legacy devices. This attack more convenient.
means it is possible for an adversary to construct a In Threat 3, an adversary is able to intercept a message
successful forgery after 219 attempts. Therefore, TKIP before the receiver hears it. Through this approach, the
adversary can obtain a packet with a valid TSC value.
implements the following countermeasures to limit the
Keeping the TSC field unchanged, the adversary is
rate of the forgery attempts from an adversary. The first
capable of modifying some bits of the packet and
Michael MIC failure is logged as a security-relevant
updating the corresponding FCS and ICV fields to make
matter. Once two failures are detected within 60 seconds,
them consistent, due to weakness in the ICV algorithm.
the transmission and reception will cease for 60 seconds.
Then the adversary has obtained the desired packet
Furthermore, the authenticator could re-key or
because the packet can pass the check for FCS, ICV, and
deauthenticate the supplicant; the supplicant should send
TSC, but with an invalid MIC. By sending out this packet,
out a Michael MIC Failure Report frame and
the adversary could force a Michael MIC failure in the
deauthenticate itself afterwards.
receiver side, and eventually launch a DoS attack. Even
worse, since 802.11i suggests updating the TSC until an
MSDU passes the Michael MIC check, if the receiver
M IV Ext. IV Data MIC ICV FCS implementation resumes communication after 60 seconds
A KeyID 4 octs (MSDU) 8 octs 4 octs 4 octs
without re-keying, the adversary can simply forward one
C 1 oct >= 1 oct
modified message repeatedly because the TSC is still
valid after the first failure. On the other hand, if the
Contains
Encrypted
TSC receiver re-keys the system or deauthenticates, the
adversary will have enough time to construct the next
Figure 4. TKIP MPDU Format modified packet and block the communication. Of course
this is not that easy because Threat 3 requires
considerable work from the adversary. However, it is
quite practical because the time required for re-keying and
As shown in the following calculation, the
re-authentication is sufficient for an adversary to
countermeasure ensures that a successful forgery could
construct the packet.
occur only every half year, which makes the forgery
This attack can be mitigated by careful consideration
practically useless. In an 802.11b network, an adversary
in the implementation. First, re-keying and
could send out approximately 212 messages per second. deauthentication are not necessary when availability is an
Therefore, the adversary is able to make a successful objective. The authenticator and the supplicant should just
forgery in about 2 minutes (approximately 27 seconds) cease for 60 seconds, and then resume communication.
without implementing the countermeasure. However, if Second, the TSC should be updated once a packet passes
countermeasures are deployed to limit the rate, for the check of FCS, ICV, and TSC, even if the Michael
example, 2 forgery attempts per minute, the attacker is MIC failure occurs. Note that in this case the
limited to make one successful forgery every 6 months retransmitted packets must use a fresh TSC. These
(approximately 218 minutes). Unfortunately, the modifications will make the DoS attack more difficult;
countermeasure leaves an obvious DoS vulnerability: an however, they do not eliminate the vulnerability.
adversary can send out unsuccessful forgery attempts to Fortunately, this attack disappears with TKIP when
cause two Michael MIC failures and shutdown a CCMP is implemented for data confidentiality.
connection. In order to prevent this DoS attack, the5.3 RSN IE Poisoning In Message 2 of the 4-Way Handshake, the
authenticator verifies the MIC before the RSN IE, which
Another possible category of DoS attacks on 802.11i is the correct order; but in Message 3, the supplicant
involves the RSN IE (RSN Information Element) checks the RSN IE before the MIC verification, and
verification mechanism. As shown in Figure 5, RSN IE aborts if the RSN IE is unmatched. Consequently, an
contains authentication and pairwise key cipher suite adversary can easily modify the RSN IE in Message 3 to
selectors, a single group key cipher suite selector, an RSN cause the handshake to fail. This vulnerability could
Capabilities field, the PMKID (Pairwise Master Key almost be considered a typo in the 802.11i documentation.
Identifier) count, and the PMKID list. The authenticator However, even if the check order is correct, there is
should insert the supported RSN IEs in the Beacon and another fundamental attack to cause the RSN IE
Probe Response and the supplicant should insert its confirmation process to fail, which is shown in Figure 6.
chosen RSN IE in the (Re)Association Request. The
authenticator and the supplicant use the negotiated
security suites to perform the authentication and key Supplicant Authenticator
Unauthenticated Unauthenticated
management protocol, and use the negotiated cipher suites
Unassociated Unassociated
to encrypt data communications. In order to confirm the 802.1X Blocked 802.1X Blocked
authenticity of the RSN IEs, the supplicant is required to
(1) Beacon + AA RSN IE
include the same RSN IE in Message 2 of the 4-Way
Handshake as in (Re)Association Request. The Bogus Beacon + Modified RSN
authenticator is also required to include the same RSN IE IE
in Message 3 of the 4-Way Handshake as in the Beacon (2) Probe Request
or Probe Response. After receiving a Message 2, the
(3) Probe Response + AA RSN IE
authenticator will bit-wise compare the RSN IE in the
message with the one it receives in the (Re)Association Bogus Probe Response + Modified RSN IE
Request from the supplicant, in order to confirm that they
are exactly the same. The supplicant will bit-wise
Legitimate Message Exchanges
compare the RSN IE in Message 3 with the one it receives
in Beacon or Probe Response. If the RSN IEs are not
exactly the same, the supplicant and the authenticator will (18) {AA, ANonce, AA RSN IE, GTK, sn+1, msg3, MIC}
deauthenticate each other and a security error should be
logged. This confirmation process prevents an adversary
from tricking the supplicant and the authenticator into RSN IE confirmation Disassociate the
failed, Disassociation Supplicant
using a weaker security scheme by forging the RSN IE
negotiations. However, as a result, it is vulnerable to DoS
attacks. Figure 6. RSN IE Poisoning
Element ID (1 octet) Length (1 octet) An adversary can easily eavesdrop on the Beacon
frames of a legitimate authenticator, modify several bits
Version (2 octets)
in the frame that are “insignificant”, where “insignificant”
Group Key Cipher Suite (4 octets) means that, the modification of these bits will not effect
the validity of the frame and the selection of the
Pairwise Key Cipher Suite Count (2 octets)
authentication cipher suites. For example, the Reserved
Pairwise Key Cipher Suite List (4m octets) bits and the Replay Counter bits in the RSN Capabilities
field are “insignificant”. The adversary then broadcasts
Authentication and Key Management Suite Count (2 octets)
this forged Beacon to poison the knowledge of RSN IEs
Authentication and Key Management Suite List (4n octets) in the supplicants. Because this forged Beacon only
modifies “insignificant” bits, the supplicant and the
RSN Capabilities (2 octets)
authenticator are still able to continue the authentication
PMKID Count (2 octets) and key management using the effective security suites.
However, the 4-Way Handshake will never succeed
PMKID List (16s octets)
because the RSN IE confirmation will fail. Accordingly,
when the supplicant uses an active scan instead of a
Figure 5. RSN Information Element Format passive one, the adversary can forge a Probe Responsewith the modified RSN IE, which requires the adversary able to securely negotiate the encryption cipher suites
to interfere with the handshake in a more timely way. The after they finish the authentication and share some secret.
adversary can also forge a (Re)Association Request with If an adversary does not change the authentication and
modified RSN IE to poison the knowledge of the key management suite selector, the RSN IE could be
authenticator, but this approach is less efficient. accepted because the correct authentication has been
Based on analysis above, an adversary can always executed. Afterwards, the authenticator and the supplicant
launch a DoS attack by RSN IE poisoning. This attack is can use the authenticated RSN IE in the 4-Way
different from the Security Level Rollback Attack, Handshake for the subsequent data encryptions. On the
because the adversary does not aim to establish a other hand, if the adversary modifies the authentication
successful connection; it simply blocks the protocol and key management suite selector, this can be detected at
execution. This attack is considered to be harmful because the beginning of the association. The association fails and
it is quite easy for an adversary to implement and it will the supplicant retries quickly without continuing message
affect all the supplicants simultaneously when the forged exchanges. In the worst case, this modification can be
Beacon is allowed. Furthermore, because the supplicant prevented in the 4-Way Handshake.
and the authenticator are unaware of the RSN IE
poisoning, they might continue to exchange considerable 5.4 4-Way Handshake Blocking
number of messages, e.g., messages (2) to (18) in Figure 1,
until the 4-Way Handshake fails. In other words, the The 4-Way Handshake is an essential component of
legitimate entities do substantial work, while the the RSNA establishment. Its purpose is to confirm the
adversary is able to successfully interfere with little work. possession of the shared PMK (Pairwise Master Key) in
This wastes the resources of the authenticator and the the authenticator and the supplicant, and derive a fresh
supplicant; moreover, the adversary will have more time PTK (Pairwise Transient Key) for subsequent data
to periodically repeat its attacks. communication. In the handshake, the authenticator and
This weakness is exploitable for three reasons. First, the supplicant generate their own nonces and send them to
the management frames like Beacon, Probe Response, each other. The PTK is derived from the shared PMK, the
and (Re)Association Request are not protected. Second, nonces, and the MAC address of the peers. Message 1 and
there are a number of message exchanges between the 3 carry the nonce generated by the authenticator; Message
RSN IE negotiation and confirmation, which consume 2 carries the nonce generated by the supplicant, and
resources and leave more time for the adversary. Third, Message 4 is an acknowledgment to indicate the
the bit-wise comparison in the 4-Way Handshake might handshake is successfully completed. While Message 2, 3,
be unnecessarily strict to confirm RSN IE. The and 4 are authenticated by the fresh PTK, Message 1 is
vulnerability may be addressed accordingly. unprotected. In order to prevent an adversary from
Authenticating the management frames is a good affecting the PTK through forging Message 1, 802.11i
approach. However, in some scenarios it might not be adopts a Temporary PTK (TPTK) to store the newly
considered acceptable to authenticate the Beacon and generated PTK until Message 3 is verified. However, this
Probe Response frames because the authenticator and the approach does not prevent DoS attacks on Message 1.
supplicant share no secret at the beginning. Therefore, an The supplicant must accept all Message 1s it receives
acceptable approach is to do the RSN IE confirmation as in order to ensure that the handshake can complete in case
soon as possible to avoid wasting message exchanges and of packet loss and retransmission. This allows an
make the attack less disruptive. Considering that the adversary to cause PTK inconsistency between the
authentication server may know the security parameters supplicant and the authenticator by sending a forged
that the authenticator supports, it can help to confirm the Message 1 with a different nonce value between the
RSN IE much earlier, such as in the 802.1X legitimate Message 1 and Message 3. In order to
authentication. However, this would require an EAP accommodate the forged Message 1s, the supplicant has
method supporting cipher suite negotiations (e.g., EAP- to store all the responding nonces and the derived PTKs.
TLS), and considerable modifications to the existing Only after a Message 3 with a valid MIC is received, the
standard might be necessary. supplicant can install the corresponding correct PTK for
Alternatively, this attack can be mitigated by loosening data communications and discard all others. Obviously,
the condition of the RSN IE confirmation. In other words, an adversary is able to launch a memory DoS attack by
the authenticator and the supplicant can ignore the sending out numerous forged Message 1s, as shown in
differences of the “insignificant” bits in the corresponding Figure 7. This attack is serious because it is simple for the
RSN IEs, while keeping the negotiation secure. Actually adversary to perform, and a successful attack will cancel
in a RSN IE, only the authentication and key management all efforts in the previous authentication process.
suite selector is essential for the subsequent handshakes, There are several approaches to address this
because the authenticator and the supplicant are always vulnerability. First, the supplicant can implement a queuewith a random-drop policy. This method helps to mitigate 5.5 Failure Recovery
the vulnerability, but does not eliminate it. Second,
Message 1 can be authenticated to defend against this The 802.11i design decisions appear to emphasize
attack, because the authenticator and the supplicant have other security objectives over availability. Once security-
already finished the authentication and shared some secret. related events or timeouts occur, the specification always
However, this requires some modifications to the message suggests Deauthentication or Disassociation. This
format; moreover, the authenticator needs to include a mechanism reduces information leakage and prevents
monotonically increasing sequence number in each further attacks, but it also increases the possibility of
Message 1 in order to prevent replays. Third, the potential DoS attacks. Therefore, different failure
supplicant can inherently eliminate this attack by re-using recovery schemes should be specified when DoS attacks
the same nonce for all received Message 1s until a 4-Way are considered significant. A better failure recovery does
Handshake completes successfully. The supplicant only not inherently prevent the DoS attacks; however, it will
stores one nonce, calculates a PTK based on this stored make the protocol more efficient, and cause more
nonce and the nonce in the received message, then verify difficulties for an adversary trying to launch an attack. For
the MIC. This approach only requires minor example, in the Group Key Handshake, a timeout will
modifications on the algorithm in the supplicant side; the cause the authenticator to disassociate or deauthenticate
supplicant need store no more than one nonce, eliminating the supplicant. The supplicant then reassociates with the
the possible memory exhaustion. However, the supplicant same AP or scans the channels for another AP, which is
will consume more computation power because it needs quite time consuming. Moreover, since the authenticator
to calculate the same PTK twice for the received Message can only install the GTK after all the supplicants have
1 and 3, given that the received nonces and derived PTKs done so, the reassociation delay of one supplicant will
are not stored. The supplicant has to make a decision on affect all others. Alternatively, if the supplicant and the
the tradeoff between the memory and the CPU authenticator just retry the Group Key Handshake or the
consumption. As a combined solution, the supplicant can 4-Way Handshake, they could resume the connection
re-use the same nonce for all Message 1s to eliminate the more quickly. On the other hand, if the Group Key
memory DoS vulnerability, and store one entry of the Handshake timeout is due to the unavailability of the
derived PTK to improve the performance. A more supplicant, e.g., the supplicant moving out of the range of
detailed discussion appears in our previous paper [19]. the authenticator, retrying the Group Key Handshake or
the 4-Way Handshake wastes more time compared to
directly disassociating from the current AP and
reassociating with another AP. This is a tradeoff the
protocol implementer must make according to the
Supplicant Authenticator
networking environment.
Auth/Assoc Auth/Assoc
This tradeoff could be generalized to any trust
802.1X Blocked 802.1X Blocked
PMK PMK relationship discovery process in a malicious environment.
Assuming a protocol instance is running between a pair of
{AA, ANonce, sn, msg1}
stations; at some point the instance fails due to some
active attacks. If the protocol restarts from the beginning,
PTK Derived this protocol will be vulnerable to a so-called “defensive
DoS attack”. That means, if an adversary has the
{SPA, SNonce, SPA RSN IE, sn, msg2, MIC}
capability of causing the protocol to fail at some point, it
{AA, Anonce[1], sn, msg1} can launch a DoS attack by periodically doing that. Since
each time the legitimate peers need to waste some
message exchanges to recover, the adversary will have
PTK Derived
{AA, Anonce[n], sn, msg1} Random GTK more time to construct the attack. On the other hand, if
the protocol recovers from the nearest point, the adversary
{AA, ANonce, AA RSN IE, GTK, sn+1, msg3, MIC} might not have sufficient time to construct the “defensive
DoS attack”; however, the protocol could be vulnerable to
another type of DoS attack, so-called “captured DoS
Inconsistent PTK Inconsistent PTK
Protocol Blocked Protocol Blocked attack”. That means, if the adversary has the capability of
propelling the protocol to some point with a legitimate
user, it is possible for the adversary to capture the user for
Figure 7. 4-Way Handshake Blocking
more time before the user could find a legitimate peer.
Hence, the selection of the recovery point depends on theassumptions of the networking scenario and the capability subsequent management frames, especially the
of the adversary. (Re)Association Request/Response frame. Through this
Specifically, in 802.11i it might be reasonable to approach the vulnerabilities of most of the management
assume that it is difficult to forge an 802.1X frames are eliminated, except the Beacon and Probe
authentication. Therefore, once the handshakes between Request/Response frames, which cannot be authenticated
the supplicant and the authenticator have proceeded because the common secret is unavailable. Of course, key
beyond the 802.1X authentication, the recovery point asynchrony and state abnormality should be carefully
could be chosen to the nearest point to improve the considered to avoid blocking the protocols.
efficiency of the protocols, because both entities (4) An appropriate failure-recovery scheme is
involving in the communications should be legitimate. On implemented to improve the efficiency of the overall
the other hand, if a supplicant and an authenticator do not protocol. In the infrastructure networks with low mobility,
finish an 802.1X authentication, it might be better to assuming the 802.1X provides strong authentication, the
restart the protocol from the beginning. Of course, in a protocol will recover from the nearest point if 802.1X has
high mobility environment, a failure might occur more been completed successfully, while the protocol will
frequently because one entity is unavailable; thus, retrying recover from the beginning if an 802.1X has not yet
the nearest point might waste more time. However, since finished.
the channel scanning time is significantly larger than the
protocol execution time, retrying the nearest point will not
increase the delay too much compared to the total
Stage 1: Network and Security
recovery delay.
Capability Discovery
5.6 Improved 802.11i
Based on the above analysis, we propose an improved
Stage 2: 802.1X authentication
version of 802.11i to make more DoS resistant. Note that
(mutual authentication, shared
due to the physical vulnerability of wireless links, DoS
secret, cipher suite)
attacks always exist through frequency jamming, network
jamming, or other exploits. However, we improve the 802.1X Failure
802.11i protocol to achieve DoS resistance in the Link
Layer. A flow chart of the improved 802.11i is shown in
Stage 3: Secure Association
Figure 8.
(management frames protected)
(1) In order to eliminate the DoS attacks by
Association Request flooding, it is better to perform Association Failure
authentication before association; this idea is originally
developed in [16]. Specifically, in 802.11i, it is possible
Stage 4: 4-Way Handshake
to replace the 802.11 entity authentication with 802.1X
(PMK confirmation, PTK
authentication; a secure association can occur after the
derivation, and GTK distribution)
802.1X authentication. This improvement might require
necessary modifications to the existing 802.1X
4-Way Handshake Timout
implementations; however, the advantages appear worth it.
(2) The authentication and key management suite
negotiation should be verified as soon as possible. Stage 5: Group Key Handshake
Otherwise, the subsequent handshakes might waste time
because the negotiated security suites could be forged by Group Key Handshake Timout
an adversary. Specifically, when an 802.1X authentication
is adopted, the peers can verify their security parameters
Stage 6: Secure Data
during the 802.1X authentication; when a PSK or a
Communications
cached PMK is used, the peers can verify the information
through a secure (Re)Association. Michael MIC Failure or Other
Security Failures
(3) The management frames should be authenticated to
improve security, and some control frames can also be
authenticated if necessary. Authenticating these frames Figure 8. A Flow Chart of the Improved 802.11i
should be performed as soon as possible. Once an The original Stage 2 and 3 in Figure 1 are switched here;
authentication process is completed successfully, the Possible recovery points for failures at different stages are
derived common secret could be used to authenticate the indicated by arrows; Dashed lines indicate Stage 5 is optional.Through these improvements, the 802.11i failure recovery for 802.11i is proposed, based on the
vulnerabilities discussed in this paper could be eliminated. characteristics of wireless networks. Finally, we integrate
Note that while the improvements result in DoS all the improvements to construct a DoS resistant variant
robustness, they may require more modifications to the of the 802.11i protocols.
existing implementations.
Acknowledgments
6 Conclusion
We thank Jesse Walker for his informative comments
This paper analyzes the IEEE 802.11i protocols for on the 802.11i protocols.
data confidentiality, integrity, mutual authentication, and
availability. Under the threats we consider, 802.11i
appears to provide effective data confidentiality and References
integrity when CCMP is used. This requires a legacy
WEP user to upgrade the hardware. Furthermore, 802.11i [1] B. Aboba, and A. Palekar. IEEE 802.1X and RADIUS
adopts a RSNA establishment procedure for mutual security. Submissions to IEEE 802.11 TGi, November, 2001.
authentication and key management, which appears to be
satisfactorily secure. However, several vulnerabilities [2] B. Aboba, and D. Simon. PPP EAP TLS authentication
protocol. RFC 2716, October, 1999.
might arise in a real implementation. If the mutual
authentication mechanism is not implemented
[3] B. Aboba. Pros and Cons of upper layer network access.
appropriately, there might be a Man-in-the-Middle attack
IEEE documents 802.11-00/382, November, 2000.
that reveals the shared secret. If a passphrase is used to
generate a 256-bit PSK, an adversary might be able to [4] W. A. Arbaugh, N. Shankar, and J. Wang. Your 802.11
find the passphrase through dictionary attacks. An Network has no Clothes. In Proceedings of the First IEEE
adversary is also able to discover the shared RADIUS International Conference on Wireless LANs and Home
secret through dictionary attacks. Furthermore, if Pre- Networks, pages 131-144, December, 2001.
RSNA and RSNA algorithms are implemented in a
[5] W. A. Arbaugh. An inductive Chosen Plaintext Attack
system simultaneously without careful considerations, an
against WEP/WEP2. Presentations to IEEE 802.11 TGi, May,
adversary is able to perform a Security Level Rollback
2001.
Attack to force the communicating peers to use WEP,
which is completely insecure. Moreover, if a wireless
[6] N. Asokan, V. Niemi, and K. Nyberg. Man-in-the-Middle in
device is implemented to play the role of both the tunneled authentication protocols. Technical Report
authenticator and the supplicant, an adversary can 2002/163, IACR ePrint archive, October, 2002.
construct a reflection attack on the 4-Way Handshake. http://eprint.iacr.org/2002/163/.
This scenario naturally appears in ad hoc networks.
Availability is another important security property in [7] AusCERT AA-2004.02. Denial of Service vulnerability in
IEEE 802.11 wireless devices. May 13, 2004.
wireless networks. Since availability is not the primary
http://www.auscert.org.au/render.html?it=4091.
design goal, 802.11i appears vulnerable to DoS attacks
even if RSNA is implemented. We review the known DoS
[8] J. Bellardo, and S. Savage. 802.11 Denial-of-Service attacks:
attacks and propose solutions appropriate to 802.11i. It
real vulnerabilities and practical solutions. In Proceedings of
appears that a better way to eliminate management frame the USENIX Security Symposium, pages 15-28, August, 2003.
vulnerabilities is to authenticate them. Furthermore, we
find and analyze some new DoS attacks arising with [9] L. Blunk, J. Vollbrecht, B. Aboba, J. Carlson, and H.
802.11i. First, we analyze the practicality of the DoS Levkowetz. Extensible Authentication Protocol (EAP).
attack on the Michael algorithm countermeasures. Here, Internet Draft draft-ietf-eap-rfc2284bis-06.txt, September 29,
2003.
eliminating re-keying and updating the TSC carefully
appear to provide significant improvements. Second, we
[10] N. Borisov, I. Goldberg, and D. Wagner. Intercepting
describe a new DoS attack through RSN IE poisoning.
mobile communications: the insecurity of 802.11. In
Several repairs are discussed. Relaxing the condition for
Proceedings of the 7th Annual International Conference on
RSN IE verification seems the preferred approach Mobile Computing and Networking, Rome, Italy, July, 2001.
because it only requires minor modifications to the
algorithm. Third, a DoS attack on the unprotected [11] N. Cam-Winget, R. Housley, D. Wagner, and J. Walker.
Message 1 of the 4-Way Handshake is described and the Security flaws in 802.11 data link protocols. SPECIAL
corresponding defenses are proposed. Fourth, tradeoffs in ISSUE: Wireless networking security, Communications of
the ACM, Volume 46, Issue 5, pages 35-39, May, 2003.
the failure-recovery strategy are discussed and an efficient[12] D. Chen, J. Deng, and P. K. Varshney. Protecting wireless [23] J. Jonsson. On the Security of CTR + CBC-MAC. Lecture
networks against a Denial of Service attack based on virtual Notes In Computer Science, Revised Paper from the 9th
jamming. In Poster Session of MobiCom2003, San Diego, Annual International Workshop on Selected Areas in
CA, September, 2003. Cryptography, pages 76-93, 2002.
[13] Cisco Systems. Cisco Aironet Response to University of [24] P. Kyasanur and N. H. Vaidya. Detection and handling of
Maryland’s Paper, “An Initial Security Analysis of the IEEE MAC layer misbehavior in wireless networks. In
802.1X Standard”. August 22, 2002. Proceedings of the International Conference on Dependable
http://www.cisco.com/warp/public/cc/pd/witc/ao350ap/prodli Systems and Networks (DSN'03), San Francisco, CA, June,
t/1680_pp.htm. 2003.
[14] P. Ding, J. Holliday, and A. Celik. Improving the security [25] M. Lynn and R. Baird. Advanced 802.11 attack. Black Hat
of Wireless LANs by managing 802.1X Disassociation. In Briefings, Las Vegas, NV, July, 2002.
Proceedings of the IEEE Consumer Communications and
Networking Conference (CCNC'04), Las Vegas, NV, January, [26] T. Marshall. Antennas enhance WLAN security. October,
2004. 2001.
http://www.trevormarshall.com/byte_articles/byte1.htm.
[15] J. Duntemann. Wardriving FAQ. April 26, 2003.
http://faq.wardrive.net/. [27] A. Mishra and W. A. Arbaugh. An initial security analysis
of the IEEE 802.1X standard. Technical Report CS-TR-4328,
[16] D. B. Faria and D. R. Cheriton. DoS and authentication in UMIACS-TR-2002-10, University of Maryland, February,
wireless public access networks. In Proceedings of the First 2002.
ACM Workshop on Wireless Security (WiSe'02), Atlanta,
Georgia, USA, September, 2002. [28] V. Moen, H. Raddum, and K. J. Hole. Weakness in the
Temporal Key Hash of WPA. ACM SIGMOBILE Mobile
[17] B. Fleck and J. Dimov. Wireless access points and ARP Computing and Communications Review, Volume 8, Issue 2,
poisoning: wireless vulnerabilities that expose the wired pages 76-83, April, 2004.
network. White paper by Cigital Inc. in 2001.
http://www.cigitallabs.com/resources/papers/download/arppo [29] T. Moore. Validating 802.11 Disassociation and
ison.pdf. Deauthentication messages. Submission to IEEE P802.11
TGi, September, 2002.
[18] S. Fluhrer, I. Mantin, and A. Shamir. Weaknesses in the
key scheduling algorithm of RC4. Lecture Notes In [30] R. Moskowitz. Weakness in Passphrase Choice in WPA
Computer Science, Revised Paper from the 8th Annual Interface. November, 2003.
International Workshop on Selected Areas in Cryptography, http://wifinetnews.com/archives/002452.html.
pages 1-24, 2001.
[31] National Institute of Standards and Technology. FIPS Pub
[19] C. He and J. C. Mitchell. Analysis of the 802.11i 4-Way 197: Advanced Encryption Standard (AES). November 26,
Handshake. In Proceedings of the Third ACM International 2001.
Workshop on Wireless Security (WiSe'04), Philadelphia, PA,
October, 2004. [32] D. Neoh. GSEC Version 1.4b Option 1, Corporate Wireless
LAN: Know the risks and best practices to mitigate them.
[20] IEEE Standard 802.11-1999. Information technology – December, 2003. http://www.securitydocs.com/links/1153.
Telecommunications and information exchange between
systems – Local and metropolitan area networks – Specific [33] J. S. Park and D. Dicoi. WLAN security: current and future.
requirements – Part 11: Wireless LAN Medium Access IEEE Internet Computing, Volume 7, No. 5, pages 60-65.
Control and Physical Layer Specifications. 1999. September/October, 2003.
[21] IEEE P802.11i/D10.0. Medium Access Control (MAC) [34] C. Rigney, S. Willens, A. Rubens, and W. Simpson.
Security Enhancements, Amendment 6 to IEEE Standard for Remote Authentication Dial In User Service (RADIUS).
Information technology – Telecommunications and RFC 2865, June, 2000.
information exchange between systems – Local and
metropolitan area networks – Specific requirements – Part 11: [35] P. Rogaway and D. Wagner. A Critique of CCM.
Wireless Medium Access Control (MAC) and Physical Layer Unpublished manuscript. February 2, 2003.
(PHY) Specifications. April, 2004. http://www.cs.berkeley.edu/~daw/papers/ccm.html.
[22] IEEE Standard 802.1X-2001. IEEE Standard for Local and [36] A. Roy and H. Chang. Physical Layer security of WLANs.
metropolitan area networks – Port-Based Network Access http://csiannual.com/classes/f2.pdf.
Control. June, 2001.[37] B. Schneier. Applied Cryptography: Protocols, Algorithms, key has inherent weakness for generating the per-packet
and Source Code in C. Second Edition, John Wiley and Sons, RC4 key [18]; an adversary can discover the key by
New York, NY, USA, 1996. eavesdropping several million packets [39]. Moreover,
because ICV is a linear and unkeyed function of the
[38] P. Shipley. Open WLANs: the early result of Wardriving.
message [10], data integrity cannot be guaranteed; even
2001. http://www.dis.org/filez/openlans.pdf.
without any knowledge of the key stream, an adversary is
able to arbitrarily modify a packet without detection, or
[39] A. Stubblefield, J. Ioannidis, and A. Rubin. Using the
Fluhrer, Mantin, and Shamir attack to break WEP. In forge a packet with a valid ICV. This weak integrity also
Proceedings of the 2002 Network and Distributed Systems enables much easier plaintext recovery, for example, IP
Symposium, San Diego, CA, February, 2002. redirection, reaction attacks [10], and inductive chosen
plaintext attack [5]. Finally, an adversary can trivially
[40] J. R. Walker. Unsafe at any key size; An analysis of the spoof the Shared Key Authentication [4, 10] through
WEP encapsulation. IEEE Document 802.11-00/362,
observing an authentication process of a legitimate station.
October, 2000.
Additionally, WEP does not implement any mechanism to
prevent replay attacks.
[41] D. Whiting, R. Housley, and N. Ferguson. Counter with
Although WEP fails to satisfy any security
CBC-MAC (CCM). RFC 3610, September, 2003.
requirements, it is not practical to anticipate users to
[42] C. Wullems, K. Tham, J. Smith, and M. Looi. Technical completely discard their devices with WEP already
Summary of Denial of Service Attack against IEEE 802.11 implemented. Hence, the Wi-Fi Alliance proposed an
DSSS based Wireless LAN's. interim solution, called Wi-Fi Protected Access (WPA),
http://www.isrc.qut.edu.au/wireless/. to ameliorate the vulnerabilities by reusing the legacy
hardware. WPA adopts a Temporal Key Integrity Protocol
(TKIP) for data confidentiality, which still uses RC4 for
data encryption, but includes a key mixing function and
Appendix. A Review of the Literature
an extended IV space to construct unrelated and fresh per-
packet keys. WPA also introduces Michael algorithm, a
weak keyed Message Integrity Code (MIC), for improved
1. Wireless Security Evolution data integrity under the limitation of the computation
power available in the devices. Furthermore, in order to
In order to provide data confidentiality equivalent to a detect replayed packets, WPA implements a packet
wired network, the IEEE 802.11 Standard [20] originally sequencing mechanism by binding a monotonically
defines Wired Equivalent Privacy (WEP). This increasing sequence number to each packet.
mechanism adopts RC4, a common stream cipher [37], to In addition, WPA provides two improved
encrypt messages with a shared key. This key is authentication mechanisms. In one mechanism, the
concatenated with a 24-bit Initialization Vector (IV) to possession of a Pre-Shared Key (PSK) authenticates the
construct a per-packet RC4 key. In order to provide data peers; furthermore, a 128-bit encryption key and another
integrity, WEP calculates an Integrity Check Value (ICV) distinct 64-bit MIC key can be derived from the PSK.
over the MSDU (MAC Service Data Unit), which is a Alternatively, IEEE 802.1X [22] and the Extensible
common Cyclic Redundancy Checksum (CRC). The Authentication Protocol (EAP) [9] can be adopted to
frame body, together with the corresponding ICV, is provide a stronger authentication for each association, and
encrypted using the per-packet key. In addition, two generate a fresh common secret as part of the
authentication mechanisms are defined: the Open System authentication process; all required keys can be derived
Authentication, which is actually a null authentication, from this shared secret afterwards.
and the Shared Key Authentication, which is a Challenge- TKIP is proposed to address all known vulnerabilities
Response handshake based on the shared key. in WEP; it does enhance the security in all aspects.
However, numerous researches have shown that none However, weakness is predestined since WPA appears
of the data confidentiality, integrity, and authentication due to the limitation of re-using the legacy hardware.
could be achieved through above mechanisms. First, the Although TKIP key mixing function has stronger security
40-bit shared key is too short for brute-force attacks [10, than WEP key scheduling algorithm, it is not so strong as
33]. Though some vendors might support a longer key expected. It is possible to find the MIC key given one per-
(104 bits), it is still possible for an adversary to recover packet key; furthermore, the whole security is broken for
the plaintext traffic because the small IV size and the the duration of a Temporal Key (TK) given two per-
static shared key result in a high possibility of key stream packet keys with the same IV32 [28]. This vulnerability
reuse [10, 40], which trivially defeats any stream cipher. does not mean that TKIP is insecure, but it discloses that
Furthermore, the concatenation of the IV and the shared parts of TKIP are weak on their own. Furthermore,Michael algorithm is designed to provide only 20 bits (or this requires significant modifications on the 802.11 PHY.
possible slightly more) of security in order to minimize In addition, some vendors have adopted different existing
the impact on the performance, which means an adversary protocols to secure network connections through the IP or
can construct one successful forgery every 219 packets. upper layer, such as IPsec and SSL. However, the
Thus, countermeasures are necessarily adopted to limit mechanisms in the upper layers might not be a good
the rate of the forgery attempts [21]. However, this solution for a WLAN, because the devices may need
countermeasure may allow DoS attacks. In addition, the partial network access prior to authentication; the
802.1X authentication may be vulnerable to Session complexity and cost of wireless devices may increase; the
Hijacking and Man-in-the-Middle (MitM) attacks [27]. performance may decrease; and typically such mechanism
Though these attacks disappear when mutual might be not extensible and ubiquitous [3]. Hence,
authentications and strong encryption are used [13], it 802.11i chooses to provide security in the Link Layer.
discloses some deficiencies of grabbing 802.1X, which is
originally designed for a switched LAN, to implement in
a shared media WLAN. 2. Availability and DoS Attacks
As a long-term solution, IEEE 802.11i [21] is
proposed to provide an enhanced MAC layer security. The past researches have extensively focused on the
Under the assumption of upgrading the hardware, 802.11i data confidentiality, integrity, and mutual authentication
defines a Counter-mode/CBC-MAC Protocol (CCMP) for wireless security. However, as another necessary
that provides strong confidentiality, integrity, and replay requirement, availability has not been considered
protection. In addition, an authentication process, sufficiently. Some might think that the DoS attacks seems
combining the 802.1X authentication and key to be inevitable due to the physical characteristics of
management procedures, is performed to mutually wireless links. However, since many DoS attacks can be
authenticate the devices and generate a fresh session key mounted by an adversary with moderate equipments, and
for data transmissions. Since 802.11i promises to be the a successful DoS attack may facilitate other advanced
right solution for wireless security, it should be able to attacks, such as Session Hijacking and Man-in-the-Middle
prevent an adversary from advanced attacks even if the (MitM), they should be considered to be real threats to a
adversary could have the most powerful equipments and WLAN implementation. Many DoS attacks have been
techniques for breaking into the system. In other words, disclosed on the WLAN systems from the Physical Layer
an implementation of 802.11i protocols in a WLAN to the Application Layer. The key point to mitigate these
should be able to provide sufficient data confidentiality, attacks is to impose relatively higher cost for an adversary,
integrity, and mutual authentication. e.g., more computation power, more message
Note that some vendors have adopted a MAC-address- transmissions, or more memory consumption, which
based Access Control List (ACL) for authorization. could make the DoS attacks impractical.
Specifically, only stations with their MAC addresses In the Physical Layer, a straightforward DoS attack is
existing in the ACL list are able to access the network. the frequency jamming; an adversary could interfere the
This method is considered to be useless since an whole frequency band with a strong noise signal, blocking
adversary can obtain valid MAC addresses easily by the legitimate data transmissions. This appears to be
sniffing the traffic [4]. Another mechanism, called Closed inevitable. Fortunately, it is relatively expensive because
System Authentication, is also proposed for access control, the adversary needs special equipments and huge power
by disabling the SSID broadcast in the Beacon. The SSID consumption to jamming the whole spectrum. Currently
is treated as a secret; only the user knowing the SSID can Spread Spectrum technology has been widely adopted in
join the network. However, this approach is worthless wireless networks, which makes the frequency jamming
because an adversary can obtain the SSID from the Probe much more difficult. Furthermore, an adversary
Request/Response frame or (Re)Association Request performing this attack can be easily detected and located
frame of a legitimate user [25]. In this paper, the by a network administrator. Therefore, it is reasonable to
requirements of authorization and access control are not assume that an adversary will not try to launch this attack
considered; instead, mutual authentication is required, for common purposes except military. There exists
from which flexible authorization and access control another easier approach to mount a frequency jamming by
policies could be implemented. exploiting the Clear Channel Assessment (CCA)
Furthermore, note that there are also many other procedure in a WLAN implementing Direct Sequence
approaches to secure a WLAN from other layers than Spread Spectrum (DSSS) [7, 42]. Particularly, most
MAC. From the Physical Layer, proper antenna selecting vendors do not remove the engineering function PLME-
and positioning can reduce the signal leakage, thus, DSSSTESTMODE from their released products, which
enhance the security [26]. It is also possible to implement makes the attack more convenient through the off-the-
a RF Firewall architecture to protect the WLAN [36], but shelf usage of a common wireless Network Interface Card(NIC). There are no complete solutions for this DoS As a summary, in the current WLAN system, DoS
attack yet. Fortunately, the attack appears to only affect a attacks are very easy to mount; furthermore, once an
WLAN system implementing DSSS (e.g., 802.11b/g), but adversary successfully mounts a DoS attack, more
not OFDM (Orthogonal Frequency Division Multiplexing, advanced attacks, such as MitM [25], could be
e.g., 802.11a/g). subsequently constructed. Therefore, it is necessary to
In the MAC layer, an adversary can scramble the deploy a security mechanism that can defend against DoS
channel by MAC preemptive jamming because the attacks. Since 802.11i does not emphasize such objective,
WLAN is designed to be cooperative. For example, the it is definitely valuable if it can be improved to mitigate
adversary can send out a short jamming noise in every the DoS attacks. Note that this paper focuses on DoS
time interval of SIFS (Short Inter-Frame Space, 10 µs in vulnerabilities in the Link Layer; Other possible DoS
802.11b networks), which will surely collide with all the attacks in PHY or upper layers are out of the scope of this
legitimate traffic, or cause the legitimate traffic to be paper.
deferred infinitely. However, this attack is not considered
to be a real threat because the adversary needs to send out
about 50000 packets per second in 802.11b networks [8].
As another possible attack, an adversary is able to
transmit legitimate messages, but not completely comply
to the standard. Specifically, the adversary could use a
smaller “backoff” time, in order to obtain an unfair
allocation of the channel bandwidth. If the adversary
adopts no “backoff”, he may ultimately cause a DoS
attack for legitimate users [24]. More DoS vulnerabilities
arise from the unprotected management frames and
control frames. An adversary is able to easily launch a
DoS attack on a specific station or the entire Basic
Service Set (BSS) by forging the Deauthentication,
Disassociation, Traffic Indication Map (TIM), or Poll
messages [8]. Furthermore, DoS attacks could be
mounted by exploiting the virtual carrier-sense scheme
through forging any frame, especially RTS (Ready To
Send) frame, with an extremely large value of NAV
(Network Allocation Vector), which can fool the devices
to consider the channel busy; thus, suppress the device
from transmitting messages [8, 12]. Additionally, as in a
wired LAN, an adversary can perform an ARP (Address
Resolution Protocol) cache poisoning to mount a DoS
attack if the adversary is able to access the network in
someway [17].
Furthermore, if an IEEE 802.1X authentication is
implemented for stronger authentication, the adversary
has more choices to mount a DoS attack through forging
EAP-Start, EAP-Logoff, and EAP-Failure messages. The
adversary can also exhaust the space of the EAP packet
identifier, which is only 8 bits long, by sending more than
255 authentication requests simultaneously [4].
In addition, due to the speed limitation of a WLAN
comparing to a wired network, it is easy to perform a DoS
attack from the IP or upper layer by simply network
jamming, e.g., ICMP ping flooding from a high-speed
wired network [32]. However, this attack could be
prevented by appropriate filtering policies and traffic
shaping in the Access Point. An adversary can also
exploit the deficiencies of the upper layer protocols to
mount a DoS attack; improvements on the upper layer
protocol might be necessary for countermeasures.