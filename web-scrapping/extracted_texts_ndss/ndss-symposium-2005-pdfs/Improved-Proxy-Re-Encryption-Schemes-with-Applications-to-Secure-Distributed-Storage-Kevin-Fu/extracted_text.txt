Improved Proxy Re-Encryption Schemes with Applications to Secure
Distributed Storage
GiuseppeAteniese(cid:3) KevinFuy MatthewGreen(cid:3) SusanHohenbergery
Abstract requiresanunrealisticleveloftrustintheproxy.
We present several ef(cid:2)cient proxy re-encryption
schemes that offer security improvements over earlier
In1998,Blaze,Bleumer,andStraussproposedanap- approaches. The primary advantage of our schemes
plicationcalledatomicproxyre-encryption,inwhicha is that they are unidirectional (i.e., Alice can delegate
semi-trustedproxyconvertsaciphertextforAliceintoa to Bob without Bob having to delegate to her) and do
ciphertextforBobwithoutseeingtheunderlyingplain- not require delegators to reveal all of their secret key
text. We predictthatfast and secure re-encryptionwill to anyone(cid:150) or even interact with the delegatee(cid:150) in or-
become increasingly popular as a method for manag- der to allow a proxyto re-encrypttheir ciphertexts. In
ing encrypted (cid:2)le systems. Although ef(cid:2)ciently com- our schemes, only a limited amount of trust is placed
putable,thewide-spreadadoptionofBBSre-encryption in the proxy. Forexample,it is notable to decryptthe
has been hindered by considerablesecurity risks. Fol- ciphertextsitre-encryptsandweproveourschemesse-
lowingrecent work of IvanandDodis, we present new cureevenwhentheproxypublishesallthere-encryption
re-encryptionschemes thatrealize astronger notionof informationitknows.Thisenablesanumberofapplica-
securityandwedemonstratetheusefulnessofproxyre- tionsthatwouldnotbepracticaliftheproxyneededto
encryptionasamethodofaddingaccesscontroltothe befullytrusted.
SFS read-only (cid:2)le system. Performance measurements We present an applicationfor proxycryptographyin
of our experimental (cid:2)le system demonstrate that proxy securing distributed (cid:2)le systems. Our system uses a
re-encryptioncanworkeffectivelyinpractice. centralized access control server to manage access to
encrypted (cid:2)les stored on distributed, untrusted repli-
cas. Weuseproxyre-encryptiontoallowforcentrally-
1.Introduction managedaccesscontrolwithoutgrantingfulldecryption
rightstotheaccesscontrolserver.
Proxyre-encryptionallowsaproxytotransformaci- No experimental implementation of proxy re-
phertextcomputedunderAlice’spublickeyintoonethat encryption schemes has been provided, to our knowl-
canbeopenedbyBob’ssecretkey.Therearemanyuse- edge, whichmakesit dif(cid:2)culttoargueaboutthe effec-
ful applications of this primitive. For instance, Alice tivenessoftheproxyre-encryptionprimitive.Inthispa-
might wish to temporarily forward encrypted email to per, we provide new protocols with improved security
hercolleagueBob,withoutgivinghimhersecretkey.In guarantees (based on bilinear maps) and demonstrate
thiscase,Alicethedelegatorcoulddesignateaproxyto theirpracticalitybasedonruntimeexperiments.
re-encryptherincomingmailintoaformatthatBobthe
delegateecandecryptusinghisownsecretkey.Clearly, 1.1.ProxyRe›encryptionBackground
Alicecouldprovidehersecretkeytotheproxybutthis
A methodologyfor delegating decryptionrights was
(cid:3)Department of Computer Science; The Johns Hopkins Univer- (cid:2)rstintroducedbyMamboandOkamoto[30]purelyas
sity; 3400 N. Charles Street; Baltimore, MD 21218, USA. Email:
anef(cid:2)ciencyimprovementovertraditionaldecrypt-and-
fateniese,mgreeng@cs.jhu.edu.
yComputer Science and Arti(cid:2)cial Intelligence Laboratory; Mas- then-encryptapproaches.
sachusettsInstituteofTechnology;32VassarStreet;Cambridge,MA In 1998, Blaze, Bleumer, and Strauss [6] proposed
02139,USA.Email: ffubob,srhoheng@mit.edu. Someofthe
the notionof(cid:147)atomicproxycryptography(cid:148),in whicha
researchofS.HohenbergerandK.Fuwasperformedwhilevisiting
semi-trustedproxycomputesafunctionthatconvertsci-
IBMResearchLabs,Zurich,SwitzerlandandtheJohnsHopkinsUni-
versityInformationSecurityInstituterespectively. phertextsforAliceintociphertextsforBobwithoutsee-ing the underlying plaintext. In their El Gamal based teeneedonlystoreasinglesecret,butanobviousdraw-
scheme,withmodulusasafeprimep=2q+1,theproxy backisthatwhentheproxyandanydelegateeinthesys-
is entrustedwith the delegationkey b=a mod q for the temcollude,theycandecrypteveryoneelse’smessages.
purposeof divertingciphertexts fromAlice to Bob via Thus, proxy re-encryption protocols combining the
computing (mgkmod p;(gak)b=amod p). The authors variousadvantagesoftheBBSandIvan-Dodisschemes,
noted, however,that this schemecontainedaninherent along with new features such as time-limited delega-
restriction: itisbidirectional;thatis,thevalueb=acan tions, remained an open problem. (We provide a list
beusedtodivertciphertextsfromAlicetoBobandvice of these desirable features in Section 3.) Our re-
versa. Thus, this scheme is only useful when the trust sults can be viewed as contributing both to the set of
relationship between Alice and Bob is mutual. (This key-insulated [12, 13, 15] and signcryption [3, 4, 38]
problem can be solved, for any scheme, by generating schemes, whereAlice mayexposehersecretkey with-
anadditional,otherwiseunused,keypairforthedelega- out needing to change her public key and/or use the
tee, butthis introducesadditional overhead.) The BBS same public key for encryption and signing purposes.
scheme contains further problems. Delegation in the This work should not be confused with the (cid:147)universal
BBS scheme is transitive, which means that the proxy re-encryption(cid:148) literature [24], which re-randomizes ci-
alone can create delegationrights between two entities phertextsinsteadofchangingthepublickey.
that have never agreed on this. For example, from the
valuesa=bandb=c,theproxycan re-encryptmessages 1.2.ApplicationsofProxyRe›encryption
fromAlice toCarol. Anotherdrawbacktothis scheme
Proxy re-encryption has many exciting applications
isthatiftheproxyandBobcollude,theycanrecoverher
in addition to the previous proposals [6, 14, 26, 39]
secretkeyas(a=b)(cid:3)b=a!
foremailforwarding,lawenforcement,andperforming
Jakobsson [26] developed a quorum-based protocol
cryptographicoperationsonstorage-limiteddevices. In
where the proxy is divided into sub-components, each
particular, proxycryptographyhas natural applications
controlling a share of the re-encryption key; here, the
tosecurenetwork(cid:2)lestorage.Thefollowingparagraphs
keys of the delegator are safe so long as some of the
describepotentialapplicationsofproxyre-encryption.
proxiesarehonest. Asimilarapproachwas considered
byZhou,Mars,SchneiderandRedz[39].
Recently,IvanandDodis[14]realizedunidirectional SecureFileSystems. Asecure(cid:2)lesystemisanatural
proxy encryption for El Gamal, RSA, and an IBE application of proxy re-encryption because the system
scheme by sharing the user’s secret key between two oftenassumesamodelofuntrustedstorage.
parties. They also solved the problem of the proxy Anumberofdistributed(cid:2)lesystemsbuildcon(cid:2)dential
alone assigning new delegation rights. In their unidi- storage out of untrusted components by using crypto-
rectional El Gamal scheme, Alice’s secret key s is di- graphicstorage[2,5,22,28].Con(cid:2)dentialityisobtained
vided into two shares s and s , where s = s +s , by encrypting the contents of stored (cid:2)les. These en-
1 2 1 2
and distributed to the proxy and Bob. On receiv- crypted(cid:2)lescanthenbestoredonuntrusted(cid:2)leservers.
ing ciphertexts of the form (mgsk;gk), the proxy (cid:2)rst Theserveroperatorscandistributeencrypted(cid:2)leswith-
computes (mgsk=(gk)s1), which Bob can decrypt as outhavingaccesstotheplaintext(cid:2)lesthemselves.
(mgs2k=(gk)s2) = m. Although this scheme offers Inasingle-usercryptographic(cid:2)lesystem,accesscon-
some advantagesoverthe BBS approach, it introduces trolisstraightforward.Theusercreatesallthekeyspro-
newdrawbacksaswell.These(cid:147)secret-sharing(cid:148)schemes tectingcontent. Thus,thereisnokeydistributionprob-
donotchangeciphertextsforAlice intociphertextsfor lem.Withgroupsharingincryptographicstorage,group
Bob in the purest sense (i.e., so that Bob can decrypt membersmustrendezvouswithcontentownerstoobtain
themwithhisownsecretkey),theydelegatedecryption decryptionkeysforaccessing(cid:2)les.
byrequiringBobtostoreadditionalsecrets(i.e.,shares Systems with cryptographic storage such as the
fs(i)g)thatmayinpracticebedif(cid:2)cultforhimtoman- SWALLOW objectstore[32] orCNFS [25]assumean
2
out-of-bandmechanismfordistributingkeysforaccess
age. For example, in our (cid:2)le system in Section 4, the
control. Other systems such as Cepheus [18] use a
number of secrets a user must manage should remain
trustedaccesscontrolservertodistributekeys.
constant regardless of the number of (cid:2)les it accesses.
Theaccesscontrolservermodelrequiresagreatdeal
OneexceptionistheIvan-DodisIBEscheme[14]where
oftrustintheserveroperator.Shouldtheoperatorprove
the global secret that decrypts all ciphertexts is shared
unworthyofthistrust,heorshecouldabusetheserver’s
betweentheproxyandthedelegatee. Thus,thedelega-
key material to decrypt any data stored on the system.Furthermore,eveniftheaccesscontrolserveroperatoris encryption schemes. Section 4 highlights the design,
trustworthy,placingsomuchcriticalkeydatainasingle implementation,andperformancemeasurementsofour
locationmakesforaninvitingtarget. proxyre-encryption(cid:2)lesystem.Weprovideconcluding
In contrast, our system makes use of a semi-trusted remarksinSection5.
accesscontrolserver. Weproposeasigni(cid:2)cantsecurity
improvementtotheaccesscontrolincryptographicstor- 2.De(cid:2)nitions
age,usingproxycryptographytoreducetheamountof
trustintheaccesscontrolserver. Inourapproach,keys Ourprotocolsarebasedonbilinearmaps[7,8,9,27]),
protecting(cid:2)lesarestoredencryptedunderamasterpub- whichweimplementedusingthefastTatepairings[21].
lickey,usingoneoftheschemesinSection3. Whena
userrequestsakey,theaccesscontrolserverusesproxy
De(cid:2)nition2.1(BilinearMap) Wesayamape : G 1(cid:2)
G^ !G isabilinearmapif:(1)G andG aregroups
cryptographyto directlyre-encryptthe appropriatekey 1 2 1 2
ofthesameprimeorderq;(2)foralla;b2Z ,g2G ,
totheuserwithoutlearningthekeyintheprocess. Be- q 1
and h 2 G^ , then e(ga;hb) = e(g;h)ab is ef(cid:2)ciently
cause the access control server does not itself possess 1
computable; (3) the map is non-degenerate (i.e., if g
the master secret, it cannot decrypt the keys it stores.
generates G and h generates G^ , then e(g;h) gener-
The master secret key can be stored of(cid:3)ine, by a con- 1 1
atesG );and(4)thereexistsacomputableisomorphism
tentownerwhousesitonlytogeneratethere-encryption 2
fromG^ toG .(Here,G mayequalG^ .)
keysusedbytheaccesscontrolserver. InSection4,we 1 1 1 1
describeourimplementationandprovideaperformance
Now,weexplainthedifferentcomponentsofaproxy
evaluationofourconstructions.
re-encryptionscheme. We will beinformalin thissec-
tion, referring an interested reader to Appendix A for
Outsourced Filtering of Encrypted Spam. Another precisede(cid:2)nitions.
promisingapplicationof proxyre-encryptionis the (cid:2)l-
De(cid:2)nition2.2(UnidirectionalProxyRe-encryption)
teringofencryptedemailsperformedbyauthorizedcon-
A re-encryption scheme is a tuple of (possi-
tractors. The sheer volume of unsolicited email, along
bly probabilistic) polynomial time algorithms
with rapid advances in (cid:2)lter-avoidance techniques, has
(KG;RG;E~;R;D~),where:
overwhelmedthe(cid:2)lteringcapabilityofmanysmallbusi-
nesses, leading to a potential market for outsourced (cid:15) (KG;E~;D~)formthestandardkeygeneration,en-
email (cid:2)ltering. New privacy regulations, such as
cryption,anddecryptionalgorithms.
the US Health Insurance Portability and Accountabil-
(cid:15) On input(pk ;sk ;pk ;sk(cid:3)), the re-encryption
ity Act (HIPAA), are encouraging companies to adopt A A B B
key generation algorithm, RG, outputs a key
institution-wideemailencryptiontoensurecon(cid:2)dential-
rk for the proxy. The fourth input marked
ity of patient information[1]. By accepting encrypted
A!B
witha’(cid:3)’isoptional.
emailfromoutsidesources,institutionsbecome(cid:147)spam(cid:148)
(cid:15) On input rk and ciphertext C , the re-
targets and (cid:2)lters are only effective on messages that A!B A
encryptionfunction,R,outputsC .
are(cid:2)rstdecrypted(whichcouldbeunacceptablycostly). B
Usingproxyre-encryption,itbecomespossibletoredi-
Correctness. Alice should always be able to de-
rect incoming encrypted email to an external (cid:2)ltering crypt ciphertexts encrypted under pk ; while Bob
A
contractorattheinitialmailgateway,withoutriskingex-
should be able to decrypt re-encrypted ciphertexts
posureofplaintextsatthegatewayitself.Usingourtem- R(rk ;C ). The encryption algorithm E~ may al-
A!B A
porary proxy re-encryption scheme presented in Sec-
lowmultipletypesofencryption,suchas(cid:2)rst-levelen-
tion3.2,ahealthcareinstitutioncanperiodicallychange
cryptions that cannot be re-encryptedand second-level
(cid:2)lteringcontractorswithoutchangingitspublickey.
encryptionsthatcan be. This givesthesendera choice
between encrypting a message only to Alice or to Al-
1.3.Roadmap
iceandherdelegateeBobwithinthesamesystem. For
re-encryptedciphertexts,werequirethattheunderlying
Therestofthispaperconsists ofthefollowing. Sec-
plaintextremainconsistent(cid:150)i.e.,Bobshouldgetexactly
tion 2 gives some number theoretic preliminaries and
whatAlicewassupposedtoreceive.1
de(cid:2)nitions necessary to understand our schemes and
their security guarantees. Section 3 presents improved
1Note, this only applies tociphertexts that were honestly gener-
proxy re-encryption schemes as well as a discussion
atedbythesender;noguaranteeisimpliedinthecaseofmalformed
on the factors to consider when comparing proxy re- ciphertexts.Security. Our security de(cid:2)nition has two parts: stan- Property BBS[6] ID[14] Thiswork
dard security, requiring that the cryptosystem remain 1. Unidirectional No Yes Yes
semantically-secure [23] even when all re-encryption 2. Non-interactive No Yes Yes
keysarepublic;andmastersecretsecurity,whereadel- 3. Proxyinvisible Yes No Yes
egator’smastersecretkeyisnotrecoverable. Oursecu- 4. Original-access Yesy Yes Yesy
rityde(cid:2)nitionissimilar tothatofIvanandDodis[14]. 5. Keyoptimal Yes No Yes
Although their de(cid:2)nition was for CCA2 security, they 6. Collusion-(cid:147)safe(cid:148) No No Yes(cid:3)
insteadusedCPA securityfortheEl Gamal, RSA, and 7. Temporary Yesy Yesy Yesy
IBE-basedschemes. The(cid:2)rstmaindifferencebetween 8. Non-transitive No Yes Yes
ourde(cid:2)nitionsisthatweconsiderthesecurityofauser 9. Non-transferable No No No
against a group of colluding parties; i.e., the security
of a delegator against the proxy and many delegatees, Table 1. We compare known proxy re›
whereas the Ivan-Dodis de(cid:2)nition focused on a single encryption schemes based on the ad›
delegatee. Second,wediscussthesystem’ssecurityfor vantages described above; no scheme
circulardelegations;thatis,whenanadversarywatches achieves property 9. We refer to the uni›
Alice and Bob delegate to each other. Finally, master directionalschemes ofIvan›Dodis. (cid:3)indi›
secretsecurityisanewguaranteeforthedelegator. cates master secret key only. y indicates
possible to achieve with additional over›
head.
3.ImprovedProxyRe-encryption Schemes
Totalkabout(cid:147)improvements(cid:148),weneedtogetasense ciphertextsthatwereoriginallysenttoher. Insomeap-
ofthebene(cid:2)tsanddrawbacksofpreviousschemes.Here plications,itmaybedesirabletomaintainaccesstoher
isalistof,inouropinion,themostusefulpropertiesof re-encryptedciphertexts. This is an inherentfeatureof
proxyre-encryptionprotocols: the Ivan-Dodisschemes(sincethe re-encryptionkey is
1. Unidirectional: DelegationfromA ! B doesnot a share of the original); the BBS scheme and the pair-
allowre-encryptionfromB !A. ing schemespresentedherecan achievethis featureby
2. Non-interactive:Re-encryptionkeyscanbegener- adding an additional term to the ciphertext: for exam-
ated by Alice using Bob’s public key; no trusted third ple, in BBS a re-encryptedciphertext with original ac-
party or interaction is required. (Such schemes were cess looks like (mgk;gak;(gak)b=a). This mayimpact
calledpassiveinBBS[6].) proxyinvisibility.
3. Proxyinvisibility: Thisisanimportantfeatureof- 5. Key optimal: The size of Bob’s secret storagere-
fered by the original BBS scheme. The proxy in the mainsconstant,regardlessofhowmanydelegationshe
BBSschemeistransparentinthesensethatneitherthe accepts. Wecallthisakeyoptimalscheme. Inthepre-
sender of an encrypted message nor any of the dele- viousElGamalandRSAbasedschemes[14],thestor-
gatees have to be aware of the existence of the proxy. age of bothBob andthe proxygrowslinearlywith the
Clearly,transparencyisverydesirablebutitisachieved numberofdelegationsBobaccepts.Thisisanimportant
intheBBSschemeatthepriceofallowingtransitivityof consideration, since the safeguardingand management
delegationsandrecoveryofthemastersecretsofthepar- ofsecretkeysisoftendif(cid:2)cultinpractice.
ticipants. Our pairing-based schemes, to be described 6. Collusion-(cid:147)safe(cid:148): One drawback of all previous
shortly, offer a weaker form of transparencywhich we schemesisthatbycolludingBobandtheproxycanre-
callproxyinvisibility. Inparticular,weallowthesender coverAlice’s secretkey: forIvan-Dodis,s = s +s ;
1 2
tobeawareoftheproxyanddecidewhethertogenerate forBBS,a=(a=b)(cid:3)b.Wewillmitigatethisproblem(cid:150)
an encryptionthat can be openedonly by the intended allowingrecoveryofa(cid:147)weak(cid:148)secretkeyonly. Inabi-
recipient((cid:2)rst-levelencryption)orbyanyoftherecipi- linearmapsetting,supposeAlice’spublickeyise(g;g)a
ent’sdelegatees(second-levelencryption). Ontheother andhersecretkeyisa;thenwemightallowBobandthe
hand,wecanensurethatanydelegateewillnotbeable proxytorecoverthevaluega,butnotaitself.Thus,Al-
to distinguish a (cid:2)rst-level encryption (computed under icecandelegatedecryptionrights,whilekeepingsigning
his publickey)froma re-encryptionofa ciphertextin- rightsforthesamepublickey.Inpractice,ausercanal-
tended for anotherparty (we are assuming that the en- waysusetwopublickeysforencryptionandsignatures,
cryptedmessagedoesnotrevealinformationthatwould butitistheoreticallyinterestingthatshedoesn’tneedto
helpthedelegateetomakethisdistinction). doso. Priorworkon(cid:147)signcryption(cid:148)exploredthis area
4. Original-access: Alice can decrypt re-encrypted (e.g., [38, 4, 3]); here we present, what can be viewedas,the(cid:2)rst(cid:147)signREcryption(cid:148)scheme(althoughwewill hastwodecryptionalgorithmswithtwodifferentsecret
not be formally concerningourselves with the security keys.Thesecryptosystemstypicallysupporta(cid:2)rst-level
ofthesignaturesinthiswork). secretkeythatdecryptsallciphertextsencryptedunder
7. Temporary: Ivan and Dodis [14] suggested ap- thecorrespondingpublickey,andasecond-levelsecret
plyinggenerickey-insulationtechniques[15,12,13]to keythatmaydecryptonlyciphertextsofacertainform
theirconstructionsto formschemes whereBobis only underthesamepublickey. Noticethattherearetrivial
able to decrypt messages intended for Alice that were solutionsto theproxyre-encryptionproblemwhenAl-
authored during some speci(cid:2)c time period i. Citing iceisallowedtousetwodifferentkeypairs,butweare
spaceconsiderations,theydidnotpresentanyconcrete interestedinsolutionsthatminimizethenumbertokeys
constructions.InSection3.2,weprovideabilinearmap tosafeguardandmanagewhileremainingef(cid:2)cient.
construction designed speci(cid:2)cally for this purpose. In Inthe fullversionofthis paper,wepresenta variant
ourconstruction,atrustedserverbroadcastsanewran- of the Paillier cryptosystemwith (cid:2)rst and second-level
dom numberat each time period, which each user can secret keys proposed by Cramer and Shoup [11]. Al-
thenusetoupdatetheirdelegatedsecretkeys.Thisisan ice keeps the (cid:2)rst-level key for herself and sends the
improvementoverusingcurrentkey-insulatedschemes second-level key to Bob as a delegation, with a proxy
where the trusted server needs to individually interact added to further regulate which ciphertexts Bob may
with each user to help them update their master (and read.Thisapproachisinteresting,becauseitisbasedon
therefore,delegation)secretkeys. an assumptionother than bilinear maps; and offers the
8. Non-transitive: The proxy, alone, cannot re- collusion-(cid:147)safety(cid:148) (i.e., protection of the (cid:2)rst-level se-
delegate decryption rights. For example, from rk cretkey)thattheschemesofIvan-Dodislack.However,
a!b
andrk ,hecannotproducerk . liketheIvan-Dodisschemes[14],itisnotkeyoptimal.
b!c a!c
9. Non-transferable: The proxyand a set of collud-
ASecondAttempt.Tominimizeauser’ssecretstorage
ingdelegateescannotre-delegatedecryptionrights. For
andthus becomekeyoptimal, we presentthe BBS [6],
example, from rk , sk , and pk , they cannot pro-
a!b b c ElGamalbased[16]schemeoperatingovertwogroups
duce rk .We are not aware of any scheme that has
a!c G ;G ofprimeorderq withabilinearmape : G2 !
thisproperty,anditisaverydesirableone.Forinstance, 1 2 1
G . Thesystemparametersarerandomgeneratorsg 2
ahospitalmaybeheldlegallyresponsibleforsafeguard- 2
G andZ =e(g;g)2G .
ingtheencrypted(cid:2)lesofitspatients;thus,ifitchooses 1 2
todelegatedecryptioncapabilitiestoalocalpharmacy, (cid:15) KeyGeneration(KG). AuserA’s keypairis of
itmayneedsomeguaranteethatthisinformation(cid:147)goes theformpk =ga;sk =a:
a a
nofurther.(cid:148) First,weshouldaskourselves: istransfer- (cid:15) Re-EncryptionKeyGeneration(RG). AuserA
abilityreallypreventable?Thepharmacycanalwaysde- delegatestoB bypublishingthere-encryptionkey
cryptandforwardtheplaintext(cid:2)lestoadrugcompany. rk = gb=a 2 G , computedfromB’spublic
A!B 1
However, this approach requires that the pharmacy re- key.
mainanactive,onlineparticipant.Whatwewanttopre- (cid:15) First-Level Encryption (E 1). To encrypt a mes-
ventisthepharmacy(plustheproxy)providingthedrug sage m 2 G under pk in such a way that it
2 a
companywithasecretvaluethatitcanuseof(cid:3)inetode- canonlybedecryptedbytheholderofsk ,output
a
crypt the hospital’s ciphertexts. Again, the pharmacy c=(Zak;mZk).
can trivially send its secret key to the drug company. (cid:15) Second-LevelEncryption(E 2).Toencryptames-
Butindoingso,itassumesasecurityriskthatisaspo- sage m 2 G under pk in such a way that it
2 a
tentiallyinjuriousto itself as thehospital. Achievinga can be decryptedby A and her delegatees, output
proxyschemethatisnon-transferable,inthesensethat c=(gak;mZk).
theonlywayforBobtotransferof(cid:3)inedecryptioncapa- (cid:15) Re-Encryption(R).Anyonecanchangeasecond-
bilitiestoCarolistoexposehisownsecretkey,seemsto levelciphertextforAintoa(cid:2)rst-levelciphertextfor
bethemainopenproblemleftforproxyre-encryption. B withrk = gb=a. Fromc = (gak;mZk),
A!B a
compute e(gak;gb=a) = Zbk and publish c =
b
3.1. New Unidirectional Proxy Re›encryption (Zbk;mZk).
Schemes (cid:15) Decryption (D 1). To decrypt a (cid:2)rst-level cipher-
text c = ((cid:11);(cid:12)) with sk = a, compute m =
a
A First Attempt. As Ivan and Dodis pointed (cid:12)=(cid:11)1=a.
out [14], one method for constructing proxy re-
encryption schemes is to create a cryptosystem that Discussion of Scheme. This scheme is very attractive;it is unidirectional, non-interactive, proxy transparent, (DBDH) assumption [7, 10]; the proof of Boneh and
collusion-safe, key optimal, and non-transitive. How- Franklin[7]thattheDBDHproblemis hardingeneric
ever, its security requires the assumption that a cannot groups, in the sense of Shoup [36], can be easily ex-
bederivedfromseeingthea-throotofapolynomialset tended to this problem, when one recalls that the ad-
ofrandomvalues(whichisplausibleinagroupofprime ditional parameter e(g;g)bc2 is represented as a ran-
order),inadditiontotheassumptionthatthefollowing dom string in the range of the mapping. Furthermore,
problemishardin(G 1;G 2): we note that the semantic security for a user who ac-
cepts, but does not give delegations can be reduced to
Given(g;ga;gb;Q),forg G 1; a;b Z q the CoDDH problem; that is, given (g;ga;Zb;Q) for
andQ2G 2,decideifQ=e(g;g)a=b: random a;b Z q and an element Q 2 G 2, decide if
Q = Zab. Original (cid:2)rst-level ciphertexts of the form
ThereisevidencethatthecomputationalBilinearIn- (Za2k;mZk) are exactly like El Gamal [16] and thus
verse Dif(cid:2)e-Hellmanproblemis hard[37], but this de- their security only depends on DDH in G . However,
2
cisionalversionhasnotbeenstudiedenough. Next,we under the CoDDH assumption, Alice’s security is as-
providea solution which makes fewer (and more stan- sured even when people send her second-level cipher-
dard)assumptions. texts (not knowing that she isn’t making any delega-
tions).ProofofTheorem3.1isinAppendixB.
AThirdAttempt.Theglobalsystemparameters(g;Z)
remainunchanged. Theorem3.1 The above scheme is correct and secure
assuming that for randomg G , a;b;c Z , and
(cid:15) KeyGeneration(KG). AuserA’s keypairisof 1 q
the form pk
a
= (Za1;ga2) and sk
a
= (a 1;a 2). dQ ec2 idG ei2 f, Qgi =ven e(( gg ;; gg )a a; bg cb (; sg tac n;e d( ag rd;g s) eb cc u2 r; iQ ty) )i at ni ds th ha erd dit so
-
(Ausercanencrypt,sign,anddelegatedecryption
rights all underZa1; ifthe valuega2 is present,it cretelogarithmassumption(mastersecretsecurity).
signi(cid:2)es that the user is willing to accept delega-
3.2. Temporary Unidirectional Proxy Re›
tions.)
(cid:15) Re-Encryption Key Generation (RG). A user encryption
AdelegatestoB publishingthere-encryptionkey
In addition to the global parameters (g;Z), suppose
rk
A!B
=ga1b2 2 G 1,computedfromB’spublic
thereisatrustedserverthatbroadcastsarandomvalue
information.
h 2 G foreachtimeperiodi (cid:21) 1foralluserstosee.
i 1
(cid:15) First-Level Encryption (E 1). To encrypt a mes-
LetZ =e(g;h )2G . WeenableAlicetodelegateto
sage m 2 G under pk in such a way that it i i 2
2 a Bobonlyfortimeperiodi,say,whilesheisonvacation,
canonlybedecryptedbytheholderofsk ,output
a asfollows.
c
a;1
= (Za1k;mZk)(toachieveproxyinvisibility
outputc a;1 =(Za2k;mZk)atnosecurityloss). (cid:15) KeyGeneration(KG). AuserA’s keypairis of
(cid:15) Second-LevelEncryption(E 2).Toencryptames- theformpk
a
=(ga0;gar);sk
a
=(a 0;a r),(plusa
sage m 2 G 2 under pk a in such a way that it temporarysecreta i fortimeperiodiwhichwillbe
can be decryptedby A and her delegatees, output generatedinRG).
c a;r =(gk;mZa1k). (cid:15) Re-EncryptionKeyGeneration(RG). AuserA
(cid:15) Re-Encryption(R).Anyonecanchangeasecond- publiclydelegatestoB duringtimeperiodiasfol-
level ciphertext for A into a (cid:2)rst-level cipher- lows: (1) B chooses and stores a random value
text for B with rk A!B = ga1b2. From b i 2 Z q, andpublisheshb ii; then, (2)A computes
c a;r = (gk;mZa1k), compute e(gk;ga1b2) = andpublishesrki =harbi=a0.
(Z Zb2 b2a k1 0k ;man Zd kp 0 )u .blish c b;2 = (Zb2a1k;mZa1k) = (cid:15) F unir ds et r-L pe kvel dE un ric nrA gy! p ttB imio en( pE ei r1 i) o. dTo i,en oc ur ty pp ut tm
c
2G =2
a a;0
(cid:15) Decryption (D 1;D 2). To decrypt a (cid:2)rst-level ci- (Za0k;mZk).
phertextc = ((cid:11);(cid:12)) withsecretkeysk , output i i
(cid:12)=(cid:11)1=ai
=a;i
mfori2f1;2g.
a (cid:15) Second-LevelEncryption (E 2). Toencryptm 2
G under pk duringtime periodi, outputc =
2 a a;i
DiscussionofScheme.Thisschemeissimilartothepre-
(ga0k;mZark).
i
viousone,excepttoacceptdelegations,ausermuststore (cid:15) Re-Encryption(R).Anyonecanchangeasecond-
two secret keys. The security of this scheme relies on level ciphertext for A into a (cid:2)rst-level ciphertext
an extension of the decisional bilinear Dif(cid:2)e-Hellman for B with rk = harbi=a0. From c =
A!B;i i a;i(ga0k;mZ iark), compute e(ga0k;rk A!B) = mastersecret,itcannotbecorruptedsoastogainaccess
Zbiark and publish c = (Zbiark;mZark) = to the (cid:2)le keys and access encrypted (cid:2)les. The secret
i b;i i i
(Zbik0 ;mZk0 ). master secret key remainsof(cid:3)ine, in the careof a con-
i i
(cid:15) Decryption(D 1). Todecryptc a;i = ((cid:11);(cid:12)), com- tentownerwhousesitonlytogeneratethere-encryption
putem=(cid:12)=(cid:11)1=ai fora
i
2fa 0;a 1;a 2;:::g. keysusedbytheaccesscontrolserver. Whenanautho-
rized user requests access to a (cid:2)le, the access control
DiscussionofScheme.Asingleglobalchangecaninval- serverusesproxycryptographytodirectlyre-encryptthe
idateallpreviousdelegationswithoutanyuserneeding appropriatecontentkey(s)fromthemasterpublickeyto
tochangetheirpublickey.ProofofTheorem3.2appears theuser’spublickey.
inthefullversionofthispaper. Thisarchitecturehassigni(cid:2)cantadvantagesoversys-
temswithtrustedaccesscontrolservers. Thekeymate-
Theorem3.2 The above scheme is correct and secure
assuming that for random g G , a;b;c Z and rialstoredontheaccesscontrolservercannotbeusedto
1 q
accessstored(cid:2)les,whichreducestheneedtoabsolutely
Q 2 G , given (g;ga;gb;gc;Q) it is hard to decide if
2 trust the server operator, and diminishes the server’s
Q = e(g;g)ab2=c (standard security) and the discrete
value to attackers. The master secret key itself is only
logarithmassumption(mastersecretsecurity).
requiredbyacontentownerwhennewusers areadded
tothesystem,andcanthereforebestoredsafelyof(cid:3)ine
4.Encrypted FileStorage
where it is less vulnerable to compromise. Finally the
schemes in Section 3 are unidirectional, meaning that
Our (cid:2)le system uses an untrusted access control
users do not need to reveal or otherwise compromise
server to manage access to encrypted (cid:2)les stored on
theirsecretkeysinordertojointhesystem.Thisallows
distributed, untrusted block stores. We use proxy re-
contentownerstoadduserstothesystemwithoutinter-
encryptiontoallowforaccess controlwithoutgranting
action, simply by obtaining their public key. Because
fulldecryptionrightstotheaccesscontrolserver.
this system works with users’ long-term keys (rather
To our knowledge, no experimental implementation
than generating ephemeral keys for the user), there is
ofproxyre-encryptionexists,whichmakesitdif(cid:2)cultto
an additional incentive for users not to reveal their de-
argueabouttheeffectivenessoftheproxyre-encryption
cryptionkeys.
primitive.
The proposed design fundamentally changes the se-
curityofanaccesscontrolserverstoragesystem.Inthis
Overview. Inour(cid:2)lesystem,endusersonclientma-
newmodel,muchofthesecurityreliesonthestrengthof
chineswishtoobtainaccesstointegrity-protected,con-
aprovably-securecryptosystem,ratherthanonthetrust
(cid:2)dentialcontent. Acontentownerpublishesencrypted
of a server operator for mediating access control. Be-
contentin theformofa many-reader,single-writer(cid:2)le
cause the access control server cannot successfully re-
system. The owner encrypts blocks of content with
encrypt a (cid:2)le key to a user without possessing a valid
unique, symmetriccontent keys. A contentkeyis then
delegationkey,theaccesscontrolservercannotbemade
encryptedwithanasymmetricmasterkeytoformalock-
to divulge (cid:2)le keys to a user who has not been specif-
box.Thelockboxresideswiththeblockitprotects.
ically authorized by the content owner, unless this at-
Untrusted block stores make the encrypted content
tacker has previously stolen a legitimate user’s secret
available to everyone. Users download the encrypted
key.
content from a block store, then communicate with an
access control server to decrypt the lockboxesprotect-
ingthecontent. Thecontentownerselectswhichusers
Chefs. We implemented our (cid:2)le system on top of
should have access to the content and gives the appro- Chefs[19],acon(cid:2)dentiality-enabledversionoftheSFS
priatedelegationrightstotheaccesscontrolserver. Read-Only (cid:2)le system [20]. Chefs is a single-writer,
many-reader(cid:2)lesystemthatprovidesdecentralizedac-
AccessControlUsingProxyCryptography. Wepro- cess control in integrity-protected content distribution.
poseanimprovementontheaccesscontrolservermodel A content owner creates a signed, encrypted database
that reduces the server’s trust requirements by using from a directory tree of content. The database is then
proxycryptography. In ourapproach,the keys used to replicatedonuntrustedhosts(e.g.,volunteers). Aclient
encrypt(cid:2)lesarethemselvessecurelyencryptedundera locatesareplica,thenrequeststheencryptedblocks.
masterpublickey,usingoneoftheschemesinSection3. Chefs tags each content block with a lockbox. The
Because the access controlserver does not possess the lockbox contains a 128-bit AES key, itself encrypted1. Block request 3. Encrypted lockbox
2. Encrypted data block 4. Re-encrypted lockbox
Block Store Client Access Control
Server
Figure 1. Typical operation of the proxy re›encryption (cid:2)le system. The user’s client machine
fetchesencryptedblocksfromtheblockstore. Eachblockincludesalockboxencryptedunder
a master public key. The client then transmits lockboxes to the access control server for re›
encryptionundertheuser’s publickey. Iftheaccess controlserver possesses thenecessary
re›encryption key, it re›encrypts the lockbox and returns the new ciphertext. The client can
thendecryptthere›encryptedblockwiththeuser’ssecretkey.
withasharedgroupAESkey.Chefsassumesanout-of- encrypted ciphertext. Thus, the choice of encryption
bandmechanismforcontentownerstodistributegroup granularity greatly affects the number of re-encryption
keystousers. calls made fromthe client to the access controlserver,
WechosetheChefsarchitecturebecauseitallowedus whichinturnaffectstheperformanceofthesystem.
toexperimentwithdifferentgranularitiesofencryption
(per-(cid:2)leandper-directory)whileprovidingatransparent 4.2.ExperimentalResults
(cid:2)lesysteminterfaceforourexperiments.
In implementing a proxy re-encryption (cid:2)le system,
we had two goals in mind. First, we wished to show
4.1.DesignandImplementation
thatproxyre-encryptioncouldbesuccessfullyincorpo-
ratedintoabasiccryptographic(cid:2)lesystem. Second,we
Wemodi(cid:2)edChefstoincludeanaccesscontrolserver.
sought to prove that the additional security semantics
Every block in a Chefs database is encrypted with a
providedbyaproxyre-encryptingaccesscontrolserver
128-bitAEScontentkeyinCBC mode. Dependingon
cameatanacceptablecosttosystemperformance.
the granularityof the encryption, a content key can be
To achieve this second goal, we conducted a num-
sharedacrossalloftheblocksinaparticular(cid:2)le,direc-
ber of benchmarks using the proxy-enabled Chefs (cid:2)le
tory or database, or unique keys can be used for each
system, using various granularities of content key us-
block. Content keys are themselves encrypted under
age (per-block and per-(cid:2)le). Along with these exper-
a system master key using the third bilinear El Gamal
iments, we conducted microbenchmarks of the proxy
scheme from Section 3.1. This encryption results in a
re-encryptionfunctionsused in ourimplementation,as
setoflockboxesstoredwiththe(cid:2)ledata,eitherin(cid:2)leor
wellasapplication-levelbenchmarksmeasuring(cid:2)lesys-
directoryinodes (per-(cid:2)le and per-directoryencryption)
tem performance. To provide a standard of compari-
orwithintheblocksthemselves(per-blockencryption).
son,weconductedthesameexperimentsonanunmodi-
Theproxyre-encryptionmakesthesealedlockbox512
(cid:2)edChefscon(cid:2)gurationwithnoaccesscontrolserveror
bits,eventhoughitstillonlyprotectsa128-bitAESkey.
proxyre-encryption,usingonlyasinglepresetAESkey
Whenaclientencountersablockforwhichitdoesnot
tosecurethecontentsofthedatabase.
possess a content key, it asks the access control server
to re-encrypt the lockbox from the master key to the
client’spublickey.Iftheaccesscontrolserverpossesses Experimental Setup. For the purposes of our test-
anappropriatere-encryptionkeyforthisclientandmas- ing, we used two machines to benchmark the proxy-
terkey,itperformstheappropriateproxyre-encryption enabled Chefs (cid:2)le system. The client machine con-
and returns the result to the client, which can then de- sisted of an AMD Athlon 2100+ 1.8 GHz with 1 GB
cryptthelockbox.Figure1illustratesthisprocedure. RAM and an IBM 7200 RPM, 40 GB, Ultra ATA/100
Each re-encryption call necessarily results in a hard drive. The server machine was an Intel Pentium
round-trip network request, in addition to the proxy 4 2.8 GHz with 1 GB RAM and a Seagate Barracuda
re-encryption and client-side decryption of the re- 7200 RPM, 160 GB, Ultra ATA/100 hard drive. BothParameter Encryption Decryption Re-encryption Decryption
size (byoriginalrecipient) (bydelegatee)
256-bit 3.1ms 8.6ms 8.4ms 1.5ms
512-bit 7.7ms 21.9ms 21.7ms 3.4ms
Table2.AverageoperationtimesforthebilinearElGamalproxyre›encryptionschemeon
ourclientmachine. Alloperationsrefertore›encryptable(cid:147)second›level(cid:148)ciphertexts.
systems were running Debian testing/unstable. The tend to be the least ef(cid:2)cient (and least practical) when
client and the server were situated in different cities, proxyre-encryptionisenabled.
representingadistributed(cid:2)lesystemscenario.Wemea-
suredthe round-triplatencybetweenthe two machines
Small-(cid:2)leBenchmark. TheSFSROandChefsbench-
at13ms,andthemaximumsustainedthroughputofthe
markseachgenerate2,022RPCs tofetchcontentfrom
networklinkat 7 Mbit/sec. We implementedthecryp-
theblockstore(1,000(cid:2)les,10directories,andoneroot
tographic primitives for the bilinear El Gamal scheme
directory(cid:151)eachgeneratingtwoRPCs: oneforthein-
using version 4.83 of the MIRACL cryptographic li-
ode,oneforthecontent).
brary[35],whichcontainsef(cid:2)cientimplementationsof
Note that Chefs adds virtually no discernible over-
the Tate pairingas well as fast modularexponentiation
head,eventhoughtheclientdecryptseverycontentfetch
andpointmultiplication.
with 128-bit AES in CBC mode. With the round-trip
timeaccountingforatleast26secondsofthemeasure-
ment, the network overshadows the cost of cryptogra-
Cryptographic Benchmark. Average times for the
phy.
cryptographic operations in the bilinear proxy re-
Theproxyre-encryption(cid:2)lesystem(cid:2)rstmakes2,022
encryptionscheme(thethirdonefromSection3.1)are
fetches of content, just like Chefs. With per-(cid:2)le gran-
giveninTable2,andprovidesomebasisforunderstand-
ularityofcontentkeys,thesmall-(cid:2)lebenchmarkgener-
ing the impact of the proxy re-encryption on overall
ates1,011re-encryptionRPCs. Theproxyre-encryption
(cid:2)lesystemperformance. Theseresultsindicatethatre-
(cid:2)le system takes about 44 seconds longer than Chefs.
encryptionistheoneofthemosttime-consumingofthe
We attribute39seconds ofthis differencetothe13ms
cryptographicoperations performedin our (cid:2)le system.
round-trip time, 21.7 ms re-encryption time on the
Inour(cid:2)lesystem,weuse512-bitproxyre-encryptionto
server, and 3.4 ms delegatee decryption time on the
protectcontentkeysinlockboxes.
clientforeachRPC (See Table2). We hopetoexplain
We conductedour benchmarksusing the 512-bitpa-
the remaining 5 seconds by conducting measurements
rameter size for the proxy re-encryption scheme, and
onisolatedportionsofourclientcode.
various encryption granularities, including per-block
With per-blockgranularity, the small-(cid:2)le benchmark
and per-(cid:2)le. Our microbenchmarks, presented in Fig-
generates2,022re-encryptionRPCs. A(cid:2)leordirectory
ures 2 and 3, include runs of the small-(cid:2)le and large-
consistsofaninodeanddatablock,thuseachreadnow
(cid:2)letestsfromtheLFSsuiteof(cid:2)lesystemperformance
generatestwo re-encryptions. The proxyre-encryption
tests [33]. We use the read phases of the LFS test to
(cid:2)le system takes about 87 seconds longer than Chefs.
measurethefundamentalperformanceofoursystem.
Becausetheper-blockre-encryptiongeneratestwiceas
The (cid:2)rst test consists of a sequential read of a large
many re-encryption RPCs as the per-(cid:2)le scenario, the
(cid:2)le.Thesecondtestreadsseveralsmall(cid:2)les.Thesetwo
resultsconcurwithourexpectations.
tests capture common workloads in a typical (cid:2)le sys-
tem. Foreachofthesetests,weexperimentedwithdif-
ferentencryptiongranularities,includingper-blockand Large-(cid:2)le Benchmark. The large-(cid:2)le benchmark
per-(cid:2)lesettings. Thesmall(cid:2)lebenchmarkinparticular generates 5,124RPCs to fetch 40 MB of content from
isaworst-casescenarioforaproxy-enabled(cid:2)lesystem, theblockstore(twoRPCsfortherootdirectory,twofor
asit requiresalargenumberoflockboxre-encryptions the(cid:2)le, and5,120forthe(cid:2)ledata). IntheSFSROand
relativetotheamountofdataread. Ontheotherhand, Chefsexperiments,the7MBitbandwidthlargelydomi-
the large-(cid:2)le case tends to exhibit exactly the opposite natesthethroughput.
effect,astheratioofre-encryptionstodatareadismuch Becausethelarge-(cid:2)leworkloadinvolvesonlyasingle
smaller. In general, all per-block encryption scenarios (cid:2)le, the per-(cid:2)le proxyre-encryptionhas no discernible100
50
0
)sdnoces(
emit
daeR
S C P P
F S
R O
h e
f s
e r
fil
ee r
b l o
c
k
Proxy
Re-encryption
Figure 2. Small›(cid:2)le microbenchmark from
LFSsuite. Weperformacompletereadon
1,0001KB(cid:2)lesdispersedin10directories.
0.8
0.6
0.4
0.2
0.0
)s/setyBM(
tuphguorhT
cost. There are a mere two proxy re-encryptionRPCs
(onefortheroot,oneforthe(cid:2)le). Theper-blockproxy
re-encryptiongenerates5,124re-encryptionRPCs,thus
we expect a signi(cid:2)cant degradation of throughput be-
causeofthenumberofextraround-trips.
The cost of per-block re-encryption is prohibitively
expensive for large (cid:2)les. We expect that per-(cid:2)le gran-
ularityorper-(cid:2)le-systemgranularitywillbemuchmore
common than per-block granularity. For instance, we
donotexpectuserstograntaccesstoportionsofasin-
gle (cid:2)le. Rather, we expect users would share access-
controlledcontentincollectionsof(cid:2)les (cid:151)similarto a
collectionofWebpagesoradirectorysubtree.
Application-levelBenchmark. Ourapplication-level
benchmarkconsistsofanEmacsversion21.3compila-
tion. Thesourcecodeisstoredinour(cid:2)lesystem,while
the resulting binaries are written to a local disk. This
workload requires access to approximately 300 (cid:2)les.
The results of this test are presented in Figure 4, and
show that the per-(cid:2)le and even per-block proxy cryp-
tography adds negligible overhead for this application
workload. We believethecost is nominalfortheaddi-
tionalsecuritysemanticsofproxyre-encryption.
Scalability. We also measured how well the access
control server performs under a heavy load. Figure 5
showsthatourproxyre-encryptionservercanscaleupto
1,000pendingrequestsbeforeexhibitingsignsofstress.
Wereplayedatraceofproxyre-encryptionRPCs. This
required no computation on the client side, but caused
the servertoperformproxyre-encryption. We start by
issuingasinglerequest,waitingfortheresponsebefore
issuinganotherrequest.Tosimulatemanysimultaneous
clients, we gradually increase the window size of out-
standingRPCs.
Our server is able to sustain 100 re-encryptions/sec
until reaching about 1,000 outstanding requests. The
server coped with up to 10,000 outstanding re-
encryption requests, but quickly spiraled downwards
thereafter. Note that ourserver is faster than the client
machine,abletoperformasingleproxyre-encryptionin
S C P P
F S
R O
h e
f s
e r
fil
ee r
b l o
9ms.
Proxyc k 4.3.Discussion
Re-encryption
Ouraccesscontrolserveractslikeacredentialsdown-
load service. For instance, PDM [31] stores encrypted
Figure 3. Large›(cid:2)le microbenchmark from
credentialsonaserver. Auserdecryptsthecredentials
LFS suite. We perform a sequential read
with a password. PDM works (cid:2)ne when an encrypted
ona40MB(cid:2)lein8KBblocks.
credential is available to a single individual. However,
our(cid:2)lesystemsupportsgroupaccesscontrol.Wecould150
100
50
0
)sdnoces(
emit
elipmoC
S C P P
F S
R O
h e
f s
e r
fil
ee r
b l o
c
k
Proxy
Re-encryption
Figure4.Application›levelbenchmark. We
recordthetimetocompileEmacs version
21.3.
100
80
60
40
20
0
1 10 100 1000 10000
Number of clients
)s/snoitpyrcne-eR(
tuphguorht
revreS
use PDM instead of our access control server, but this
would reduce the key distribution problem to that of
sharingapasswordwithallgroupmembers.
We selected a single-writer, many-reader(cid:2)le system
ratherthanageneralpurpose(cid:2)lesystemto experiment
with proxy re-encryption in content distribution. This
eliminates problems not directly related to proxy re-
encryption,suchasforkconsistency[29].
In practice, an organization’s data may consist of
manydistinct(cid:2)le sets orequivalenceclasses, accessto
eachofwhichshouldbelimitedtoasubsetoftheorga-
nization’smembers.Forinstance,alargecompanywith
several departments might wish to keep data from in-
dividualdepartmentscon(cid:2)dentialwithintheoriginating
department. However, an access control server shared
withotherdepartmentswouldhaveadvantagesinrelia-
bility and logging. This can easily be achieved by us-
ingmanydifferentmasterkeys,eachofwhichencrypts
content keys for (cid:2)les owned to a different group. The
correspondingsecretkeyscanbeheldbydifferentcon-
tentowners,whoseonlyoperationalresponsibilityisto
generatere-encryptionkeysfornewusers.
Becausethereisnofundamentaldifferenceinformat
betweenamasterpublickeyandauser’spublickey,in-
dividual users can use their own public keys as master
keys, allowing users to act as content owners of their
own personal (cid:2)le sets. Additional possibilities can be
achievedifmultiple(cid:2)lekeysareusedtoencryptsingle
(cid:2)les, allowing for (cid:2)les that are available only to users
whobelongtomultiplegroupssimultaneously.
Webelievethatourexperimentalresultsdemonstrate
the practicality of proxy re-encryption in protecting
storedcontent.Thoughproxyre-encryptionaddsalevel
ofoverheadto(cid:2)lesystem,thisoverheadisnotextreme,
andcanbeworththeadditionalsecuritythatcomesfrom
centralizingaccesscontrolatasemi-trustedaccesscon-
trol server. Various system choices, such as parameter
sizes and encryption granularity can greatly affect the
ef(cid:2)ciencyofthe system; we have selectedthe ones we
believetobemostpromising.
5.Conclusions
In this paper, we explored proxy re-encryptionfrom
a predominately systems perspective. We outlined the
characteristics and security guarantees of previously
known schemes, and compared them to a suite of im-
Figure5.Aggregateaccesscontrolserver
provedre-encryptionschemes we present overbilinear
throughput. The server cantolerate 1,000
maps. These pairing-based schemes realize important
simultaneous re›encryption requests be›
newfeatures,suchassafeguardingthemastersecretkey
foreshowingsignsofsaturation.
of the delegatorfrom a colluding proxyand delegatee.
One of the most promising applications for proxy re-encryptionisgivingproxycapabilitiestothekeyserver [7] D. Boneh and M. Franklin. Identity-based encryption
ofacon(cid:2)dentialdistributed(cid:2)lesystem;thiswaythekey from the Weil Pairing. SIAM Journal of Computing,
serverneednotbefullytrustedwithallthekeysofthe 32(3):586(cid:150)615,2003.
[8] D.Boneh,C.Gentry,B.Lynn,andH.Shacham. Aggre-
systemandthesecretstorageforeachusercan alsobe
gateandveri(cid:2)ablyencryptedsignatures.InProceedings
reduced.Weimplementedthisideainthecontextofthe
of Eurocrypt ’03, volume 2656 of LNCS, pages 416(cid:150)
SFSRO(cid:2)lesystem,andshowedexperimentallythatthe
432,2003.
additional security bene(cid:2)ts of proxy re-encryptioncan
[9] D.Boneh,H.Shacham, andB.Lynn. Shortsignatures
bepurchasedforamanageableamountofrun-timeover- fromtheWeilpairing. InProceedingsofAsiacrypt’01,
head. Weleaveopenthetheoreticalproblemof(cid:2)nding volume2248,pages514(cid:150)532,2001.
a proxy re-encryption scheme that does not allow fur- [10] J. H. Cheon and D. H. Lee. Dif(cid:2)e-Hellman problems
ther delegations; that is, Bob (plus the proxy) can not and bilinear maps. Cryptology ePrintArchive: Report
delegatetoCarolwhatAlice hasdelegatedtohim. We 2002/117,2001.
[11] R.Cramerand V.Shoup. Universalhash proofs and a
also leave open the practical problemsof (cid:2)ndingmore
paradigm for adaptive chosen ciphertext securepublic-
ef(cid:2)cientimplementationsofsecureproxyre-encryption
key encryption. In Proceedings ofEurocrypt ’02, vol-
schemes,aswellasconductingmoreexperimentaltests
ume2332ofLNCS,pages45(cid:150)64,2002.
inotherapplications. [12] Y. Dodis, M. K. Franklin, J. Katz, A. Miyaji, and
Chefs is part of the SFSRO code base available via M.Yung. Intrusion-resilientpublic-key encryption. In
CVS from www.fs.net. Source code for our proxy Proceedings of CT-RSA ’03, volume 2612 of LNCS,
re-encryption library and (cid:2)le system is available upon pages19(cid:150)32,2003.
emailrequest. [13] Y. Dodis, M. K. Franklin, J. Katz, A. Miyaji, and
M.Yung. Agenericconstructionforintrusion-resilient
public-key encryption. InProceedings ofCT-RSA’04,
Acknowledgments. WearegratefultoSrinathAnan-
volume2964ofLNCS,pages81(cid:150)98,2004.
tharaju,JanCamenisch,FransKaashoek,MaheshKalla- [14] Y.DodisandA.Ivan. Proxycryptographyrevisited. In
halla, Ron Rivest, and the anonymous reviewers for ProceedingsoftheTenthNetworkandDistributedSys-
helpful comments and discussions. Thanks also to temSecuritySymposium,February2003.
DavidLiben-NowellforhisLATEXexpertise. Thiswork [15] Y.Dodis, J.Katz, S.Xu, and M.Yung. Key-insulated
publickeycryptosystems. InProceedingsofEurocrypt
was partially supported by an NDSEG Graduate Re-
’02,volume2332ofLNCS,pages65(cid:150)82,2002.
searchFellowship,anIntelPhDFellowship,andaNSF
[16] T.ElGamal. Apublickeycryptosystemandasignature
grant.
schemebasedondiscretelogarithms. InProceedingsof
Crypto’84,pages10(cid:150)18,1984.
References [17] A.FiatandA.Shamir. Howtoproveyourself:Practical
solutions to identi(cid:2)cation and signature problems. In
[1] 104th United States Congress. Health Insurance
proceedingsofCrypto’86,volume263ofLNCS,pages
Portability and Accountability A (HIPPA), 1996.
186(cid:150)194,1986.
http://aspe.hhs.gov/admnsimp/pl104191.htm; Last ac- [18] K. Fu. Group sharing and random access in cryp-
cess:August16,2004. tographic storage (cid:2)le systems. Master’s thesis, Mas-
[2] A.Adya, W.Bolosky, M. Castro, R.Chaiken, G.Cer- sachusettsInstituteofTechnology,May1999.
mak,J.Douceur,J.Howell,J.Lorch,M.Theimer,and [19] K.Fu. Integrityandaccesscontrolinuntrustedcontent
R. Wattenhofer. Farsite: federated, available, and re- distributionnetworks. PhDthesis,MassachusettsInsti-
liablestoragefor an incompletely trustedenvironment. tuteofTechnology,Manuscript.
SIGOPSOper.Syst.Rev.,36(SI):1(cid:150)14,2002. [20] K.Fu,M.F.Kaashoek,andD.Mazie(cid:30)res.Fastandsecure
[3] J.H.An,Y.Dodis,andT.Rabin.Onthesecurityofjoint distributedread-only(cid:2)lesystem. ACMTrans.Comput.
signatureand encryption. InProceedings ofEurocrypt Systems,20(1):1(cid:150)24,2002.
’02,volume2332ofLNCS,pages83(cid:150)107,2002. [21] S. D. Galbraith, K. Harrison, and D. Soldera. Imple-
[4] J.Baek,R.Steinfeld,andY.Zheng. Formalproofsfor mentingthetatepairing.InProceedingsoftheAlgorith-
the security of signcryption. In Proceedings of Public micNumberTheorySymposium,volume2369ofLNCS,
Key Cryptography ’02, volume 2274 of LNCS, pages pages324(cid:150)337,2002.
80(cid:150)98,2002. [22] E.-J. Goh, H. Shacham, N. Modadugu, and D. Boneh.
[5] M. Blaze. A cryptographic (cid:2)le system for UNIX. In SiRiUS:Securingremoteuntrustedstorage.InProceed-
ACMConferenceonComputerandCommunicationsSe- ingsoftheTenthNetworkandDistributedSystemSecu-
curity,pages9(cid:150)16,1993. ritySymposium,pages131(cid:150)145,February2003.
[6] M.Blaze,G.Bleumer,andM.Strauss.Divertibleproto- [23] S.Goldwasserand S.Micali. Probabilisticencryption.
colsandatomicproxycryptography. InProceedingsof Journal of Computer and System Sciences, 28(2):270(cid:150)
Eurocrypt’98,volume1403,pages127(cid:150)144,1998. 299,1984.[24] P. Golle, M. Jakobsson, A. Juels, and P. F. Syverson. [39] L. Zhou, M. A. Marsh, F. B. Schneider, and A. Redz.
Universal Re-encryption for Mixnets. In Proceedings Distributedblinding for ElGamalre-encryption. Tech-
ofCT-RSA’04,volume2964ofLNCS,pages163(cid:150)178, nicalReport2004(cid:150)1924,CornellComputerScienceDe-
2004. partment,2004.
[25] A.HarringtonandC.Jensen.Cryptographicaccesscon-
trolin a distributed (cid:2)lesystem. In Proceedings of 8th
A. De(cid:2)nition of Unidirectional Proxy En-
ACMSymposium on Access ControlModels and Tech-
nologies (SACMAT 2003), Villa Gallia, Como, Italy, cryption
June2003.ACM.
[26] M.Jakobsson. Onquorumcontrolledasymmetricproxy De(cid:2)nitionA.1(UnidirectionalProxyRe-encryption)
re-encryption. InProceedingsofPublicKeyCryptogra- A unidirectionalproxyre-encryptionscheme is a tuple
phy,pages112(cid:150)121,1999. of (possibly probabilistic) polynomial time algorithms
[27] A. Joux. A one-round protocol for tripartite Dif(cid:2)e- (KG;RG;E~;R;D~),wherethecomponentsarede(cid:2)ned
Hellman. InProceedingsofANTS-IVconference, Lec- asfollows:
ture Notes in Computer Science., volume 1838, pages
385(cid:150)394,2000. (cid:15) (KG;E~;D~) are the standard key generation, en-
[28] M.Kallahalla,E.Riedel,R.Swaminathan,Q.Wang,and
cryption,anddecryptionalgorithmsfortheunder-
K.Fu. Plutus(cid:150)scalablesecure(cid:2)lesharingonuntrusted lying cryptosystem. Here E~ and D~ are (possibly
storage. InProceedingsoftheSecondUSENIXConfer-
singleton)setsofalgorithms.Oninputthesecurity
enceonFileandStorageTechnologies,March2003.
parameter1k,KGoutputsakeypair(pk;sk). On
[29] J.Li,M.N.Krohn,D.Mazie(cid:30)res,andD.Shasha. Secure
untrusteddatarepository(SUNDR). InProceedingsof input pk A and message m 2 M, for all E i 2 E~
the 6th Symposium on Operating Systems Design and the output is a ciphertext C . On input sk and
A A
Implementation,pages91(cid:150)106,SanFrancisco,CA,De- ciphertextC , thereexistsaD 2 D~ thatoutputs
A i
cember2004. themessagem2M.
[30] M.MamboandE.Okamoto.ProxyCryptosystems:Del- (cid:15) On input(pk ;sky;pk ;sk(cid:3)), the re-encryption
egation of the Power to Decrypt Ciphertexts. IEICE A A B B
key generation algorithm, RG, outputs a key
Trans. Fund. Electronics Communications and Com-
rk for the proxy. The fourth input marked
puterScience,E80-A/1:54(cid:150)63,1997. A!B
[31] R. Perlman and C. Kaufman. PDM: A new strong with a ’(cid:3)’ is sometimes omitted; when this hap-
password-based protocol. In Proceedings of the 10th pens we say that RG is non-interactive since the
USENIXSecuritySymposium,August2001. delegateedoesnotneedtobeinvolvedinthegen-
[32] D. Reed and L. Svobodova. Swallow: A distributed eration of the re-encryptionkeys. The second in-
datastoragesystemforalocalnetwork. InA.Westand putmarkedwitha’y’maybereplacedbythetuple
P.Janson, editors, LocalNetworksforComputerCom- (rk ;sk );seeRemarkA.3formore.
A!C C
munications,pages355(cid:150)373.North-HollandPublishing
(cid:15) Oninputrk andciphertextC ,re-encryption
A!B A
Company,Amsterdam,1981.
function,R,outputsC .
[33] M.RosenblumandJ.Ousterhout.Thedesignandimple- B
mentationofalog-structured(cid:2)lesystem.InProceedings
Correctness. Informally, a party holding a secret key
ofthe13thACMSymposiumonOperatingSystemsPrin-
sk should always be able to decrypt ciphertexts en-
ciples(SOSP),pages1(cid:150)15,Paci(cid:2)cGrove,CA,October A
crypted under pk ; while a party B should be able
1991.ACM. A
[34] C.-P. Schnorr. Ef(cid:2)cient signature generation by smart to decrypt R(rk ;C ). E~ may contain multiple
A!B A
cards. JournalofCryptography,4:161(cid:150)174,1991. encryption algorithms; for example, having (cid:2)rst-level
[35] M. Scott. MIRACL library. Indigo Software.
encryptions that cannot be re-encrypted by the proxy;
http://indigo.ie/(cid:24)mscott/#download.
while second-level encryptions can be re-encrypted by
[36] V.Shoup. Lowerboundsofdiscretelogarithmsandre-
the proxyand then decryptedby delegatees. This pro-
lated problems. In Proceedings of Eurocrypt ’97, vol-
videsthesenderwithachoicegiventhesamepublickey
ume1233ofLNCS,pages256(cid:150)266,1997.
[37] F. Zhang, R. Safavi-Naini, and W. Susilo. An ef(cid:2)- whether to encrypt a message only to Alice or to Al-
cient signature scheme from bilinear pairings and its ice and, say, her secretary. Whenever a re-encryption
applications. In Proceedings of Public Key Cryp- doestakeplace,however,werequirethattheunderlying
tography ’04, volume 2947 of LNCS, pages 277(cid:150) plaintextremainconsistent(cid:150)i.e.,Bobshouldgetexactly
290, 2004. Full version of the paper available at whatAlicewassupposedtoreceive.2
http://www.uow.edu.au/(cid:24)fangguo/PKC04.pdf.
[38] Y.Zheng. Signcryptionanditsapplicationsinef(cid:2)cient 2Note, this only applies tociphertexts that were honestly gener-
publickeysolutions.InProceedingsofISW’97,volume atedbythesender;noguaranteeisimpliedinthecaseofmalformed
1396ofLNCS,pages291(cid:150)312,1997. ciphertexts.More formally, let key pairs (pk ;sk ) and computed or inferred by even a coalition of colluding
A A
(pk ;sk ),generatedaccordingtoKG,belongtopar- delegatees.ForallPPTalgorithmsA ,
B B k
tiesAandB,respectively,andletrk begenerated
A!B
accordingtoRG. Then,forallmessagesminthemes- Pr[(pk B;sk B) KG(1k);f(pk q;sk q) KG(1k)g;
sagespaceM,thefollowingequationsholdwithproba- frk RG(pk ;sk ;pk ;sk(cid:3))g;
B!q B B q q
bilityone: frk RG(pk ;sk ;pk ;sk(cid:3))g;
q!B q q B B
8E
i
2E~; 9D
j
2D~; (cid:11) A k(pk B;f(pk q;sk q)g;frk B!qg;frk q!Bg):
D (sk ;E (pk ;m))=m; (cid:11)=sk ]=(cid:23)(k):
j A i A B
9E 2E~; 9D 2D~;
i j RemarkA.3 Unfortunately, acheiving security based
D j(sk B;R(rk A!B;E i(pk A;m)))=m: on the de(cid:2)nition of the re-encryption key generation
functionRG as originallystated is very dif(cid:2)cult to re-
We provide a security de(cid:2)nition similar to that of alize. We do not know of any such scheme, includ-
IvanandDodis [14]. Althoughtheirde(cid:2)nitionwas for ing the prior work of Ivan and Dodis [14], that does
CCA2 security, they instead used CPA security for the not succumb to the follow attack: transfer of dele-
ElGamal,RSA,andIBE-basedschemes;forsimplicity, gation rights, where, on input sk and rk , one
B A!B
wefocusdirectlyonCPAsecurity.The(cid:2)rstmaindiffer- can compute rk . (Recall our discussion of non-
A!C
encebetweenourde(cid:2)nitionsisthatweconsiderthese- transferability in Section 3.) To see this in our second
curityofauseragainstagroupofcolludingparties;for andthirdschemes,considerthatoninputbandgb=a,one
example, the security of a delegator against the proxy can output (gb=a)1=b = g1=a which would allow any-
andmanydelegatees,whereastheIvan-Dodisde(cid:2)nition one to decrypt Alice’s second-level ciphertexts. Thus,
focusedonasingledelegatee. Secondly,wediscussthe we modify the de(cid:2)nition of RG to be executed with
system’s security for circular delegation where the ad- either the secret key of the delgatorAlice sk or with
A
versary watches Alice and Bob delegate to each other. bothare-encryptionkeyfromAlicetoBobrk and
A!B
Finally,weprovideanewguaranteeforthedelegator(cid:150) Bob’ssecretkeysk . ThisimpliesthatBobisallowed
B
eveniftheproxyandalldelegateescollude,theycannot totransferAlice’sdecryptioncapability. Arguably,this
recoverhismastersecretkey. Wediscusssomebene(cid:2)ts relaxedde(cid:2)nitionis notso damagingsince Alice is al-
ofthislastfeatureinRemarkA.4. readytrustingBobenoughtodelegatedecryptionrights
tohim.
De(cid:2)nitionA.2(SecurityofU.P.Re-encryption)
Let(cid:0) = (KG;RG;E~;R;D~)beaunidirectionalproxy RemarkA.4 At(cid:2)rstglance,mastersecretsecuritymay
re-encryptionscheme. seem very weak. All it guarantees is that an adver-
sary cannot output a delegator’s secret key sk . One
A
Standard Security. The underlying cryptosystem mightaskwhythisisuseful.Recall,however,thatmost
(KG;E~;D~)issemantically-secure[23]againstanyone
standardsignatureschemes,suchasElGamal[16]and
whohasnotbeendelegatedtherighttodecrypt.Thatis, Schnorr[34],areactuallyproofsofknowledgeofadis-
forallPPTalgorithmsA k,E i 2E~,andm 0;m 1 2M k, crete logarithm value, such as sk A = a 2 Z q, turned
intoasignatureusingtheFiat-Shamirheuristic[17].In-
Pr[(pk ;sk ) KG(1k);f(pk ;sk ) KG(1k)g;
B B q q tuitively, if an adversary cannot output Alice’s secret
frk RG(pk ;sk ;pk ;sk(cid:3))g; key, then the adversary cannot prove knowledge of it
q!B q q B B
f(pk ;sk ) KG(1k)g; either. Thus, using a proxyre-encryptionscheme with
h h mastersecretsecuritymeansthatausermaybeableto
frk B!h RG(pk B;sk B;pk h;sk(cid:3) h)g; safelydelegatedecryptionrights(viareleasingga)with-
frk
h!B
RG(pk h;sk h;pk B;sk(cid:3) B)g; outdelegatingsigningrightsforthesamepublickeyZa.
(m ;m ;(cid:11)) A (pk ;f(pk ;sk )g;:::
0 1 k B q q
:::fpk g;frk g;frk g); B.ProofsofSecurity
h q!B B!h
b f0;1g;b0 A k((cid:11);E i(pk B;m b)): Theorem 3.1 The scheme in Section 3.1 is cor-
b=b0]=(cid:23)(k): rect and secure under the extended decisional bilinear
Dif(cid:2)e-Hellman (EDBDH) assumption that is for ran-
Master Secret Security. The long term secrets of a dom g G 1, a;b;c Z q, and d 2 Z q, given
delegator(sometimesservingasadelegatee)cannotbe (g;ga;gb;gc;Zbc2;Zd) it is hard to decide if d (cid:17) abcmodq(standardsecurity)andthediscretelogarithmas- First, we observe that if d = abc, then the simula-
sumption(mastersecretsecurity). tionisperfect;andifd 6= abc,thenm isinformation-
b
theoretically hidden from A, since W(cid:11)(cid:12)=(cid:13)(=Zd) was
Proof.Oursecurityde(cid:2)nitionquanti(cid:2)esoverallencryp- chosenindependentlyofy(cid:11)=(ga). Thus,ifA succeeds
tion algorithms E 2 E~; in this case, we have two al- withprobability1=2+",thenSsucceedswithprobabil-
i
gorithms E ;E , where a ciphertext of the (cid:2)rst form ity1=2+"=2.ThiscontradictstheeDBDHassumption.
1 2
(Zk;mZa1k) can bepubliclycomputedfroma cipher- MasterSecretSecurity.SupposeanadversaryAcan
textofthesecondform(gk;mZa1k)viae(g;gk)=Zk.
recoverthe secret keyof a targeteduser T (i.e., sk =
t
Thus,itsuf(cid:2)cestoarguethesecurityofE 2 only. (t 1;t 2)) with non-negligible probability by interacting
Standard Security.3 Suppose A distinguishes en- with T according to the second part of de(cid:2)nition A.2,
cryptionsofE withnon-negligibleprobability,wesim- thenwecanbuildanadversarySthattakesdiscretelogs
2
ulateanadversaryS thatdecideseDBDHasfollows: inG . Letusfocusourattentiononrecoveringonlythe
1
valueb .OursimulatorSworksasfollows:
1. On input
(g;ga;gb;gc;Zbc2;Zd),
the simulator
1
sets y = gc, W = e(y;y), and obtains the tuple: 1. On input (g;ga) in G 1, output the global pa-
rameters (g;Z) and the target public key pk =
t
(y =gc;y(cid:11) =ga;y(cid:12) =gb;y(cid:13) =g; (Za;gt2),whereZa =e(g;ga)andt 2 isarandom
elementinZ .
W(cid:12)=(cid:13) =Zbc2;W(cid:11)(cid:12)=(cid:13) =Zd); q
2. Next,fori=1uptopoly(k),Acanrequest:
for(cid:11)= a;(cid:12) = b;(cid:13) = 1:
c c c (a) a delegation from T to a party corrupted
by A. S randomly selects r ;r
The simulator sends A the global parameters (i;1) (i;2)
(y;W) and the target public key pk = Z q, sets rk T!i gar(i;2), pk i =
(W(cid:12)=(cid:13);gt),wheretisrandomlyselectedfroT mZ . (Wr(i;1);gr(i;2)), and sk i = (r (i;1);r (i;2)),
q
andsends(pk ;sk ;rk )toA.
2. Next,fori=1uptopoly(k),Acanrequest: i i T!i
(b) a delegation to T from a party corrupted by
(a) a delegation from T to an honest party.
A. A can generate these delegations inter-
S randomly selects r (i;1);r (i;2) Z q, nally by running(pk ;sk ) KG(1k) and
s (Wets r(ir ;1k )T ;y! (cid:12)i
r(i;2)
),andy(cid:13) ser( ni d;2 s) (pa kn id ;rkp Tk !i i)t=
o
computingrk
i!T
=(i gt2)i i1.
3. Eventually, A must output a purported secret key
A.
forT oftheform((cid:11);(cid:12)). Thesimulatorreturnsthe
(b) adelegationtoT fromanhonestparty.Suses
value(cid:11).
either therecordedvaluer fromthe pre-
(i;1)
vious step if the honest party already exists,
The simulation is perfect; thus A must not be able
or generates fresh random values for a new
to recover the master secret key of T, despite accept-
party,andcomputesrk
i!T
=(gt)r(i;1).
ing and providingnumerousdelegations to T, because
(c) a delegation to T from a party corrupted by
otherwise,S canef(cid:2)cientlysolvethediscretelogarithm
A. A can generate these delegations inter- probleminG . 2
nally by running(pk ;sk ) KG(1k) and 1
i i
computingrk
i!T
=(gt)i1.
3. Eventually,Amustoutputachallenge(m ;m ;(cid:28)),
0 1
where m 6= m 2 M and (cid:28) is its internal
0 1
state information. The simulator randomly se-
lects b 2 f0;1g, computes the ciphertext c =
b
(y(cid:11);m W(cid:11)(cid:12)=(cid:13)), sends(c ;(cid:28)) toA, andwaits for
b b
Atooutputb0 2f0;1g.
4. Ifb = b0, thenS guesses(cid:147)d = abc(cid:148); otherwiseS
guesses(cid:147)d6=abc(cid:148).
3Thesemanticsecurityforauserwhoaccepts,butdoesnotgive
delegations can be reduced to the CoDDH problem; that is, given
(g;ga;Zb;Q)forrandoma;b Z q andanelementQ 2 G2,de-
cideifQ = Zab. Here,weprovesecurityforamoregeneralsetof
usersasinde(cid:2)nitionA.2.