Client-side defense against web-based identity theft
NeilChou RobertLedesma YukaTeraguchi JohnC.Mitchell
ComputerScienceDepartment,StanfordUniversity,StanfordCA94305
{neilchou,led242,yukat,jcm}@stanford.edu
Abstract experiment with this approach using a browser plug-in
called SpoofGuard. The plug-in monitors a user’s In-
ternet activity, computes a spoof index, and warns the
Webspoofingisasignificantprobleminvolvingfraud- user if the index exceeds a level selected by the user.
ulent email and web sites that trick unsuspecting users While Internet-savvy users who watch the address bar,
into revealing private information. We discuss some statusbar,andotherinformationcarefullymaynotneed
aspects of common attacks and propose a framework SpoofGuard, the current level of accuracy and effec-
for client-side defense: a browser plug-in that exam- tivenessmaybesufficienttohelpmanyunsophisticated
ines web pages and warns the user when requests for web users. If the methods we propose become widely
data may be part of a spoof attack. While the plug- deployed, through our plug-in or through other client-
in, SpoofGuard, has been tested using actual sites ob- sidedefensivesoftware,thenphisherswillcertainlytake
tained through government agencies concerned about steps to circumvent them. However, we expect further
the problem, we expect that web spoofing and other effort and study to produce correspondingly better de-
forms of identity theft will be continuing problems in fenses. Moreover,ifsynergisticserver-sidemethodsare
comingyears. deployedbyconcernedcompanies,itseemspossibleto
thwartincreasinglysophisticatedattacks.
SpoofGuard uses domain name, url, link, and
image checks to evaluate the likelihood that a
1 Introduction
given page is part of a spoof attack. For ex-
ample, a page with a suspicious url such as
Webspoofing,alsoknownas“phishing”or“carding”
etrade-maintenance.suspicious.org
[CNN03,FBI03],isasignificantformofInternetcrime
or www.etrade.com@129.170.213.101/
that is launched against hundreds or thousands of indi-
maintainance.aspandanE*Tradelogowillhave
viduals each day. The US Secret Service and the San
a higher spoof index than a page with neither of these
Francisco Electronic Crimes Task Force report that ap-
characteristics. SpoofGuard also uses history, such as
proximately30attacksitesaredetectedeachday. Each
whether the user has visited this domain before and
attacksitemaybeusedtodefraudhundredsorthousands
whether the referring page was from an email site
of victims, and it is likely that many attack sites are
such as Hotmail or Yahoo!Mail. Most importantly,
neverdetected. Atypicalwebspoofattackbeginswith
SpoofGuard intercepts and evaluates user posts in
bulk email to a group of unsuspecting victims. Each is
light of relevant history and the spoof index of a form
told that there is a problem with their account at a site
page. SpoofGuard examines post data user name and
suchasE*Trade.Victimsofthespoofingattackthenfol-
password fields and compares posted data to previ-
lowalinkintheemailmessagetoconnecttoaspoofed
ously entered passwords from different domains. This
E*Tradesite. Onceavictimentershisorherusername
mechanism warns a user against sending her E*Trade
and password on the spoof site, the criminal has the
password to a site with an E*Trade logo but outside
meanstoimpersonatethevictim,potentiallywithdraw-
the etrade.com domain, for example. Password
ingmoneyfromthevictim’saccountorcausingharmin
comparisons are done using a cryptographically secure
otherways.
hash, so that plaintext passwords are never stored by
We describe some common characteristics of recent
SpoofGuard.
web spoofing attacks and propose a framework for
Stoppingwebspoofingbearssomesimilaritytointru-
client-side countermeasures. Like other inexact detec-
sion detection, spam filtering, and thwarting traditional
tion mechanisms, including virus detection and email
social engineering attacks. Intrusion detection systems
spam filtering, the approach we explore involves look-
[Pax99, Sno03] typically monitor network and host ac-
ingforcharacteristicsofpreviouslydetectedattacks.We
1tivity, compute statistical or other indices, and attempt tegrityofbrowserindicatorssuchastheurlindicatorin
to detect intrusions by comparing the index of current the status bar, not analyzing user behavior, web pages,
activityagainstpreviousstatistics. Whilewebspoofing and html post data to stop leakage of sensitive user in-
mayberegardedasaspecialcaseofintrusiondetection, formation. Whileweconsideredusinganalternateterm
thebrowserseemslikethatappropriateplacetocombat suchas“phishing”inthispaper,weuse“webspoofing”
webspoofing. Abrowserplug-inisrelativelyeasytoin- since this currently appears to be the term most com-
stallandhasaccesstohonestandspoofpagessentover monlyusedbylawenforcementandconcernedcompa-
https,givingSpoofGuardabetterchanceofcatchingan nies.
attackthananetworkproxyorotherexternalhttptraffic The goals of this paper are to raise awareness of the
monitors.Whileaplug-inalonedoesnothavefullinfor- web spoofing problem and propose a framework for
mationfromemailprogramssuchasOutlookorEudora client-side protection. While sophisticated and deter-
thatmaycontainthemessagesthatlaunchanattack,the mined attackers will be able to circumvent our current
browserdoesprovideanindicationofthereferringpage tests(throughsimpletechniquesweexplainlaterinthe
orapplication,anditispossibletoscanandparsepages paper), there is plenty of room for improving specific
fromemailsitessuchasHotmailorYahoo!Mail. There- testsandtuningthecoefficientsofourspoofindexfunc-
fore,fornon-expertuserswhoreademailthroughtheir tion. Furthermore, thewebspoofingproblemisimpor-
browser,SpoofGuardhasthepotentialtoexamineevery tantandwebelieveourSpoofGuardexperiencewillbe
stepofastandardwebspoofattack. useful for developing more sophisticated defenses. We
Likeotherintrusiondetectionefforts,itisappropriate discussthewebspoofingprobleminmoredetailinSec-
toevaluateSpoofGuardbymeasuringitseffectiveatpre- tion2,andoursolutionsinSection3. TheSpoofGuard
venting attacks, the false alarm rate (number of unnec- implementationanduserinterfacearedescribedinSec-
essary warnings), and its performance impact. Spoof- tion 4. Some SpoofGuard evaluation information ap-
Guard will only be useful if it detects attacks without pears in Section 5, followed by suggestions for server-
raising too many false alarms, since users will almost sidemethodsinSection6,somemorespeculativeclient-
certainly reject any method that interferes with normal side methods in Section 7, and concluding remarks in
browsing activity. We have evaluated the false-alarm Section8.
rate by using SpoofGuard ourselves over a period of Throughoutthepaperweusethefollowingterminol-
time, and we have evaluated its effectiveness for pre- ogy.
venting attacks using actual spoof sites brought to our • Spoofsite or Spoofpage: the siteorpage thatis a
attention by members of the San Francisco Electronic maliciouscopyofsomelegitimatewebpage.
Crimes Task Force. While this is not an extensive • Attacker: the person or organization who sets up
enough test to draw broader conclusions, SpoofGuard thespoofsite.
doescatchthesampleattacksfoundinthewildanddoes • Honest site or honest page: the legitimate site or
notaddanynoticeabledelaytoordinarywebbrowsing. pagethatisbeingspoofed.
Since web spoofing attacks begin with bulk email, a • Spoofindex:ameasureofthelikelihoodthataspe-
goodgeneralspamsolution[Bri03,Din03]couldreduce cificpageispartofaspoofattack,describedinSec-
theincidenceofwebspoofingattacks. However,current tion3.
spamsolutionsareonlypartlyeffectiveatblockingun-
A prototype version of SpoofGuard will be made pub-
wantedemail,andwearenotawareofanyspamefforts
liclyavailableshortly.
aimedspecificallyatidentifytheft. Whilethebrowser-
based techniques we explore in this paper are comple-
2 Theproblem
mentaryandindependentofspamfiltering,theremaybe
additionalwaysofcombiningemailscanningwithweb
According to Agents of the U.S. Secret Service San
pageanalysisthatwillleadtobetterspoofpreventionin
Francisco Electronic Crimes Task Force [Von03], the
thefuture.
U.S.Government’sInternetFraudComplaintCenterre-
PreviouseffortsbythePrincetonSecureInternetPro-
ceivedover75,000complaintsin2002. Ofthisnumber,
gramminggroupandothers[FBDW97,EY01]havead-
48,000casesresultedinfurtheractionrequests. Thisis
dressed another form of “web spoofing” in which an
a three-fold increase over 2001. The total dollar losses
attacker causes all html page requests from a victim
areestimatedatmorethan$54millioncomparedto$17
to pass through the attacker’s site. This form of web
millionfor2001. Amajorityofthesefraudcomplaints
spoofing allows the attacker to monitor all of the vic-
areintrusions,auctionfraud,creditcard/debitfraud,and
tim’s activities, including posted passwords or account
computer intrusion. Agents of the U.S. Secret Service
numbers. However, previous methods for countering
SanFranciscoElectronicCrimesTaskForcereportthat
thisformofattackhavefocusedonmaintainingthein-
webspoofingwasfirstnoticedinlate2001andgrewin
2popularityin2002,correlatingwiththelargeincreasein gan Stanley’s Discover unit, eBay Inc. and its Pay-
Internet Fraud. Further, a majority of the $37 million Pal unit, Wachovia Corp.’s First Union unit and the
increase in losses from 2001 to 2002 can be attributed MassachusettsStateLotteryreportedphishingscamsin
towebspoofing. AgentsworkingfraudcasesintheBay recent months. Some general information about web
Area also report that a majority of their Internet cases spoofing,includingadditionalnewsarticlesandrecords
involvewebspoofing. of actual attacks, may be found at http://www.
One factor that adds to the severity of web spoofing antiphishing.org/,awebsiteprovidedbyTum-
attacks is that many users use the same username and bleweedCommunications.
password at several sites. This allows a phisher who
2.2 Propertiesofrecentattacks
reelsinavictimtousethisinformationonmorethanone
site. Forthisreason,companiesthatprovidepassword-
Wedescribecommonpropertiesoftenspoofwebsites
protectedservicesaredependentoneachotherfortheir
recentlyfoundinthewild. Figure4givesanexampleof
security. Thisisnotonlytruewithregardtowebspoof-
anEbayspoof(partiallyobscuredbyaSpoofGuardpop-
ing,butforotherkindsofattacksaswell. Ifpasswords
upwarningtheuser).
from one site can be stolen by attacking the site itself,
• Logos. Thespoofsiteuseslogosfoundonthehon-
these may also be used at other sites that protect their
estsitetoimitateitsappearance.
passworddatabasemoreeffectively.
• Suspicious urls. Spoof sites are located on
servers that have no relationship with the hon-
2.1 Sampleattack
est site. The spoof site’s url may contain
A recent attack described in a New York Times ar- the honest site’s url as a substring (http:
ticle[HF03] actually mentioned fraudulent email, indi- //www.ebaymode.com), or may be simi-
catingsomelevelofpublicawarenessofspoofattacks. lar to the honest url (http://www.paypaI.
OnJune18,2003,thousandsoffraudulente-mailswith com). IP addresses are sometimes used to dis-
thesubject“FraudAlert”weresentout,hopingtoreach guise the host name (http://25255255255/
Best Buy customers. The e-mails attempted to con- top.htm). Others use @ marks to ob-
vince customers that Best Buy’s fraud department re- scure their host names (http://ebay.com:
quiredadditionalcustomerinformation,“inoureffortto top@255255255255/top.html), or contain
deterfraudulenttransactions.”Tofurtherlureunsuspect- suspicious usernames in their urls (http://
ing victims, the e-mail provided a link that purported middleman/http://www.ebay.com.)
to reach a “special Fraud Department” at the Best Buy • Userinput.Allspoofsitescontainmessagestofool
website. Instead, thelinkactuallypointedtoafraudu- theuserintoenteringsensitiveinformation,suchas
lentpageunrelatedtoBestBuy.TheBestBuyattacker’s password, social security number, etc. Some suc-
pageresembledanofficialBestBuypage,usingtheBest cessfulspoofshaveevenbeensoboldastoaskfor
Buy logo, incorporating elements from an official Best name, address, mother’s maiden name, driver’s li-
Buy page, and providing links to other Best Buy re- cense,andsoon.
sources.Thepagerequestedacustomer’ssocialsecurity • Shortlived. Mostspoofsitesareavailableforonly
numberandcreditcardinformation. a few hours or days – just enough time for the at-
A web page from the Michigan Attorney General tackertospoofahighenoughnumberofusers.The
[Cox03]cites“afewgiveawaystothisparticularscam:” implicationisthatdefensivemethodsthatalertthe
usertoaspoofsitearemoreeffectivethanreactive
• The [email] message did not issue from an
methodsthatattempttoshutdownthesite.
@bestbuy.comaddress,
• Copies. Attackers copy html from the honest site
• The link embedded in the message does not
and make minimal changes. Two consequences
take the user to a “special Fraud Depart-
are: (i)somespoofpagesactuallycontainlinksto
ment page” on Best Buy’s site, but to a
images(e.g. logosandbuttons)onthehonestsite,
page hosted under a completely different do-
rather than storing copies, (ii) the names of fields
main name (such as digitalgamma.com or
and html code remain as on the honest site. We
your-instant-credit-reporter.org),
notethatwhenaspoofsitereferstothehonestsite
• The “National Credit Bureau” mentioned in the
forembeddedimagesitgivesthehonestsiteanop-
scamdoesnotexist.
portunitytodetectthespoof:thehonestsitedetects
The Michigan Attorney General also points out that an http request for an embedded image where the
the Best Buy spoof is similar to spoofs imitating Pay- referralheaderisnotthehonestsite. Suchrequests
Pal and eBay. A more recent Dow Jones Newswires shouldnotoccurunlessthehonestsiteisbeingpla-
story [Ber03] states that EarthLink, Citibank, Mor- giarized.
3• Sloppiness or lack of familiarity with English. commonlyusedinintrusiondetectionsystemsandspam
Many spoof pages have silly misspellings, gram- filters[Din03].
maticalerrors,andinconsistencies.IntheBestBuy The scoring function not only sums individual tests,
scam,thefakewebpagelistedatelephonenumber butalsosumsproductsofpairs, triples, andlargersub-
with a Seattle area code for a Staten Island, NY, setsoftests. Thereasonforproducttermsisthatwhen
mailingaddress. certain combinations of events occur the likelihood of
• HTTPSisuncommon. Mostspoofwebsitesdonot thepagebeingaspoofincreasesdramatically.Forexam-
usehttpsevenifthehonestsitedoes. Thissimpli- ple,ifacompanylogoappearsonanunauthorizedpage
fiessettingupthespoofsite. andthepagecontainspasswordandcreditcardfields,the
pageisverylikelytobeaspoof. Consequently,theterm
3 Solutions correspondingtotheproductofthesethreetestsisgiven
substantialweight.
A number of tests can be used to distinguish spoof
pages from honest pages. We present the tests we im-
3.2 Statelesspageevaluation
plementedandevaluatedinthreegroups:statelessmeth-
odsthatdeterminewhetheradownloadedpageissuspi- Webeginbydescribingacollectionofteststhatwork
cious,statefulmethodsthatevaluateadownloadedpage byexaminingthecurrentpageonly.
inlightofprevioususeractivity,andmethodsthateval-
uate outgoing html post data. Our browser plug-in ap-
Url check There are various methods that attackers
plies these tests to all downloaded pages and combines
can use to produce misleading urls. For example, an
theresultsusingascoringmechanismdescribedbelow.
@inaurlcausesthestringtothelefttobedisregarded,
Thetotalspoofindexofapagedetermineswhetherthe
with the string on the right treated as the actual url for
plug-in alerts the user and determines the severity and
retrieving the page. Combined with the limited size of
type of alert. Since pop-up warnings are intrusive and
the browser address bar, this makes it possible to write
annoying,weattempttowarntheuserthroughapassive
urls that appear legitimate within the address bar, but
toolbar indicator in most situations. A user checkbox
actuallycausethebrowsertoretrieveapagefromanar-
caneliminateallpop-upsifdesired.
bitrarysite.
We note that server-side methods, such as tracking
server image requests, may also be effective in identi-
fyingspoofsites. However,thefocusofthispaperison Imagecheck Spoofsitesusuallycontainimagestaken
client-sidebrowsersolutions. Insection6,wecomment from the honest site. For example, the eBay logo ap-
onsomewaysthatserver-sidemodificationsmaymake pears on spoofed eBay pages to give the user the im-
ourclient-sidemethodsmorereliableandeffective. pressionthattheyarecommunicatingwitheBay. Ifthe
eBay logo appears on a login page unrelated to eBay,
3.1 Scoring thatpageissuspicious. Thesameappliestootheriden-
tifiably eBay-specific images such as banners and but-
Givenadownloadedwebpageandsomebrowserstate
tons.Wenotethatcorporatelogosoftenlegitimatelyap-
as input, our plug-in applies tests T ,...,T , with test
1 n pearonmanye-commercesites(e.g.,theAmazonlogo
T producing a number P in the range [0,1]. By con-
i i appearsonsitesthatsellproductsthroughAmazon)and
vention,P = 1indicatesthatthepageislikelytobea
i therefore we only count this test for pages that ask for
spoof and P = 0 indicates the opposite. Most of our
i privateuserinput.
tests return either 0 or 1, but some can return a value
In order to apply this check in a stateless way, the
between0and1.
SpoofGuardplug-inissuppliedwithafixeddatabaseof
We combine the test results into a total spoof score,
images and their associated domains. Since attackers
TSS,usingastandardaggregationfunction:
generally do not have email lists for customers of spe-
(cid:80)
TSS(page) = n w P cificsites,theymusttrytospoofsitesthatareusedbya
(cid:80)i=1 i i
+ n w P P significantfractionofwebusers. ThusSpoofGuardcan
(cid:80)i,j=1 i,j i j
+ n w P P P be useful even if we only account for relatively small
i,j,k=1 i,j,k i j k number of frequently spoofed domains such as eBay,
+ ...
PayPal,AOL,andsoon. Whenthebrowserdownloads
Thew’sarepresetweightsselectedtominimizethefalse aloginpageallimagesonthepagearecomparedtoim-
alarmrate. Notethatmostofthew’saresettozeroso ages in the SpoofGuard database. The spoof-score for
thattheactualnumberoftermsintheexpressionisrel- thepageisincreasedifamatchisfoundbutthepage’s
atively small. This approach of applying multiple tests domainisnotavaliddomainfortheimage.
andcombiningtheresultsusingascoringmechanismis Whatifthespoofpagecontainsaslightmodification
4oftherealimage? Theimagecomparisontestmightfail Referring page When a user follows a link, the
todetectthespoof. Fortunately,asnotedearlier,attack- browsermaintainsarecordofthereferringpage. Since
ers often directly copy or link to images on the honest the typical web spoofing attack begins with an email
site. Nevertheless,wedefendagainstsmallimagemod- message,areferringpagefromawebsitewheretheuser
ification by storing an image hash rather than the ac- may have been reading email (such as Hotmail) raises
tualimage. Imagehashingreferstoahashingalgorithm thelevelofsuspicion.Onecomplicationassociatedwith
that produces the same hash for similar images. While Hotmail, for example, is that Hotmail uses numeric IP
presenttechnologydoesnotprovideidealimagehashes, addresses instead of symbolic host names. Therefore,
therehasbeensomeprogressinthisarea[VKJM00]. In when a user clicks on a link in a Hotmail message, the
our case, image hashing can be strengthened by asking browser provides a numeric IP address to SpoofGuard
e-commercesitestouseimagesthatareespeciallywell asthereferringpage. Inthissituation,SpoofGuarduses
suited for image hashing. For example, in many cases reverseDNStofindthedomainnameassociatedwitha
wecoulduseopticalcharacterrecognition(OCR)asthe numericaddress,allowingustoidentifyHotmailasthe
image hashing algorithm. An added benefit of image referringsite.
hashingisthatstoringanimagehashratherthanthefull
imagereducesplug-instoragerequirements.Wediscuss
Image-domain associations The image check de-
otheraspectsofthistestinSection5.3.
scribed above (in section 3.2) relies on a database as-
sociatingimagessuchascorporatelogoswithdomains.
Linkcheck Thelinkscontainedwithinapageareex- Theinitialstaticdatabasecanbeassembledusingaweb
amined. The link check fails for a page if at least one- crawlerorothertool,oritcanbeaugmentedusinganin-
fourthofthelinksfailtheurlcheckdescribedabove. dividual’sbrowsinghistory. AnearlyversionofSpoof-
Guard used a fixed database; the current SpoofGuard
implementationusesahashedimagehistoryfile.
Passwordcheck Pagesthatrequestapasswordmerit
closer scrutiny than pages that do not. If a page re-
3.4 Evaluatingpostdata
quests a password (or other sensitive information), we
alsocheckwhetherhttpsisusedand,ifso,whetherthe
Evaluatingpostdataisacriticalpartofanyclient-side
certificatechecksucceededorfailed.
defense against web-spoofing attacks, since the point
of any defense is to prevent malicious sites from gain-
3.3 Statefulpageevaluation
ing confidential information from an honest web user.
When a user fills in form data, SpoofGuard intercepts
In stateful page evaluation, the browser history file
and checks the html post data, allowing the actual post
andadditionalhistorystoredbySpoofGuardareusedto
to proceed only if the spoof index is below the user-
evaluatethereferringpage. Sinceitisimportanttomin-
specific threshold for posts. If a user confines pop-up
imizethenumberoffalsealarms,SpoofGuarddoesnot
warningstopostsonly,thentheuserwillneverbeinter-
issueanywarningsforvisitingasitethatisintheuser’s
rupted when reading web pages, only (possibly) when
history file. The rationale for this is that if the user is
fillinginforms. Note,however,thatevenifnowarnings
warnedthefirsttime,anddecidestoproceed,theuseris
aregeneratedonpagesleadinguptothespoofform,the
assumedtohavesufficientreasontotrustthesite.
page checks described above are used, in combination
with analysis of the post data, to determine the spoof
Domaincheck Ifthedomainofapagecloselyresem-
indexassociatedwithanhtmlpost.
bles a standard or previously visited domain, the page
may be part of a spoof. Although crude, we currently
Outgoing password check SpoofGuard maintains a
comparedomainsbyHamming(edit)distance. Forex-
database of (cid:104)domain, user name, password(cid:105) triples. If
ample efrade.com will raise the domain check if
the user reuses a password on a new domain, this
etrade.comisinthefileofcommonlyspoofedsites
trips the password check. To avoid the possibility of
orintheuserhistory. Clearly, itispossibletoimprove
leaking sensitive information, the stored passwords are
our comparison algorithm by studying the way people
hashed using SHA-1 and the comparison is performed
arefooled;thisisasignificantdirectionforfuturework.
onhashedvalues.
Arelatedissueisthatsomebusinessesoutsourcesome
oftheirweboperationstocontractorswithdifferentdo-
main names. This poses an interesting challenge that Interactionwithimagecheck Inourspoofindexcal-
webelievecanbeaddressed. However,outsourcedweb culation, the image check interacts with the outgoing
activity leads to false alarms in the current version of passwordchecknon-linearly. Forexample,ifauseren-
SpoofGuard. tersherE*Tradeusernameandpasswordtoasitethatis
5notatetrade.com,thisraisethespoofindexacertain 4.1 Plug-in interface and access to browser
amount (determined in part by user-selected weights). data
The spoof index is raised multiplicatively higher if the
SpoofGuard consists of a COM component that ex-
sitealsocontainstheE*Tradelogo.
tends IDeskband, an interface that causes IE to load
SpoofGuard as a registered toolbar, and a few other
modules that run in response to actions of the toolbar
Check of all post data There are several ways that
component. SpoofGuard is written in Visual C++, and
a web page might request a password. For example, a
uses both Windows Template Library (WTL) 7.0 and
cleverspoofsitemightuseanimageoftheword“pass-
MicrosoftFoundationClassLibrary(MFC).TwoSpoof-
word” instead of html text to request the user’s pass-
Guard window classes implement the CWindowImpl
word. To protect against this form of spoof attack, all
interface to define the appearance and user interaction
outgoingdatainanhtmlpostcanbehashedandchecked
of the toolbar. The interaction between the main mod-
against a database of passwords and other information
ules,describedbelow,isshowninFigure1.
deemed sensitive. In this way, we can still detect pass-
• WarnBar: This is a COM component that houses
word leakage, even if the spoof page does not contain
the SpoofGuard toolbar. All site evaluations and
thetext“password.”
postdatachecksarecarriedouthere.
• ReflectionWnd: ThisCWindowImplclassimple-
mentsatransparentwindowthatsitsontopofthe
Exceptionforsearchengines Sinceausermayenter
toolbar and reflects user messages (e.g. mouse
anydataintoasearchengine,SpoofGuardisnotsuspi-
clicks)toUWToolBar. WarnBarrequestsReflec-
cious of known search engines at known domains. It
tionWnd to pop-up a warning message when the
is also possible to ignore data posted into a “search”
user tries to send sensitive information to a suspi-
or “find” field in an arbitrary page. This allows for
ciousserver.
shopping sites, for example, that allow a customer to
• UWToolBar:ThisCWindowImplclassdefinesthe
search the catalog by keyword or product name. Of
appearance of the toolbar. UWToolBar stores the
course, goodpasswordpracticewouldpreventanintel-
usersettings(e.g.checkindex,threshold,etc.)dur-
ligentuserfromusingaproductnameorotherEnglish
ing runtime. WarnBar requests UWToolBar for
wordasanimportantpassword,renderingthisexception
these settings to determine the traffic lights color
unnecessary.
and the warning messages that appear in the Cur-
rentPageStatusdialog. Usersettingsarestoredin
4 SpoofGuardarchitecture theregistrywhenSpoofGuardcloses.
• ConfigDlg opens an Options window when the
user clicks the Options button. UWToolBar up-
SpoofGuard is an Internet Explorer browser helper
datestheusersettingsbasedontheresultthatCon-
object,or“plug-in.” AbrowserhelperobjectisaCOM
figDlgreturnswhenthewindowterminates.
component that is loaded when IE starts up; it runs
• DomainDlgopenstheCurrentPageStatuswindow
in the same memory context as the browser. In gen-
whentheuserclicksonthetrafficlighticon.Itcon-
eral, a browser helper object may perform any action
tains the warning messages specific to the current
onIEwindowsandmodules,includingmanipulatingthe
page.
browsermenuandtoolbar, detectingandrespondingto
browserevents,andcreatingadditionalwindows.
SpoofGuardaccessestheInternetExplorerhistoryfile Browser data and events When Internet Explorer
and uses three additional files stored in the user profile launches, it calls the SetSite method in the IOb-
directory. Oneisaread-onlyfileofhostnamesofemail jectWithSiteinterfacetoinitializeWarnBar. WarnBar
sites such as Hotmail and Yahoo!Mail, used in the re- receivesapointertothewebbrowserobject,andpasses
ferring page check. The other two files are the file of the object to the ReflectionWnd and UWToolBar, al-
hashedpasswordhistory(domain,username,andpass- lowing SpoofGuard to constantly check the browser
word)andthefileofhashedimagehistory. SpoofGuard contents during execution. Internet Explorer’s DWeb-
canusereverseDNStofinddomainnamesfornumeric BrowserEvents2 class exports BeforeNavigate2 and
IPaddresses,butdoesnototherwisesendorreceiveany DocumentComplete event handlers, which are both
information on the network. The browser history file implemented in WarnBar class. A BeforeNavigate2
can be reset using a browser dialog box and the addi- eventoccursbeforenavigation.ThisgivesWarnBarthe
tional SpoofGuard histories can be reset using a button urlthatthebrowserisattemptingtonavigateto,theout-
ontheSpoofGuardconfigurationpanel. going post, and a chance to cancel the navigation. The
6ReflectionWnd ConfigDlg
Sends user messages
(e.g. button click)
Requests Options window
(user settings) to pop up.
Requests a pop
up warning if
WarnBar shows
UWToolBar
that a site’s total
alert value is
higher than the
Requests Current Page
user’s threshold.
Status window to pop up.
Sends current user
settings (e.g. weight
values, alert level)
WarnBar DomainDlg
Figure1.SpoofGuardarchitecture
7providers(e.g., Hotmail)providelinkstootherpartsof
theirserviceusingnumericIPaddressesinsteadofsym-
bolichostnames.Givenanumericaddress,SpoofGuard
performsareverse-DNSlookuptorevealthehostname.
Figure2.SpoofGuardtoolbar
Anotherwaytoestimatethelikelihoodthatanemaillink
was used is to see whether the referrer field is empty.
urlcheckusingthehistorylist,thedomainnamecheck, Thereferringpagefieldisemptywiththebrowserisini-
the email referring page check and post data check are tiallystarted,andwhentheusertypesinaurl. Although
carried out after a BeforeNavigate2 event. A Docu- an empty referrer field does not always imply that the
mentComplete event occurs when a web site finishes user has clicked on an e-mail link, the field is empty if
loading completely. The image check, link check, and the user launches the browser through a link in his or
passwordcheckarecarriedoutafteraDocumentCom- here-mailsoftware. Whileitisconservativetotreatan
pleteevent. emptyreferrerfieldinthesamewayasalinkfromHot-
mail, this may give false alarms since the referrer field
4.2 Userinterface is empty whenever a new Internet Explorer window is
opened.
The SpoofGuard toolbar is shown in Figure 2. The
options button can be used to configure the tool, while
Differentinputnamesforusernamesandpasswords
the traffic light (green, yellow, or red) provides an in-
Since different sites have different input field names
dication to the user about the current page. Clicking
forusernamesandpasswords,twentyusernameandten
on the traffic light also pops up additional information
password variations are predefined in SpoofGuard, and
aboutthecurrentpage. Whenthespoofratingisabove
they are used to identify sensitive information in the
theuser-specifiedthreshold,SpoofGuardwillpop-upan
obtained post data structure. These predefined names
additionalwarningwindowthatrequiresuserconsentto
are used by many online bank forms, commercial sites
senduserwebforminput(orotherhttppostdata)outto
suchasAmazonandeBay,andweb-basede-mailsites.
awebsite.
SpoofGuardcurrentlydoesnotrecognizeusernameand
Theconfigurationpop-up,showninFigure3,letsthe
password combinations from sites that use other input
userselectaspoofratingthreshold,andsetindependent
fieldnames.
weightsandsensitivitylevelsforthedomainname,url,
link, password, and image checks. The user may also
disable pop-ups, set history cache, enable image hash Frames Frameshavehistoricallyproventroublesome
caching,andenablehighlightingofsuspiciouslinks. tobothwebbrowsersandusers. Forsimplicity, Spoof-
SpoofGuardhastwomethodstoconveyitsanalysisto Guard currently treats frames as independent pages,
the user. To keep SpoofGuard as unobtrusive as possi- without parsing the frameset to determine its frames.
ble, weuseatrafficlightsymbolonthebrowserbarto For example, if a frameset includes frames located on
indicate the degree of spoof by color: red, yellow, and different hosts, SpoofGuard may flag this situation as
green. The actual colors displayed are determined by a possible malicious redirect. Related to this is a cus-
the user’s threshold settings. Should the user want to tomizable security setting in Internet Explorer, “Navi-
readthedetailsofSpoofGuard’sanalysis,heorshecan gatesub-framesacrossdifferentdomains”,whichgives
clickthetrafficlight,andmoreinformationappears. In theuserachoicetoallowordisallowthisbehavior. We
extremesituations,SpoofGuardmayalsohaltapostand expecttoimprovethehandlingofframesinafuturever-
ask the user if she wishes to continue. In combination, sionofSpoofGuard.
thetrafficlightandpopupprovideaneffectivemeansof
alertingtheusertosuspiciouswebpages,whileavoiding
POSTdatavsAutoComplete SpoofGuardcompares
theannoyanceofconsistentpopupwindows.
outgoing passwords with its database of <username,
password, domain> triples rather than with values
4.3 Implementationdifficultiesandsolutions
stored in Internet Explorer’s AutoComplete repository.
Detecting whether the user has clickedon an e-mail When a user submits a form, SpoofGuard obtains
link A typical phisher sends unsolicited e-mails that the post data as a SafeArray structure, which Internet
contain links to the spoof site. SpoofGuard therefore Explorer passes to SpoofGuard via an event handler.
attempts to determine whether the user was directed to SpoofGuardthenscansitforsensitiveinformation,and
a site from an e-mail message. One way is to check stores a resulting hash into a file. There are two ad-
the referrer field against a list of host names associ- vantages to using post data. First, post data checking
ated with web-based e-mail providers. However, some is more secure, because SpoofWatch hashes the pass-
8Figure3.SpoofGuardconfigurationpop-up
9words, whereas AutoComplete encrypts them with a Explorer’shistoryandrestartedthebrowserbeforeload-
known key that is stored on the user’s computer. Sec- ing each spoof page; this kept the history of previous
ond, many Internet Explorer users turn off AutoCom- testsfrombiasingtheanalysisofanotherspoofpageon
pleteeitherduetofrequentpop-upwindowsthataskfor thesamespoofserver(ourtestserver). Finally,inorder
the users permission before storing the data, or for pri- toprovideSpoofGuardwithsomeinformationaboutthe
vacy. Therefore, SpoofGuard is more secure while ef- honestsite,wevisitedeBay’swebsiteandnavigatedto
fectivelyservingalargeruserbase. thesign-inpagebeforeeacheBayspoof. Atthehonest
eBaysign-in,weperformedamocksign-inusing‘hello’
Redirects Currently, a page that redirects to another and ‘test’ as the username and password, respectively.
page may cause SpoofGuard to flash yellow or red or AlthougheBaydidnotaccepttheseasalegitimateuser
pop-up a small post data warning box, depending on nameandpasswordpair,theywererecordedbySpoof-
user configuration. In the next version of SpoofGuard, Guard,whichwasallthatweneededforthetest.
weplantorecognizeredirectsinhtmlpagesmoreeffec- Theresultsofourtestwere:
tivelyandeliminatethesespuriouswarnings. • Allfourteenspoofpageshavepasswordinputfields
and SpoofGuard successfully noted this. Spoof-
5 Evaluation Guard also noted that the form submissions were
insecurebecausethepageswereretrievedfromour
We evaluated the effectiveness of our plug-in using
webserverwithoutusingsecurehttp(https).
severalcriteria. First,doestheplug-indetectthesample
• All fourteen pages include inlined images, such
spoofsfoundinthewild? Second,isthefalsealarmrate
as the eBay logo, that are retrieved directly from
sufficiently small? Third, how difficult is it to write a
eBayservers.TheseimageswerealreadyinSpoof-
spoofpagethatisnotdetectedbyourplug-in? Finally,
Guard’simagefileasaresultoftheinitialnaviga-
how does our plug-in affect browser performance. We
tiontothehonestsite. Inthetest,SpoofGuardcor-
discusseachofthesebelow.
rectlynotedthatthespoofpageswitheBayimages
matchedthoseimagesfromthehonesteBaysite.
5.1 Detectionofspoofattacks
• We performed a mock sign-in on the spoof pages
In addition to debugging tests to make sure each totestSpoofGuard’soutgoingpasswordcheck.For
SpoofGuardmeasurementworksproperly,weevaluated eachpage,weused’hello’and’test’,thesamepair
SpoofGuard’s overall effectiveness by testing it against used on the honest eBay site in the initialization
fourteen actual spoof web pages sent to us by the U.S. part of the experiment. SpoofGuard successfully
Secret Service. Nine of the fourteen pages are spoofs identified the user name and password from the
of eBay’s sign-in page. Two spoof pages purport to honest site and popped up a warning to the user,
be “identity and billing verification” pages that request asshowninFigure4.
a large amount of personal information, such as eBay
WebelievethattheSpoofGuardimagecheckandout-
username and password, residence information, credit
goingpasswordcheckareimportantstrengths,sinceto-
card information, ATM card PIN, bank account rout-
getherthesechecksstopoutgoingdataandtheyarenot
ing number, social security number, mother’s maiden
redundant with information that may be found in the
name,dateofbirth,anddriver’slicensenumberandis-
browseraddressbar,statusbar,orrenderedhtml. While
suingstate. Onespoofsitestatesthatbecauseof“regu-
theimagechecker’shashingalgorithmcanbeimproved
larmaintenanceofoursecuritymeasures,youraccount
todetectslightmodificationstotheimages, thecurrent
has been randomly selected for this maintenance,” and
checkssuccessfullycatchspoofsobservedinthewild.
requestsausernameandpassword. Thelasttwosuggest
thattheusercouldwinacarifausernameandpassword
5.2 Falsealarmrate
areprovided.
We tested SpoofGuard on all fourteen spoof pages Thefalsealarmratedependsinpartonhowfrequently
using the default settings and recorded all SpoofGuard the user establishes new accounts and how frequently
messagesforeachpage. SinceSpoofGuarddoesnotan- theuserclearsthebrowserhistorycache. Wehaveused
alyzehtmlfilesstoredlocallyonauser’scomputer, we SpoofGuard ourselves over several weeks. With de-
setupawebserverthathostedthefourteenspoofpages. faultsettings,thereareoccasionalspuriousyellowlights
Sincemostspoofwebsitesdonotusehttps, ourserver whilebrowsing, andsometimesthefirstuseofalegiti-
used ordinary insecure http. Each page was retrieved matesitewithusernameandpasswordinputwilltrigger
from our web server by entering the url directly into afalsepostwarning. Manyoftheunnecessarywarnings
the address bar in Internet Explorer. In order to force aretheresultofframeorredirectionproblems(notedin
SpoofGuard to analyze each page, we cleared Internet section4.3)thatweexpecttoresolveinthenextversion
10Figure4.SpoofGuarddetectshonestusernameandpasswordonspoofsite.
11ofSpoofGuard. Iftheuseropensanewaccount,andin- to performance with a dummy plug-in containing only
tentionallyuses the same passwordas another account, thetimingchecks. Totrytoaccountforthefactthatnet-
this will also produce an unwanted warning. However, work latency shows up in the timing numbers, we also
second and subsequent visits (without clearing the his- ran a second round of tests with all pages in the cache.
torycache)donotleadtoadditionalfalsealarmsforthis AlthoughthemeasurementsdonotcaptureSpoofGuard
situation. timing with great accuracy, the numbers we obtained
seem to support our belief that there is no noticeable
5.3 Security degradationofuserbrowsingexperience.
TheperformancetestswerecarriedoutonTrafficMar-
ThesolutionsdescribedinSection3arecertainlynot
ketplace’s list of 30 most visited sites, using a 1GHz
fool-proof. Anattackerwithareasonableunderstanding
Pentium III with 128MB of RAM, connected through
of web-site construction and a day or two of time can
a10MbpsEthernetcard. Retrievingpagesoverthenet-
circumventourcurrenttests. Forexample,herearesim-
work,ittookanaverageof779millisecondstonavigate
plewaysoffoolingtheSpoofGuardpasswordandimage
fromonepagetoanotherwithoutSpoofGuardinstalled,
checks:
and 911 milliseconds with SpoofGuard. With pages in
• Someofourtestscompareuserinputonaparticu- the cache, these numbers dropped to 484 milliseconds
larpagetopasswordsthattheuserusedatprevious and 601 milliseconds, respectively. These measure-
sites. An attacker could fool these tests by break- mentssuggestthatthesequenceofcheckscarriedoutby
ingthepasswordinputfieldonthespoofpageinto SpoofGuardtakeontheorderof100–250milliseconds
two adjacent fields that would look contiguous to onanolderprocessor. Furthermore,theCPUusagewas
the user, but would cause our password compari- 30% without SpoofGuard, and 40% with SpoofGuard,
son tests to fail. Similarly, javascript on the spoof althoughthevarianceinCPUusagewashighwhilethe
pagecouldencodepostdatasentfromthepageso varianceintimingnumberswaslow. Overall,however,
astodefeatourpostdatatests. itseemssafetoconcludethatSpoofGuarddoesnotim-
• Some of our checks compare images (logos) on a poseasignificantperformancepenalty. Thenon-expert
spoofpagetoimagesthatappearonhonestpages. users for whom the plugin is designed are unlikely to
An attacker could defeat these tests by slicing an notice the computation overhead; they are particularly
image into adjacent vertical slices and presenting unlikelytonoticetheSpoofGuardoverheadiftheirnet-
theseslicesonenexttotheother. Noneoftheindi- workconnectionsareslow.
vidual slices would match images in the plug-in’s
database,buttotheuserthecompleteimagewould 6 Server-sideassistance
lookauthentic. Thiswoulddefeatsomeofourim-
agetests. The techniques we have implemented and tested are
designedtodetectweb-spoofingattackswithoutanyco-
These limitations notwithstanding, our methods clearly operationfromwebsitesthatarespoofed. However,we
makeitharderforattackerstosetupeffectivespoofsites. coulddomuchmorewiththehelpofe-commerceweb
Given the extremely low level of sophistication we’ve sites. For example, the two methods suggested below
seen so far in actual spoof attacks, it is difficult to pre- addsimpletagstohonestwebpages. Theadditionalin-
dicthowquicklyphisherswouldrespondtodeployment formationgatheredfromhonestsitescanbeuseddetect
of SpoofGuard or related methods. In addition, should spoofsmoreeffectively.
moresophisticatedspoofsitesappear,theframeworkwe
haveadoptedinSpoofGuardcanbeextendedwithmore 6.1 Markformfieldswithconfidentialitytags
sophisticated checks and defensive password manage-
Theoutgoingpasswordcheckcomparesoutgoingdata
ment.
to stored (and hashed) sensitive data sent previously to
honest login pages. E-commerce sites can help Spoof-
5.4 Performance
Guardidentifysensitivefieldsbymarkingthemwithan
As SpoofGuard users, we have not noticed any per- additionalhtmlattribute.
formancedegradationasaresultofthebrowserplug-in. We propose adding a CONFIDENTIALITY attribute to
We attempted to confirm this subjective impression by the<INPUT>htmlelement. Forasensitivefield(pass-
making rudimentary measurements. We inserted tim- word, username, creditcard) the html element would
ingchecksatthebrowserBeforeNavigate2andDocu- looklike
mentCompleteevents,measuringCPUusageandnav- <INPUTNAME=”username”TYPE=”text”
igation speed for retrieving and processing each page. CONFIDENTIALITY=”username”>
We compared performance with SpoofGuard installed where CONFIDENTIALITY is one of username, pass-
12word, creditcard, SSN and possibly other pre-specified imagesreferencedwiththe SPOOFGUARD attributeare
strings. The confidentiality attribute helps SpoofGuard storedinthedatabase.
determinehowtoprocessthefield. Notethatwedonot Whenthebrowserdownloadsaloginpagecontaining
use the NAME attribute to infer confidentiality so as to an image whose hash is in the database it does the fol-
givethesitecompletefreedomoveritsfieldnames. lowing:
Confidentiality tags could improve the detection rate • Check to see if the page’s domain is in the list of
andreducethefalsealarmrate. Specifically,ifdatanot domainsassociatedwiththeimage. Ifso,letF be
currentlytrackedbySpoofGuardismarkedconfidential, thefrequencyforthedomain. Ifnot,setF to0.
SpoofGuardwillbeabletowarntheuserwhenthiscon- • Let M be the maximum frequency in the image’s
fidentialdataisexposed. Ifconfidentialitytagsbecome record. Thetestreturnthevaluep=1−F/M.
widelyused,thenSpoofGuardcouldbecomelesslikely
to spuriously track information that is not confidential, Toseehowthisworks, considertheeBayloginpage
reducing the likelihood of false alarms. The proposed and consider an image marked with SPOOFGUARD on
html confidentiality tags may also have other uses be- thatpage. Now,considertherecordintheplug-in’sim-
yondspoofidentification. Forexample,akioskbrowser age database corresponding to this image. Most likely,
couldcloseawindowandflushshort-termcookiesafter the eBay login page will have the highest frequency in
acertainidletimeifentrytothesiteinvolvedconfiden- the image record. Consequently, the eBay login page
tialdata. will have p = 0 indicating that it is not likely to be a
spoof.OtherpagescontainingthisimagewithaSPOOF-
6.2 Imagetagging GUARD attribute (either set up by an attacker or by
someone attempting to DoS eBay) will have a much
The image check described in Section 3.2 is useful
lower frequency and therefore result in a p value close
inidentifyingspoofloginpagessincethesepagesneed
to1.Thistechniquepreventsabuseofthistestfordenial
to reproduce the look-and-feel of the honest site. We
ofservice.
alreadymentionedinSection3.2thate-commercesites
canhelpstrengthenthismechanismbychoosingimages
6.3 Passwordhashingandsite-specificsalt
that can be hashed robustly. In addition, e-commerce
sitescanhelpmakethisteststatefulratherthanstateless. Usersoftenusethesamepasswordatmanydifferent
Todosoweproposeaddinganewattributetothe IMG sites. For example, the same password may be used
element in an html page. The attribute enables honest for an E*Trade account as for a newspaper site. We
sites to identify images on their login page that are not can combat this problem using site-specific password
supposedtoappearonloginpagesoutsidethesite. For salt. Password salt, or other improvements of the stan-
example,theIMGelementpointingtotheeBaylogoon dard password mechanism, also help with other secu-
eBay’sloginpagewouldlooklike: rity problems. In particular, when attackers break into
<IMG SRC=http://ebay.com/login-logo.gif a low security site they often try the recovered user-
SPOOFGUARD> name/password combinations at various financial sites.
TheSPOOFGUARDattributeindicatesthatifthisimage As a result, a web site implementing proper security
appears on a non-ebay web page requesting sensitive policies suffers when other sites do not apply recent
user input then it is likely the page is a spoof. Poten- patchesandstorepasswordsintheclear.
tially,theSPOOFGUARDattributecouldincludeavalue Passwords at one site can be made independent of
(low,high)thusgivingthesiteadministratorsomecon- passwordsatothersitesbyaddinganewSALTattribute
troloverthescoreaddedtothetotalspoofscoreforthe tothehtml<INPUT>element. Thisattributeletsasite
page. Wenotethatthisattributeshouldonlybeusedon specifyper-serversalt;per-usersaltisnotpossiblesince
sensitivehtmlpagessuchasaloginpage. itissuppliedbeforetheuserisidentified. Withthisnew
Next,wedescribehowtheSpoofGuardplug-inwould attribute,passwordfieldswouldlooklike:
use this attribute. The difficulty is in ensuring that this <INPUTNAME=“pwd”TYPE=“password”
attribute is not used for denial of service. We slightly SALT=“E*Trade”>
reorganizetheplug-in’simagedatabase. Eachrecordin wherethesitedevelopersensurethattheirsaltisunique
thedatabaseisasfollows(onerecordperimage): to their site. For example, one could use the domain-
image-hash (d ,f ) (d ,f ) ... (d ,f ) nameasasalt.
1 1 2 2 s s
where d is a domain on which this image was found, When processing a password field the browser first
i
andfrequencyf isthenumberoftimestheuservisited computes E [salt], where E is block cipher, pwd is
i pwd
the page. The plug-in either maintains the frequency the password entered by the user, and salt is the salt
value itself (adding one every time the page is loaded) from input html element. The browser transmits the
or uses the browser’s history file to compute it. Only resulting value rather than the user’s password. If the
13saltattributeisnotpresentinthehtmlpage,thebrowser function. Second, this mechanism could potentially be
uses0asthesalt. Themainpointisthatwiththeblock usedtolaunchadenialofserviceattackagainstanhon-
cipher, it is hard to compute E [X] from E [Y] estsite.
pwd pwd
for X (cid:54)= Y. Consequently, a newspaper break-in will
notcompromiseanE*Tradepassword. Notethatthisis
Search engines to the rescue. Spoof sites are often
similartochallenge-responseauthentication,exceptthat
direct copies of pages on the honest site. Therefore,
each site uses a fixed and unique challenge rather than
when viewing a sensitive page (a page that requests a
a random challenge. This way the site need only store
userpassword),ourbrowserplug-incoulddoaGoogle
in its database a hash of the submitted password value
search on some key phrases or links on the page. If a
ratherthantheplaintextsubmittedpassword.
page similar to the current page is found at a different
Onedifficultyindeployingsite-specificsaltisthatall
domain, the plug-in would increase the page’s spoof-
browsersmustbesimultaneouslymodifiedandwebsites
score.
mustre-authenticatetheirusersafterthismechanismis
Weconsiderthismethodtobespeculativesincepages
deployed. Another problem is that this mechanism it-
areoftencachedatvarioussitesonthewebanditwould
self is susceptible to spoofing. As presented, a spoof
be difficult to distinguish a spoof from a cached page.
siteneedonlycontactthehonestsitetoobtainthesite-
Inaddition,ifeverybrowserintheworldautomatically
specific salt, then pass the same salt on to the victim.
issued a Google query for every password page it en-
This will cause the victim’s browser to send the spoof
counters, the resulting traffic would likely overwhelm
sitetheexactpasswordneededtogainaccesstothehon-
Google. ThereisalsonobusinessincentiveforGoogle
est site. Although we have not done a thorough study,
tosupportsuchaservice.
site-specific salt may still be useful when the request
comes over https and the certificate check establishes
Forensics. Suppose internal tests at E*Trade indicate
a reliable association between the salt and the request-
thatauser’spasswordhasbeencompromised. E*Trade
ing domain. With this limitation, site-specific salt will
suspects that this is the result of a spoof E*Trade site.
produce distinct passwords for distinct sites, and pre-
They wish to quickly determine where the site is. One
vent a phisher who sets up an insecure (i.e., non-https)
optionistoexaminetheuser’shistoryfilesinceitcon-
site from obtaining a password associated with a more
tainsallthesitestheuservisitedrecently,includingthe
secure(https)site.
spoof site. However, a well-minded user would likely
refusetohandoverthebrowser’shistoryfileduetopri-
7 MoreSpeculativeTechniques
vacy concerns. To reduce the user’s exposure, Spoof-
Guardcouldkeeptrackofsiteswheretheuserentereda
Wedescribeafewtechniquesthatmightbeusefulin
passwordidenticaltohisE*Tradepassword.Onlythose
combatingspoofsites.Wedidnotexperimentwiththese
siteswouldbehandedovertoE*Trade.
since we consider them to be more speculative at the
Weconsiderthismethodtobespeculativesincemost
moment.
spoofsitesareactiveforonlyafewdays.Mostlikelythe
processrequiredforobtainingdatafromtheuserwould
CollaborativeMethods. Severalprojects[Bri03]use take more time than that. Nevertheless, the problem of
collaborativemethodstoidentifyspamemail. Asimilar quickly locating spoof sites is important and deserves
mechanism might apply to blocking spoof sites. Con- attention. Wemayexperimentwithusingwebcrawlers
siderauserwhousesourplug-in,butignoresthewarn- forthistaskinthefuture.
ingissuedbytheplug-inwhenvisitingasite. Theuser
entershisidentifyinginformation,submitsthedata,and
8 Conclusion
thenrealizesthathejustenteredprivateinformationon
a spoof site. At that point the user might want to alert Most of the $37 million increase in losses from In-
the authorities as well as alert other users to avoid the ternet fraud observed between 2001 to 2002 has been
site. By providinga “send alert” buttonin our browser attributed to web spoofing [Von03]. While web spoof-
plug-intheusercouldnotifyacentralserverthatthecur- ing(orphishing)maybecomemoresophisticatedinthe
rent page is a spoof. If enough users identify the page future,weproposeasetofmethodsthatappeareffective
as a spoof the server could alert all plug-ins to block forthekindofsimpleattacksobservedbylawenforce-
thepage. Thismightdramaticallyreducethenumberof mentandaffectedcompanies. SpoofGuardusesacom-
userswhogetdupedbythespoofsite. binationofstatelesspageevaluation,statefulpageevalu-
Weconsiderthismethodtobespeculativefortworea- ation,andexaminationofoutgoingpostdatatocompute
sons. First,user’swhoaredupedbyspoofsitesarealso aspoofindex. Whenauserentersausernameandpass-
likely to be unaware of the “send alert” button and its wordonaspoofsitethatcontainssomecombinationof
14suspicious url, misleading domain name, images from for example, were widely deployed, then a spoof site
an honest site, other measures discussed in section 3, authenticatingauserwouldnothaveanywaytoimper-
andausernameandpasswordthathavepreviouslybeen sonatetheuseronthehonestsite. Inthissense,Spoof-
usedatanhonestsite,SpoofGuardwillinterceptthepost Guardhelpspatchoveraweaknessincurrentwebprac-
andwarntheuserwithapop-upthatfoilstheattack.We tices that could be solved more effectively by stronger
havetestedSpoofGuardwithactualattacksfoundinthe knowntechnology. However,thehistoryoftheInternet
wild and found the mechanisms generally unobtrusive suggeststhatonceaconventioniswidelyadopted, itis
and effective. While technically savvy Internet profes- verydifficulttointroducenewstandards.
sionals probably do not need SpoofGuard themselves,
therearemanylesssophisticateduserswhomaybenefit Acknowledgments
fromthistool.
In order to effectively reduce the impact of Internet Thanks to Dan Boneh, Alissa Cooper, Greg Crabb,
fraudbasedonwebspoofing,SpoofGuardmustbedis- TomPageler,RobertRodriguez,andChrisVonHolt.
tributed and deployed, or the mechanisms tested here
must be adopted by browser companies and integrated References
into standard browser security mechanisms. While the
[Ber03] Tara Siegel Bernard. Citigroup’s
initial tests from our research effort are promising, we
logo used in identity-theft attempt.
expect to continue to refine SpoofGuard and subject
SmartMoney.com, August 18, 2003.
the components of our method to more rigorous sta-
http://www.smartmoney.
tistical testing. Especially if some of the server-side
com/bn/ON/index.cfm?story=
methods described in section 6 are adopted by compa-
ON-20030818-000809-1407%.
nies subject to web spoofing fraud, such as EarthLink,
Citibank, Morgan Stanley’s Discover unit, eBay, Pay- [Bri03] Brightmail inc. http://www.
Pal, banks and state lotteries [Ber03], we believe that brightmail.com,2003.
SpoofGuard methods will reduce fraud. In addition to
reducing the direct loss figure mentioned above, good [CNN03] ‘phishing’ scams reel in your iden-
protectionagainstweb spoofing wouldsignificantlyre- tity. http://www3.cnn.com/
ducecustomersupportcosts. 2003/TECH/internet/07/21/
A second consequence of deploying the methods de- phishing.scam/,July22,2003.
scribed in this paper is that phishers will have to work
[Cox03] Mike Cox. Fraudulent emails - thieves
hardertospoofwebusersintorevealingsensitiveinfor-
intend to steal your personal informa-
mation.Asdiscussedinsection5.3andelsewhere,many
tion 6/2003, 2003. Posting from the
of our tests can be circumvented by relatively simple
Michigan Attorney General, http:
modifications to spoof pages. Like virus detection and
//www.michigan.gov/ag/0,
spamfiltering,weexpectthatanyseriousefforttocom-
1607,7-164--70494--,00.html.
batwebspoofingwillleadtomoresophisticatedspoofs
andtheneedformoresophisticateddefenses. Asmen-
[Din03] Theo Van Dinter. Spamassassin, 2003.
tioned throughout the paper, the methods currently im-
http://useast.spamassassin.
plemented in SpoofGuard can be improved. Individual
org/.
pagetestscanbeimproved,morepagetestcanbeadded,
and the formula for computing the spoof index can be [EY01] S.W. Smith E.Z. Ye, Y. Yuan. Web
refined. Furthermore, if e-commerce sites act on their spoofing revisited: Ssl and beyond, 2001.
concernabouttheproblem,server-sidetechniquesoffer http://www.cs.dartmouth.edu/
significantpromiseforcombatingwebspoofing. ˜pkilab/demos/spoofing/.
From a broader perspective, web spoofing takes ad-
[FBDW97] Edward W. Felten, Dirk Balfanz, Drew
vantageoftheunauthenticatedemailandweakweb-site
Dean, andDanS.Wallach. Webspoofing:
authentication. AsaTumbleweedCommunicationsweb
An internet con game. In Proceedings of
siteregardingphishing[Tum03]pointsout,onecounter-
20thNationalInformationSystemsSecurity
measure is “the use of digitally signed email to protect
Conference,1997.
againstphishinghackerattacksandspamemail.”While
this is certainly true, digitally signed email has been
[FBI03] FBI web spoofing warning, 2003.
technicallyfeasibleformanyyears,yettheadoptionrate
http://www.fbi.gov/pressrel/
remainssmall.Strongwebsiteauthenticationcouldalso
pressrel03/spoofing072103.
eliminatewebspoofing. Ifchallenge-responsemethods,
htm.
15[HF03] Katie Hafner and Laurie J. Flynn. E-mail
swindle uses false report about a swindle.
NYTimes,June21,2003.
[Pax99] Vern Paxson. Bro: a system for detect-
ing network intruders in real-time. Com-
puter Networks (Amsterdam, Netherlands:
1999),31(23–24):2435–2463,1999.
[Sno03] Snort: The open source network intrusion
detection system, 2003. http://www.
snort.org/.
[Tum03] Tumbleweed Communications. Dig-
itally signed email to protect against
phishing hacker attacks, 2003.
http://www.tumbleweed.com/
en/solutions/phishing.html.
[VKJM00] R. Venkatesan, S.-M. Koon, M. H.
Jakubowski, and P. Moulin. Robust im-
age hashing. In Proceedings of the Inter-
national Conference on Image Processing,
2000.
[Von03] C.T.VonHolt. ResidentAgentInCharge,
US Secret Service, San Jose, CA. Private
communication,2003.
16