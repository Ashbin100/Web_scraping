∗
Global Intrusion Detection in the DOMINO Overlay System
VinodYegneswaran PaulBarford SomeshJha
ComputerSciences Department,
UniversityofWisconsin,Madison
E-mail:{vinod,pb,jha}@cs.wisc.edu
Abstract 1 Introduction
Internetintrusionsandlarge-scaleattackscanhavecatas-
Sharingdatabetweenwidelydistributedintrusiondetec-
trophic affects, including stolen or corrupted data, wide-
tion systems offers the possibility of significant improve-
spreaddenial-of-serviceattacks, hugefinanciallosses and
mentsinspeedandaccuracyoverisolatedsystems. Inthis
even disruption of essential services. For example, it has
paper, we describe and evaluate DOMINO (Distributed
beenestimatedthattheCodeRedIvirusinfectedmorethan
OverlayforMonitoringInterNet Outbreaks);anarchitec- 359,000hosts,resultinginfinanciallossesofover$2bil-
tureforadistributedintrusiondetectionsystemthatfosters
lion[16,28]. Giventheirpotentiallyprofoundimpact,de-
collaborationamongheterogeneousnodesorganizedasan
tectingnetworkintrusionsandattacksisanimportantgoal.
overlaynetwork. TheoverlaydesignenablesDOMINOto
However,protectingnetworksfromnefariousintrusions
beheterogeneous,scalable,androbusttoattacksandfail-
and attacks remains challenging for a number of reasons.
ures. AnimportantcomponentofDOMINO’sdesignisthe
First,andperhapstheforemost,isthefactthattheproblem
useofactive-sinknodeswhichrespondtoandmeasurecon-
isaconstantlymovingtargetduetocontinuedinnovation,
nectionstounusedIPaddresses. Thisenablesefficientde-
easy access to new portscanning tools and the Internet’s
tection of attacks from spoofed IP sources, reduces false
basicvulnerabilitytowidespreadintrusionsfromdifferent
positives, enables attack classification and production of
classesofworms[44].Second,evenwhennewexploitsare
timelyblacklists.
identified,theprimarymeansforpropagatingthisinforma-
We evaluate the capabilities and performance of
tionisthroughorganizations,suchasCERT[8],whichcan
DOMINOusingalargesetofintrusionlogscollectedfrom
result in unacceptably slow response times for installing
over 1600 providers across the Internet. Our analysis
countermeasures. Third, while infrastructuressuch as IP-
demonstratesthesignificantmarginalbenefitobtainedfrom
supportedtraceback[41]orpushback[26]offerpromisein
distributed intrusion data sources coordinated through a
combating intrusions and attacks, these and other similar
system like DOMINO. We also evaluate how to configure
measuresarenotyetwidelydeployed.
DOMINOinordertomaximizeperformancegainsfromthe
Currentbestpracticeforprotectingagainstintrusionsis
perspectivesofblacklistlength,blacklistfreshness andIP
throughtheuseoffirewallsornetworkintrusiondetection
proximity.Weperformaretrospectiveanalysisonthe2002
systems(NIDS)[31]. Firewallsarechokepointsthatfilter
SQL-Snake and 2003 SQL-Slammer epidemics that high-
traffic at network gateways based on local security poli-
lightshowinformationexchangethroughDOMINOwould
cies[6]. NIDSpassivelyobservethelocalnetworktraffic
havereducedthereactiontimeandfalse-alarmratesdur-
and react to specific signatures (misuse detection) or sta-
ingoutbreaks.Finally,weprovidepreliminaryresultsfrom
tisticalanomalies(anomalydetection). ExamplesofNIDS
our prototype active-sink deployment that illustrates the
thatemploymisusedetectionareSnort[39]andBro[34].
limited variability in the sink traffic and the feasibility of
One of the fundamental weaknesses of misuse-detection-
efficientclassificationanddiscriminationofattacktypes.
based NIDS is their inability to detect new types of in-
trusions. Anomaly detection techniques establish statisti-
∗The U.S. Government is authorized to reproduce and distribute calprofilesofnetworktrafficandflaganytrafficdeviating
reprints forGovernmental purposes, notwithstanding anycopyright no- fromthe profile as anomalous. The high variabilitycom-
tices affixed thereon. The views and conclusions contained herein are mon in network packet traffic limits the effectiveness of
thoseoftheauthors,andshouldnotbeinterpreted asnecessarilyrepre-
this approach [23]. In general, current NIDS suffer from
sentingtheofficialpoliciesorendorsements,eitherexpressedorimplied,
twomajordrawbacks: highfalsealarmratesandperspec-
oftheabovegovernmentagenciesortheU.S.Government.tivefromasinglevantagepoint,whichlimitstheirability 2. Ideal configuration parameters for the DOMINO ar-
todetectdistributedorcoordinatedattacks. chitecture focused on blacklist size (a sorted list of
One promising approach to addressing the above- theworstoffendingsources)andfrequencyofblack-
mentioned shortcomings is throughthe use of distributed listgeneration.
networkintrusiondetectionsystems(DNIDS).Inthisenvi-
3. Thereactiontimeinidentifyingwormoutbreaks.
ronment, alerts from different NIDS are combined to ad-
dress above-mentioned shortcomings. Valdes and Skin-
4. Theeffectonfalsealarmrates.
ner [47] show that “merging” alerts from different NIDS
deployedinasingleadministrativedomaincanreducethe 5. The effectiveness of DOMINO in identifying slow
overallfalsealarmrate. Improvementsevenfromthislim- scanners.
itedperspectiveindicatethepotentialforDNIDS.
6. Thevariabilityinpayloaddistributionsinactive-sink
1.1 Contributions data.
The first contributionof this paper is in the description 1.2 Results
ofanewarchitecturefordistributedintrusioninformation
sharing. The DOMINO architecture enables NIDS de- There are several important results of our experimental
investigation:
ployed at diverse locations to securely share intrusion in-
formation. DOMINO’s overlaydesign facilitates scalable • Improvedsummaries: Throughourmarginalutility
datasharing,heterogeneousparticipationandrobustnessto
experimentswedemonstratethatthroughasmallnet-
nodes joining and leaving the infrastructure. DOMINO’s
workofcollaboratingpeers(approximately40),indi-
datasharingarchitecturedescribesthemethodsoftransfer
vidual networks can significantly improve their per-
andsummarizationofinformationbetweennodes.Thisar-
spective on global attack behavior. The size of the
chitectureisflexiblesoastoenableconsiderationoflocal
individual peering nodes is less significant than the
policies.
numberofcollaboratingpeers.
AnimportantpartofDOMINO’sarchitecturearenodes
thatmonitorunusedIPaddresses.Wecallthecollectionof • Blacklists (worst-offender list): We show that few
thesenodestheDOMINOactive-sinks.Thesedatasources (approximately tens) attack sources are responsible
aredevoidoffalsepositivessincetheymonitorunusedIP for a significant portion of all scans on any given
addresses. Theactive-sinksprovidebettermechanismsto dayandthatsubstantialbenefitcanbeachievedeven
detectspoofedsourcesandallowforefficientclassification throughrelativelystaleblacklists.
ofattackpacketsintowelldefinedcategories. Thereisan
important additional benefit in monitoring unused IP ad- • Decreased reaction time: We evaluate the reac-
tion time of our system using data from two differ-
dressesinthattheremaybefewerprivacyconcernsassoci-
ent outbreaks: SQL-Snake 2002 and SQL-Sapphire
atedwithcollectingthisdata.
Thesecondcontributionofthispaperisintheevaluation 2003 [27]. We provide examples of rules that
DOMINOcouldemploytoreactfavorablytoeachof
oftheDOMINO’sdesignandperformancecharacteristics.
these scenarios without significant false alarms. We
Our evaluation is based on the use of a set of intrusion
logs gathered from over 1600 different networks across demonstratethat reaction time to exploit recognition
canbesubstantiallyreducedinDOMINOundereach
theInternetoverafourmonthperiod. To ourknowledge,
thisisthefirstevaluationoftheDNIDScapabilityusinga oftheseconditions.
large,distributeddataset, anditprovideskeyinsightsinto • Slow scanners: Our results suggest that relatively
effectiveness of distributed intrusion detection. We have
small daily blacklists of around 40 sources can have
completedan architecturalspecificationof DOMINO and
asignificantimpactindeterringslowscanners.
implementationis ongoing. Monitoringcomponentshave
beendevelopedwhiletheimplementationofmessagepass- • Utility of active-sink data: We providepreliminary
ingcomponentsareongoing. Therefore,weperformedan resultsfromouractive-sinkdeploymentthathighlight
ex post facto analysis based on DOMINO’s specification. the limited variability in observed payloads of mali-
Wealsoevaluatedatafromaprototypeactive-sinkdeploy- cioustrafficandmotivateourapproachtowardsbuild-
ment.Ourexperimentsfocusedonevaluatingthefollowing ingarobustclassifier.
aspectsofDOMINO:
Our results have a number of important implications.
1. The marginal utility of adding measurement nodes
First, the DOMINO architecture demonstrates a frame-
in detecting worst offenders and creating port sum-
work within which systems from different administrative
maries.domains can participate in coordinated intrusion detec- alerts. Severalresearchersaredevelopinglanguagestoex-
tion. Second,theclearimprovementsinabilitytoidentify pressalerts[12]. Astheselanguagesarestandardized,we
intrusions through coordinated data sharing should make plan to incorporate them into DOMINO. Merging alerts
thisacompellingconsiderationfornetworkadministrators. from various sources has also been studied by several re-
Third,thedeploymentofactivesinknodesonunusedad- searchers [10, 47]. The merging algorithm in DOMINO
dressspaceintheInternetwouldsignificantlyincreasethe is influencedbyourexperimentalresults. We are alsoin-
fidelityandspeedofalertgenerationinintrusiondetection vestigating algorithms from data fusion [14] for this pur-
systems. As a widely deployed infrastructure, DOMINO pose.Thegoalofintentionrecognitionistocorrelatealerts
itselfmustbeconsideredatargetforattacks. Tobeeffec- (possiblyemergingfromdifferentsources)toinfertheplan
tive,DOMINOmustberesilienttoavarietyofattacks. A oftheadversary[11, 21]. InthecontextofDOMINOwe
discussionofpossiblethreatsandcorrespondingmitigating are not working on this problem. However, we plan to
measuresinDOMINOarediscussedinsection 5. incorporate an existing intention recognition module into
DOMINO. We are also investigatingthe use of structures
2 Related Work
to reason about sequences of attacks, such as privilege
graphs[13]andattackgraphs[42],forthepurposesofin-
There are several techniques for intrusion detection,
tentionrecognition.
such as misuse detection [34, 38], statistical anomaly de-
Our work is also influenced by empirical studies of in-
tection [25, 43, 48], information retrieval [4], data min-
trusion and attack activity. Moore et al. [30] examined
ing [22], and inductivelearning [45]. For a survey of in-
theprevalenceofdenial-of-serviceattacksusingbackscat-
trusion detection reader can consult existing literature on
teranalysis. In[28],theauthorsanalyzethedetailsofthe
thistopic[1,31,33].Aclassificationofintrusiondetection
CodeRedwormoutbreakandprovideimportantperspec-
systemsappearsin[18,SectionII].
tive on the speed of worm propagation. In a follow-on
Severalresearchershavestartedinvestigatingdistributed
work, Moore et al. [29] provide insights on the speed at
networkintrusiondetection[5,11,19]. In [2],theauthors
which countermeasures would have to be installed to in-
proposeCOVERAGE,acooperativevirusresponsemech-
hibit the spread of worms like Code Red. The work that
anismthatreactstohighlyvirulentviruses.Indra[19]pro-
isperhapsmostcloselyassociatedwithDOMINOis[50].
posesafullypeer-to-peerapproachtointrusiondetection.
Inthatpaper,we exploredthe statistical characteristicsof
Itsorganizationiscompletelyad-hoc,doesnottakelocal-
Internetintrusionactivityfromaglobalperspective. That
ity into account and the infrastructureserves primarily as
work informs DOMINO’s design from the perspective of
a rule dissemination mechanism. Current state of the art
thepotentialuseofmultiplesites incoordinatedintrusion
foraggregatingintrusionlogsandobservingglobaltrends
detection.
isthroughtheDSHIELDproject [46].Thenumberofpar-
ticipants and volume of data collected makes this a very 3 DOMINOArchitecture
attractiveresource.Howevertherearecertainweakness:
3.1 DOMINOOverview
• Datacollectionisstaticandisdevoidofrealtimeanal-
ysisorrulegenerationcapabilities. A DOMINO network is a dynamic infrastructure com-
posedofadiversecollectionofnodeslocatedinanetwork
• Payload information and complete protocol headers
spanning the Internet. The objective of this system is to
are not captured. This often makes attack classifica-
provideaframeworkforinformationsharingaimedatim-
tionimpossible.
proving intrusion detection capability for all participants.
• IPaddresslocalityisignored.Thereisnomechanism Thereareseveraloverarchingrequirements,propertiesand
toadjustqueriestoaccountforIPaddressspaceprox- challengesinorganizationofthisnetwork. Theserequire-
imity. mentsarenotunlikethoseofotherlargeinformationshar-
inginfrastructuresandincludethefollowing:
• A monolithic database limits scalability and also in-
troducesasinglepointoffailure. • Availability: Since all networks are prone to sys-
tem failures, congestion and attacks, the infrastruc-
Ourinfrastructureseekstoaddresssomeofthedefecien- ture must be resilient to temporary network instabil-
ciesinthisapproach. DOMINO’sdesignusesacombina- ities. Furthermore, it is crucial that the network re-
tion of peer-to-peer and hierarchical components provid- mainavailableinthefaceofwormoutbreaks,denial-
ing significant advantages over a purely hierarchical ar- of-serviceattacksandotherInternetcatastrophes.
chitecture. These advantages include simplified informa-
tion sharing, scalability and fault tolerance. Currently,
DOMINO uses a “flat tuple space” to express variousavailability is vital to the resilience of the infrastructure.
Two importantrequirementsare1) resilienceto failureof
axisnodesand2)theabilitytoquicklydetectandadaptto
topologicalchangesresultingfromnodesjoiningandleav-
ing.
Overlaynetworkshavebeenshowntobehighlyresilient
to disruption and possess the ability to deliver messages
evenduringlarge-scalefailuresandnetworkpartitions[3].
Inorderto enhancerobustnessandextendthe availability
of the architecture, external connectivity (from nodes not
participatinginDOMINO)totheaxisoverlayismaintained
throughasetofDOMINOaccesspoints(DAP).Participa-
tionattheaxisnodelevelinDOMINOisachievedthrough
Figure 1. DOMINO Node Organization. Axis
anadministrativeprocedure,describedinSection3.3.
Nodesparticipateinapeertopeeroverlay.
Eachaxisnodeintheoverlayisdescribedintermsofits
followingcomponents:
• Decentralization: A decentralized architecture pro- Activity Database: The schema of the axis database has
fiveimportantrelations:packetlogs,localandglobalsum-
videsforgreaterflexibilityandeliminatesanysingle
maries, vulnerabilities and alerts. Axis nodes will act as
pointoffailure.
intrusiondatacollectionpointsinDOMINOandtypically
• Heterogeneity: Thenetworkmustbeabletoharmo- belongtolargeandwell-managednetworkssincethereisa
nizesystemsfromdisparatenetworksofvaryingsizes highleveloftrustrequiredtoparticipateatthislevel.
thatrunawiderangeofNIDSandfirewalltechnolo-
Active-Sinks: Asinkholeisalargechunkofunused(but
gies. This would allow DOMINO to overcome any
advertised) IP address space. An active-sink sniffs traf-
weaknessesassociatedwithindividualNIDSrulesor
fic bound to these addresses addresses and simulates vir-
organizationaltopologies.
tual machines by supportingsome level of interaction. A
• Pervasiveness: Thenetworkwouldbemosteffective naiveinstantiationofanactive-sinkisaLaBreatarpit[24].
in identifyingattacktrendsandcharacterizingglobal LaBrea was developedas a mechanism for slowing Code
Internetintrusionphenomenon,ifitobtainsrepresen- RedIpropagationbycreatinga“stickyhoney-pot”orper-
tativeparticipantsacrossa“moderatesize”portionof sistentconnectionsoversink-holes.Thesecausetheinfect-
IPaddressspace. ingmachinestotemporarilygetstuckthusslowingpropa-
• Privacy: Thenetworkshouldnotrevealdatathatin- gationof an outbreak. Otherexamplesof active-sinksin-
cludeHoneyd [36](ahighlycustomizablelow-interaction
dividualparticipantsconsidersensitive.Itshouldalso
honeypot)andiSink(ascalablesinkholeresponder) [49].
notincreasethelikelihoodofattackagainstindividual
Thisapproachtomonitoringhasimportantauxiliaryben-
participants.
efitstoDOMINOthatincludesthefollowing:
• Inducement:Finallytheremustbeanincentive(adi-
1. Active-sinksenableexaminationofthepayloadpack-
rect benefit) for networks to join this infrastructure.
ets. Thishelpsinassociatinganattackwithapartic-
The critical mass of participants requiredfor obtain-
ular vulnerability. For example, examination of the
ingimmediatebenefitshouldbereasonablylow.
“GET” request helps distinguish between Code Red,
AsshowninFigure1,aDOMINOnetworkiscomprisedof
Nimdaandothervariants. Thisisnotpossibleintra-
threesets ofparticipants: axisoverlay, satellitecommuni-
ditional NIDS unless you have a service running on
tiesandterrestrialcontributers. Wedescribeeachofthese
thatport.
inthefollowingsections. Allcommunicationbetweenthe
axisoverlaynodesandthesatellitesisencrypted. Wepro- 2. Spoofed sources behave differently to an active-sink
vide a brief description of the key distribution strategy in response. They do not send the payload packet. In-
Section 3.3. stead, they respond with a reset or simply drop the
SYN/ACK received from the sink. Thus any source
3.1.1 AxisOverlay
thatsendsapayloadtotheactive-sinkcanbeconsid-
ered to be malicious or misconfigured. This enables
TheaxisnodesarethecentralcomponentoftheDOMINO
creationofhighconfidenceblacklistsandattachment
architecture. They are responsible for the bulk of the in-
ofgreateraccountabilitytotheattacksources.
trusion information sharing. Hence, their scalability andTo assess the feasibility and scalability of a large scale thesenetworksandtheirunderlyingNIDSandfirewallsoft-
active-sinkdeployment,wehavebeenrunningaversionof ware implementations. Extensions to provide support for
anactive-sink(analogoustoatarpit)on3classBnetworks DOMINOwouldbeimplementedasplug-insforthesesys-
over4weeks.ThenumberofmonitoredIPswereincreased tems.
fromaround50,000to100,000duringthemeasurementpe- Thesatellitenodesareorganizedinahierarchysuchthat
riod. Characterizationandanalysisofdatacapturedatthe each node routes all communication with the larger net-
sinkisdiscussedinappendixD. workthroughaparentnodethatiseitheranotherDOMINO
Each axis node ideally maintains both an NIDS and an satellite or an axis node. Data collected at the satellite
active-sink over large unused IP address space. Our ex- nodesis transmittedtotheaxisnodesthroughacombina-
perience with similar datasets, as discussed in Section 4, tionofpushandpullmechanisms. Thedataobtainedfrom
indicates that a collectionof around20 such data sources satellites is consideredtobe less trustworthythan whatis
issufficienttoidentifyglobalattackcharacteristicswitha collectedattheaxisnodes.
highdegreeofaccuracy. Hence,weexpectthenumberof Thesatellites havethepotentialtogeneratealargevol-
axisnodestobeconsistentlyover20inordertomaximize umeofspontaneousalerts.Duetotheirlimitedperspective,
effectivenessofthesystem. thesenodesmayalsobeincapableofperforminglocalanal-
ysisorclassificationofattackseverity. Hence,thesenodes
NIDS/Firewall: NIDS and firewall rules provide data
are organizedinto ad-hoc hierarchies that allows for effi-
on specific intrusion signatures and on rejected packets.
cientclusteringofneighboringalertsandrobustconstruc-
Both of these are fundamental intrusion data sources in
tionofpertinentdigests. Preservinghierarchicalattributes
DOMINO.
towardstheedgesoftheDOMINOoverlayalsofacilitates
DOMINOQueryEngine: TheDOMINOaxisnodesex- efficientdataaggregation,intelligentroutingofqueriesand
portaqueriableinterfacethatcanbeusedtotunefirewall responses, establishment of trust levels and simplifies ad-
parametersandtoexpeditiouslyreacttooutbreaks.Queries ministrativedemands.
from external sources are directed through the DAPs and Axis nodes and satellites enjoy a symbiotic relation-
their accessibility is controlled to protect the integrity of ship.Therepresentationofthesatellitesallowsthenetwork
theinfrastructure.Finally,thequeryenginealsosupportsa wider coverage across the IP space. The inducement for
“trigger”mechanismthatallowstheaxisnodestopulldata thesatellitesisaglobalvantagepointthatallowsforrapid
fromthesatellitesonareal-timebasis. Suchmechanisms outbreakrecognition,dynamiccontentfilteringandappli-
canproveextremelyvaluableforgatheringfine-grainedin- cationspecificsourceblacklistingtoprotecttheirnetworks
formationforanalyzingnewoutbreaks. inatimelymanner.
DOMINOSummaryExchangeProtocol:TheDOMINO 3.1.3 TerrestrialContributers
axisnodesintheoverlayparticipateinaperiodicexchange
The terrestrial contributers form the least trustworthy but
of intrusion information. We refer to the data sets ex-
potentiallyaverylargesourceofdata. Thesenodesdonot
changed as summaries - the actual format of the sum-
implement the DOMINO protocol, may not have active-
maries is described later in this section. The summaries
sinksandarenotboundtoanyparticularsoftwareinstalla-
areexchangedatthreelevelsofgranularities:hourly,daily
tion. Rather, these nodes could run any firewall or NIDS
andmonthly. Asummaryexchangeinvolvesthefollowing
software and simply supply daily summaries of port scan
steps:
data. Terrestrial contributers are simply a means for ex-
1. Pulling data from the satellites. Alternatively this pandingcoveragebyincludingintrusiondatasetsfromout-
could also be implemented as a periodic push. The sideoftheinfrastructure.
choiceislefttothesatellites.
3.1.4 DOMINOMessages
2. Generationofthesummarydataandmulticasttoother
To foster interoperability and maximize extensibility the
axisnodes.
DOMINOprotocolmessagesarerepresentedinXML.We
3. Executing the store operation to enable persistent extendthe schema proposedby the IDWG (IntrusionDe-
availabilityofthisdata. tection Working Group) in the IDMEF (Intrusion Detec-
tion Message Exchange Format) draft [17]. Our schema
3.1.2 SatelliteCommunities
addsfivenewmessagetypestothetwoprovidedbytheID-
MEF(alertsandhearbeats). Thesevenmessagecategories
Satellite communities are smaller networks of satellite
in DOMINO are as follows: 1) Alerts 2) Summary Mes-
nodesthatimplementalocalversionoftheDOMINOpro-
sages 3) Heartbeats 4) Topology Messages 5) Queries 6)
tocol. Thereis potentiallya widedisparityinthe sizes of(a)Utilityofadditionalsubnetsfordetectingworstoffender. (b)Utilityofadditionalsubnetsfordetectingtoptargetport.
Figure2.MarginalUtilities
DBUpdatesand7)Triggers.Adescriptionofeachofthese curvebasedpublic-keysystems[20]. Thepublic-keyofan
messagetypesandtheirformatsisgiveninAppendixA. axisnodecanalsobeusedforauthenticationusingastan-
dardchallenge-responseprotocol(forexample,see[32]).
3.2 InformationSharing
Finally, authenticationschemes basedonsecret keyex-
Everyaxisnodemaintainsalocalandglobalviewofin- changes could also be considered. We chose not to pur-
trusionandattackactivity. Thelocalviewconsidersactiv- sueanauthenticationschemebasedonsharingsecretkeys,
ity in its own networkand its satellites. Axis nodes peri- sincethiswouldentailsharingasecretkeybetweenevery
odicallyreceivesummariesfromtheirpeerswhicharethen pair of axis nodes. This approach would be less scalable
usedtocreatetheviewofglobalactivity.Issuesincreating and require more maintenancethan our choice of using a
theseviews includescalability,timeliness andtrust. Each public-keysystem.
axis node can employ its own strategy for creating both
4 Results
local and global views. Strategies for data aggregationto
createlocalandglobalviewsarediscussedinappendixB.
In this section, we first providebackgroundresults that
3.3 Authentication demonstratetheutilityofsharingintrusioninformation.In
particular, we measure the amount of information that is
The axis nodesin DOMINO areassociated with a high
gainedbyaddingadditionalmeasurementnodes. Nextwe
degree of trust so authenticating all inter-axis communi-
investigate temporal attributes like the stability of black-
cation is vital. We currentlyuse public-keycryptography
lists, effectivenessof blacklist in terms of its size and the
(specifically RSA [37]) for this purpose. However, other
similarityofblacklistswithrespecttodestinationIPprox-
schemesforsourceauthenticationcouldalsobeused. We
imity. We also explore how information sharing infras-
do not anticipatethe numberof axis nodes to scale at the
tructure would affect reaction times during a worm out-
same rate as the overall DOMINO infrastructure, so key
break. The aforementioned results are all based on data
distribution amongthese nodes is not envisionedas a big
obtained from DSHIELD [46]. We used a set of firewall
hurdle. In fact, there could easily be a special certificate
andNIDSlogsofportscanscollectedovera4monthperiod
authority(CA)fortheDOMINOnetwork,andwhenanew
fromover1600firewalladministratorsdistributedthrough-
axisnodejoinsDOMINO,itcanengageinakeydistribu-
out the globe as the basis for analysis. Detailed descrip-
tionprotocolwiththeDOMINOCA.
tion of the data appears in appendix C. Description and
When an axis node multicasts an intrusion summary, it
analysisof the data capturedat the active-sinkis givenin
firstcomputesaSHA-1hashofthesummaryandappends
appendixD.
the digital signature of the hash to the summary which
is verified by all recipients. This approach is scalable in 4.1 MarginalUtility
DOMINO because axis nodes broadcast summaries rela-
tivelyinfrequentlyandthesummariesarelightweight(or- Weuseaninformationtheoreticapproachtoquantifythe
der of KBs). For example, in ourcurrentimplementation additionalinformationthatisgainedbyaddingnewnodes
the broadcastingperiodis approximatelyone hour. How- in a distributed intrusion detection framework. Our ap-
ever, we plan to undertake an experimental evaluation of proachutilizes the well knownKullback-Leibler [15] dis-
theoverheadofcomputingdigitalsignaturesinthecontext tancemetricforprobabilitydistributionstomeasurethein-
ofDOMINO.Wearealsoinvestigatingothermechanisms formationgain.
forsourceauthentication(eg.[35,40]), includingelliptic-100
80
60
40
20
0
1 10 100 1000
Length of Blacklist (# IPs)
deretliF
snacS
fo
egatnecreP
Daily Blacklist
Weekly Blacklist
Monthly Blacklist
10000
1000
100
20 40 60
Source Rank
(a)EffectivenessofBlacklistswithlength.
snacS
fo
rebmuN
egarevA
Daily
Weekly
Monthly
(b)EffectivenessofBlacklistswithAge.
Figure3.EffectivenessofBlacklists.
Aframeworkforevaluatingthemarginalbenefitofem- Intheequationgivenabove,thesumrangesoverallthe
ployingadditionalmeasurementsites inthecontextofIn- sourceportsthatappearintheintrusionlog.
ternettopologydiscoveryhasbeenpresentedin[7]. They We use this framework to measure the effectiveness of
presentedtwomethodologiesforquantifyingthemarginal sharinglogsinidentifyingtheworstoffendersandtheef-
benefitobtainedbyincorporatingresultsfromanadditional fectivenessofidentifyingthemostfrequentlyscannedtar-
experiment:onlineandofflinemarginalutilitymetric. The getports. ForeachdayinthemonthofJune,werandomly
offlinemetricconsidersthe benefitofeachexperimenton selected100/24’sand100/16’sfromthe DSHIELDlogs
anexpostfactobasis,measuringeachexperiment’suseful- todeterminethenumberofparticipatingnetworksthatare
nessafteralltheexperimentshavebeenconducted. Inour requiredtoobtainastabledistribution.
study,eachexperimentcorrespondstoanadditionalintru- Figure 2(a) depicts the diminishing marginal benefit of
sionlogsubmittedfromadifferentnetworkandwechoose adding additional network logs for developing port sum-
theofflinemetricaswearenotconcernedwiththeorderin maries. Thecurvesfor/16and/24networksshowa very
whichthelogsaresubmitted. similartrendwiththeadditionalbenefitdecliningtoalmost
AssumethatwehavenintrusionlogsS1,···,Sn. Each zeroat20and40networksrespectively.Themessagehere
logSi definesa distributionPi overthe sourceportsthat isthatthereissomebenefittohavingabiggermeasurement
originate a scan, i.e., Pi(s) is the probability that a scan networks,butclearlyitismoreimportanttohavemeasure-
originatedfromportsgiventheintrusionlogSi. Werank mentsfrommultiplevantagepoints.
theintrusionlogsbytheentropyofthecorrespondingdis- The graph of the marginalbenefit for developingworst
tribution,i.e.,fori<j,PihashigherentropythanPj.In- offenderlist(orblacklist)isgiveninFigure2(b).Themes-
tuitively,aprobabilitydistributionwithhigherentropycon- sage is even more pronounced in this graph; clearly size
tributes“more”totheoveralldistribution. LetP[1,···,i] be does not matter, but more is better! Together the graphs
thedistributionwhentheinformationinthelogsS1,···,Si imply that a collaboration of 40-60 networks is adequate
arecombinedandletP betheoveralldistribution(whenall to develop port summaries and blacklists with a high de-
theintrusionlogsarecombined).ThemarginalutilityofSi gree of confidence. It is also interesting to note that the
(denotedbyU(Si))is: actualmarginalutilityvaluesforworstoffendersishigher
thanthatforportsummaries. Thissuggeststhatitismore
importantto add additionalsites for developingblacklists
U(Si ) = d KL(P[1,···,i],P)
(cid:2) (cid:3) thanitisforcreatingportsummaries.
(cid:1)
= P[1,···,i] (s)log
P[1 P,·· (· s,i )](s)
Summary: Marginal utility of information used to detect
s targetandsourceports(forportscans)isminimalafter40
nodes. Thissuggeststhatwithrespecttoidentifyingtarget5000
4000
3000
2000
1000
01 10 100 1000 10000 1e+05 1e+06 1e+07
IP Distance
ytiralimiS
tsilkcalB
800
600
400
200
0
Hour starting at 05-20-2002 00:00
Figure 4. Similarity of Blacklists with IP ad-
dressproximity.
ports and the worst offenders for port scans, a DOMINO
networkwithapproximately40axisnodeswillsuffice.
4.2 BlacklistEffectiveness
One of the crucial operational parameters for the
DOMINOoverlayis thesize of theblacklists that areex-
changed between the participants. The DOMINO axis
nodes develop and exchange service specific blacklists at
multiplegranularities.
To study this, we generated a combined blacklist for
alltheDSHIELDprovidersatthreedifferentgranularities
(daily,weeklyandmonthly).Figure 3(a)illustratesthere-
lationshipbetweentheblacklistlengthanditseffectiveness
intermsofthepercentageofallscansblocked.
The graph shows that at any given hour, around 90%
of all scanning activity can be attributed to about 1024
source IPs. More surprisingly, a global daily blacklist of
16sources,accountformorethan60%ofallscans. Sim-
ilarbenefitscanbeachievedbyastale(monthly)blacklist
ofaround250sources.
Summary: Fewsourcesareresponsibleforalargefraction
ofall scans andmanysourcespersist. Therefore,thesize
oftheblacklistsintheDOMINOnetworkdoesnothaveto
beverylarge.
4.3 BlacklistAging
Figure3(b)providesanothermeanstovisualizetheaging
ofblacklists.Weagaincreateblacklistofthetop60sources
atmultiplegranularitiesandgraphthe“averagedailynum-
berofscans”generatedbyeachrank. Forthehigherranks
(top10),thehourlyblacklistsclearlydeliversuperiorper-
formance.However,forthelowerranksthereareinstances
wherethemonthlyblacklistperformsaswellorbetterthan
the daily blacklist. This validates the need for maintain-
ing blacklists at multiple granularities, and suggests that
at lower granularities there is greater benefit to creating
longerblacklists.
snacS
fo
rebmuN
2e+05
No. sources / hour
1.5e+05
1e+05
50000
00 20 40
secruoS
fo
rebmuN
No. scans / hour
Inflection Point
Figure 5. Scan Rate of 48 hrs surrounding
SQL-Snakeoutbreak.
4.4 IPAddressProximity
IPaddressproximityisanimportantconsiderationinthe
organizationoftheDOMINOtopology.Therearetwocon-
flicting issues that must be resolved in the allocation of
satellitestoaxisnodes. First,tominimizefalsealarmsand
to effectively cluster related scans and attack episodes, it
wouldbebeneficialtoorganizenearbynodes(ornetworks)
underthesamehierarchy(sincescanningandattacktools
areoftendesignedtosequentiallytraverseIPspace).How-
ever,foreveryaxisnodetoobtainacompositeviewofthe
attackactivity,itwouldbeidealtohavedatafromadiverse
setofIPblocks.Wewouldliketounderstandtheappropri-
ategranularityofaggregationthatmaximizesthistradeoff.
We randomly selected 100 /24 networks and measured
the similarity in their monthly blacklists for June 2002.
WedefinedtheIPaddressdistancebetweentwonetworks
A.B.CandX.Y.Zasfollows:
Dist=|A−X|∗2562 +|B−Y|∗256+|C−Z|
Toexpressthe similaritybetweenblacklists of twonet-
works, we needed a metric that provides greater weight
for a match of higher rank. The asymmetric similarity
of list B 2 to B 1 is denoted by sim(B 1,B 2). The sym-
metric similarity between lists B 1 and B 2 (denoted by
SymSimilar(B 1,B 2)) is the average of sim(B 1,B 2) and
sim(B 2,B 1). Formally, the similarity metrics are defined
asfollows(ldenotesthelengthofthelistsB 1andB 2):
(cid:1)
sim(B 1,B 2) = [l−rank(s i,B 2)]
si∈B1∩B2
SymSimilar(B 1,B 2) =
sim(B 1,B 2)+sim(B 2,B 1)
2
Figure 4 shows the similarity between blacklists as a
functionoftheIPaddressdistancebetweentwonetworks.Figure 6. Reduction in Reaction Time as we Figure 7. Change in Alarm Rate as we add
addmorenetworks morenetworks.
Thefigureclearlyshowsthatthereisahighdegreeofsim- activity but did not have any triggers that fired appropri-
ilaritybetweentheblacklistsof/24networksthatareclose atespontaneousalerts. Inthis experiment,weusedavot-
together(inthesame/16)andlittlesimilarityfartheraway. ingschemetogenerateanoutbreakalarm,i.e.,anoutbreak
alarmis generatedif atleast 20%ofthe nodesvoteforan
Summary: Similarity of the two blacklists is positively
alarm.Anodevotesforanalarmifthefollowingholds:1
correlatedwiththeIPdistancebetweentheirrespectivenet-
works. This observation has several consequences in the • 200%increaseinnumberscansfromthehourlyaver-
contextofDOMINO.First,satellitenodesinthesame/16 age,and
IPaddressshouldbeorganizedunderasingleaxisnodeand
• 100%increaseinthenumberofsourcesfromhourly
thatthesetof/16addressspacesshouldberandomlydis-
average,and
tributedamongtheaxisparticipants.Second,whenanaxis
node generates its version of global summary, simple ag- • numberofsourcesisgreaterthanfive.
gregationwouldbelikelytoworkjustaswellasweighted
Thereactiontimeisdefinedastheelapsedtimebetween
merging.
theinflectionpointandthefirstalarmafterthatpoint. Fig-
4.5 RetrospectiveAnalysis: SQLSnake ure6showsthedecreaseinobservedreactiontimefroman
averageofmorethananhourwithasinglenodetoalmost
Inthissection,weperformaretrospectiveanalysisonthe
zero as we add sufficient axis nodes (approximately 50).
SQL-Snake Outbreak from May 2002. Unlike its prece-
Figure7displaystheaveragenumberofalarms,whichde-
dents(CodeRedandNimda)SQL-Snakewas arelatively
creaseswithtopologysizeandstabilizesatabout8. These
slow-spreadingworm,duetothesmallsizeofthesuscep-
alarms are not false alarms, but correspondexactlyto the
tible population and its mode of propagation (TCP). We
8 preceding hours before the inflection point that show a
wantedtomeasurehowinformationsharingthroughasys-
gradualincreaseinthesourceratesandarepointswhenthe
tem like DOMINO would affect reaction time and alarm
outbreakcould have been predicted earlier by DOMINO.
rate during such an outbreak. We randomlyselected 100
Theoscillatorybehaviorofthe alarmrateis anartifactof
/24networksandtrainedthemwiththeportsummarydata
therulethatrequiresatleastanintegral20%ofthepartici-
of port 1433 (used by MS-SQL server) for the first two
pantstovoteforanoutbreak.
weeks of May. In particular, for each network we mea-
suredthehourlyaveragenumberofscansandtheaverage Summary: By adding sufficient nodes, outbreaks can be
numberofsources. detected early with minimal reaction time and few false
Figure5showsthehourlyscanningrateintermsofthe alarms.
numberofscans andthenumberofdistinct sourcesscan-
4.6 RetrospectiveAnalysis:SQL-Sapphire
ning port 1433 during the 48 hours surrounding the out-
break. We denote the first visually apparent point of an The SQL-Sapphireworm also knownas SQL-Slammer
outbreak(5/21,00:00)astheinflectionpoint. was released in January 2003, and wreaked significant
We simulated 100 random iterations of DOMINO net- havoconthenetworkinginfrastructuresinundertenmin-
works of axis nodes and in each iteration we measured utes. Thewormdistinguisheditself fromits predecessors
the number of outbreak alarms generated in networks of
size ranging from 1 to 100 nodes. We assumed that the 1Wecouldhavechosenamorecomplicatedruleforgeneratingalarms
(forexample,onebasedonstatisticalanomalydetection). However,this
DOMINO nodes exchangehourlysummaries of scanning
simplerulesufficestoillustrateourpoint.12000
9000
6000
3000
0
Time (Jan 25, 2003)
snacS
fo rebmuN
32000
No. sources / minute
24000
16000
8000
0 05:06:00 05:18:00 05:30:00 05:42:00 05:54:00
secruoS
fo rebmuN
3000
No. scans / minute
2500
2000
1500
1000
500
01 10 100
Number of Subnets
(a)Scanratesonport1434surroundingSQL-SapphireOutbreak
(01/25/20035:00-6:00am).
)sdnoces(
emiT
noitcaeR
Rule 1
Rule 2
Rule 3
(b)ReactionTimeforSQL-SapphireOutbreak.
Figure8.StatisticsforSQL-sapphire.
byitssmallpayloadsize(singleUDPpacketof404bytes) repeated the previous experiment with 100 random itera-
that enabled a rapid propagation rate in spite of a small tions. In each iteration, we picked 100 random class-C
susceptible population (75000) [27]. The reality of such subnets and used the data from first 2 weeks of January
high speed worms [44] implies that distributed architec- totrainthesystem. Wemeasuredepisoderates,simulated
tures, such as DOMINO,might havethe best opportunity spontaneousalertsandthencatalogedthechangereaction
todetectandreacttosuchwormoutbreaks. timeasweaddadditionalsubnetsundereachofthe3rules.
Figure8(a)showstheexponentialincreaseinthenumber Figure8(b)shows that by addingsufficient nodes, the re-
ofscansandnumberofsourcesintheminutesfollowingthe actiontimecanbereducedtoafewseconds. Thegoalof
outbreak. For such epidemics, alarms generated through DOMINOisnotoutbreakcontainmentbutratheroutbreak
hourlyaxis summariesdo not suffice. DOMINO’s mech- recognition and insulation of maximal number of partici-
anism to deal with such scenarios are spontaneous alerts pants [29].
thatareissuedthroughtriggers. In [51]theauthorsshowthattheworminfectionrateand
Whenever possible, DOMINO nodes associate related susceptibilitycanbeaccuratelypredictedbyobservingdata
packets with episodes, e.g., horizontal scan episode (se- collectedfromasinglenetworkthatspansasmallfraction
quentialscanofseveralmachinesinthesamesubnetaimed oftheentireaddressspace.
atthesametargetport),verticalscanepisode(scanofmul-
4.7 SlowScanners:BlacklistEvasion
tiple ports of single IP to survey several vulnerabilities),
andacoordinatedscanepisode(distributedscanofasub- In this section we evaluate the ability of slow scan-
netthroughmultiplesources). Forepisodesoneveryport, ners to evade blacklists generated by the infrastructure.
DOMINOnodesmaintaintheaveragenumberofscans,the DOMINOaxisnodesperiodicallyexchangeblacklistsum-
averagenumberofattacksourcesandtheduration. Atrig- marieswhichcontainafinitelistofTop-Nlocalworstof-
ger for a spontaneous alert can be defined as an episode fenders and their volume of activity. For simplicity, we
thatdeviatesfromtheaverageasfollows:2
assume that summaries are generated at networks on the
• numberofsourcesis>5,and orderof/16-s. Toensurethatasourcedoesnotappearin
theglobalblacklist, it must ensurethat it does notappear
• thenumberofscansis>10timestheaverage,or inanyofthelocalblacklistsummaries.
Theoptimalstrategyforanomniscientadversarywould
• thenumberofsourcesis>10timestheaverage,or
betosimultaneouslyscanallsubnets,suchthattherateat
• thedurationis>10timestheaverage. each/16wouldbebelowtheblacklistthreshold(volumeof
theN-thoffender).Inthisscenario,thetimetocompletely
Werecognizetheexistenceofanoutbreakwhenatleast scan a single subnet would essentially be the same as the
10% (rule 1), 20% (rule 2) or 30%(rule 3) of the partic- timerequiredtoscantheentireIPaddressspace.Theutility
ipants generate a spontaneous alert in the last hour. We of DOMINO in such scenarios is in its ability to prolong
thisscanningprocess.
2Asintheprevioussubsection,wecanuseamoresophisticatedrule
We perform a worst case analysis using logs from
togenerate aspontaneous alert. However, asimple rulewill sufficeto
DSHIELD.Weconstructedhourlyanddailyblacklistsona
illustrateourpoint.
/16foranentiremonthandcomputedthe90-thpercentile1e+05
10000
1000
100
10
1
20 40 60 80 100
Source Rank
)elitnecreP
ht09(
emuloV
lacipyT
1000
Hourly Blacklist
Daily Blacklist
800
600
400
200
0
20 40 60 80 100
Blacklist Length
(a)TypicalvolumeofTop100offendersinhourlyanddaily“lo-
cal”blacklists.
)syaD(
tenbus
eht
nacs
ot
emiT
Hourly Blacklist
Daily Blacklist
(b)Minimaltimerequired(inDays)toevadeaTop-Nblacklistand
scanthesubnet.
Figure9.BlacklistEvasion.
values as the basis for blacklist thresholds for N from 1- maybeattempted.Theseincludeattacksintentupondeny-
100. Figure 9 shows the blacklist thresholds and how ingserviceintheinfrastructure,attemptstoinfiltratethein-
the time to scan an entire subnet (or IPv4 address space) frastructure,andattacksintentuponreducingDOMINO’s
changeswiththeblacklistsize(N)andgranularity(hourly, effectiveness.
daily).Thereareseveralnoteworthycharacteristicsinthese
5.1 DenialofService
graphs.
First, hourlyanddailyblacklistscanbeaneffectivede- Threat: Anattempttoeffectivelyremovenode(s)through
terrantforevasivescanners.Thefigureshowsthattoevade DoSattackfromsystemsoutsideofDOMINO.
adailyblacklistof100sourcesitwouldtakealmost1000 Remedy: Inthefaceofstandardpacketfloodattacks,itis
days (little less than 3 years) and more than 400 days to certainlypossiblethatsomeset ofDOMINOnodescould
evadeanhourlyblacklistoftop40sources. Secondly,for be effectivelyremovedfrom the infrastructure. In fact, it
largervaluesofN,dailyblacklistsseemtobemoreeffec- is a non-goal of the infrastructure to protect nodes from
tive than hourlyblacklists. Finally, the staircase behavior DoS attack. However, the distributed, coordinatednature
ofthehourlyblacklistisduetotheheavy-tailednatureof oftheinfrastructuremakesitrobusttotheremovalofnodes
hourlysources. Forexample,for60≤ N ≤ 100we have throughfailuresorattacks.
sources that haveexactly 4 scans duringthe hour, and 50
≤ N ≤ 60correspondsto 5scans. The flat regionat 0≤ Threat: A compromised DOMINO node begins sending
N ≤ 20inthedailyblacklistscorrespondsto sourcesthat largeamountsof what appearsto be legitimatedata in an
attempttomountaDoSattackonanotheraxisnode.
horizontallyscantheentire/16exactlyonce(65Kscans).
Remedy: Anaxisnodecanapplyfilterstoincomingdata
5 Threat Vulnerability suchthatdatasentbyanynodeorsetofnodescannotex-
ceedaspecifiedthreshold.Theconfigurationoffilterswill
As a widely deployed infrastructure, DOMINO itself
bedependentbothuponsystemresourcesanduponhistor-
must be considered a target for attacks. To be effective,
icalvariability. Ifmultipleaxis nodeshavebeencompro-
DOMINOmustberesilienttoavarietyofattacks.Whileits
mised,thenfilteringcouldceasetobeeffective.
designisrobust,wehavenotattemptedtoaddressallpos-
siblevulnerabilitiesofDOMINOtoattack.Byvirtueofthe 5.2 Infiltration
fact that its architectureenables heterogeneousclient par-
Threat:Anattempttomasqueradeasanaxisnode.
ticipation,itmaywellbeinfeasibletoaddressallpossible
Remedy:AsdiscussedinSection3.3,weassumethataxis
vulnerabilities. WeaddressthreatstoDOMINOthrougha
nodes are intermittently forced to participate in a mutual
model that considers the most likely forms of attacks that
authenticationprotocolbyotheraxisnodes.IfanaxisnodeN fails the authentication protocol initiated by a specific 6 ConclusionsandFuture Work
axis node, it broadcasts a message to axis nodes in the
DOMINOnetworkinformingthemthataxisnodeN might In this paper, we describe and evaluate DOMINO, a
cooperative intrusion detection system. DOMINO is de-
becompromised.
signedtoenableintrusioninformationsharinginaglobally
5.3 Obfuscation distributednetworkconsistingof: 1)trustedaxisnodesor-
ganizedinapeer-to-peeroverlay,2)satellitenodesassoci-
Threat: A compromised node sends data (perhaps large
ated with each axis node that are hierarchicallyarranged,
amounts)thatissupposedtoberealinanattempttoobfus-
3) terrestrial nodes, which are deployed at the leaves of
catesomeotheractivity.
the infrastructure,that providedaily intrusionsummaries.
Remedies: There are two remedies for this threat. First,
DOMINO’sdesignisbasedonheterogeneousdatacollec-
nodesattachaSHA-1digestwitheachblockofdata. The
tion through NIDS, firewalls and active-sinks. This ar-
collisionresistantpropertyofSHA-1willmakeitveryhard
chitectureenablesDOMINO to be secure, scalable, fault-
for the adversary to tamper with the data sent by an axis
tolerant,andfacilitatesdatasharing.
node. The second remedy stems from the distributed na-
Our evaluationof DOMINO is based on data from two
ture of DOMINO. When results are forwarded between
sources. The first is a set of intrusionlogs collectedover
axisnodes,filterscanbeappliedduringthedatafusionpro-
afourmonthperiodfromover1600networksworldwide.
cesssuchthatnosinglenodehastheabilitytoskewresults
Thesecondis froma prototypesink implementationon a
throughsimplyincreasingdatavolume. Filteringwithina
single network which monitors over 100K IP addresses.
nodesetbelowanaxisnodecanalsobeappliedatthedis-
Our evaluation clearly demonstrates the utility of sharing
cretionoftheaxisnode. Theeffectwillbethesameasthe
information between multiple nodes in a cooperative in-
axislevelfilter. Forobfuscationattacksnotbasedonvol-
frastructure. Weuseaninformation-theoreticapproachto
ume, the fusion process is designed to emphasize the co-
showthatperspectiveonintrusionscanbegreatlyenhanced
ordinatedperspectivewhichsignificantlyreducesorelimi-
bycooperationofarelativelysmallnumberofnodes. Us-
natestheeffectivenessofthisattack.
ing the 2002 and 2003SQL-worm outbreaks, we demon-
Threat:Attemptsatstealthyand/orcoordinatedscanning. stratethatfalse-alarmratescanbesignificantlyreducedin
Remedy: Perhaps the most important strength of DOMINOandthatreactiontimeforoutbreakdetectioncan
DOMINOistheenhancedperspectiveaffordedthroughco- besimilarlyreduced. Finally,weprovideaninitialevalu-
ordinationofmultiplesites. Thisenhancedperspectivecan ationoftheeffectivenessofactive-sinksindiscriminating
expose both stealthy and coordinatedscans at much finer betweentypesofattacksbasedonexaminingpayloaddata.
granularitythandetectionatasinglesite. However,ifthe Our results clearly demonstrate that active-sinks provide
adversary is willing to sufficiently slow their scanning or importantinsight in this regard. Based on these analysis,
employssufficientlymanynodesinacoordinatedfashion, we conclude that DOMINO offers a significant opportu-
theycouldstilleludedetectioninDOMINO.Theremedyis nitytoimproveintrusionandoutbreakdetectioncapability
toincludeenoughnodesinDOMINOtomakethethreshold intheInternet.
onstealthyorcoordinatedscanninghighenoughtorender We intend to pursue future work in a number of direc-
thisalternativeinfeasible. tions. First,weplantodevelopmoreinteractive-sink-hole
responders that would further enhance attack discrimina-
Threat:Anattempttoavoidactive-sinknodes.
tioncapability.Secondly,weplantodeployanoperational
Remedy: Themostbasic functionofactive-sinknodesis
DOMINO infrastructure. This will enable us to test and
to track scanningactivity onunusedIP addresses. In this
furtherdeveloptheDOMINOtopologycreationandmain-
sense,theywillalwaysbeusefulevenifsomeadversaries
tenance protocols. As we expand, the infrastructure will
can isolate their use to specific networks or IP addresses
enablecasestudiesoffutureintrusionandoutbreakactiv-
within networks. The combineduse of an NIDS (on live
ity. Wealsoplantoinvestigatealternativemethodsforin-
IP addresses) and active-sinks (unused IP addresses) will
formationmergingandsharingwiththegoalofimproving
meanthatallintrusionattemptshavethepossibilityofbe-
efficiencyandprecision. Finally,weplantodeveloptools
ingtracked.Asimplewaytoconfuseactive-sinkidentifica-
forautomatingfirewallrulegeneration.
tionistoemployprobabilisticresponses. Namely,instead
ofrespondingto all SYN packetsin an IPblock, onlyre- Acknowledgements
spondtosomenumberofthem.
We believe that as long as attackers spoof source ad- TheauthorswouldliketothankJohannesUllrichforpro-
dresses and active-sink nodes monitor significant fraction viding access to the DSHIELD logs. Thanks also go to
of the unused IP space, traffic captured by the sinks will David Plonka for his great help in getting the DOMINO
providevaluableinsightintonetworkintrusions. active-sink up and running. Finally we would like tothank the anonymous reviewers and our shepherd Ange- [16] IDG. Study: Code Red costs top $2 billion.
losKeromytisforvaluablesuggestionsthathelpedsubstan- http://www.thestandard.com,August2001.
tially improve the content and organization of the paper. [17] IDWG. Intrusion Detection Message Exchange Format.
This work was supported in part by the Office of Naval
http://www.ietf.org/html.charters/idwg−charter.html,2003.
[18] K. Ilgun, R. Kemmerer, and P. Porras. State transi-
Research (ONR) under contract N00014-01-1-0708 and
tion analysis: A rule-based intrusion detection approach.
ArmyResearchOffice(ARO)undercontractDAAD19-62-
IEEE Transactions on Software Engineering, 21(3):181–
1-0304.
199,March1995.
[19] R. Janakiraman, M. Waldvogel, and Q. Zhang. Indra: A
References
peer-to-peer approach to network intrusion detection and
prevention. UnpublishedManuscript,2003.
[1] J.Allen,A.Christie,W.Fithen,J.McHugh, J.Pickel,and
[20] N.Koblitz. Ellipticcurve cryptosystems. Mathematicsof
E.Stoner. Stateofthepracticeofintrusiondetectiontech-
Computation,48:203–209,1987.
nologies. Technical Report CMU/SEI-99-TR-028, Soft-
[21] C.Krugel,T.Toth,andC.Kerer. Decentralizedeventcor-
wareEngineeringInstitute,CarnegieMellon,January2000.
relationforintrusiondetection. InProceedingsofInforma-
[2] K.G.Anagnostakis,M.B.Greenwald,S.Ioannidis,A.D.
tionSecurityandCryptology(ICISC),Seoul,Korea,pages
Keromytis,andD.Li. Acooperativeimmunizationsystem
114–131,December6–72001.
foranuntrustinginternet. InProceedingsofthe11thInter-
[22] W.Lee,S.Stolfo,andK.Mok. Adataminingframework
nationalConferenceonNetworks(ICON),2003.
for building intrusion detection models. In IEEE Sympo-
[3] D.Andersen,H.Balakrishnan,F.Kaashoek,andR.Morris.
siumonSecurityandPrivacy,1999.
Resilientoverlaynetworks. InProceedingsof18thSympo-
[23] W. Leland, M. Taqqu, W. Willinger, and D. Wilson. On
siumon Operating SystemPrinciples SOSP,Lake Louise,
the self-similar nature of Ethernet traffic (extended ver-
Alberta,October2001.
sion). IEEE/ACMTransactionsonNetworking,pages2:1–
[4] R. Anderson and A. Khattak. The use of information re-
15,1994.
trieval techniques for intrusion detection. In Proceedings
[24] T.Liston. Labreahomepage. http://www.hackbusters.net,
ofFirstInternationalWorkshopontheRecentAdvancesin
2003.
IntrusionDetection(RAID),September1998.
[25] T. Lunt, A. Tamaru, F. Gilham, R. Jagannathan, P. Neu-
[5] J.S.Balasubramaniyan,J.O.Garcia-Fernandez,D.Isacoff,
mann, H. Javitz, A. Valdes, and T. Garvey. A real-time
E. H. Spafford, and D. Zamboni. An architecture for in-
intrusiondetectionexpertsystem(IDES)-finaltechnicalre-
trusiondetectionusingautonomousagents. In14thAnnual
port. Technicalreport,ComputerScienceLaboratory,SRI
Computer Security Applications Conference (ACSAC’98),
international,MenloPark,California,February1992.
pages13–24,December7–111998.
[26] R.Mahajan,S.Bellovin,S.Floyd,J.Ioannidis,V.Paxson,
[6] S. Bellovin and W. Cheswick. Network firewalls. IEEE
andS.Shenker. Controllinghighbandwidthaggregatesin
CommunicationsMagazine,September1994.
the network. In Computer Communications Review V32,
[7] P. B. A. Bestavros, J. Byers, and M. Crovella. On the
N3,July2002.
marginalutilityofnetworktopologymeasurements.InPro-
[27] D. Moore, V. Paxson, S. Savage, C. Shannon, S. Stan-
ceedingsofACMSIGCOMMInternetMeasurementWork-
iford, and N. Weaver. The Spread of the Sap-
shop,SanFrancisco,CA,November2001.
phire/Slammer Worm. http://www.caida.org/outreach/-
[8] C.C.Center. http://www.cert.org,2001.
[9] CERT. Cert Incident Note IN-2002-06. papers/2003/sapphire/sapphire.html,2003.
http://www.cert.org/incident note/IN-2002-06.html, [28] D.Moore,C.Shannon, andK.Claffy. CodeRed: ACase
2002. Study on the Spread and Victims of an Internet Worm.
[10] F.Cuppens. Managingalertsinamulti-intrusiondetection InProceedingsofACMSIGCOMMInternetMeasurement
environment.InProceedingsofthe17-thAnnualComputer Workshop,November2002.
SecurityApplicationsConference(ACSAC),2001. [29] D.Moore,C.Shannon,G.Voelker,andS.Savage. Internet
[11] F.Cuppens andA.Miege. Alertcorrelationina coopera- quarantine: Requirements for containing self-propagating
tiveintrusiondetectionframework.InProceedingsofIEEE code. InProceedingsofIEEEINFOCOM,April2003.
SymposiumonSecurityandPrivacy,pages202–215,2002. [30] D. Moore, G. Voelker, and S. Savage. Inferring internet
[12] F.CuppensandR.Ortalo.LAMBDA:Alanguagetomodel denial of service activity. In Proceedings of the USENIX
adatabasefordetectionofattacks.InProceedingsofRecent SecuritySymposium,WashingtonD.C.,August2001.
Advances in Intrusion Detection (RAID), pages 197–216, [31] B.Mukherjee,L.T.Heberlein,andK.Levitt. Networkin-
2000. trusiondetection. IEEENetwork,May/June1994.
[13] M.Dacier. Towards QuantitativeEvaluationofComputer [32] R. Needham and M. Schroeder. Using encryption for au-
Security. PhD thesis, Institut National Polytechnique de thentication inlargenetworksofcomputers. Communica-
Toulouse,December1994. tionsoftheACM,21:993–999,1978.
[14] I. Goodman, R. Mahler, and H. Nguyen. Mathematics of [33] S. Northcutt. Network Intrusion Detection: An Analyst’s
data fusion. Kluwer Academic Publishers Group, Dor- Handbook. NewRiders,1999.
[34] V.Paxson.BRO:ASystemforDetectingNetworkIntruders
drecht,1997.
[15] R.Gray.EntropyandInformationTheory.Springer-Verlag, inRealTime. InProceedingsofthe7thUSENIXSecurity
1990. Symposium,1998.[35] A.Perrig. TheBiBAone-timesignatureandbroadcastau- extendthe schema proposedby the IDWG (IntrusionDe-
thenticationprotocol. InProceedingsofthe8thACMCon- tection Working Group) in IDMEF (Intrusion Detection
ferenceonComputerandCommunicationsSecurity(CCS), Message Exchange Format) draft [17]. Our schema adds
November5-82001. fivenewmessagetypestothetwoprovidedbytheIDMEF
[36] N.Provos. Honeyd -avirtualhoneypot daemon. InPro-
(alerts and hearbeats). The seven message categories in
ceedingsofthe10thDFN-CERTWorkshop,February2003.
DOMINOareasfollows:
[37] R.Rivest,A.Shamir,andL.Adelman.Amethodforobtain-
ingdigitalsignaturesandpublic-keycryptosystems.Coom- Alerts-Alertsarespontaneousresponsestoeventsasde-
municationsoftheACM,21:120–126,1978. finedbyNIDSandfirewallorcustompolicies. Mostalerts
[38] M.Roesch. Snort-lightweightintrusiondetectionfornet-
are generatedat the small networks or satellites, however
works. In Proceedings of the USENIX LISA conference,
they might get propagatedto the axis level dependingon
November1999.
the pervasiveness and severity. Alert clustering and sup-
[39] M.Roesch. TheSNORTNetworkIntrusionDetectionSys-
pressionisaverychallengingproblemandvitaltotheop-
tem. http://www.snort.org,2002.
[40] P. Rohtagi. A compact and fast hybrid signature scheme erational success of the infrastructure. The IDMEF draft
formulticastpacket. InProceedingsofthe6thACMCon- defines a few alert classifications: tool alert, correlation
ferenceonComputerandCommunicationsSecurity(CCS), alertandoverflowalert.TheDOMINOaxisnodesalsoex-
pages93–100,1999. changealertswhenthereisasignificantdeviationfromthe
[41] S.Savage,D.Wetherall,A.Karlin,andT.Anderson. Prac- periodicsummaries. For example, outbreakalerts, black-
ticalNetworkSupportforIPTracback. InProceedingsof
listalertsanddenial-of-serviceattackalerts. TheDTDfor
ACMSIGCOMM,2000.
analertisasfollows:
[42] O.Sheyner, J. Haines, S.Jha, R.Lippmann, and J.Wing.
Automatedgenerationandanalysisofattackgraphs.InPro- <!ELEMENT Alert (CreateTime, DetectTime?,
AnalyzerTime?, Classification, Source*, Target*,
ceedingsofIEEESymposiumonSecurityandPrivacy,May
AdditionalData?)>
2002. <!ATTLIST Alert version CDATA #FIXED ’1’, ident
[43] S.Staniford,J.Hoagland,andJ.McAlerney. Practicalau- CDATA #REQUIRED, impact CDATA ’unknown’>
tomateddetectionofstealthyportscans. InProceedingsof
SummaryMessages-DOMINOsummariesaretypically
theACMCCSIDSWorkshop,November2000.
exchangedby the axis peers in one of three possible for-
[44] S.Staniford, V.Paxson, and N.Weaver. HowtoOwnthe
Internet in Your Spare Time. In Proceedings of the 11th mats relating to the type of information being transmit-
USENIXSecuritySymposium,2002. ted.Thesummarymessagetypesinclude:PortSummaries,
[45] H. Teng, K. Chen, and S. C.-Y. Lu. Adaptive real-time SourceSummariesandClusterSummaries.DOMINOalso
anomaly detection using inductively generated sequential defines three levels of trust (low, medium and high) for
patterns. In IEEE Symposium on Security and Privacy, summary messages based on their source (axis/satellite).
pages278–284,1999. The choice of three levels of trust is somewhat arbitrary
[46] J.Ullrich. DSHIELD.http://www.dshield.org.
andareusedascuesforintelligentaggregation. TheDTD
[47] A. Valdes and K. Skinner. Probabilistic alert correlation.
forsummarymessagesisasfollows:
InProceedings ofRecentAdvances inIntrusionDetection
(RAID),pages54–68,2001. <!ELEMENT Summary (CreateTime, SummaryDuration,
[48] C.Warrender,S.Forrest,andB.Pearlmutter. Detectingin- IPBlockSummary+)>
<!ATTLIST Summary version CDATA #FIXED ’1’, ident
trusions using system calls: Alternative data models. In
CDATA #REQUIRED>
IEEESymposiumonSecurityandPrivacy,pages133–145, <!ELEMENT IPBlockSummary (MinIP, MaxIP, IPCount,
1999. TrustLevel, PortSummary?, SourceSummary?,
ClusterSummary?)>
[49] V.Yegneswaran,P.Barford,andD.Plonka. OntheDesign <!ELEMENT PortSummary (VulnID/PortNum, NumUniqSrcIP,
and Utilityof Internet Sinks for Network Abuse Monitor- NumUniqDestIP, ScanCount>)
<!ELEMENT SourceSummary (VulnID/PortRange, ScanCount,
ing. UniversityofWisconsinTechnicalReport,2003.
AggregateScanCount, NumUniqTargets)>
[50] V.Yegneswaran, P.Barford,andJ.Ullrich. Internetintru- <!ELEMENT ClusterSummary(SrcIPList, DestIPList,
sions: Global characteristics and prevalence. In Proceed- VulnID/PortRange, ScanCount)>
ingsofACMSIGMETRICS,June2003.
Heartbeats-InDOMINOtheSatelliteNodesperiodically
[51] C.C.Zou,L.Gao,W.Gong,andD.Towsley. Monitoring
exchangeheartbeatmessageswiththeparentnodes.These
andearlywarningforinternetworms.InProceedingsofthe
10th ACM Conference on Computer and Communications areusedtoindicatethecurrentstatustohigherlevelnodes
Security(CCS),October2003. andvice-versa.Theseintervalofheartbeatsisleftuptothe
satellites,itcouldbesayevery10minutesoreveryhour.
A DOMINOMessages <!ELEMENT Heartbeat (CreateTime, AnalyzerTime,
AdditionalData*)>
<!ATTLIST Heartbeat ident CDATA #REQUIRED>
Tofosterinteroperabilityandmaximizeextensibilitythe
DOMINOprotocolmessagesarerepresentedinXML.WeTopology Messages - There are four different types of B InformationSharing
topology messages: adopt, detour, recall, and divorce.
Potential strategies for information sharing include the
When a satellite node is disconnected from its parent, it
following:
tries to reconnect through the normal heartbeat exchange
protocol. Ifthisfails,itissuesanadoptmessagetoaDAP Local aggregation: Once intrusioninformationhas been
thatisthenmulticasttotheoverlayofaxisnodes. Anaxis gatheredatthesatellitenodes,thenextstepis toconsider
node might forward the adopt message to any applicable how to organize and refine the data to create a coherent
children. Thesatellite analyzestheacknowledgmentsand pictureofmaliciousactivities. Moreover,ifsatellitenodes
respondswithadetourmessagetothemosteligibleparent. send “raw alerts”, the axis nodes will get overwhelmed.
When an axis or satellite parent restarts, it issues a recall Therefore, alerts from the satellite nodes need to be “ag-
messagetoall its children. Thechildcanaccepttheinvi- gregated”beforetheyarecommunicatedtotheaxisnodes.
tation to rejoinbyissuing a divorcemessage to the foster Cuppens [12] describesa cooperativeintrusiondetection
parent and a simultaneous detour message to the original moduleorCRIMasameansforcombiningalertsfromdif-
parent. ferentIDSs. DOMINOadoptsandextendsthisdesignfor
thepurposesofaggregating“rawalerts”.
<!ELEMENT TopologyMessage (CreateTime, Type,
IPBlockSummary?>)
<!ATTLIST TopologyMessage version CDATA #FIXED Global aggregation: The most straight-forward way to
’1’, ident CDATA #REQUIRED>} merge logs from multiple sites is through a simple addi-
Queries - The DOMINO Query Messages are exchanged tionoraverageacrosseachdimensionofdata. Whilethis
inXQueryformat. Sincetheaxisnodesmaintainaconsis- approachprovidesasimplemeansfororganizingandsum-
tentschemainter-axisqueriescouldbedoneinSQL.How- marizing data, it also has the risk of inaccuracy. As an
ever,wechosetouseXQuerytomaximizeinteroperability example, consider the case of a Port Summary. It seems
with satellites. We providean examplequerywhich is to logicalto addthe the numberofscans and thenumberof
unique destinations, but simply adding the set of unique
createatop10blacklistforport1433betweentwospeci-
fiedtimes: sources across axis nodes is almost certainly not appro-
priate. DOMINO currently performs simple aggregation
for $src in distinct(document("scans.xml"))//source
for Port Summaries (but does not consider the results for
let $scan := document("scans.xml")//:scan[source = $src]
let $time := $scan/timestamp, $port = $scan/port sources).
where $port = 1433 and $time > 1044206900
and $time < 1044206960 Weighted merging: A potentially important considera-
return
<blacklist> tion in fusing summaries is IP address proximity. In par-
<source> {$src} </source> ticular, summaries generated from “neighboring” IP ad-
<num_scans> {sum{$scan/count}} </numscans>
</blacklist> dress blocks might be more germane than those gener-
} sortby {sum{$scan/count}} limit 10 ated in a “distant”network(since it is not uncommonfor
scansorattackstoproceedhorizontallythroughIPspace).
DB Updates - The DOMINO protocol also provides an
A weighted merging approach that emphasizes proximity
automaticmechanismfor updatingNIDS rulesets and the
mightbemoreappropriate. DOMINOcurrentlyperforms
axisvulnerabilitydatabase. Thiscanalsobeconsideredas
averysimpleweightedmergingofblacklists.
a means for dispensingtimely content based filters to the
satellites. Theformatofthesemessagesisstraightforward. Sampling: Samplingis the standardmethodforreducing
<!ELEMENT DBUpdate (CreateTime, VulnerabilityID, thescale of measurementdata. Thegoalin anysampling
Signature)> approach is to balance quantity of data with precision of
<!ATTLIST DBUpdate version CDATA #FIXED ’1’, ident
CDATA #REQUIRED, description CDATA> measurement. In the case of DOMINO, this is challeng-
<!ELEMENT Signature (TargetPorts+, Payload?, ing since intrusions can take the form of attacks (which
SourcePort*, Protocol+, Seqno?)>
would be easy to sample) and stealthy scans (rare events
Triggers - Triggers can be issued by DOMINO axis and whicharehardtosample). Anysamplingmethodusedin
satellitestonodesthatarelowerinthehierarchy.Atrigger DOMINO would have to poses the ability to expose both
hasthreecomponents1)Query2)Constraintand3)Action. typesofevents. Weareinvestigatingthefeasibilityofem-
We definetwotypesofactions: alertsandfilterrules. An ployingsamplingasatechniquefordatasharing.
exampleofantriggeristhegenerationofanoutbreakalert ArelatedissuethatisimportantinDOMINOistheaging
whenthenumberofscansexceedsacertainthreshold. oflocal data. The packet data accumulatedin largesinks
couldbeontheorderof100’sofMegabytesperday.Sum-
<!ELEMENT Trigger (CreateTime, Query, Constraint,
Action)> maries, however, are meant to be light weight so simply
<!ATTLIST Trigger version CDATA #FIXED ’1’, ident purgingdataolderthanacertainnumberofdaysmightbe
CDATA #REQUIRED, description CDATA>
<!ELEMENT Action (Alert?, Filter?)> areasonableapproachinpractice. However,caremustbefromtheactive-sink. Thepositiveflowsareoutboundand
Table1.MonthlysummaryofDSHIELDlogs
thenegativeareinbound. Asmightbeexpected,thenum-
Month No:Scans No:DestIPs
berofinboundpacketsishigherthanoutboundbecausethe
May.2002 48million 375,323
active-sinkdoesnotrespondtothepersistentpayloadpack-
June.2002 61million 382,224
ets.Thedifferenceinthenumberofinboundandoutbound
July.2002 68million 402,050
flows is an artifact of the way flows are accountedover5
minuteintervals. Itshouldnotbesurprisingthatthereare
nooutboundUDPpackets. Thenumberofinboundpack-
takentoensurethatperiodicpatterns,suchasthemonthly
etswastypicallybetween200-300packetsorabout40-50
riseandfalloftheCodeRedworm,arenotlost.Atpresent,
connection attempts per second. The active-sink running
we proposethatDOMINO maintainsummariesat several
onaPentium4LinuxPC,hadnoproblemcopingwiththis
granularities and uses weighted averaging to merge older
trafficratesincenoper-connectionstateismaintained.The
summarieswithmoretimelydata.
connection attempts spanned a wide variety of ports and
C IntrusionTrace Data originatedfromhundredsofthousandsofsources. Atyp-
ical summary of the top ports for a given week is shown
WeuseasetoffirewallandNIDSlogsofportscanscol- in Table 3. The ms-sql-s and ms-sql-m scans correspond
lected overa 4 monthperiod from over1600 firewall ad- totherecentSQL-SapphirewormandSQL-Snakerespec-
ministrators distributed throughout the globe as the basis tively. The HTTP probes are from Code Red and Nimda
for analysis of DOMINO. The logs provide a condensed infectedhosts. Themicrosoft-dsscans,port139,port135
summary (lowest common denominator) of portscan ac- scans are from the Lioten worm [9]. These are followed
tivity obtainedfromvariousfirewall andNIDS platforms. byscansforfourdifferentopenproxyservers(oftenused
Some of the platforms supported include BlackIce De- asameansobfuscateInternetactivity).
fender,CISCOPIX,ZoneAlarm,LinuxIPchains,Portsen-
try and Snort. This approach significantly increases the
coverageandreducesrelianceonindividualNIDS’sinter-
pretationofevents.
Table2illustratestheformatofatypicallogentry. The
date and time fields are standardized to GMT and the
providerhashallowsforaggregationofdestinationIPad-
dresses that belong to the same administrative network.
Table 1 provides a high level summary of the data that
wasusedinthisanalysis3. Thedatasetwasobtainedfrom Figure10.Protocolbreakdownofactive-sink
DSHIELD.ORG – a research effort funded by the SANS packetsJan28-Feb4.
Institute as part of their Internet Storm Center [46]. The
goalsof DSHIELDincludedetectionandanalysisof new
wormsandvulnerabilities,notificationtoISPsofexploited
systems,publishingblacklistsofworstoffendersandfeed-
backtosubmitterstoimprovefirewallrulesets. Thedatais
comprisedof logs submitted by a diverse set of networks
and includes 5 Class B networks, over 45 Class C sized
networksandalargenumberofsmallersub-networks.The
networksrepresentedinthisdatasetarewidelydistributed
both geographically and topologically in the autonomous
systemspace.Thisprovidesauniqueperspectiveonglobal
Figure11.Protocolbreakdownofactive-sink
intrusionactivityhighlightedbyDSHIELD’s contribution
flowsJan28-Feb4.
inthedetectionandearlyanalysisofCodeRed,Nimdaand
SQLworm(s)outbreaks.
An important application of the traffic captured by the
D PreliminaryResultsfromthe Active-Sink active-sink nodes is generating signatures for malicious
payloads, e.g., signature for a payload of a worm. Cur-
Figures10and11showthenumberofpacketsandflows
rently,NIDSusesimplepatternmatchingtoidentifymali-
per second respectively that were inbound and outbound
ciouspayloads.Thismethodcanleadtosignificantnumber
3WealsousedDSHIELDdataforport1433fromJanuary,2003for offalsepositivesbecausevariationsinmaliciouspayloads
ourSQL-Sapphireanalysis. cannot be detected. We demonstrate how the traffic cap-Table2.Samplelogentriesfromportscanlogs
Date Time Sub.Hash No:Scans SrcIP SrcPort TargtIP TargtPort TCPFlags
2002-03-19 18:35:18 provider2323 3 211.10.7.73 1227 10.3.23.12 21 S
2002-03-19 18:35:19 provider2323 16 211.10.7.73 1327 10.3.23.12 53 SF
Table3.Sampleweeklysummarytopprobedservices
Service Port Protocol Flows Octets Packets
ms-sql-s 1434 UDP 548838 388453676 1371925
microsoft-ds 445 TCP 541528 42580046 545867
ms-sql-m 1433 TCP 301428 115385725 997172
http 80 TCP 249569 66851055 728766
netbios-ss 139 TCP 99075 10894702 230539
AnalogX(ProxyServer) 6588 TCP 82707 8594185 134813
https 443 TCP 69025 7988260 158725
HyViewProxy 3128 TCP 27483 1146324 27970
http-alt 8080 TCP 27109 1109656 27374
WinNT/2000RPC 135 TCP 6765 291224 7279
turedbytheactive-sinknodescanbeusedtocreateamore peciallytrueofport80)thattryaslightlydifferentsearch
“robust”signatureforamaliciouspayload. pathfromthedefaultforthepresenceofanexploit.There-
Ourfirststepistoclusterthepayloadsofthetrafficob- fore, our experiments demonstrate that clusters naturally
served at the active-sink nodes. Intuitively, each cluster correspond to classes of malicious payload, so classifiers
corresponds to malicious payload. Next, we construct a generatedfromtheseclustersshouldbesuccessfuliniden-
classifierforeachcluster.Theseclassifierscanthenbeused tifyingmaliciouspayloads.
by a NIDS to identifymalicious payloads. We have only
performedtheclusteringstep. Inthefuture,wewillinves-
tigate constructing classifiers and their use in identifying
maliciouspayloads. However,theresultsoftheclustering
areencouraging.
We performedclusteringon datacollectedbetweenJan
6, 2003and Jan 28, 2003. First, we constructeda finger-
print for each payload. A fingerprintfor a payloadis the
distributionoverbytesbetween0x1Fand0x7E(theseare
the same bytes that are used by Snort in displaying pay-
Figure12.Variabilityinthepayloadclusters.
loads). Each fingerprintalso recordsthe numberof bytes
that were outside this range. The distance between two
Table4.ClusterSummary
payloadsistheKullback-Leiblerdistancebetweentheirfin-
Cluster Port(No.Scans)
gerprints. Payloadswereclusteredusingthek-means[15]
Cluster1 445(1090338)
algorithmandthesumofsquaredmetricwasusedtodeter-
Cluster2 80(1315982),3128(10995),8080(24066)
minetheoptimalnumberofclusters.
Cluster3 139(160668),443(27377),3128(7181)
Ourresults show thatthereare six distinct clusters(see
Cluster4 135(5791)
Table 4). Figure 12 provides a cumulative distribution
Cluster5 23(29108),80(2309958),8080(10770)
functionofthedistancefromtheclustercenters. Clusters
Cluster6 1433(2167842)
1 and 3 are perfect clusters (distance of zero). The clus-
ters with port 80 (2 and 5) and port 1433 seem to have
little more variability. Port 8080 scans in cluster 2 and 5
appeartobeCodeRed/Nimdavariants. Thevariabilityin
theseclusterscanbeattributedtotworeasons: eachattack
of CodeRed,NimdaandSQL-Snakeis a series ofsimilar
packetsthatattempttoopenashellandexecuteaseriesof
commands. Thereareseveralvariantsoftheseworms(es-