Using Directional Antennas to Prevent Wormhole Attacks
Lingxuan Hu David Evans
Department of Computer Science
University of Virginia
Charlottesville, VA
[lingxuan, evans]@cs.virginia.edu
Abstract Wireless ad hoc networks typically assume omni-
directional antennas. In this paper, we consider devices
Wormhole attacks enable an attacker with limited with directional antennas. Directional antennas have
resources and no cryptographic material to wreak havoc been shown to improve efficiency and capacity of wireless
on wireless networks. To date, no general defenses networks. Several MAC protocols [4, 14, 12, 20] and
against wormhole attacks have been proposed. This routing protocols [5, 2, 17] have been proposed that take
paper presents an analysis of wormhole attacks and advantage of directional antennas.
proposes a countermeasure using directional antennas. Next we provide background on secure routing
We present a cooperative protocol whereby nodes share protocols and previous work on preventing wormhole
directional information to prevent wormhole endpoints attacks. Section 3 considers wormhole attacks and
from masquerading as false neighbors. Our defense analyzes their effectiveness. Section 4 introduces
greatly diminishes the threat of wormhole attacks and directional antennas and describes the antenna model we
requires no location information or clock synchronization. use. Section 5 describes our protocols for verifying
neighbor relationships. Section 6 considers the impact of
our protocol on network connectivity and routing
1. Introduction performance, and Section 7 analyzes the impact of
directional errors. Section 8 concludes.
Wireless ad hoc networks have properties that increase
their vulnerability to attacks. Wireless links are inherently 2. Background
vulnerable to eavesdropping and message injection, as
well as jamming attacks. Constraints in memory, Several secure routing protocols have been proposed for
computing power, and battery power in mobile devices wireless ad hoc networks. Papadimitratos and Haas [23]
can impose trade-offs between security and resource present the SRP protocol that secures against
consumption. non-colluding adversaries by disabling route caching and
Routing in ad hoc wireless networks is an especially providing end-to-end authentication using an HMAC
hard task to accomplish securely, robustly and efficiently. primitive. SEAD [7] uses one-way hash chains to provide
Many proposed routing protocols are focused on energy, authentication for DSDV [21]. Ariadne [8] uses an
and provide no protection against an adversary. Some authenticated broadcast technique [22] to achieve similar
secure routing protocols also have been proposed. security goals on DSR [11]. Marti et al. [16] examine
However, due to the unpredictability of ad hoc networks, it techniques to minimize the effect of misbehaving nodes
is hard to detect behavior anomalies in route discovery. through node snooping and reporting, but it is vulnerable
In particular, proposed routing protocols cannot prevent to blackmail attacks. ARRIVE [13] proposes probabilistic
wormhole attacks. In a wormhole attack, an attacker multi-path routing instead of single path algorithm to
introduces two transceivers into a wireless network and enhance the robustness of routing. These secure routing
connects them with a high quality, low-latency link. protocols are still vulnerable to wormhole attacks which
Routing messages received by one wormhole endpoint are can be conducted without having access to any
retransmitted at the other endpoint. Attackers can exploit cryptographic keys.
wormholes to build bogus route information, selectively Wormhole attacks depend on a node misrepresenting its
drop packets, and create routing loops to waste the energy location. Hence, location based routing protocols have
of network. the potential to prevent wormhole attacks [15].Localization may be done using globally accessible
beacons that broadcast known locations (that may be A
pre-configured or determined using GPS [29]). Recently X
there has been some research to build localization system C
using localized protocols [19, 1, 10, 18]. The location Y
service itself may become the attack target. Localization
systems generally require some seed nodes that know their
B
own positions, which may not be possible in all network
environments. Sastry, Shankar, and Wagner propose a
protocol that verifies a node is located within a particular
Figure 1. Wormhole attack. The
adversary controls nodes X and Y and
region [28]. If an attacker acquires a wormhole endpoint
connects them through a low-latency link.
within the region, the attacker could make other nodes also
appear to be within the region. An adversary who
For most routing protocols, the attack has impact on
acquires a wormhole endpoint within the region has
nodes beyond the wormhole endpoints’ neighborhoods
already violated their security requirements.
also. Node A will advertise a one-hop path to B so that C
A previous approach for detecting wormhole attacks is
will direct packets towards B through A. For example, in
to use packet leashes [9]. A temporal packet leash places
on-demand routing protocols (DSR [11] and AODV [24])
a bound on the lifetime of a packet that restricts its travel
or secure on-demand routing protocols (SEAD [7],
distance. The sender includes the transmission time and
Ariadne [8], SRP [23]), the wormhole attack can be
location information in the message, and the receiver
mounted by tunneling ROUTE REQUEST messages
checks that the packet could have traveled the distance
directly to nodes near the destination node. Since the
between the sender and itself within the time between
ROUTE REQUEST message is tunneled through high
reception and transmission. Since radio transmissions
quality channel, it arrives earlier than other requests.
travel at the speed of light, temporal packet leashes require
According to the protocol, other ROUTE REQUEST
tightly synchronized clocks and precise location
messages received for the same route discovery will be
knowledge.
discarded. This attack thus prevents any other routes
Our approach to preventing wormhole attacks is for
from being discovered, and the wormhole will have full
nodes to maintain accurate information about their
control of the route. The attacker can discard all
neighbors (nodes within one hop communication distance).
messages to create a denial-of-service attack, or more
This is simpler than using location since each node need
subtly, selectively discard certain messages to alter the
only maintain a set of its neighboring nodes. A message
function of the network. An attacker with a suitable
from a non-neighboring node is ignored by the recipient.
wormhole can easily create a sinkhole that attracts (but
Note that any protocol used to maintain accurate neighbor
does not forward) packets to many destinations. An
sets may itself be vulnerable to wormhole attacks, so our
intelligent attacker may be able to selectively forward
goal is to design a neighborhood discovery protocol that is
messages to enable other attacks.
not vulnerable to wormhole attacks. The security of our
To show how much damage a single wormhole can
protocol will rely on using directional antennas to obtain
cause to routing, we simulated randomly distributing
relative direction information, and cooperation among
nodes in a rectangular region and used the shortest path
nodes to verify possible neighbors.
algorithm to find the best route between any node pairs.
If a wormhole is formed, some far away nodes will appear
3. Wormhole Attacks
to be neighbors and some node pairs will be able to find a
“shorter” path through the wormhole. Hence the route
In a wormhole attack, an attacker forwards packets between them is disrupted by the wormhole. In
through a high quality out-of-band link and replays those simulation experiments, a single wormhole with two
packets at another location in the network [9, 15]. Figure randomly placed endpoints disrupts over 5% of all
1 shows a basic wormhole attack. The attacker replays network routes.
packets received by X at node Y, and vice versa. If it A more intelligent attacker may be able to place
would normally take several hops for a packet to traverse wormhole endpoints at particular locations. Strategically
from a location near X to a location near Y, packets placed wormhole endpoints can disrupt nearly all
transmitted near X traveling through the wormhole will communications to or from a certain node and all other
arrive at Y before packets traveling through multiple hops nodes in the network. In sensor network applications,
in the network. The attacker can make A and B believe where most communications are directed from sensor
they are neighbors by forwarding routing messages, and nodes to a common base station, wormhole attacks can be
then selectively drop data messages to disrupt particularly devastating. If the base station is at the
communications between A and B. corner of the network, a wormhole with one endpoint near1 frequencies such as 2.4GHz or 5 GHz [27]. In switched
0.9 antenna systems, one of several fixed directional antennas
0.8 can be selected using a switch. The transceiver can then
0.7 choose between one or more beams for transmitting or
0.6 receiving [25].
0.5 Most work on directional antennas has focused on
0.4 media access protocols [14, 12, 4, 20]. Directional an-
0.3 tennas can increase spatial reuse and reduce packet
collisions and negative effects such as deafness [4].
0.2
Routing protocols using directional antennas can out-
0.1
perform omnidirectional routing protocols [2, 5, 17]. In
0
0 50 100 150 200 250 300 350 400 450 500 this paper, we show that directional antennas also have
security benefits. In particular, directional information
can be used to mitigate wormhole attacks.
We adopt the antenna model in [5]. The model
assumes an antenna with N zones. Each zone has a
conical radiation pattern, spanning an angle of 2π/N
radians. The zones are fixed with non-overlapping beam
directions, so that the N zones may collectively cover the
entire plane as shown in Figure 3. When a node is idle, it
listens to the carrier in omni mode. When it receives a
the base station and the other endpoint one hop away will message, it determines the zone on which the received
be able to attract nearly all traffic from sensor nodes to the signal power is maximal. It then uses that zone to
base station. If the base station is at the center of the communicate with the sender.
network, a single wormhole will be able to attract traffic The zones are numbered 1 to N oriented clockwise
from a quadrant of the network. Figure 2 shows the starting with zone 1 facing east. This orientation is
effectiveness of a wormhole in disrupting communications established with respect to the earth’s meridian regardless
from sensor nodes to a base station. One endpoint of the of a node’s physical orientation. This is achieved in
wormhole is within one hop of the base station; the modern antennas with the aid of a magnetic needle that
position of the second endpoint varies along the x axis. remains collinear to the earth’s magnetic field. It ensures
When the base station is in a corner of the network, a that a particular zone always faces the same direction.
wormhole with the second endpoint near the base station When sending messages, a node can work in omni or
can effectively disrupt all network communications. If directional mode. In omni mode signals are received
the second endpoint is placed in the opposite corner, with a gain Go, while in directional mode with a gain of Gd.
approximately half of the nodes in the network will send Since a node in directional mode can transmit over a
messages for the base station to the wormhole. longer distance, Gd > Go. The omnidirectional and
directional gains can be estimated from [25]. For ex-
ample, when the number of zones is 6, and the omni
4. Directional Antennas transmission range is 250m, then the directional trans-
mission range is 450m [5]. For our simulations, we use
Directional antenna systems are increasingly being the same ratio between omni and directional transmission
recognized as a powerful way for increasing the capacity distances, but scale the ranges to 40m and 72m.
and connectivity of ad hoc networks [25, 26]. Transmitting
in particular directions results in a higher degree of spatial
reuse of the shared medium. Further, directional trans-
mission uses energy more efficiently. The transmission
range of directional antennas is usually larger than that of
omnidirectional antennas, which can reduce hops for rout-
ing and make originally unconnected devices connected.
Antenna systems may be broadly classified into
switched and steered antennas systems. Steered antennas
provide fine directional control, but are too expensive for
most sensor network applications. Switched antennas
provide less precise directional control, but can be
inexpensive and moderately small, particularly at COTS
detpursiD
noitatS
esaB
ot
setuoR
fo
noitcarF
Base Station at Corner Base Station at Center
Position of Endpoint (x,x)
Figure 2. Impact of Wormhole Attack. A
strategically placed node can disrupt a
substantial fraction of communications. The
position of the second endpoint moves
diagonally across the network (position 250
means the second endpoint is at the center of
the network; 0 means it is in the bottom left
corner).
5 6
π/3 r
4
1
3 2
Figure 3. Directional Antenna with 6 zones.
Each zone is a wedge with radius r spanning
π/3 radians. Zone 1 always faces east. The
dashed circle shows the omnidirectional
communication radius.shown in Figure 3
5. Protocols ^zone The opposite directional
element. For example, if
Our approach to detecting wormhole attacks depends on zone=1 then ^zone=4.
nodes maintaining accurate sets of their neighbors. An zone (A, B) Zone in which node A hears
attacker cannot execute a wormhole attack if the node B
wormhole transmitter is recognized as a false neighbor and neighbors (A, zone)
its messages are ignored. One important property of Nodes within one (directional
directional antennas is a node can get approximate distance) hop in direction zone
direction information based on received signals. Next we of node A.
document our assumptions about the network. Then, we
describe three increasingly effective protocols for 5.2 Directional neighbor discovery
preventing wormhole attacks. As directional information
is added, attacks become increasingly difficult to execute The directional neighbor discovery protocol does not
successfully. The first protocol, directional neighbor prevent many wormhole attacks, but it forms the basis for
discovery, does not rely on any cooperation between nodes, our other protocols.
and cannot prevent many wormhole attacks. By sharing Immediately after deployment, nodes will have no
information among neighboring nodes, the verified known neighbors. Each node will randomly choose a
neighbor discovery protocol can prevent wormhole attacks time and periodically use neighbor discovery protocol to
where the attacker controls only two endpoints and the update its neighbor set. We call the node that initiates the
victim nodes are at least two hops distant. Finally, the protocol the announcer.
strict neighbor discovery protocol prevents wormhole From Figure 3, one obvious observation is if node A is
attacks even when the victim nodes are nearby. in node B’s zone direction, then node B is in node A’s
opposite direction ^zone (for example, if zone=1,
5.1 Assumptions ^zone=4). We summarize this as:
A∈neighbors(B, zone)⇒B∈neighbors(A, ^zone)
We assume all non-wormhole communication channels
are bidirectional: if A can hear B, then B can hear A. This This relies on all nodes having the same antenna
is not always the case in wireless networks, especially if orientation due to their common magnetic orientation.
battery power and physical characteristics of antennas vary. Because of measurement imprecision, it is possible that
With our protocol, unidirectional links cannot be the actual zone will be off by one in either direction. For
established. simplicity of this presentation, we assume this observation
We assume a mechanism is available to establish secure holds for now. In Section 7, we consider the impact of
links between all pairs of nodes and that all critical directional inaccuracies.
messages are encrypted. Several efficient mechanisms The simple directional neighbor discovery protocol
have been proposed for establishing secure link keys in ad works in three steps:
hoc networks [6, 3, 22].
Since using directional antennas can increase the 1. A → Region HELLO | ID
A
transmission range significantly, we only have a modest The announcer A broadcasts a HELLO message that
requirement on network density. For example, when the includes its identity. This is done by transmitting the
density in omni mode is 10, then the density in directional message in every direction, sequentially sweeping
mode will be 32.4, which is enough for our protocol to through each antenna in the antenna array.
work efficiently. If the network is sparse, our protocol 2. N → A ID | E (ID | R | zone (N, A))
can still prevent wormhole attacks, but there is an
N KNA A
All nodes that hear the HELLO message send their
increased likelihood nodes will be disconnected from the
node ID and an encrypted message to the announcer.
network (as discussed in Section 6).
The message contents are encrypted with a key shared
between the announcer and the sender, which the
We use the following notation:
sender can determine based on knowing its own node
A, B, C... Legitimate nodes
ID and that of the announcer. The encrypted
X, Y Wormhole endpoints
message contains the announcer’s ID, a random
R Nonce
challenge nonce, and the zone in which the message
E (M) Message encrypted by key
KAB was received.
shared between nodes A and B
3. A → N R
zone The directional element,
The announcer decrypts the message and verifies that
which ranges from 1–6 asit contains its node ID. It further verifies that it heard nodes are added and the decrypted nonces are transmitted.
the message in the opposite zone from the zone The adversary tunnels the responses through the wormhole,
reported by the neighbor. That is, zone (A, N) = and transmits them to the senders. The distant sending
^zone (N, A). If it is correct, it adds the sending nodes will appear as neighbors to the announcer, and the
neighbor to its neighbor set for zone (A, N). If the announcer will be added to each sending node’s neighbor
message was not received in the appropriate zone, it is set.
ignored. Otherwise, the announcer transmits the Figure 4 shows an example scenario. An attacker has
decrypted challenge nonce to the sending neighbor. established a wormhole between nodes X and Y. With
Upon receiving the correct nonce, the neighbor inserts omnidirectional antennas, the attacker can systematically
the announcer into its neighbor set. forward all neighbor discovery messages through the
wormhole to convince all nodes in regions I and II they are
A node only modifies its neighbor set through the mutual neighbors. With directional antennas, the attack’s
neighbor discovery protocol, either as a result of responses effectiveness is reduced. Only node pairs that are in
to its own announcements or through announcements it opposite directions relative to the wormhole in each region
receives from its neighbors. When a message outside will accept each other as neighbors. For example, if the
the neighbor discovery protocol is received the receiving attacker forwards messages between A and B through the
node will check that its sender is in its neighbor set. The wormhole, the directional protocol would prevent A and B
node will ignore messages from nodes that are not from accepting each other as neighbors since A hears B
members of its neighbor set. Hence, if the neighbor sets (retransmitted by X) in its zone 4, and B hears A in its zone
are maintained correctly, a wormhole attack cannot be 4 instead of the expected opposite zone 1. However, the
conducted because nodes will not accept messages that attacker can mislead A and C into believing they are
arrive from nodes that are not in their neighbor set. (This neighbors since they are on opposite sides of their
assumes all messages are authenticated using link keys. respective wormhole endpoints. On average, one sixth of
If some messages are not authenticated, an attacker can the links between the two regions will be accepted through
impersonate a legitimate neighbor and send those the wormhole. This does not, however, greatly diminish
messages. Presumably, any sensitive control or routing the overall effectiveness of the wormhole attack. The
messages would be authenticated.) nodes in opposite regions will advertise the paths they find
However, the neighbor discovery protocol itself is through the wormhole to their neighbors, and indirectly
vulnerable to wormhole attacks. An attacker with a draw traffic towards the wormhole. As illustrated in
wormhole can establish a false distant neighbor by sending Figure 2, an adversary who can establish a single
challenges and responses through the wormhole. An ad- wormhole link may be able to disrupt nearly all network
versary with two transceivers, one near the announcer and traffic.
another in a distant area of the network, can tunnel the
announcer’s HELLO message to the distant area through 5.3 Verified neighbor discovery protocol
out-of-band channel. The wormhole node rebroadcasts
the message, and receives challenges from neighboring Although the simple directional protocol does not
nodes. It tunnels those challenges through the wormhole, sufficiently mitigate the effectiveness of wormhole attacks,
and transmits them to the announcer. To the announcer, it suggests that if nodes cooperate with their neighbors
the challenges appear to be perfectly legitimate, so the they can prevent wormholes since the attacker will only be
able to convince nodes in particular regions that they are
neighbors.
Assume the adversary has one transceiver at each end of
5 6 5 6 the wormhole. As described in the previous section, it
A
X C Y B can only trick nodes that are in opposite directions from
4
1
the wormhole endpoints into accepting each other as
1 4
neighbors. Hence, nodes in other locations can establish
3 2 3 2 the announcer’s legitimacy. We call such nodes verifiers.
Consider node C in Figure 4. Since C receives A’s
Region I Region II transmissions through Y in its zone 1 antenna, all of its
neighbors in zone 1 should also be neighbors of A. If any
Figure 4. Directional Attack. The
of those nodes are in different directions from Y (such as
adversary establishes a wormhole between X
node B in Figure 4), then the wormhole will not be able to
and Y, and can trick A and C into accepting
convince them they are neighbors of A. Note however,
each other as neighbors by forwarding
that C could be on the other end of the wormhole, as
messages since they are in opposite zones
shown in Figure 5. Here, B will hear A and C from the
relative to the respective wormhole endpoints.west through the wormhole (zone (B, A) = zone (B, C) = 4), relative positions, but do not establish that they are
and C will hear A directly from the east (zone (A, C) = communicating without going through a wormhole. Next,
^zone(C, A) = 1) and C will hear B from the west through the protocol uses a verifier node to confirm the link is not
the wormhole (zone (C, B) = ^zone (B, C) = 4). Hence, being created through a wormhole:
we need a stricter requirement on verifiers to prevent
4. N → Region INQUIRY | ID | ID | zone(N, A)
verifiers from acting through the wormhole. N A
All neighbor nodes that hear the HELLO message
A valid verifier V for the link A ↔ B must satisfy these
broadcast an inquiry in directions except for the
properties:
received direction and opposite direction. So, if N
1. zone (B, A) ≠ zone (B, V). Node B hears V in a received the announcement in zone 1, it will send
different zone from node A, hence it knows A and inquiries to find verifiers to zones 2, 3, 5 and 6. The
V are in different locations, and both cannot be message includes zone (N, A), so prospective verifiers
coming through a single wormhole endpoint. can determine if they satisfy the verification
2. zone (B, A) ≠ zone (V, A). Node B and V hear properties by having heard A in a different zone.
node A from different directions. A wormhole
5. V → N ID | E (ID | zone (V, N))
can deceive nodes in only one direction. So if V KNV A
Nodes that receive the inquiry and satisfy the
both B and V are directionally consistent with A
verification properties respond with an encrypted
in different directions (zone (B, A) = ^zone (A, B)
message. This message confirms that the verifier
and zone (V, A) = ^zone (A, V)), then they know
heard the announcement in a different zone from N
A is not being retransmitted through a wormhole.
and has completed steps 1-3 for the protocol to
In Figure 5, C cannot act as a verifier since zone (B, A) = authenticate A and its relative position.
zone (C, A), failing the first property. Node D can act as
To continue the protocol, N must receive at least one
a verifier, since zone (B, A) = 4 ≠ zone (B, D) = 5, and
verifier response. If it does, it accepts A as a neighbor,
zone (D, A) = 3 ≠ zone (B, A) = 4. Note, however, that
and sends a message to A:
the wormhole cannot convince D and A to accept each
other as neighbors since zone (D, A) = 3 ≠ ^zone (A, D) 6. N → A ID N | E KAN (ID A | ACCEPT)
= 1. Hence, B will not be able to verify A as a neighbor After receiving the acceptance messages, the
through D. announcer adds N to its neighbor set.
We modify the original protocol to use verifier nodes to
The verified neighbor discovery protocol depends on
establish legitimate neighbor relationships. The first
both neighbor and verifier nodes receiving correct
three steps are the same as in the simple neighbor
challenge responses from the announcer before either node
discovery protocol:
will accept the announcer as a neighbor. Likewise, the
1. A → Region HELLO | ID announcer will not accept any neighbors until they have
A
been mutually confirmed. The protocol is secure against
2. N → A ID | E (ID | R | zone (N, A))
N KNA A
wormhole attacks that involve two distant endpoints, since
3. A → N R
a wormhole can only deceive nodes to accept a particular
These steps authenticate the nodes and their apparent neighbor if they are in the same relative direction from the
wormhole, while the verified neighbor discovery protocol
requires that a node receives confirmation from a verifier
node in a different direction before accepting a new
6
5 neighbor. Without acquiring key material, an attacker
5 6 D
cannot create a wormhole since it must rely on forwarding
4 C X C Y B 1 messages to legitimate nodes through the wormhole to
A 1 4 decrypt the nonce challenges. Those nodes will determine
that the reception direction is inconsistent, and refuse to
3 2 3 2
complete the protocol.
The verified neighbor discovery protocol is vulnerable,
Region I Region II however, to a wormhole attack in which a single endpoint
Figure 5. Verifiers. Node C cannot act as node acts as both a receiver and a retransmitter to deceive
a verifier for the link A↔B since the wormhole two nodes that are close to each other (but not within one
attacker could make a node on the other end hop) that they are neighbors. The next section describes
of the wormhole appear. Node D could act as this attack, and a variant of the protocol that prevents it.
a verifier, since it satisfies the verifier
properties.5.4 Strict neighbor discovery protocol
Figure 6 shows the verifier region of two neighbor
nodes. If there is a node in the shaded region, it can act as
a verifier for A and B. However, the verifier region may
still exist when two nodes are slightly out of radio range,
and a smart adversary can use this to make them to be
neighbors.
Figure 7 depicts the Worawannotai attack in which the
adversary convinces two nearby (but not neighboring)
Figure 7. Worawannotai attack.
nodes they are neighbors. Node B is located just beyond
the transmission range of node A. There will be two messages are not reaching B and can retransmit them
areas that could have valid verifier for this protocol. If through another node. This approach would not work
there is a valid verifier in those areas, the attacker can just against the distant wormhole attack, since A’s neighbors
put one node in between A and B (node X in Figure 7) and are likely to also forward packets directed towards B
use it to listen to and retransmit messages between A and B. towards the wormhole endpoint.
Nodes A and B will mistakenly confirm they are neighbors To prevent the Worawannotai attack, we need to place
using verifier V, but the attacker will have control over all additional constraints on verifiers. The strict neighbor
messages between A and B. discovery protocol exchanges the same messages as
The Worawannotai attack will succeed only if the victim verified neighbor discovery protocol but has stricter
nodes (A and B in the figure) are unable to communicate requirements on verifiers. In strict protocol, a valid
directly, but are close enough to have a verifier that can verifier V for the link A ↔ B must satisfy these three
hear both A and B. Assuming perfect transmission properties:
distances, this means A and B must be more than r distance
1. zone(B, A) ≠ zone (B, V).
apart, but less than
2. zone(B, A) ≠ zone (V, A).
2rcosπ/6=r 3
3. zone(B, V) cannot be both adjacent to
after which the size of the false verification region is zero. zone(B, A) and adjacent to zone(V, A).
If A and B are aligned horizontally, the size of the areas
that could contain false verifiers is The first two conditions are the same as previous
protocol, and they guarantee that the adversary cannot
r 3
2  x  replay the confirmation message from verifiers. The third
4 ∫  1−x2 − dx
 3 condition ensures that the verifier region is empty when
r+a
two nodes are out of radio range, so the adversary cannot
2
where r + a is the distance between A and B. The use this to conduct Worawannotai attack.
maximum area is slightly less than 15% of the Figure 8 shows the verifier region of the strict protocol.
transmission area in the worst case where A and B are just Compared with Figure 6, we can see that the region
over r distance apart (a is 0), and decreases substantially between A and B is no longer contains verifiers. We next
as the distance increases. show that the shaded areas cannot contain any verifiers if
Another mitigating factor is that nodes A and B are A and B are further than r distance apart, and hence, the
within two hops through legitimate nodes (including the Worawannotai attack cannot succeed.
false verifier). This means if the data communication We consider the region above and left of A; the proof for
protocol uses acknowledgements, A will discover
Figure 8. Strict Verifier Region. The
Figure 6. Verifier Region. The shaded area
shaded area is the verifier region of node A
is the verifier region of node A and B in verified
and B in strict neighbor discovery protocol
neighbor discovery protocol.all other regions is equivalent. All potential verifiers V in example in Figure 4, an enterprising attacker could
that region have zone (V, A) = 2 and zone (V, B) = 2. retransmit node A’s announcement through the wormhole.
Let x denote the x coordinate of node N, d the actual Before transmitting B’s response, the attacker would use a
N NM
distance between nodes N and M, and θ the angle magnet to disorient A one half rotation so its east zone is
NM
between nodes N and M relative to the horizontal axis. now facing west. Hence, A would accept B’s response as
For a verifier V in the above left region, we have: coming from the opposite direction (even though it
actually came from the same direction). Note that the
x = x + d cos θ
V A AV AV attacker would have to reorient A correctly before it sends
x = x + d cos θ
V B BV BV out the next message. In practice, it is unlikely that a
x B = x A + d AB cos θ AB magnet attack could be done successfully because of the
physical intrusiveness and timing precision needed. In
Because zone(V, A) = 2 and zone (V, B) = 2, we know
most cases, it would be easier for an attacker to set up
θ and θ are between π/2 and 5π/6. Hence, the
AV BV multiple endpoints.
minimum value of cos θ is 0 for π/2. So, we know x ≤
AV V
x and x ≤ x . This makes sense since V must be to the
A V B 6. Analysis
left of both A and B. Substituting the expansion of x
B
from the third equation into the second equation, we have,
Our protocols have low overhead, but may effect the
x = x + d cosθ + d cosθ
V A AB AB BV BV overall performance of the network by preventing
Since zone (A, B) = 1, θ is between −π/6 and π/6. legitimate links from being established. In this section
AB
Minimizing the values of the cosines, we have we analyze the impact of our protocols on node
connectivity and routing performance. In both the
x ≥ x + d cos π/6+ d cos 5π/6.
V A AB BV verified protocol and the strict protocol, it is possible that
The Worawannotai attack is possible only if d >r and in step 3, there are no potential verifier nodes. Without a
AB
d ≤ r. So, this implies x > x which contradicts x ≤ x verifier node, N cannot distinguish legitimate neighbors
BV V A V A
and proves that no false verifier could exist. Similarly, from neighbors through a wormhole. Nodes near the
we can prove that all other three shaded regions are also perimeter of the network are especially prone to having no
empty if A and B are further than one hop apart. verifier nodes. In this case, an optimistic strategy will
continue the protocol and accept the announcer without
5.5 Discussion verification, while a conservative strategy will reject the
announcer and stop the protocol. The first choice permits
The strict neighbor discovery protocol prevents successful wormhole attacks while the second choice may
wormhole attacks when the adversary has only two prevent some legitimate nodes from joining the network.
endpoints. An attacker with multiple endpoints could Because the damage a successful wormhole attack can
selectively forward packets through different endpoints to cause is substantial, we adopt the more conservative
establish false neighbors. In the extreme, an attacker who choice: a node will only accept another node as a neighbor
can surround a particular target node with wormhole if it can be verified by at least one verifier.
endpoints can make messages arrive in any zone by Hence, our protocol prevents some legitimate links from
transmitting them through a different endpoint. Our being established. Losing links diminishes the
defense does not prevent multiple endpoint attacks, effectiveness and efficiency of the network. If all links
although it should be noted that the resources necessary to for a particular node are lost, it will be disconnected from
carry out such an attack are substantial. the network and provide no value. The probability that a
The overhead associated with our protocol is minimal, link is lost depends on the likelihood that a satisfactory
the main cost is the potential loss of valid links (discussed verification node cannot be found. This probability
in the next section). For pairwise key distribution, the scales inversely with the density of the network. For
typical process to securely discover one link (without reasonably dense networks, there is a high probability that
resistance to wormhole attacks) involves node a legitimate link will be verified.
announcement, challenge and response (3 messages). Our Figure 9 shows typical results from simulating a low
protocol adds additional messages for inquiry, verification density network with an average of 3 neighbors within the
and acceptance. omnidirectional communication distance and 9.72
One possible, but unrealistic, attack is to use magnets to neighbors within the directional transmission distance.
attempt to disorient nodes. An attacker could use a Under 14% of all links are lost, and only 1.3% of nodes are
magnet to control the orientation of a node to make it completely disconnected due to the verified neighbor
receive messages in the appropriate zone. This would protocol. The number of links lost increases substantially
require tight coordination between the wormhole with the strict neighbor discovery protocol because of the
retransmitting packets and the magnet controller. For the reduced area for possible verifiers: the lost link and500
450
400
350
300
250
200
150
100
50
0
0 50 100 150 200 250 300 350 400 450 500
disconnected nodes rates are 58% and 5.3% respectively. routing. We use the shortest path routing to evaluate our
For a more typical network density of 10 neighbors (32.4 protocol, and measure average route path length when the
neighbors within the directional transmission distance), network density changes from 4 to 20. The results show
less than 0.5% of links are lost and no nodes are that using the verified protocol for routing has virtually no
disconnected in verified neighbor discovery protocol, and impact on the path length: the path length is almost
40% of links are lost and 0.03% nodes are disconnected in identical. The strict protocol will increase the path length
strict neighbor discovery protocol. around 20% when the network is reasonably dense
The closer nodes are to each other, the more likely they (omnidirectional density > 10).
are find a verifier and establish a link. Figure 10 shows the
impact of the distance between two nodes on their 7. Directional Errors
likelihood of establishing a link. For a reasonably dense
network (omnidirectional density > 10), nearly all links So far, we have assumed nodes always hear each other
are kept when the distance of nodes is within r in the in directly opposite directions (e.g., if node A hears node B
verified protocol or within 0.6r in the strict protocol. in zone 1, node B hears node A in zone 4). In a typical
Few nodes are completely disconnected with either deployment, this is often not the case. If nodes are near
protocol, but the lost links can affect routing performance.
Figure 11 shows the impact of our protocols on network
)sretem(
y
500
450
400
350
300
250
200
150
100
50
0
0 50 100 150 200 250 300 350 400 450 500
x (meters)
)sretem(
y
x (meters)
a. Verified Protocol (Density=3, directional density = 9.7) b. Strict Protocol (Density = 3, directional density = 9.7)
Figure 9. Impact on Connectivity. Circular nodes establish all possible links;
triangular nodes establish some links, but are unable to establish at least one possible
link; solid square nodes are unable to establish any links.
1
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0
0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
oitaR
detcennoC
skniL
10
9
8
7
6
5
4
3
Verified Protocol (Density=10)
Verified Protocol (Density=3) 2
Strict Protocol (Density=10)
Strict Protocol (Density=3)
1
0
4 6 8 10 12 14 16 18 20
Node Distance (r)
Figure 10. Node distance and connectivity.
htgneL
htaP
egarevA
Directional Transmission
Verified Protocol
Strict Protocol
Omnidirectional Node Density
Figure 11. Impact on routing path length.1
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0
0 10 20 30 40 50 60
the transition point between two zones, small differences availability of other suitable defenses and the potential
in node orientation, antenna alignment and gain, and damage a successful wormhole attack can inflict, this
transmission irregularities will lead to legitimate nodes tradeoff is desirable for many applications.
appearing to be in the wrong zone. As result, some links
between legitimate neighbors will be lost.
Figure 12 shows the impact of directional errors on Acknowledgements
network connectivity. We assume directional errors can
be modeled by disorienting nodes by a random angle that This work was supported by the National Science
is ± the maximum directional error. Hence, for maximum Foundation through CAREER (CCR-0092945) and ITR
directional error of 60 degrees, the average node is (EIA-0205327) awards. Chalermpong Worawannotai
misoriented by ½ zone. The fraction of links lost because discovered the “Worawannotai attack” and suggested the
of directional errors increases linearly with the directional solution.
error. For a reasonably dense network, even as the
directional error reaches 60 degrees fewer than 0.1% of
nodes are fully disconnected. References
Another approach to directional errors would be to
accept communications from directions that are not
[1] N. Bulusu, J. Heidemann and D. Estrin. GPS-less Low Cost
directly opposite the reception direction, but rather in an
Outdoor Localization for Very Small Devices. IEEE
adjacent zone. This would eliminate most of the links Personal Communications Magazine, October 2000.
lost to directional errors, but would substantially weaken [2] S. Bandyopadhyay, K. Hausike, S. Horisawa and S. Tawara.
the security of the protocol. An Adaptive MAC and Directional Routing Protocol for Ad
Hoc Wireless Networks Using ESPAR Anenna.
8. Conclusion ACM/SIGMOBILE MobiHoc October 2001.
[3] H. Chan, A. Perrig and D. Song. Random Key
Predistribution Schemes for Sensor Networks. IEEE
Wormhole attacks are a powerful attack that can be
Symposium on Security and Privacy 2003.
conducted without requiring any cryptographic breaks.
[4] R. Choudhury, X. Yang, R. Ramanathan and N. Vaidya.
An attacker who conducts a successful wormhole attack is
Using Directional Antennas for Medium Access Control for
in a position to disrupt routing, deny service to large Ad Hoc Network. ACM MobiCom 2002, September 2002.
segments of a network, and use selective forwarding to [5] R. Choudhury and N. Vaidya. Ad Hoc Routing Using
tamper with network applications. Directional antennas Directional Antennas. University of Illinois, Coordinated
offer a promising approach to preventing wormhole Science Laboratory, Technical Report, August 2002.
attacks. They are less expensive than many mechanisms [6] L. Eschenauer and V. Gligor. A Key-Management Scheme
proposed for localization, and offer other advantages in for Distributed Sensor Networks. ACM Conference on
addition to security including more efficient use of energy Computer and Communication Security, November 2002.
and better spatial use of bandwidth. The protocols we [7] Y. Hu, D. Johnson, and A. Perrig. SEAD: Secure efficient
distance vector routing for mobile wireless ad hoc networks.
propose reduce the threat of wormhole attacks with
IEEE Workshop on Mobile Computing Systems and
minimal loss of network connectivity. Given the lack of
Applications, June 2002.
oitaR
1
Lost Links, Strict Protocol 0.9
Lost Links, Verified Protocol
Disconnected Nodes, Strict Protocol 0.8
Disconnected Nodes, Verified Protocol
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0
0 10 20 30 40 50 60
Maximum Directional Error Degree
oitaR
Lost Links, Strict Protocol
Lost Links, Verified Protocol
Disconnected Nodes, Strict Protocol
Disconnected Nodes, Verified Protocol
Maximum Directional Error Degree
a. Density = 3 (9.7 directional density) b. Density = 10 (32.4 directional density)
Figure 12. Impact of directional errors.[8] Y. Hu, A. Perrig and D. Johnson. Ariadne: A Secure [25] R. Ramanathan. On the Performance of Beamforming
On-Demand Routing Protocol for Ad Hoc Networks. ACM Antennas in Ad Hoc Network. MobiHoc 2001, October
MobiCom 2002, September 2002. 2001.
[9] Y. Hu, A. Perrig, and D. Johnson. Packet Leashes: A [26] R. Ramanathan, Redi, Santivanez, Wiggins and Polit. Ad
Defense against Wormhole Attacks in Wireless Ad Hoc Hoc Networking with Directional Antennas: A Complete
Networks. INFOCOM 2003, April 2003. Solution. BBN Technical Report, 2003.
[10] T. He, C. Huang, B. Blum, J. Stankovic and T. Abdelzaher. [27] C. Santivanez and J. Redi. On The Use of Directional
Range-Free Localization Schemes for Large Scale Sensor Antennas for Sensor Networks. Military Communications
Networks. ACM MobiCom 2003, September 2003. Conference (MILCOM 2003), October 2003.
[11] D. Johnson, D. Maltz, and J. Broch. The Dynamic Source [28] N. Sastry, U. Shankar, and D. Wagner. Secure
Routing Protocol for Multihop Wireless Ad Hoc Networks. Verification of Location Claims. ACM Workshop on
In Ad Hoc Networking, C. Perkins, Ed. Addison-Wesley, Wireless Security (WiSe 2003), September 19, 2003.
2001. [29] B. Wellenhoff, H. Lichtenegger and J. Collins. Global
[12] T. Korakis, G. Jakllari and L. Tassiulas. A MAC protocol for Positions System: Theory and Practice, Fourth
full exploitation of Directional Antennas in Ad-hoc Wireless
Edition. Springer Verlag, 1997.
Networks. MobiHoc 2003.
[13] C. Karlof, Y. Li, J. Polastre. ARREVE: Algorithm for Robust
Routing in Volatile Environments. Technical Report
UCB//CSD-03-1233, March 2003.
[14] Y. Ko, V. Shankarkumar and N. H. Vaidya. Medium access
control protocols using directional antennas in ad hoc
networks. IEEE INFOCOM, 2000.
[15] C. Karlof and D. Wagner. Secure Routing in Sensor
Networks: Attacks and Countermeasures. First IEEE
International Workshop on Sensor Network Protocols and
Applications, May, 2003.
[16] S. Marti, T. J. Giuli, K. Lai, and M. Baker. Mitigating
routing misbehavior in mobile ad hoc networks. ACM/IEEE
International Conference on Mobile Computing and
Networking, 2000.
[17] A. Nasipuri, J. Mandava, H. Manchala and R. E. Hiromoto.
On Demand Routing Using Directional Antennas in Mobile
Ad Hoc Networks. IEEE Wireless Communications and
Networking Conference (WCNC), September 2000.
[18] D. Niculescu and B. Nath. Ad Hoc Positioning System (APS)
using AoA. INFOCOM 2003.
[19] R. Nagpal, H. Shrobe and J. Bachrach. Organizing a Global
Coordinate System from Local Information on an Ad Hoc
Sensor Network. 2nd International Workshop on
Information Processing in Sensor Networks (IPSN '03),
April, 2003.
[20] A. Nasipuri, S. Ye, J. You, R.E. Hiromoto. A MAC protocol
for mobile ad-hoc networks using directional antennas.
IEEE Wireless Communications and Networking
Conference, September 2000.
[21] C. E. Perkins and P. Bhagwat. Highly dynamic
destination-sequenced distance-vector routing (DSDV) for
mobile computers. ACM SIGCOMM Conference on
Communications Architectures, Protocols and Applications,
1994.
[22] A. Perrig, R. Szewczyk, V. Wen, D. Culler and D. Tygar.
SPINS: Security Protocols for Sensor Networks. Wireless
Networks Journal, September 2002.
[23] P. Papadimitratos and Z. Haas. Secure routing for mobile ad
hoc networks. SCS Communication Networks and
Distributed Systems Modeling and Simulation Conference,
January 2002.
[24] C. Perkins and E. Royer. Ad-Hoc On-Demand Distance
Vector Routing. IEEE Workshop on Mobile Computing
Systems and Applications, February 1999.