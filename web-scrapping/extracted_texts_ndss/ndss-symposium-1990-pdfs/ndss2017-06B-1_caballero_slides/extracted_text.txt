Dissecting Tor Bridges: a Security
Evaluation of Their Private and Public
Infrastructures
Srdjan Matic, Carmela Troncoso, Juan CaballeroInternet CensorshipOnion Routing
Vanilla Tor Protocol
101.182.129.111
http://facebook.com
3Tor Bridges
Bridges:
• IP not available in consensus
• First hop
• Pluggable transports (PTs)
• Public or private
• Default bridgesOur Goals
• Perform first systematic study of the security
of the Tor bridge infrastructure
– Public bridges
– Private bridges
– Private proxies
5Known Tor Issues
Two issues known to Tor project since October 2010
1. Vanilla Tor Certificates
– Vanilla Tor uses TLS handshake
– Easy to spot certificates
– It won’t be fixed
2. Open OR Port
– Bridges have open OR Port with Vanilla Tor
– Even if they do not offer Vanilla Tor
– Difficult to fix
6Outline
Intro
Approach
Public Bridge Analysis
Private Bridge AnalysisDatasets
Scan 200+ ports with multiple protocols
19 ports scanned with TLS
Indexed data available
Scan 6 ports with TLS
Raw + indexed data available
Identify candidate bridge IP addresses (without scanning ourselves)
Node-level data on public bridges + relays
Some bridge data sanitized
Is there sensitive data not anonymized?
8Discovering Bridges
1. Finding candidate IP addresses
2. Filtering relays
3. Verifying IP addresses
4. Identifying private proxies
5. Classifying as public or private bridge
9Outline
Intro
Approach
Public Bridge Analysis
Private Bridge AnalysisBridge Population
April 2016:
• 5.3K active public bridges
• 2.3K bridges with clients
Different population metrics!
11Bridge Stability
55% of the bridges live < 1 day à No clients
Bridges with clients long lived à 4 months (median)
Bridges with clients rarely change IP address
12PT Deployment
April 2016
Conflicting
security
properties!
13Or Port Distribution
Top-3 OR ports are used by 71% of public bridges
Scanning on those ports
reveals majority of bridges!
14Bridge Ranking
Not all bridges are equally important
How well is country-level blocking working?
How well is blocking of specific PT working?
Which bridges should censor target next?
91% traffic used default bridges!
Censor can disconnect users in reaction to an event
15Outline
Intro
Approach
Public Bridge Analysis
Private Bridge AnalysisBridge Discovery (April 2016)
• Deanonymized 35% public bridges with clients
• Found 684 private bridges
• Found 645 private proxies
• 35% bridges private, 65% public
17Bridge Cluster Types
1,343 clusters, 75% singletons
Type-I : 47
Type-II : 138
≤164
Type-III : 88
Type-IV : 43
≤178 Type-V : 10
Mixed : 16
77% Proxies and Backend in same AS
Proxies do not provide IP diversity
18Conclusion
• Public Bridges
– Bridges with clients live 4 months, no IP changes à Blocking
– PTs with conflicting security properties
– Top-3 OR ports 71% public bridges à Patch CollecTor
– 91% bridge traffic uses default bridges à Defeats purpose
– Bridge Ranking enables targeted attacks
• Bridge discovery
– Deanonymized 35% of public bridges
– Found 684 private bridges + 645 private proxies
– 35% bridges are private
– Clusters of bridges+proxies deployed à Little IP diversity
• Open OR Port needs fixingQuestions?Joint Work With
Srdjan Matic Carmela TroncosoPublic Bridges Analysis
(1) Bridge Population (2) Bridge Stability (3) PT Deployment
(4) OR Port Distribution (5) Bridge Ranking (6) CollecTor
Security Analysis
22Private Bridge & Proxy Analysis
(1) Population (2) Clusters (3) Hosting
We first need to IP diversity
Cluster Types
AS diversity
discover private bridges! Private Proxies
23Bridge Clustering & Ranking
• Cluster bridges from same owners
1. Same fingerprint
2. Similar nicknames
3. Same contact information
4. Similar verified IP address
5. Similar IP address in descriptor
• Rank Bridges
– Not all bridges equally important
24Related Work
• Design secure Pluggable Transports
– Obfs4, Skypemorph, BridgeSPA,
StegoTorus, ScrambleSuit
• Techniques to discover bridge IP
– Ling et al., McLachlan and Hopper, Zmap
25Ethical Considerations
• Approved by IMDEA’s ethics review board
• Disclosed to Tor project at submission
• We only use leaks/info from public datasets
• No access to any user traffic
• No malicious Tor nodes added
• No deanonymized bridges revealed
• No data release
26Internet Censorship28