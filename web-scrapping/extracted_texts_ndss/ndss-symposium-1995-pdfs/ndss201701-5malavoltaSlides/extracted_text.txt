SilentWhispers: Enforcing Security and Privacy
in Decentralized Credit Networks
$
Giulio Malavolta Pedro Moreno-Sanchez Aniket Kate Matteo Maffei
Saarland University Purdue University Purdue University TU Vienna
NDSS 2017Yet Another Talk about Cryptocurrencies?
✦ TumbleBit and CoinShuffle++ are excellent ideas to provide
privacy in Bitcoin
2Yet Another Talk about Cryptocurrencies?
✦ TumbleBit and CoinShuffle++ are excellent ideas to provide
privacy in Bitcoin
✦ Bitcoin (as other permissionless cryptocurrencies) relies on a
blockchain:
✦ High storage requirement (>100 GB)
✦ High power consumption for proof-of-work
2Yet Another Talk about Cryptocurrencies?
✦ TumbleBit and CoinShuffle++ are excellent ideas to provide
privacy in Bitcoin
✦ Bitcoin (as other permissionless cryptocurrencies) relies on a
blockchain:
✦ High storage requirement (>100 GB)
✦ High power consumption for proof-of-work
Is it possible to have a decentralized
payment system without a blockchain?
2Credit (or IOU Settlement) Networks: Basics
3Credit (or IOU Settlement) Networks: Basics
Transactions in the real world
pay $100
Bob Alice
IOweYou $100
Bob Alice
3Credit (or IOU Settlement) Networks: Basics
Transactions in the real world A credit network representation
pay $100
Bob Alice
100
Bob Alice
IOweYou $100
Bob Alice
3Credit (or IOU Settlement) Networks: Basics
Transactions in the real world A credit network representation
pay $100
Bob Alice
100
Bob Alice
IOweYou $100
Bob Alice
During a hike with Alice & Bob
pay $10
Carol
Dave
IOweYou $10
Carol
Dave
3Credit (or IOU Settlement) Networks: Basics
Transactions in the real world A credit network representation
pay $100
Bob Alice
100
Bob Alice
IOweYou $100
Bob Alice
During a hike with Alice & Bob
pay $10
Dave Carol
Carol
Dave
IOweYou $10
Carol
Dave
3Credit (or IOU Settlement) Networks: Basics
Transactions in the real world A credit network representation
pay $100
Bob Alice
100
Bob Alice
IOweYou $100
1
Bob Alice 0
During a hike with Alice & Bob
pay $10
Dave Carol
Carol
Dave
IOweYou $10
Carol
Dave
3Credit (or IOU Settlement) Networks: Basics
Transactions in the real world A credit network representation
pay $100
Bob Alice
111000
Bob Alice
IOweYou $100
1
Bob Alice 0
During a hike with Alice & Bob
pay $10
Dave Carol
Carol
Dave
IOweYou $10
Carol
Dave
3Credit (or IOU Settlement) Networks: Basics
Transactions in the real world A credit network representation
pay $100
Bob Alice
111000
Bob Alice
IOweYou $100
0
1
1
Bob Alice 0
During a hike with Alice & Bob
pay $10
Dave Carol
Carol
Dave
IOweYou $10
Carol
Dave
3Credit Network Examples
✦ Academic proposals:
✦ Ostra: preventing e-mail spam
[NSDI’08]
✦ Bazaar: strengthening e-commerce
[NSDI’11]
✦ SumUp: Sybil-resilient content voting
[NSDI’09]
✦ Industry deployments:
✦ Ripple: A real-life online payment network
✦ Stellar: Another real-life online payment network
4Credit Network Examples
✦ Academic proposals:
✦ Ostra: preventing e-mail spam
[NSDI’08]
✦ Bazaar: strengthening e-commerce
[NSDI’11]
✦ SumUp: Sybil-resilient content voting
[NSDI’09]
✦ Industry deployments:
✦ Ripple: A real-life online payment network
✦ Stellar: Another real-life online payment network
4Ripple Credit Network
5Ripple Credit Network
5Ripple Credit Network
5Ripple Credit Network
5Ripple Credit Network
5Ripple Credit Network
5Ripple Credit Network
5Ripple Credit Network
0
A 3
E
€
D
€
1
0 4
5
$
6 0
0
7
£
C
A
D
1
0
0
5Ripple Credit Network
0
A 3
E
€
D 0
1
€
C
1 B
T
0 4 T
5 B C
5
$
6 0
0
7
£
C
A
D
1
0
0
5Ripple Credit Network
0
3
€
0
€
C
1 B
T
4 T
5 B C
5
$
6 0
0
7
£
C
A
D
1 0 0
5
XYZ
40
GDW
10
A
E
D
1
0
X I D 1 0 0
FMM 280Ripple Credit Network
0
3
€
0
€
C
1 B
T
4 T
5 B C
5
$
6 0
0
7
£
C
A
D
1 0 0
5
XYZ
40
GDW
10
A
E
D
1
0
X I D 1 0 0
FMM 280
Worldwide,
Tx time Integrity
cross-currency txRipple Credit Network
0
3
€
0
€
C
1 B
T
4 T
5 B C
5
$
6 0
0
7
£
C
A
D
1 0 0
5
XYZ
40
GDW
10
A
E
D
1
0
X I D 1 0 0
FMM 280
Worldwide,
Tx time Integrity
cross-currency tx
~ 1 day
~ 5 secondsRipple Credit Network
0
3
€
0
€
C
1 B
T
4 T
5 B C
5
$
6 0
0
7
£
C
A
D
1 0 0
5
XYZ
40
GDW
10
A
E
D
1
0
X I D 1 0 0
FMM 280
Worldwide,
Tx time Integrity
cross-currency tx
~ 1 day High fees
~ 5 seconds Tiny feesRipple Credit Network
0
3
€
0
€
C
1 B
T
4 T
5 B C
5
$
6 0
0
7
£
C
A
D
1 0 0
5
XYZ
40
GDW
10
A
E
D
1
0
X I D 1 0 0
FMM 280
Worldwide,
Tx time Integrity
cross-currency tx
~ 1 day High fees Bank only
~ 5 seconds Tiny fees Public verifiabilityRipple Credit Network
0
3
€
0
€
C
1 B
T
4 T
5 B C
5
$
6 0
0
7
£
C
A
D
1 0 0
5
XYZ
40
GDW
10
A
E
D
1
0
X I D 1 0 0
FMM 280
Worldwide,
Tx time Integrity
cross-currency tx
~ 1 da Ry
i
mi p
p
mp rl ioe
t
tv
ac
e
na ccn
er
os H asi g nsin g
-
dci hf u si c erfa re ten
t
len et l csy my
e n t s
Bank only
r e
~ 5 seconds Tiny fees Public verifiabilityPublic Verifiability & Privacy Problem
The Ripple Ledger
Credit Graph
Transaction Details
6Public Verifiability & Privacy Problem
The Ripple Ledger
Credit Graph
Transaction Details
Listening to Whispers of Ripple: Linking
Wallets and Deanonymizing Transactions
in the Ripple Network
Pedro Moreno-Sanchez, Muhammad Bilal Zafar,
Aniket Kate.
PETS ‘16
6Public Verifiability & Privacy Problem
The Ripple Ledger
Credit Graph
Transaction Details
Listening to Whispers of Ripple: Linking
Wallets and Deanonymizing Transactions
in the Ripple Network Current credit networks employ
a global ledger
Pedro Moreno-Sanchez, Muhammad Bilal Zafar,
Aniket Kate.
PETS ‘16
6Our Contributions
✦ We question the need for a global
ledger and global consensus
7Our Contributions
✦ We question the need for a global
ledger and global consensus
✦ SilentWhispers: Decentralized
credit network with security and
privacy guarantees defined in UC
framework
Inspired by our work in NDSS’15
7Our Contributions
✦ We question the need for a global
ledger and global consensus
✦ SilentWhispers: Decentralized
credit network with security and
privacy guarantees defined in UC
framework
Inspired by our work in NDSS’15
✦ SilentWhispers overcomes several
challenges: existence of a path,
credit on a path and integrity of
transactions
7Our Contributions
✦ We question the need for a global ✦ SilentWhispers uses distributed
ledger and global consensus landmark routing, secure multi-
party computation and 2-step
transactions
✦ SilentWhispers: Decentralized
credit network with security and
privacy guarantees defined in UC
framework
Inspired by our work in NDSS’15
✦ SilentWhispers overcomes several
challenges: existence of a path,
credit on a path and integrity of
transactions
7Our Contributions
✦ We question the need for a global ✦ SilentWhispers uses distributed
ledger and global consensus landmark routing, secure multi-
party computation and 2-step
transactions
✦ SilentWhispers: Decentralized
credit network with security and
privacy guarantees defined in UC
framework
✦ SilentWhispers is feasible in
practice and offers interesting
Inspired by our work in NDSS’15
alternatives to current emerging
✦ SilentWhispers overcomes several payment systems
challenges: existence of a path,
credit on a path and integrity of
transactions
7SilentWhispers: A Decentralized Credit Network
8SilentWhispers: A Decentralized Credit Network
✦ Local Information suffices: Credit links of a user determine his
credit in the network
8SilentWhispers: A Decentralized Credit Network
✦ Local Information suffices: Credit links of a user determine his
credit in the network
1 5 In-flow = 450
450 Out-flow = 40
Charles
Bob 25
Net-flow = 410
Alice
8SilentWhispers: A Decentralized Credit Network
✦ Local Information suffices: Credit links of a user determine his
credit in the network
1 5 In-flow = 450
450 Out-flow = 40
Charles
Bob 25
Net-flow = 410
Alice
✦ Net-flow is what matters: Net-flow of a user must not change
without the user’s consent
8SilentWhispers: A Decentralized Credit Network
✦ Local Information suffices: Credit links of a user determine his
credit in the network
1 5 In-flow = 450
450 Out-flow = 40
Charles
Bob 25
Net-flow = 410
Alice
✦ Net-flow is what matters: Net-flow of a user must not change
without the user’s consent
5
Charles In-flow = 450
1 5
450 Charles Out-flow = 40
Bob
25
Net-flow = 410
Alice
8SilentWhispers: A Decentralized Credit Network
✦ Local Information suffices: Credit links of a user determine his
credit in the network
1 5 In-flow = 450
450 Out-flow = 40
Charles
Bob 25
Net-flow = 410
Alice
✦ Net-flow is what matters: Net-flow of a user must not change
without the user’s consent
5
Charles In-flow = 450
1 0
450 Charles Out-flow = 40
Bob
25
Net-flow = 410
Alice
8SilentWhispers: A Decentralized Credit Network
✦ Local Information suffices: Credit links of a user determine his
credit in the network
1 5 In-flow = 450
450 Out-flow = 40
Charles
Bob 25
Net-flow = 410
Alice
✦ Net-flow is what matters: Net-flow of a user must not change
without the user’s consent
5
Charles In-flow = 450
1 0
445 Charles Out-flow = 40
Bob
25
Net-flow = 410
Alice
8SilentWhispers: A Decentralized Credit Network
✦ Local Information suffices: Credit links of a user determine his
credit in the network
1 5 In-flow = 450
450 Out-flow = 40
Charles
Bob 25
Net-flow = 410
Alice
✦ Net-flow is what matters: Net-flow of a user must not change
without the user’s consent
5
Charles In-flow = 450 445
1 0
445 Charles Out-flow = 40 35
Bob
25
Net-flow = 410
Alice
8Challenges
✦ Find paths between users
✦ Calculate credit available in the path
✦ Ensure integrity of transactions
✦ And more …
9The routing challenge
10Routing Challenge: Landmark Routing
11Routing Challenge: Landmark Routing
✦ Determine credit path from sender to receiver
11Routing Challenge: Landmark Routing
✦ Determine credit path from sender to receiver
✦ Common problem in standard networks and ad-hoc networks
11Routing Challenge: Landmark Routing
✦ Determine credit path from sender to receiver
✦ Common problem in standard networks and ad-hoc networks
✦ The max-flow approach:
✦ Not scalable enough: O(V3) or O(V2log(E))
11Routing Challenge: Landmark Routing
✦ Determine credit path from sender to receiver
✦ Common problem in standard networks and ad-hoc networks
✦ The max-flow approach:
✦ Not scalable enough: O(V3) or O(V2log(E))
✦ Landmark routing [Tschusiya ’89]
✦ Calculate subset of all paths
11Routing Challenge: Landmark Routing
✦ Determine credit path from sender to receiver
✦ Common problem in standard networks and ad-hoc networks
✦ The max-flow approach:
✦ Not scalable enough: O(V3) or O(V2log(E))
✦ Landmark routing [Tschusiya ’89]
✦ Calculate subset of all paths
11Routing Challenge: Landmark Routing
✦ Determine credit path from sender to receiver
✦ Common problem in standard networks and ad-hoc networks
✦ The max-flow approach:
✦ Not scalable enough: O(V3) or O(V2log(E))
✦ Landmark routing [Tschusiya ’89]
✦ Calculate subset of all paths
U2 U3
11Routing Challenge: Landmark Routing
✦ Determine credit path from sender to receiver
✦ Common problem in standard networks and ad-hoc networks
✦ The max-flow approach:
✦ Not scalable enough: O(V3) or O(V2log(E))
✦ Landmark routing [Tschusiya ’89]
✦ Calculate subset of all paths
U2 U3
U1 U4
11Routing Challenge: Landmark Routing
✦ Determine credit path from sender to receiver
✦ Common problem in standard networks and ad-hoc networks
✦ The max-flow approach:
✦ Not scalable enough: O(V3) or O(V2log(E))
✦ Landmark routing [Tschusiya ’89]
✦ Calculate subset of all paths
✦ Distributed BFS: Local information suffices
U2 U3
U1 U4
11Routing Challenge: Landmark Routing
✦ Determine credit path from sender to receiver
✦ Common problem in standard networks and ad-hoc networks
✦ The max-flow approach:
✦ Not scalable enough: O(V3) or O(V2log(E))
✦ Landmark routing [Tschusiya ’89]
✦ Calculate subset of all paths
✦ Distributed BFS: Local information suffices
U2 U3
U1 U4
11Routing Challenge: Landmark Routing
✦ Determine credit path from sender to receiver
✦ Common problem in standard networks and ad-hoc networks
✦ The max-flow approach:
✦ Not scalable enough: O(V3) or O(V2log(E))
✦ Landmark routing [Tschusiya ’89]
✦ Calculate subset of all paths …
✦ Distributed BFS: Local information suffices
U2 U3
U1 U4
11Routing Challenge: Landmark Routing
✦ Determine credit path from sender to receiver
✦ Common problem in standard networks and ad-hoc networks
✦ The max-flow approach:
✦ Not scalable enough: O(V3) or O(V2log(E))
✦ Landmark routing [Tschusiya ’89]
✦ Calculate subset of all paths …
✦ Distributed BFS: Local information suffices
✦ Enough in practice1,2
U2 U3
✦ More efficient than max-flow1,2
1[Our work in NDSS ’15] U1 U4
2[Viswanath et al. EUROSYS ’12]
11Calculation of credit available in a path
12Credit in a Path: SMPC
30 15 25 10
13Credit in a Path: SMPC
30 15 25 10
13Credit in a Path: SMPC
[x]: Secret share of x
0 ]
3
[
30 15 25 10
[30]
[
3
0]
13Credit in a Path: SMPC
[x]: Secret share of x
0 ]
3
[
30 15 25 10
[30]
[
3
0]
✦ Given [x] it is not possible to know x
13Credit in a Path: SMPC
[x]: Secret share of x
0 ]
3
[
[15]
30 15 25 10
[30]
[15]
[
3
0]
✦ Given [x] it is not possible to know x
13Credit in a Path: SMPC
[x]: Secret share of x
0 ]
3 [25]
[
[15]
30 15 25 10
[30]
[25]
[15]
[25]
[
3
0]
✦ Given [x] it is not possible to know x
13Credit in a Path: SMPC
[x]: Secret share of x
[10]
0 ]
3 [25]
[
[15]
30 15 25 10
[30]
[25]
[15] [10]
[25]
[
3 0] [10]
✦ Given [x] it is not possible to know x
13Credit in a Path: SMPC
[x]: Secret share of x [credit in path]
[10]
0 ]
3 [25]
[
[15]
[credit in path]
30 15 25 10
[30]
[25]
[15] [10]
[25]
[
3 0] [10]
[credit in path]
✦ Given [x] it is not possible to know x
13Credit in a Path: SMPC
[x]: Secret share of x [credit in path]
[10]
0 ]
3 [25]
[
[15]
[credit in path]
30 15 25 10
[30]
[25]
[15] [10]
[25]
[
3 0] [10]
[credit in path]
✦ Given [x] it is not possible to know x
13Credit in a Path: SMPC
[x]: Secret share of x [credit in path]
[10]
0 ]
3 [25]
[
[15]
[credit in path]
30 15 25 10
[30]
[25]
[15] [10]
[25]
[
3 0] [10]
[credit in path]
✦ Given [x] it is not possible to know x
✦ Given “enough” copies of [x] one can reconstruct x
13Integrity of the transactions
14Transaction Integrity and Dispute Resolution
15Transaction Integrity and Dispute Resolution
✦ 2-step transaction: on hold and settle
15Transaction Integrity and Dispute Resolution
✦ 2-step transaction: on hold and settle
5
✦ Example:
15 20
15Transaction Integrity and Dispute Resolution
✦ 2-step transaction: on hold and settle
5
✦ Example:
(5)
10
15 20
15Transaction Integrity and Dispute Resolution
✦ 2-step transaction: on hold and settle
5
✦ Example:
(5) (5)
10 25
15 20
15Transaction Integrity and Dispute Resolution
✦ 2-step transaction: on hold and settle
5
✦ Example:
(5) (5)
10 25
Ok, received!
15 20
15Transaction Integrity and Dispute Resolution
✦ 2-step transaction: on hold and settle
5
✦ Example:
(5)
10 25
Ok, received!
15
15Transaction Integrity and Dispute Resolution
✦ 2-step transaction: on hold and settle
5
✦ Example:
(5)
10 25
Ok, received!
15
Incentive
15Transaction Integrity and Dispute Resolution
✦ 2-step transaction: on hold and settle
5
✦ Example:
10 25
Ok, received!
Incentive
15Transaction Integrity and Dispute Resolution
✦ 2-step transaction: on hold and settle
5
✦ Example:
10 25
Ok, received!
Incentive
✦ Integrity:
✦ All landmarks cannot make the user lose credit
15Transaction Integrity and Dispute Resolution
✦ 2-step transaction: on hold and settle
5
✦ Example:
No! our credit is 15!
10 25
Ok, received!
Incentive
✦ Integrity:
✦ All landmarks cannot make the user lose credit
15Transaction Integrity and Dispute Resolution
✦ 2-step transaction: on hold and settle
5
✦ Example:
No! our credit is 15!
10 25
Ok, received!
Incentive
✦ Integrity:
✦ All landmarks cannot make the user lose credit
✦ Accountability:
✦ In case of dispute, users must prove the link value
✦ Local logs suffice to determine the valid current value
✦ The disputed value is bounded
15Evaluation
16Evaluation and Discussion
17Evaluation and Discussion
✦ C++ prototype implementation
✦ Secret Sharing-based MPC library: https://github.com/Zayat/MPC-
Shared
17Evaluation and Discussion
✦ C++ prototype implementation
✦ Secret Sharing-based MPC library: https://github.com/Zayat/MPC-
Shared
✦ Setup using Ripple transactions:
✦ Maximum path length: 10 links
✦ Maximum number of paths: 7 landmarks (Ripple Gateways)
17Evaluation and Discussion
✦ C++ prototype implementation
✦ Secret Sharing-based MPC library: https://github.com/Zayat/MPC-
Shared
✦ Setup using Ripple transactions:
✦ Maximum path length: 10 links
✦ Maximum number of paths: 7 landmarks (Ripple Gateways)
✦ Computing available credit on a path in ~1.3 seconds
✦ Different paths in parallel
17Evaluation and Discussion
✦ C++ prototype implementation
✦ Secret Sharing-based MPC library: https://github.com/Zayat/MPC-
Shared
✦ Setup using Ripple transactions:
✦ Maximum path length: 10 links
✦ Maximum number of paths: 7 landmarks (Ripple Gateways)
✦ Computing available credit on a path in ~1.3 seconds
✦ Different paths in parallel
Feasible to run in practice current Ripple transactions
17Evaluation and Discussion
✦ C++ prototype implementation
✦ Secret Sharing-based MPC library: https://github.com/Zayat/MPC-
Shared
✦ Setup using Ripple transactions:
✦ Maximum path length: 10 links
✦ Maximum number of paths: 7 landmarks (Ripple Gateways)
✦ Computing available credit on a path in ~1.3 seconds
✦ Different paths in parallel
Feasible to run in practice current Ripple transactions
✦ SilentWhispers has attracted attention from industry:
✦ KOINA: https://koina.cc/
17The Landscape of Emerging Payment Systems
18The Landscape of Emerging Payment Systems
Cryptocurrencies Ripple SilentWhispers
Direct transactions between Transactions only
Transfer
of funds any two wallets via a path with enough credit
18The Landscape of Emerging Payment Systems
Cryptocurrencies Ripple SilentWhispers
Direct transactions between Transactions only
Transfer
of funds any two wallets via a path with enough credit
Transaction Fixed currency agreed Support for cross-currency
flexibility
between sender and receiver transactions
18The Landscape of Emerging Payment Systems
Cryptocurrencies Ripple SilentWhispers
Direct transactions between Transactions only
Transfer
of funds any two wallets via a path with enough credit
Transaction Fixed currency agreed Support for cross-currency
flexibility
between sender and receiver transactions
Locally verified by users
Transaction
Globally verified
verification
in the path
18Take Home Message
19Take Home Message
✦ A credit network does not require a
global ledger or global consensus
19Take Home Message
✦ A credit network does not require a
global ledger or global consensus
✦ SilentWhispers: A decentralized
credit network enforcing security
and privacy and overcoming
several challenges
19Take Home Message
✦ A credit network does not require a ✦ SilentWhispers is feasible in
global ledger or global consensus practice and it has attracted
attention from industry
✦ SilentWhispers: A decentralized
credit network enforcing security
and privacy and overcoming
several challenges
19Take Home Message
✦ A credit network does not require a ✦ SilentWhispers is feasible in
global ledger or global consensus practice and it has attracted
attention from industry
✦ SilentWhispers: A decentralized ✦ SilentWhispers is an interesting
credit network enforcing security alternative in the landscape of
and privacy and overcoming emerging payment systems
several challenges
19Take Home Message
✦ A credit network does not require a ✦ SilentWhispers is feasible in
global ledger or global consensus practice and it has attracted
attention from industry
✦ SilentWhispers: A decentralized ✦ SilentWhispers is an interesting
credit network enforcing security alternative in the landscape of
and privacy and overcoming emerging payment systems
several challenges
Thanks!
@pedrorechez
19