Hey, My Malware Knows Physics!
Attacking PLCs with Physical Model Aware Rootkit
Luis A. Garcia Ferdinand Brasser Mehmet H. Cintuglu
Rutgers University Technische Universita¨t Darmstadt Florida International University
l.garcia2@rutgers.edu ferdinand.brasser@trust.tu-darmstadt.de mcint015@fiu.edu
Ahmad-Reza Sadeghi Osama Mohammed Saman A. Zonouz
Technische Universita¨t Darmstadt Florida International University Rutgers University
ahmad.sadeghi@trust.tu-darmstadt.de mohammed@fiu.edu saman.zonouz@rutgers.edu
Abstract—Trustworthyoperationofindustrialcontrolsystems Nation-state ICS malware such as the Stuxnet worm [24]
(ICS) depends on secure code execution on the embedded pro- against Iranian nuclear uranium enrichment facilities and
grammablelogiccontrollers(PLCs).Thecontrollersmonitorand BlackEnergycrimeware[23]againsttheUkraniantrainrailway
control the underlying physical plants such as electric power and electricity power industries show that targeted attacks on
grids and continuously report back the system status to human critical infrastructures can evade traditional cybersecurity de-
operators.
tectionandcausecatastrophicfailureswithsubstantiveimpact.
We present HARVEY, 1 a PLC rootkit that implements a The discovery of Duqu [14] and Havex [43] show that such
physics-aware stealthy attack against cyberphysical power grid attacksarenotisolatedcasesastheyinfectedICSinmorethan
control systems. HARVEY sits within the PLC’s firmware below eight countries.
the control logic and modifies control commands before they are
sent out by the PLC’s output modules to the physical plant’s ICS security has been traditionally handled using network
actuators. HARVEY replaces legitimate control commands with security and information technology (IT) practices [52]. ICS
malicious,adversary-optimalcommandstomaximizethedamage security goals, however, differ from traditional IT security
tothephysicalpowerequipmentandcauselarge-scalefailures.To goals due to additional requirements and conditions of op-
ensuresystemsafety,theoperatorsobservethestatusofthepower eration. The interconnection of the physical world and virtual
system by fetching system parameter values from PLC devices. world, bridged by cyberphysical systems (CPS), is a unique
To conceal the maliciously caused anomalous behavior from feature of ICS compared to traditional IT infrastructures.
operators, HARVEY intercepts the sensor measurement inputs to
And unlike most traditional IT systems, high availability is
thePLCdevice.HARVEYsimulatesthepowersystemwiththele-
critical for ICS. A process failure can have fatal consequences
gitimatecontrolcommands(whichwereintercepted/replacedwith
threatening human lives and resulting in immense financial
malicious ones), and calculates/injects the sensor measurements
that operators would expect to see. We implemented HARVEY
loss.2
on the widely spread Allen Bradley PLC and evaluated it on a
ICS are monitored and operated in a centralized fashion:
real-world electric power grid test-bed. The results empirically
prove HARVEY’s deployment feasibility in practice nowadays. embedded CPS, known as programmable logic controllers
(PLC), are connected to a central control terminal (human-
machine interface HMI) through which a human operator can
I. INTRODUCTION supervisethesystem.PLCsaredigitalcomputingdevicesused
for automating industrial electromechanical processes. They
Industrial control systems (ICS) interconnect, control and
control the state of the output ports based on signals received
monitor industrial environments such as electrical power gen-
from the input ports and stored programs, and operate typi-
eration, transmission and distribution, chemical production,
cally under hard environmental conditions, such as excessive
oil and gas refining and transport, and water treatment and
vibration and high noise [9], [20]. PLCs control standalone
distribution. In recent years, ICS have received considerable
equipmentanddiscretemanufacturingprocesses.Theirlogical
attention due to security concerns originated by the trend to
behaviorwithregardtoinputsandoutputscanbeprogrammed
connect ICS to the Internet [22]. In particular, critical infras-
by the operator.
tructuresconnectedtoandcontrolledbyICSsubstantiatethese
security concerns. Nevertheless, the ICS market is expected to The main goal of sophisticated attackers is to remain
grow to $10.33 billion by 2018 [47]. stealthy from ICS operators. In particular, the HMI’s view of
the system should not indicate any effect caused by attacks.
1Harvey Dent (Two-Face) is a fictional super-villain adversary of the For this, the adversary can either compromise and manipulate
superhero Batman. The right half of his face looks normal/benign, unlike the HMI itself, or launch a more sophisticated attack on
thehideouslyscaryleftsideofhisface. PLCs. A prominent example of HMI related attacks is the
infamous Stuxnet [24]. However, HMIs are often based on
commodity computer systems for which a wide variety of
Permission to freely reproduce all or part of this paper for noncommercial
purposes is granted provided that copies bear this notice and the full citation security solutions exist, including anti-virus software, security
on the first page. Reproduction for commercial purposes is strictly prohibited enhanced operating systems, run-time attack protections, and
without the prior written consent of the Internet Society, the first-named author many more. This makes the HMI an unattractive attack target.
(for reproduction of an entire paper only), and the author’s employer if the
On the other hand, although many PLC related attacks have
paper was prepared within the scope of employment.
NDSS ’17, 26 February - 1 March 2017, San Diego, CA, USA
Copyright 2017 Internet Society, ISBN 1-891562-46-0 2ICS are also not what is usually considered Internet of Things (IoT) as
http://dx.doi.org/10.14722/ndss.2017.23313 therearesubstantialdifferences(cf.SectionVIII-A).been published in recent years [8], [12], [32], [44], they have
ICS Network Virtual World HMI
limitations with regard to stealthiness and result in obvious
effects, such as disrupting the operation of PLCs [44]. Other
ta l hott g ra oic c uk ) g,s ho w tp hhe eir ca Pht Le Cao l ’ln sow rth es me otP h tL eeC mo’s ap nea arp a gp t eol mi rca ett noi ton cd ael pte e av c be t il li( t thc iea e sl il re [1d p 2rc ]e ,o s [n e 3t nr 2co ]el
.
I I I I1 2 3
4
O O1
2
Control Logic
Input Output
Firmware
Module Module
Goals and Contributions. In this paper we present a novel
class of stealthy PLC attacks that we refer to as Man-in- Scan Cycle
the-PLC. Our exploit intercepts the PLC’s input and output Input CPU Output Hardware
values, provides an arbitrary view of the system to the control
logic (i.e., the program running on the PLC), and simulates a
semantically correct system state towards the central control Sensor Physical World Actuator
unit while changing the actual system state. We provide the
following main contributions: Fig. 1: PLC Architecture
• We present a novel attack class on industrial control
systems: a cyber-physical attack which is completely A. Background
invisible to the control center of an ICS.
• Wereverseengineeredthecentralcontrolloopmechanism An ICS is a distributed system which is composed of
of a widely deployed Allen Bradley 1769-L18ER-BB1B physicalcomponents,likesensorsandactuators,whichinteract
CompactLogix 5370 L1 Rev. B PLC. with the physical system (e.g., power grid) and cyber com-
• We developed a prototype implementation of HARVEY, ponents (e.g., cyber-networks and servers). Although ICS are
and tested and evaluated it on an Allen Bradley PLC. largely self-contained, interfaces exist through which external
Allen Bradley is one of the most used ICS suppliers in components can interact with the systems. For instance, a
the United States. human operator can monitor the systems state and influence
• We evaluate our attack in a real power grid test environ- it through a human-machine interface (HMI). Most PLCs are
ment. connectedtotheICSviaanEthernetnetwork,andhence,often
indirectly connected to the Internet. It is also quite common
We would like to stress that our main contribution and that PLCs are directly connected to the Internet [32].
noveltyofourrootkitliesinitsphysics-awareness.Thismakes
Centralized operation and maintenance is an essential fea-
our solution more general than all solutions published before,
ture of ICS. An operator can program and monitor PLCs and
including real world attacks like Stuxnet [24]. To be able
the applications running on them remotely, i.e., retrieve the
to implement and evaluate our prototype, we had to reverse
status of a PLC and re-program it over the network. The
engineer the PLC to gain the required insight into its inner
information which can be retrieved from the PLC contains,
working, in particular, the PLC’s control of input and output
among others, the control logic applications on the PLC. All
lines, and the connection between the firmware and control
applications, including their source code and further meta
logic programs.
information, can be loaded from a PLC.3
Following the standard responsible disclosure policies, we
have taken necessary steps and have contacted the vendor, Programmable Logic Controllers (PLC). Programmable
Allen Bradley, informing them about the possibility of such logic controllers (PLC) are cyber-physical systems that are
maliciousexploitsagainsttheircontrollers.AllenBradleygave used to control industrial appliances. PLCs have input and
us clearance to publish our findings. output modules to interact with the physical world. They can
translate physical inputs, mostly current on a wire, into digital
The remainder of the paper is structured as follows. First, values and vice versa. Connected to physical appliances such
we provide the reader with a background on industrial control assensorsandactuators,PLCscanconvertsensorreadingsinto
systems in general and programmable logic controllers in digitalvalues,processthereadingswiththebuilt-incomputing
particular, and present our system model and adversary model unit,andforwardtheoutputstothephysicalworld.Thelogical
in Section II. In Section III, we explain the general concept of behavior of PLCs, i.e., the processing of the input data, is
HARVEY before providing details on the physics-aware data programmable.
manipulations of our attack in Section IV. In Section V, we
describe how we reverse engineered the firmware of an Allen Such control loops can be either local, i.e., the inputs and
Bradley PLC and implemented our rootkit. In Section VI, we outputs are handled by a single PLC, or distributed, i.e., the
provide an extensive evaluation for our physics-aware PLC inputs are read by one PLC and forwarded over the network
rootkitagainstarealpowergridtest-bed.SectionVIIprovides to another PLC.
areviewofrelatedworkintheareaofICSsecurity.Wediscuss
ThetwomainsoftwarecomponentsofaPLC,controllogic
ourfindingsandpossible mitigationstrategiesinSectionVIII,
and firmware, are shown in Figure 1. The firmware is acting
and conclude in Section IX.
as a kind of operating system (OS). The firmware contains,
amongotherfunctionality,modulestoreadandwritetheinputs
and outputs of the PLC from/to the physical world. These
II. BACKGROUNDANDSYSTEMMODEL modules can be seen as drivers for the I/O hardware. Control
logic programs can be considered the PLC’s application layer.
In this section, we provide basic knowledge for the rest of The firmware provides services to read from input lines and
the paper. We provide detailed information about industrial write to output lines of the PLC. They are used by the control
control systems (ICS) and programmable logic controllers
(PLC), and we define the system model and adversary model 3ThisenablestheoperatortodetectmaliciousmodificationofthePLCon
we will consider throughout the paper. thecontrollogiclayer.
2C. Adversary Model and Assumptions
Operator
Stealthiness.Themaingoaloftheadversaryistolauncha
HMI
stealthyattackonanindustrialcontrolsystem(ICS).5 Stealthy
meansthattheattackdoesnotcauseunintentionallyobservable
Physical effects. For instance, sensor readings analyzed by a system
Central
System operator or automated tools should align with what they are
Control expected to be. Real world examples like Stuxnet [24] have
(Power Grid)
shown that stealthy attacks have a more enduring impact on
a system than a short attack which will rapidly break down a
Sensor / Actuator system.
HMI: Human-Machine Interface
The attack exploits the circumstance that in real world
PLC: Programmable Logic Controller
systems the operator’s view of the entire system is limited to
Fig. 2: System Model the information provided by the HMI, i.e., he cannot directly
observe the physical system and detect attack effects through
an out-of-band channel like visual contact. This limitation
can be due to different reasons, e.g., in large and distributed
logic to program the behavior of the PLC. The control logic
systems the operator is physically not capable of observing
programs are executed repeatedly in fixed intervals, called
the entire system, or the system operates in a hazardous
scan cycles. The control logic program reads input values
environment and for safety reasons the operator only has
from memory and stores the output values to memory. The
remote access to the system.
underlying firmware is responsible for the interchange of
these updated values to and from the PLC’s general purpose PLC-only Attack. We assume that the adversary compro-
input/output (GPIO) ports, i.e., the interface to the physical mises only PLCs and no other components of the ICS, hence
system, as well as the reporting mechanisms of the PLC, i.e., thenameMan-in-the-PLC.Inparticular,wedonotassumethat
the LED display on the device and the HMI. The scan cycle the adversary has manipulated the human-machine interface
is illustrated by the white arrows in Figure 1.4 (HMI), e.g., to hide suspicious activities from the operator.6
BesidesanoperatorobservingtheHMI,theICSmightinclude
Forinstance,apumpcanincreasethepressureinapipe.In securitymechanismslikeSCADA-specific7 intrusiondetection
order to have a constant pressure in the pipe the pump must systems (IDS) that monitor the system [52]. We assume the
be active until the predefined pressure is reached. Whether adversary cannot compromise (all) monitoring entities (i.e.,
the desired level has been reached is determined based on IDS systems) in an ICS in order to hide an attack.
sensor readings. However, the sensor and the pump are not
Furthermore,ICScomponentslikeHMI’sareusuallybased
directly connected. The sensor measurements are read by the
on commodity hardware and software, e.g., a workstation
PLCthroughitsinputlines.Thevalueisthenprocessedbythe
PC running Windows operating system. Security solutions
controllogic,andtheresultistranslatedbackintothephysical
for those systems already exist, e.g., anti-virus software and
system to steer the pump.
automatedsoftwareupdatesolutions,increasingtheprobability
for detection of an attack.
This approach allows for high flexibility, e.g., the sensor
and actuator (pump) might not operate in close proximity Physical Model Extraction.Weassumetheadversaryhas
and the sensor measurements have to be sent to the PLC knowledge about the inner workings of his target and uses
controlling the actuator. This can be done cost-efficiently this information to build a model of the correct behavior of
through existing computer networks, even over the internet. the target to be able to hide suspicious effects of the attack.
Furthermore, processing data in the cyber network allows for The adversary can get the required information, for instance,
more complex relations between sensor measurements and throughaninsider,orthroughprecedinginformationgathering
actions. attacks [32]. Although physical model extraction is outside of
the scope of this paper, it is worth noting that monitoring
and management systems of the ICS can be leveraged to
extract information about the physical model. For instance, in
powersystems,energymanagementsystems(EMS)areusedto
B. System Model
controlthepowergridinfrastructure.AnEMSisacollectionof
computer-aidedtoolsusedbyoperatorsofelectricutilitygrids
In this paper, we mainly consider large distributed ICSs
tomonitor,controlandoptimizetheperformanceofgeneration
that are operated in a centralized manner. Figure 2 shows
andtransmissionsystems.AtypicalsuiteofEMSapplications
an abstract view of our system model in which a physical
includes several components that feed sensor measurements
systemisoperatedfromacentralcontrolterminal.Thecontrol
into state estimation systems, contingency analysis software,
terminal provides a HMI that allows an operator to monitor
optimal power flow control analysis software, as well as an
the system and interact with the system (by sending control
HMI. Hence, the power system topology information can be
commands). The connection between the control terminal in
extractedthroughinsiderintruders(e.g.,Stuxnet[24])orEMS
the cyber world of the ICS and the physical world is provided
compromises.Additionally,unlikeinpurely-cybersettings,the
by PLCs. PLCs capture the physical system’s state by reading
physical power system and its topology is often exposed to
measurements from sensors. Additionally, PLCs control the
outside world; therefore, physical system reconnaissance is
system’sactuators,basedonboththecontrolactionsgenerated
relatively simpler.
bytheirlocalcontrollogicandthecontrolcommandssentfrom
the operator. 5ObviouslytheattackercouldalsouseHARVEY’scapabilitiestocausevery
visibleattacksifhechoosesto.
6Stuxnet for instance utilized a compromised HMI to hide itself from the
4PLCscanbeprogrammedwithmultipleindependentcontrollogicappli- operator[24].
cationswhichareexecutedsequentiallywithinineachscancycle. 7SCADA:supervisorycontrolanddataacquisition.
3III. HARVEY:MODEL-AWAREROOTKIT For attacks on simple systems the model would be simple,
too, and can be created manually. For more complex systems
Thecentralpropertyofourrootkit HARVEY isthefactthat
themodelcanbecreatedwithautomatedtools.8 Theattacker’s
it takes into account the physical topology of the industrial
advantage is that he does not need to have a comprehensive
control system (ICS) it infects. This gives HARVEY unique
model of the entire system. She only needs a model for parts
capabilities. Most importantly, it allows our rootkit to be
of the system her attack will operate in. For instance, if the
stealthy. HARVEY is completely invisible to the ICS’s virtual
attacker aims to damage a specific pipe in a large plant, she
world. This means that the effects of attacks launched by
only needs a model covering those components that her attack
HARVEY canneitherbedetectedbyhumanoperatorsmonitor-
will effect, which might be as few as a single pump and a
ing system measurements nor by security tools like intrusion
single sensor. Additionally, the model can also incorporate
detection systems (IDS) monitoring the ICS network. This
the deployed (if any) intrusion detection sensors to ensure the
makes HARVEY uniquely powerful and goes beyond attacks
malicious control commands do not trigger the alerts.
known today.
In Section VI, we will present our evaluation results of
The idea of our model-aware rootkit is to infect the
our model-aware malware on a real power grid. It shows that
firmware of a programmable logic controller (PLC), allowing
manipulations in the physical world can be hidden from the
HARVEY to control all inputs and outputs of the PLC. The
cyber world.
control logic program gets access to the PLC’s input values
throughthefirmwarefromthephysicalworld,processesthem,
and then provides outputs that are forwarded to the physical PLC Infection. Our rootkit works by compromising a PLC’s
worldthroughthefirmware.Thecontrollogiccanalsointeract firmware, which the attacker can achieve in different ways.
with other cyber components in the industrial control system The attack can use the built-in firmware update mechanism
(ICS) over network. to replace the firmware on a PLC. Depending on the PLC
model,firmwareupdatesarenotsecureagainstmanipulations.9
BecauseHARVEYlivesinthefirmwarelayerandintercepts
Firmware updates can be deployed over the network for most
the control and information flow of the firmware, it is com-
PLCs. Hence, PLCs which are reachable by the attacker over
pletely transparent to the control logic. Each output which is
the network can be compromised directly.
passed from the control logic to the firmware is captured by
HARVEY and can be changed, e.g., to maximize the effects The attacker can also compromise PLCs locally. Many
of the attack. Similarly, HARVEY can change the input values PLCs allow firmware updates from local media such as SD
seen by the control logic arbitrarily, e.g., to hide effects of its cards. Additionally, the attacker can use hardware interfaces
attack. likeJTAG10toconnecttothePLCandmanipulateitsfirmware.
An attack has recently been presented that shows the ease of
HARVEY only compromises the PLC’s firmware, hence, it
JTAG implantation [25]. In Section V we describe in detail
cannotbedetectedbytheoperator’sPLCmanagementtools.In
our attack on a PLC through its JTAG interface.11
contrast,malwarethatoperatesonthecontrollogiclevelcanbe
detected through the PLC’s remote management capabilities. Lastly, if the previous attack methods are not available,
Control logic malwares need to rely on additional techniques the adversary could facilitate run-time attacks, e.g., net-
or assumptions to hide themselves from the operator. Stuxnet work exploits. To the best of our knowledge, there are no
compromised the operators workstation to hide itself [24]; PLCs available that have run-time attack mitigation tech-
Bru¨ggemannandSpennebergrelyontheobservationthatthey niques deployed. This means that attacks like code injec-
cancausetheoperator’sremotemanagementsoftwaretocrash tion are likely to succeed on PLCs. Remote code execu-
by manipulating meta-data stored on the PLC [12]. tion vulnerabilities on PLCs have been issued just this past
year, e.g., CVE-2016-0868, CVE-2016-5645 and all vulner-
Although our Man-in-the-PLC rootkit cannot be detected
abilities associated with the FrostyURL vulnerability, such
directly by the operator, it could still be detected indirectly
as CVE-2015-6490, CVE-2015-6492, CVE-2015-6491, CVE-
through the effects it causes. To prevent unintended, possibly
2015-6488, and CVE-2015-6486. However, even in the pres-
suspicious effects in the ICS, HARVEY does not change input
ence of protection mechanisms, the developments in the desk-
andoutputvaluesarbitrarily.Instead,ourrootkitactsaccording
top and server world have shown that attackers will find new
to a model of the target system which ensures that the opera-
means of circumventing these protection mechanisms. Code
tor’sviewofthesystemstaysconsistentwithhisexpectations.
reuse attacks, like return oriented programming (ROP), have
Thismeansthatifthemalware’sgoalistoincreasethepressure
already been applied on embedded systems [27].
in a pipe to damage it, it is not sufficient to activate the pump
by setting the output of the PLC accordingly. A sensor would
measuretheincreasingpressureandwouldalerttheoperatoror IV. PHYSICS-AWARENESS
trigger an automatic safety mechanism. Hence, for the attack
ThissectionexplainshowHARVEYmanipulatesthecontrol
to be successful, the malware must also ensure that sensor
actuation actions and sensor measurements within a PLC.
readingspresentedtotheoperatorarenotsuspicious,e.g.,hide
the increasing pressure. Figure 3 shows how HARVEY manipulates data streams to
damage the physical plant while ensuring the operators see
Since our rootkit uses a model to manipulate inputs and
what they would expect to see based on their inputs to the
outputs of a PLC in a coordinated fashion, it can present a
system. HARVEY performs the attack through manipulation
normal operation view towards the cyber world while manip-
ulating the physical world.
8Relatedworkfocusingonmodelingindustrialcontrolsystemsisdescribed
inSectionVII.
Model. The model according to which our malware is operat-
9WewillelaborateonourfindingsonfirmwareupdatesecurityinSectionV.
ingcanbecreatedand/orobtainedindifferentways. HARVEY
10Joint Test Action Group (JTAG) is an IEEE standard for testing and
essentially makes use of the same models that are used to
debuggingintegratedcircuits.
controltheunderlyingphysicalplatformlegitimately.However, 11Note that the goal of our work is to show the effectiveness of physics-
themalwareoptimizesthecontrolcommandsforanadversarial aware malware, providing novel infection vectors were not the scope of our
objective function. efforts.
4Operator module write requests, and replaces them with malicious
control output u∗. It calculates the malicious control outputs
m
through similar logic as the legitimate controller with only
one difference: it calculates the control outputs that minimize
Legi5mate-­‐Looking Interface the corresponding objective function u∗=argmin obj(x,f) to
u
maximize the damage on the physical plant. HARVEY writes
the calculated commands to the corresponding PLC output
Legi>mate Control Logic
ports that are connected to the physical plant actuators. The
corrupted control commands drive the plant towards unsafe
fake legi5mate-­‐looking statesleadingtopotentialphysicalfailures,e.g.,powersystem
legi5mate control
measurements blackouts.
It is noteworthy that HARVEY’s malicious control output
PLC Firmware Rootkit (Power System Model) calculation can also incorporate additional constraints that
may be introduced to evade the detection of the attack. For
instance,inawaterplant,theconstraintsmayavoidanextreme
adversary-­‐op5mal
actual measurements increase of the pump rotation speed because of its potentially
malicious control
noticeable noise. Additionally, without the loss of generality,
… … the linear model mentioned above can be replaced with either
Physical System simpler or more complicated models used by the PLC control
Sensors (e.g., power system) Actuators logic depending on the specific control system domain (see
Section VI for an empirical power system case study.)
Fig. 3: HARVEY Two-Way Data Manipulation Attack
B. Monitoring: Sensor Data Corruption
of data in both directions: i) control commands sent by the The control command manipulation attack, discussed
operators and/or the control logic on the PLC to the actuators above, causes unsafe physical plant states, but it does not
deployed on the physical plant; and ii) sensor measurements containthenecessaryamountofstealthforpracticalreal-world
from the deployed sensors to the operators. The control deployment. Hence, it can be easily detected by the control
commands are corrupted to damage the physical system and system operators, who continuously monitor the real-time
cause system failures, whereas the sensor measurements are physical plant state on the human-machine interface (HMI)
corruptedtoevadetheoperatordetectionofthecausedfailures. screens.TheHMIscreensarefrequentlyupdatedautomatically
by fetching the PLC’s memory for the most recent physical
A. Control: Malicious Plant Actuation system sensor measurements that have been delivered to the
PLC’s input module.
In real-world control systems, e.g., power systems, the
system dynamics continuously change due to various factors, Toevadethedetection,HARVEYinterceptsthesensormea-
e.g., electricity consumption changes by the civilians. Such surementsonthePLCandreplacesthemwithfakevaluesthat
changes require updated control of the physical system to wouldmaketheunderlyingphysicalsystemstatuslooknormal
ensureit maintains itscorefunctionalities.For instance,inthe to the operators. Stuxnet implemented an innovative system
power grid control systems, the generation set-points (control status record-and-replay attack. The worm would record the
commands) are updated dynamically by the controllers to plantdynamicsfor13daysbeforeitinjectedmaliciouscontrol
ensure the amount of power that is consumed equals the logic on the PLC. Once the attack started on the plant
generated amount by the generators. (maliciouscontrollogicexecutiononthePLC),Stuxnetwould
replay the recorded data stream back to the operator screens.
The control of the physical plant is often performed based
on the models of the underlying physical dynamics, e.g., Such record-and-replay attacks would work in specific
fluid dynamics for the water networks and Kirchhoff laws control system plants with static and stationary low-pace
for the power systems. The models encode the correlations dynamics such as uranium enrichment, which was Stuxnet’s
betweenthesystemparametersduetothephysicslawscaused target. However, the sole record-and-replay attack would not
by inter-component connections and dependencies. The most be practical and can be easily detected if used in typical
populargenericmodelingfollowslineardynamicalstate-based controlsystemswithhigh-pacedynamicssuchasapowergrid.
formalism x˙= f(x,u), where In power grids, the operators constantly change the system
configuration/topology and parameter values as a result of
f(x,u)=Ax+Bu+ω (1) manyexternalunpredictablefactors,suchasreal-timedemands
by the end-point electricity consumers and real-time climate
y=Cx+ε. (2)
forrenewableenergysourcessuchassolarandwindgeneration
The matrices A,B,C represent the dynamics of the physical plants. Therefore, a replay of a previously recorded sensor
system,xisthestatevectorofthesystem,yisthesensormea- measurement stream back to the operators is very unlikely
surements sent to the PLC, and u are the control outputs from to match exactly the expected status of the power system
the PLC to the actuators. ω and ε encode the noise in system following the operator’s most recent control commands.
dynamicsandthesensormeasurements,respectively.ThePLC
controllogicreceivesthesensormeasurementsyandcalculates
HARVEY addresses the challenge above in highly dynamic
the corresponding optimal control commands u∗ to maximize controlsystemenvironmentsthroughreal-timeandlightweight
a domain-specific objective function u∗ =argmax obj(x,f), physical plant simulation within the PLC firmware. HARVEY
u takes the legitimate controller commands that either the oper-
e.g., the minimum total generation cost in power systems.
ator or the legitimate controller logic on the PLC issues to be
The calculated control commands are sent to the PLC output
modules through its firmware facilities.
sent to the output modules and actuators. HARVEY then simu-
latesthephysicalplantdynamicsbysolvingthecorresponding
HARVEY sitswithinthefirmwareandinterceptstheoutput plantmodels(e.g.,Equation(1)).Throughthesimulationofthe
5physicalsystem,HARVEYessentiallycalculateshowthepower
systemwould“look”ifthelegitimatecontrolcommandswould
really be sent to the deployed actuators. HARVEY replaces the
actualsensormeasurementswiththeircorrespondingsimulated
fake values before they are written to the PLC memory. The
following PLC memory reads by the operators’ HMI software
would be receiving the fake measurements. Hence, the HMI
screenswouldshowalegitimate-lookingphysicalsystemstate
to the operators.
ThefabricatedPLCmemoryvaluesareusedassensormea-
surements by the legitimate control logic that is developed by
the operators and runs on top of the malicious PLC firmware.
Consequently,thelegitimatecontrollogicwillcalculatecontrol
commands that satisfy the operators’ expectations on the HMI
screens. It is noteworthy that HARVEY does not replace the
legitimatecontrollogicexecution.Instead,itrunsitsmalicious
code in parallel to the legitimate control logic, and hence
the outputs from both executions are calculated and used
for different purposes (i.e., for faking the physical system Fig. 4: LM3S2793 JTAG Pins and Their Connections to the
appearance and damaging its actual components). 10-pin ARM-JTAG Connector.
weusedtoselectthetargetdeviceforourimplementation.On
C. Distributed Monitoring and Control
one hand, groundwork on reverse engineering Allen Bradley
Inpractice,alarge-scalecontrolsystemisoftenmaintained PLCs had been done before by the Air Force Institute of
by a set of distributed PLCs, each in charge of their assigned Technology [7], [44]. On the other hand, unlike Siemens
local “zone”. As an example, in power systems, the electricity PLCs–which have received a lot attention in recent years–
grid is typically partitioned into several sub-areas each main- AllenBradleyPLCsaremostlyuncharted.Nevertheless,Allen
tained by a separate controller [28]. In water plant facilities, Bradley is one of the largest vendors for industrial control
thewatertreatmentisoftenperformedinasequenceofseveral systems internationally. In particular, the CompactLogix L1
serial phases such as chlorination, pH control, filtration, and series is widely used in several safety-critical infrastructure
disinfection.Individualphasesareusuallyoperatedbyseparate applicationssuchaspowergrids,waterplants,oil&gasrefiner-
control logic programs either all on the same PLC or each sit- ies, and medical devices (e.g., the Adept Viper S650 surgical
ting on a separate PLC. For real-time monitoring and control, assistant robot).
each PLC takes the monitoring and control responsibility of
The 1769-L18ER-BB1B CompactLogix 5370 L1 Rev. B
its associated zone independently such that its local sensor
is based on a Texas Instruments Stellaris LM3S2793 Micro-
measurements suffice for its zonal control operations.
controller,12 which uses the ARM Cortex-M3 instruction set
The distributed monitoring and control paradigm is tradi- architecture (ISA).
tionally employed to ensure real-time and reliable operation;
Two sets of pins from the processor’s pin configuration
however,itcanbeleveragedbythePLCfirmwareattackssuch
were of relevance to our work: (1) the processors pins asso-
asHARVEYtoensureitsstealthinessagainstlarge-scalecontrol
ciated with the JTAG interface, and (2) the input/output port
systems even when one or just a few of PLCs are infected.
pins of the processor.
Put in other words, to perform an attack against a large-scale
platform, the adversaries do not have to compromise all the JointTestActionGroup(JTAG)iscommonlyusedtorefer
controllers to maintain stealth. toIEEEStandard1149.1[1].JTAGcanbeusedasahardware
debugging interface in the processor.13 We used JTAG to
V. HARVEYIMPLEMENTATION develop our HARVEY prototype, as the JTAG connection
allowed us to read out the CPU’s memory, including flash
This section describes our rootkit implementation for an memory, read-only memory (ROM) and static random access
Allen Bradley 1769-L18ER-BB1B CompactLogix 5370 L1 memory (SRAM). Although HARVEY is not limited to JTAG
Rev. B. It is noteworthy that the attack implementation is as method to infect a PLC exploring further infection paths is
explainedspecificallyforthePLCmodelabove.ThePLCsoft- out of scope in this work.
ware/hardware architectures are fundamentally similar across
various vendors. Hence, the proposed techniques can be gen- Figure 4 shows the PLC’s CPU, i.e., a Texas Instruments
eralized to other widely-used industrial PLCs. LM3S2793. The CPU’s pin allocations are marked as well as
the connection of the JTAG pins to the solder pad on the right
HARVEY deeply interferes with the core functionality of side of the board.
thePLC’sfirmware.Thisinterferenceallowscomplexbehavior
manipulations of the PLC, which is required for stealthy con-
A. Preparation
trol system attacks as described in the previous section. Since
thefirmwareofPLCisnotopenlyavailable,wehadtoreverse
The ultimate goal of our work was to modify the firmware
engineer it as the first step of our prototype implementation.
of the PLC to manipulate input and output values of the PLC
Most techniques in this multi-step process are known but
without changing the PLC’s control logic. To accomplish that
nonetheless technically challenging and needed.
12The processor’s data sheet can be found online and reveals important
Device Selection and Specification. Before we get into the detailsabouttheprocessor[49].
analysisdetailsoftheAllenBradley1769-L18ER-BB1BCom- 13Although the JTAG header was physically compatible to typical ARM
pactLogix 5370 L1 Rev. B, we shortly explain which criteria Cortex-M310-pinJTAGconnection,thepinconfigurationwasdifferent.
6techniques presented in [7]. This code provided a greater
TABLE I: TI LM3S2793 Memory Map
insight of higher level functionality of the firmware, but the
memoryweextracteddirectlyfromtheCPUthroughtheJTAG
Start End Description
interfaceprovedtobemorefruitful.UsingtheJTAG-extracted
0x00000000 0x0001FFFF On-chip Flash
memory files, we first aimed to get a general understanding
0x00020000 0x00FFFFFF Reserved of the functionality of the firmware. Using the ARM Cortex-
0x01000000 0x1FFFFFFF ROM M3 documentation, we were able to identify the nested vector
0x20000000 0x2000FFFF On-chip SRAM interrupt controller (NVIC) table. This table contained the ad-
0x20010000 0x21FFFFFF Reserved dressoftheresethandler,i.e.,wherethedevicestartsexecution
0x22000000 0x221FFFFF Bit-band alias of after a reset. Using this address, we were able to follow the
SRAM boot sequence and disassemble the core functionality in the
... ... PLC’s flash memory as well as all functions called in SRAM
0x4005C000 0x4005CFFF GPIO Port E (AHB) and ROM.
0x4005D000 0x4005DFFF GPIO Port F (AHB)
More importantly, we used the ROM data sheets for
0x4005E000 0x4005EFFF GPIO Port H (AHB)
Stellaris LM3S devices to identify calls to the micro-
0x4005F000 0x4005FFFF GPIO Port G (AHB)
controller’s built-in functions [48]. This helped to iden-
... ...
tify when important calls to functions that interacted
with system peripherals were executed. Identifying these
functions gave us a basic understanding as to how the
we had to find the firmware functions which are responsible firmware was configuring the controller. Specifically, the
for handling the PLC’s inputs and outputs. functions to control the CPU’s general purpose input/output
(GPIO) ports, such as the ROM GPIOPinTypeGPIOInput,
The first step in analyzing the firmware of our prototyping
ROM GPIOPinTypeGPIOOutput, ROM GPIOPinWrite and
platform was to obtain images of the firmware. We used two
ROM GPIOPinRead functions, provided us with functions to
approaches: (1) We downloaded firmware update packages
look out for as we disassembled the firmware.
from the vendor’s website and extracted the firmware images
from them.14 (2) We extracted the firmware from the PLC’s One other detail worth mentioning is that we were able to
memoryusingtheJTAGinterfaceofthePLC’smainprocessor. find where the NVIC table was being re-based after the initial
boot sequence. Typically the NVIC is re-based to address
Firmware Images. Allen Bradley PLCs (at least Compact- 0x4000inARMCortex-M3processors.Thiswasconfirmedin
Logix L1 and ControlLogix L61 models) have two firmwares. our dis-assembly as the vector table offset (located at address
(1) A base firmware which is shipped with the PLC which 0xE000.ED08) was set to 0x4000 at the end of the boot
provides a minimal function set of the PLC, and (2) a full sequence.ByknowingwheretheNVICis,weknewwherethe
flashedfirmwarewhichprovidesallfunctionalityforoperation. addresses of the interrupt service routines (ISR) specified in
The latter will be referred to as full firmware for the rest of the LM3S2793 documentation were located. In the following
the paper, while the first we call base firmware. section, we will see the significance of this detail.
The base firmware can only be extracted from the PLC’s
OnlineFirmwareAnalysis.TheJTAGconnectionofthePLC
memoryasitisnotcontainedinthefirmwareupdatepackage.
allowedustoanalyzeanddebugfirmwareduringitsexecution.
Thebasefirmwareisintendedtohaveonecentralfunctionality:
We could set break points, step through functions, read and
to recover the PLC in case an update of the full firmware did
write memory and modify registers of the CPU while it is
not succeed. Hence, the base firmware should not be updated.
executing. We used this to follow the control flow of the
The full firmware of the PLC can be updated, with several firmware and discover reachable code sections.
versions are available for download from the vendor’s web- Through the analysis we could identify the main loop
site [42]. It can be updated remotely over Ethernet or locally
of the firmware. We coupled our online analysis with our
via USB or SD card.
offline analysis to step through functions and follow along the
disassembled paths. By knowing the boundaries of the main
Memory Layout and I/O mapping.TheTILM3S2793maps loop, we could investigate where the interaction between the
all flash memory, ROM, SRAM as well as peripheral devices LEDs/HMIandtheGPIOPortsoccurred.ThePLCisequipped
intoonecontiguousmemoryaddressspace.TableIshowsparts with LEDs, one per I/O pin. Similarly, the input values sent
of the memory map of the CPU [49]. to the HMI allow the operator to observe the system state.
When the PLC is power-cycled, an LED sequence is
B. I/O Interception
generated where each LED associated to the embedded I/O
To recover the functionality of the firmware we use offline is sequentially blinked, starting from the Input Ports to the
as well as online analysis of the firmware. Offline analysis Output Ports. This sequence is relatively slow and involves a
was done with standard reverse engineering tools such as hex sleep period. This allowed us to halt the processor in between
editors and dis-assemblers. The online analysis was possible two LEDs being blinked. After stepping through the LED
due to the JTAG connection we could establish with the PLC. sequence,wewereabletodeterminethesubroutineassociated
with sending the LED values over I2C. Additionally, we
OfflineFirmwareAnalysis.Wedisassembledthedownloaded identified the address where the I/O values are stored before
and extracted firmware binary files from the firmware update theyaresenttotheLEDs.Weconfirmedthisbymodifyingthe
file. However, only a small portion of the code was initially associated registers (while the CPU was halted) and stepping
disassembled correctly, to improve the results we utilized throughtoforcearbitraryvaluesdifferentfromthetypicalLED
sequence. Although this confirmed that we could control what
14VendorslikeSiemensencrypttheirfirmwareimagesinupdatepackages. values were being sent to the LEDs, we still needed to take
However, the key to decrypt them have been published [8]. The firmware control of the interchange between the LEDs/HMI and the
imagesassociatedwithourPLCarenotencrypted. GPIO Ports.
7We found that the main loop has one reference to this
LED update function. We noticed that before this update
function, a few timer interrupts were being disabled. Using
the information from the re-based NVIC table as well as the
data sheet, we were able to find the associated ISRs located
in SRAM. In particular we found that the Timer 0A ISR was
responsiblefortheinterchangebetweentheGPIOPinsandthe
LEDs/HMI.
As described in Section II-A PLCs operate on the basis of
so-called scan cycles, i.e., in fixed intervals inputs are read,
the control logic is executed, and the results are written back.
We are careful to identify this main loop as being directly
correlated to the scan cycle. The Timer 0A ISR seems to be
independent of the scan cycle as it is set to run every 0.25 µs.
It is only interrupted when updating the LED values. Because
this process has not been fully reverse-engineered, we cannot
make much stronger inferences than those already mentioned.
C. I/O Interception Code Modifications
Asdescribedintheprevioussection,weidentifiedtheexact
Fig. 5: Original GPIO-output update ISR assembly code com-
twosubroutineswherethevaluesfromGPIOPortsEandFare
pared to modified subroutine with branch to malicious code.
beingforwardedtothePLCmemoryassociatedwiththeinput
values, i.e., the input values sent to the control logic program,
the LEDs and the HMI, as well as where the output values
from the PLC memory are forwarded to the associated output
memory for the LEDs, HMI, and GPIO Ports G and H.
For the output update routine, HARVEY uses the physical
models to send legitimate-looking data to the LEDs/HMI,
and sends malicious values to GPIO Ports G and H. For the
input update routine, HARVEY uses the legitimate input data
from GPIO Ports E and F to update the malicious model and
possibly coordinate with the output modifications. HARVEY
again uses the physical models to report legitimate-looking
input values to the LEDs/HMI. The input values, which the
control logic might report, e.g., to the system operator, can be
crafted such that they correspond to the observation HARVEY
makesonthecontrollogic’soutput,asdescribedinSectionIV.
Fig. 6: Original GPIO-input update ISR assembly code com-
I/O Interception Details. In order to implement our attacks, pared to modified subroutine with branch to malicious code.
wemodifiedtwosubroutineswithintheTimer0AISRthatare
responsiblefortheinterchangeofvaluestoandfromtheGPIO
Ports. Figure 5 shows the aforementioned first attack scenario Inthiscase,thegoalwastofaketheinputvaluesbeingsent
where we reported false output values to the LEDs and HMI. to the LED’s/HMI as well as the actual ladder logic program
runningonthePLC.Withnoinputs,theexpectedvaluewould
Thefigureshowstheoriginalsubroutinethatwasresponsi- be 0xFFFFFFFF. In our attack, we disregard the values read
bleforforwardinganupdatedoutputvaluefrommemorytothe from the GPIO Ports E and F and simply wrote a value of
GPIO Ports G and H. The subroutine first updates the address 0xFFFFFFFCtotheinputLEDs,settingInputPort0andInput
correspondingtotheLEDandHMIoutput,=LED Output,and Port 1 to high.
then calculates the correct values to send to the GPIO Ports.
Forourattack,wefirstmodifiedanarbitrarylocationofusable
D. Firmware Update
(or re-usable) memory in SRAM and injected our malicious
assembly code. Once the malicious code was written, we We believe that the built-in remote firmware update func-
modified the subroutine to branch to our malicious code. The tionality of PLCs is the most likely method for an attacker to
malicious code would then branch back to the subsequent compromise a device. This is based on observations in related
instructions once the appropriate values were modified. In our workthatfirmwareupdatesarenotprotectedagainstmalicious
attack scenario, a safe system state with Output Port 0 high modifications [7], [44]. For our PLC model, the situation is
would have a “0” at the least significant bit, representing the different. Firmware updates are protected by cryptographic
0 port, and the rest of the bits would be set to 1, i.e., a value means. Firmware updates are delivered together with certifi-
of 0xFFFFFFFE. In our attack, we want to set Output Port cates in the X.509 standard [16]. The certificate contains a
0 to low and Output Port 1 to high, i.e., write a value of SHA-1 [37] hash of the firmware binary file and is signed
0xFFFFFFFD to the associated memory address. We chose to with1024bitRSA[41].Althoughthecertificateisself-signed,
branch to an arbitrary memory location to prove that we can the PLC will abort the update process when provided with a
makeuseoftheavailablememorytoimplementmorecomplex self-signed certificate using a different key than the original
attacks. Figure 6 shows the second attack implemented in a one. This makes it practically impossible for an attacker to
similar fashion. change the firmware and install it on the PLC. To succeed,
8the attacker has two options, (1) he could attempt to find a 35 31,74 31,03
pre-image hash collision for the SHA-1 hash of the benign
30
fi torm siw gnar te hebin cea rr ty i, fio car t( e2 .) he could factorize the public key used )sµ
( e25
m
iT20
However, an attacker can always compromise a device n o15
through the JTAG interface, like we did.
itu
ce10
x
E 5
0,18 0,25
VI. EVALUATIONS 0
PID (DINT) PID (REAL) Relay Logic Attack Timer 0A Interrupt
We evaluated several aspects of HARVEY. On one hand, Code
we evaluated the effects of HARVEY on the individual pro-
grammable logic controllers (PLC), its influence on execution Fig. 7: Feasibility Analysis: Performance Overhead
times and its memory consumption. On the other hand, we
evaluatedHARVEYinareal-worldpowersystemtoempirically
prove that HARVEY can (1) maximize the effects on the ExecutionTime.ToevaluatetheperformanceofHARVEY,we
physical system, and (2) hide its malicious effects from the measured its execution time and compared it to the execution
operator. time of the PID control logic. The measurements are provided
inFigure7,dependingonthemodethePIDcontrollogictakes
between31.03µsand31.74µs.ThetimerA0interrupthandler,
A. PLC Evaluation
whichcontrolstheinput/outputinterchangebetweentheGPIO
Our PLC model is equipped with an ARM Cortex-M3 ports and the LEDs/HMI, takes only 0.25µs, which is two
processor with 64KB RAM [49]. It has 512KB memory for ordersofmagnitudefaster.Ourattackcode,whichimplements
user programs (control logic), as well as 16 DC digital inputs a simple relay logic, takes only 0.18µs.
and 16 DC digital outputs.
As described in Section II-A PLCs work in scan cycles.
This means inputs are read and outputs are written at a fixed
Experimental Setup. To evaluate the effects of HARVEY rate, while the control logic gets executed in between. The
on a PLC we set it up with a typical control logic. control logic execution time may not exceed the scan cycle
We installed a control logic program for a PID (propor- length, otherwise it gets interrupted. Usually, the execution
tional–integral–derivative) controller which is shipped by the time of control logic is well below the length of a scan
vendorofourPLCasastandardcontrollogicinstructionused cycle.Thismeansthat HARVEY canutilizethetimedifference
in many environments. between control logic execution length and scan cycle length.
In order to model fake input and output values, we used a If the unused time of a scan cycle is not sufficient for
customimplementationofaPIDcontroller.Figure9showsan HARVEY, there are several potential solutions that can be
extract of its assembler code. The code represents a sample implemented to influence the length of a scan cycle. For
PID update function that takes in the current system error instance, HARVEY’s periodic execution depends on a timer
and the difference in time since the last iteration and updates interrupt configuration. Because HARVEY is executing within
the control output based on the summation of the scaling the firmware, the timer interrupt configuration can be modi-
terms. These scaling terms are determined by the type of PID fied to better suit the attacks needs. Similarly, the reporting
controller. In this case, we defined proportional, derivative mechanisms for the control logic/HMI also depend on the
and integration error terms to be summed for the control timer interrupt configurations that are implemented within the
output. A windup guard is used to set a maximum value for firmware.Therefore,thereareseveralpermutationsofanattack
the integration term. We compiled this code using a pre-built vectorthatwouldallowHARVEYtoexecuteinatimelyfashion
GNUtoolchain forARM Cortex-M3processors aswell asthe withareasonableamountofindependencefromthescancycle
StellarisWare libraries for our processor. duration.
To validate the modifications of HARVEY we had to
Memory Consumption. Our PLC has a finite amount of
compare the physical outputs of the PLC with the information
memory which must be shared between the benign firmware
providedtotheoperator.Tomeasurethephysicaloutputofthe
and HARVEY. Although the firmware initially occupies most
PLC we wired it to a voltmeter. To determine the operator’s
partsofthememory,largepartsareneverused.Thesesections
view of the system state, we used the built-in LEDs of the
were determined during our online analysis. Furthermore, we
PLCaswellastheonlinemonitoringprovidedbythevendor’s
examined subroutines that were no longer called after the ini-
control logic development suite, which we will refer to as our
tial boot sequence. Once the PLC reached the aforementioned
HMI. The PLC has a dedicated LED per input and output pin
main loop, we were able to identify the subset of subroutines
whichlightsupaccordingthelogicalstateofthepin,i.e.,when
that were called by the PLC during the boot sequence but
there is current on the pin the LED will turn on, otherwise,
were no longer referenced within the main loop. We refer
the LED will be off. On the HMI side, online updates of the
to this memory as reusable memory. We verified that these
downloaded control logic program are displayed in real-time.
functions were no longer used by setting breakpoints at the
We used HARVEY to break the relationship between the function addresses as well as any referenced locations within
displayed system state and the actual inputs and outputs on the subroutine. We consider unused memory as memory parts
the physical pins of the PLC. which contain regular patterns that indicate that the memory
is not used, for instance, memory sections filled with all
0x00000000orall0xFFFFFFFF.Additionally,wefoundlarge
Attack.WewereabletochangetheLEDandHMIstatesofthe
chunksofmemorythatcontainwhatseemstobegarbagecode
PLCarbitrarilyandindependentlyofthestateoftheinputand
that is never referenced throughout the firmware execution.
output pins. Similarly, we were able to set the output values
of pins regardless of the commands sent by the control logic. For the practical feasibility of HARVEY, Figure 8 lists
960000 1970 pid_update
PUSH {R4-R6}
50000 (collapsed code)
)se
tyB40000
S
(
BT
c
ER
o
QD
l
.
l
W
a p s e
R
d
l3 o,
c
c
o
_R
d
84
e
1,
)
D
0[ R 7 , # 0 x 3 0 ]
;integration with windup guarding
(
e30000
ziS
e d20000
o
C
10000 LDR R3,=int_error ;int_error >= windup_guard
228 92 24 1932 54063 (collapsed code)
0 B loc_81F2
PID (DINT) PID (REAL) Relay Logic PID Attack Code Available
Attack Code Memory
LDR R3,=int_error ;int_error-=windup_guard
Instruction/Code Unused Memory Reusable Memory (collapsed code)
B loc_81F2
Fig. 8: Available Memory vs. Malware Size
LDR R3,=windup_guard ;int_error>windup_guard
;int_error=windup_guard
(collapsed code)
the memory consumption of the PID control logic as well as
reusable and unused memory in the firmware. It also shows LDR R3,=prev_error ;differentiation
(collapsed code)
the memory consumption of the custom PID update function STRD.W R3,R4,[R7#0x28]
LDR R3,=proportional_gain ;scaling
we used as the adversary’s system model in our setup. (collapsed code)
BL _muldf3
(collapsed code)
HARVEY can utilize the unused memory as well as the LDR R3,=integral_gain
reusable memory parts, which is significant portion of the LDRD.W R0,R1,[R3]
LDR R3,=int_error
PLC’s memory (56.033Bytes out of 65.536Bytes). (collapsed code)
BL _muldf3
(collapsed code)
LDR R3,=derivative_gain
B. Real-World Power System Case Study (collapsed code)
BL _muldf3
(collapsed code)
We evaluated HARVEY on a real-world power system test- LDR R2,=control ;summation of terms(control=p+i+d)
(collapsed code)
bed,wheredistributedPLCswithinstalledPIDmodulesalong LDR R2,=prev_error ;prev_error=curr_error
(collapsed code)
with more complicated control algorithms (discussed below) POP {R4-R7,PC}
maintain safe power system operation.
Fig. 9: Injected Malicious PID Controller
The electricity grid is modeled using the mathematical
power flow equations (physical Kirchhoff laws):
fp=−Pg+Pl+∑|V||V |(G cosθ +B sinθ ), (3) The legitimate OPF’s objective is to minimize the cost
i i i i k ik ik ik ik
k∈C
while ensuring the system operates safely. HARVEY imple-
ments a modified version of the algorithm, malicious optimal
which mandate how the sensor measurements (e.g., real/re-
power flow (mOPF), to maximize the cost without the need
active power values on i-th power node (bus) P/Q, power
i i for compliance with safety constraints:
bus voltagesV, inter-bus phase angles θ , and the admittance
i ij
(inverse resistance) parameters (G ,B ) on the transmission max c(x,u)
ij ij
line between the buses i and j correlate due to well-known u
physics Kirchhoff laws. P ig represents the amount of power s.t. P ig−P il =∑|V i||V k|(G ikcosθ ik+B iksinθ ik)
that is injected to the i-th power bus by a generator, and Pl is k (5)
the amount that is consumed by the end-users at that bus.i Qg−Ql = ∑|V||V |(G sinθ −B cosθ )
i i i k ik ik ik ik
k∈C
Optimalpowerflow(OPF)isthemostwidelyusedcontrol
∀i,j∈N, ∀l∈G, ∀k∈C
algorithmthatisusedinpracticenowadaystocalculatetheop-
timal control commands continuously. In power systems, OPF where the calculated control commands would maximize the
finds an optimal power generation set-point that minimizes amount of possible damage to the power system. The calcu-
total cost c while meeting operational safety constraints [2]. lated commands are used as set-points to be maintained by
The control commands typically include power output (set- the inner-loop PID controllers. Please note that the specific
points) of generators [19]. The OPF’s equality constraints are objective function for different malicious goals can be simply
the power balance equations at each bus in the system. Its used instead in the formulation above.
inequality constraints are the network operating safety limits
suchaslineflowcapacitiesandgeneratorpoweroutputlimits: Our power system test-bed implements IEEE nine-node
(bus) benchmark topology [15] including three synchronous
min c(x,u)
power generators and controlled by nine distributed PLCs.
u
s.t. Pg−Pl =∑|V||V |(G cosθ +B sinθ ) Figure 10 shows the test-bed (top right), its cyber network
i i i k ik ik ik ik topology (top middle), power system topology (top left), Lab-
k
View control diagram (bottom right), supervisory control and
Qg i −Ql i = ∑|V i||V k|(G iksinθ ik−B ikcosθ ik) (4) data acquisition device interconnections (bottom middle), and
k∈C monitoring and control operations (bottom left). The model
Pg≤Pgmax has three substations and corresponding loads (which con-
l l
sume power). The power nodes are connected through power
∀i,j∈N, ∀l∈G, ∀k∈C
transmission lines. To follow real world implementations, we
where u denotes the controls commands to be calculated; x equipped each substation with protection functions such as
representsdependentvariables;V andθdenotethebusvoltage over-current, voltage and frequency, i.e., the substation will
magnitudes and angles, respectively. openatransmissionlineiftheycarrycurrentbeyonditsphysi-
107 8 9
2 PMU PMU 3 Power System Control Area Generation
Control Plane Unit
PLC
Gen 2 PMU PMU Gen 3 Main Control Unit Distribution
5 Substation 2 6 Lines
Substation 1 Substation 1 Substation 3
PMU PMU Substation 3 Router Router IEDs SCADA
4
Communication Ethernet
1 Link Fiber Optic
IEEE 9 Bus Substation 2
Power System Router
Control Area
Gen 1
System Master SCADA SCADA PDC PLC HIL
Operator Control Center Central Controller Simulation
Grid Control
Applications
OPC UA
Middleware
Information Exchange
State Estimation Protection IED 1 IED 3
Substation Substation
Load Shedding Power Flow Measurement Measurement
Wide Area Monitoring and Control
IED 2
Event Analysis and Disturbance Recording Substation
Measurement
Fig. 10: The Evaluation Smart Grid Test-Bed
calcapacityorcauseover-voltageorover-frequencysituations. measurements to be viewed by the operators. Figure 12 shows
To monitor the power system, the voltage and current sensors the results (before the noise was added for the presentation
(phasormeasurementunitsPMUs)sendtheirmeasurementsto clarity). As the attack on the physical plant would result in
PLC controllers that act as monitoring/control agents and are noticeable side effects such as equipment operational noise,
responsible for all operational functions in the system. HARVEY’s outputs show a minor system perturbation within
safetylimitsthatisnormallyobservedondailydynamicpower
On the cyber end, the testbed includes a human-machine
system operations. From the operators’ viewpoint, the system
interface (HMI) server to provide the system status to the op-
acts safely and no corrective action is needed.
eratorsthroughitsconnectionstothePLC.Thedataexchange
betweendifferentfielddevicesisestablishedbyopenplatform
Adversary–optimal control attack: optimal malicious attack
communications(OPC)ClientI/Oservers[38].KepwareOPC
using real-world control algorithms. In this attack scenario,
Server provides embedded drivers to connect to the PLC. The
HARVEY implements a real-world power system controller
testbedemploysaReLabdevicedrivertoconnecttoandobtain
algorithm, called optimal power flow (OPF) [10], that is
measurements (IEEE C37.118) from PMU sensors. Briefly,
widely used in power system control centers internationally.
using Kepware’s IEC 61850 MMS clients, the KEPServerEX
OPF is implemented as a linear programming function: it
OPC Server drivers create an interface for any of the OPC
typically finds the optimal power system control strategy that
clients running in the network.
minimizes the overall cost while ensuring the system safety.
The system safety is usually defined by a set of lower and
We evaluated HARVEY for two attack scenarios.
upper bound thresholds for various system parameters such
Steady-state system malicious attack: Repeated heavy load as power transmission line current capacities, and minimum/-
circuit breaker open/close triggering without loss of power maximum allowed system frequency 59.5-61Hz (60Hz is the
system stability. In this scenario, the malicious PLC firmware nominal power grid frequency in USA). The control strategy
randomly (blindly) selects a circuit breaker to attack and is essentially a set of control commands that the PLC sends
triggers the opening/closing of the breaker several times, i.e., to the actuators, e.g., generation set-points to the generators
a transmission line opened and closed repeatedly. The power thatmandatehowmuchpowereachgeneratorshouldgenerate.
system was able to withstand this attack scenario without HARVEY implements the same control algorithm on the PLC
losing the stability since the target circuit breaker load was after making three modifications to the algorithm (we call
in the limits of power system generation reserve capacity. The it malicious OPF - mOPF): i) it removes the condition that
SEL-451PMUislocatedongenerator1bus,andthe421-PMU ensures the system is within safety margins; ii) it replaces
islocatedatgenerator2bus.Figure11showsthepowersystem the cost minimization function with maximization so that the
status during the attack that starts at 11.29.30 PM. The circuit adversarial impact becomes maximum; and iii) HARVEY adds
breakerwasopenedandclosedthreetimessequentiallywithin predefined stealthy conditions to ensure its malicious control
ten seconds. The heavy loading in the system deteriorated the actions do not get noticed/detected by the local operators on
system frequency (Figure 11a) and voltage (Figure 11b). The site due to the noise the actions generate. Example conditions
AC phase angle difference between generator 1 and generator are“nopowergeneratordisconnectfromtherestofthepower
2 exceeded permissible limits (Figure 11c). The power flow grid” in large power plants, since such disconnects cause a
magnitudes (Figure 11d) also violated safety thresholds tem- noticeable sound noise to the potential local operators. In
porarily.Asshown,althoughtheinstantvoltageandfrequency practice, there are typically few or no operators present on
of the system exceeded permissible limits, the power system remote power system substations. This gives HARVEY more
was able to withstand this type of attack. During the attack, freedom in terms of what malicious actions it can carry out.
HARVEY was able to run the power system model on the
PLC in parallel and generate fake legitimate-looking sensor In this attack scenario, HARVEY’s objective was to im-
11)V
)z
H
(
e
d u
(
y
c
t
ilp
n m
e
u A
q e
e g
r F a t
lo
V
(a) Frequency (b) Voltage Magnitude
)
s e ) W
e
r M
g
e (
D r
( e
e w
lg
n
o
P
A e
e
s a h
v
it
c A
P
(c) AC Voltage Phase Angle (d) Power
Fig. 11: Actual Power System Measurements
system. The fabricated fake sensor measurements (Figure 14)
)zH are sent back to the operators’ HMI screens. Consequently,
(
y
from the operators’ viewpoint, the underlying power system
cn
follows their expectation, while in reality, the system goes
e
u
q through serious instability situations facing potential large-
e
rF scale failures. An experienced operator might get suspicious
of small disturbances visible in the graph. However, such
disturbances can also occur in normal operation. Similarly, an
)V automated tool monitoring the ICS must be tolerant to small
(
e g disturbances to reduce the number of false positive alarms.
a
tlo
V
VII. RELATEDWORK
)W
We discuss related work on ICS security in terms of
M
( re proposed defense mechanisms and possible attacks.
w
o
P Defense mechanisms have been proposed on network and
e
v itcA h go ras pt/ hd sev bi ac se el dev oe nls. MSO arC koC vA d[ e5 c3 i] sig oe nne pr ra ot ce es sn se et sw co or nk s-l ie dv ee ril na gtta tc hk
e
Time(s) impactoftheadversarialactionsonthephysicalpowersystem.
Fig. 12: Fake Measurements to Mislead the Operator CPMA [17] uses the ICS attack graphs to perform security-
oriented risk analysis, so-called contingency analysis, regard-
plement mOPF on the PLC to calculate adversary-optimal ing potential threats against the power grid. Both solutions
controlstrategyforthepowerplant.Usingthepowersystem’s consider PLCs as the interface between cyber and physical
safety constraints, HARVEY intercepts the legitimate control assets of the infrastructures, and identify them as potential
action outputs and instead sends out its optimally-calculated targetsbytheadversaries.SCPSE[54]andCPAC[21]present
maliciouscontrolcommandstothepoweractuatorsatspecific astatefuldetectionmechanismtodetectattacksagainstcontrol
time points. HARVEY sets the nominal frequency reference to systems based on the received sensor measurements by the
62 Hz, and its malicious controller calculates and sends out operators. HARVEY evades such detectors completely through
control commands accordingly. replacing them with legitimate-looking fake measurements.
Figure 13 shows the actual power system measurements. Unlike traditional IT cyber networks, ICS networks often
HARVEY makes the power system frequency exceed its safety follow well-defined behavioral patterns. Therefore, online ICS
margins through its malicious commands (Figure 13a). The intrusion detection solutions monitor the runtime operation
system’s voltage magnitude (Figure 13b), AC voltage phase for anomalous behaviors as opposed to the signature-based
angle (Figure 13c), and electric power values (Figure 13d) paradigm [13], [31], [51]. Formby et al. [26] employ the
experience serious instability as well. However, in order to behavioralprofilesfordevicefingerprintingandaccesscontrol.
mislead the operator, HARVEY implements a legitimate OPF SecuritysolutionsinICShastobenon-intrusiveagainstsafety-
algorithminthebackgroundtosimulatethepowersystemand critical operations with real-time constraints that run mostly
calculateindividualsystemparametersassumingthatthelegit- on resource-limited embedded devices/controllers [52]. Such
imate OPF control commands were carried out on the power anomaly-basedsolutioncannotidentify HARVEY,sinceituses
12)V
)z
H
(
e
d u
(
y
c n e u
t
in
g a M
q e r F e g a
t
lo
V
(a) Frequency (b) Voltage Magnitude
)s
e e )W
r
g M
e
D
( e
(
r e w
lg
o
n P
A
e
e
v
s
a
itc
h A
P
(c) AC Voltage Phase Angle (d) Power
Fig. 13: Actual Power System Measurements
as HARVEY wouldfeedfake-legitimate-lookingmeasurements
)zH to the PLCs backplane, i.e., HARVEY resides between the
(
y
the I/O modules and the backplane. However, a Weaselboard
cn implementation can prevent arbitrary firmware updates over
e
u
q the network. Therefore, an attacker would need to convince
e
rF the operator to run a firmware update with a compromised
firmwarebinaryfileoruseaJTAGimplantationtomodifythe
firmware.
)A
(
tn
There have been several security solutions focused on
e rru
C
t ah ne ad tte at ce kcti lo ikn eo Hf Afi Rr Vm Ew Ya ,re e.gm .,od ci ofi nc ta roti lo -n fls owtha mt oc no itu ol rd ingpre sv oe lun -t
tions [40]. However, our contribution is not in the evasion of
firmware modification attacks, but rather the evasion of intru-
)W
sion detection solutions that sit outside of the PLC. Attacks
M
(
re
such as Ghost in the PLC [3] have shown that these firmware
w modification monitoring solutions can be circumvented.
o
P
e v Attacks on ICS and PLCs have grown significantly since
itcA
their seminal example emergence, the Stuxnet worm [24] that
targeted the Iranian Natanz nuclear enrichment plant. Stuxnet
Time(s)
iscategorizedasamaliciouscontrolcommandinjectionattack.
Fig. 14: Fake Measurements to Mislead the Operator Through four Windows zero-days, Stuxnet compromised HMI
and sent malicious control logic to the PLC. Stuxnet attacks
thesamepowermodeltofakesensormeasurementsandmake would be identified using TSV [34] as violating the plant’s
them look normal. safety requirements and blocked from the PLC execution.
SimilartoStuxnet,PLC-Blasterworm[12]injectsamalicious
TSV [34] and [55] provide a bump-in-the-wire solution control logic on the vulnerable PLCs (Siemens S7-1200v3)
betweentheHMIandPLCdevicetointerceptandanalyzethe after a network scan. For stealth, PLC-Blaster manipulates
control logic downloads on the PLC by the HMI server. TSV the meta-data of its control logic which will cause the HMI
implements formal methods to verify the safety of the code software (Siemens Step7) to crash when the operator tries to
regardingthephysicalplantsafetyrequirements,anddropsthe retrieve information from an infected PLC. This would raise
control logic if a counterexample is found. TSV is unable to the operator’s suspicion leading to potential detection. Ghost
detectHARVEYasittargetscontrollogicupdatesanddoesnot in the PLC [3] provided a PLC rootkit that exploited I/O
support firmware updates or network-level firmware exploits. pin control operations to provide a cyber framework for an
undetectable rootkit. However, the rootkit does not provide a
The Weaselboard [36] is a PLC backplane analysis that
means of stealthiness with respect to the monitoring entity
capturesbackplanecommunicationsbetweenmoduleswiththe
overseeing the physical evolution of the system.
intention of preventing zero-day exploits on PLCs. The inter-
module traffic is forwarded to an external analysis system that On the sensing side, false data injection attacks [33],
detectschangestoprocesscontrolsettings,sensorvalues,mod- [35], [50] have been shown to be capable of misleading the
ule configuration information, firmware updates, and process operators.Theattackersincontrolofasubsetofsensorswould
control program (logic) updates. Because the board monitors send corrupted measurements to control centers to mislead
backplanecommunication, HARVEY wouldremainundetected the state estimation and controller servers. False data injection
13attacksdonotconsidertheoperator’scontrolcommandstothe remove themselves from a list structure maintained by the
plant, and hence their fabricated system state may not satisfy OS[46].HARVEY,however,hastocompensateforthechanges
the operators’ expectation, and hence can be detected simply. to its physical world which will eventually feed back as input
readings.
On the network side, Beresford [8] discovered vulnerabil-
ities in Siemens S7 series communication protocol for replay
Internet of Things (IoT). In recent years, the term IoT is
attacksleadingtoaremoteshellaccess.Theattackwasspecific
used over-extensively even though (or because) there is no
tothatPLCmodelnumberofSiemensonly.Thesimilarattacks
widelyacceptedandprecisedefinitionoftheterm.Whilethere
onfirmwarevulnerabilities(e.g.,insecurechecksumvalidation
are definitions that include ICS (e.g., every computing device
during the update process [7], DDoS attacks against common
with a network connection) we would argue that ICS are not
industry protocol CIP package handler functions [44]) are
part of the IoT. Many IoT devices are based on commodity
orthogonal to HARVEY since HARVEY’s core contribution is
hardware and software (e.g., ARM Cortex-A processors and
to inject and run a power system model as a rootkit (after
LinuxbasedOS)andthusnotmuchdifferentfromsystemslike
the firmware is compromised) to damage the physical plant
smartphones. Hence, attacks on IoT devices, such as the com-
while evading the operator detection. The above-mentioned
promise of the Google nest thermostat [30], are not applicable
PLC attacks did not leverage the domain-specific features to
to ICS. Another significant difference between consumer IoT
i) maximize their destructive physical impact using adversary-
devices and ICS is the real-time operation of PLCs, reflected
optimal control algorithms, and ii) simulate the physical plant
by the control loop design of the PLC’s firmware. IoT devices
model to fabricate legitimate-looking measurements to the
rarely have strict real-time requirements. Further differences
operators.
include software deployment schemes (IoT device’s software
Klick et al. [32] show that internet-facing controllers can is controlled by the device manufacturer, PLC control logic
be compromised, act as a SNMP scanner or SOCKS proxy, is installed by the programmer/operator), or device lifetime
and be misused by an adversary to attack devices that are (ICS might be operated for decades). Lastly, the operation of
not directly connected to the internet. This technique can be IoT devices (and their effects on the environment) are often
usedtoextend HARVEY’scompromiseddevices.Additionally, unsupervised, hence, an IoT rootkit does not need to provide
therehavebeentheoreticalattackframeworksproposedagainst a manipulated system state view to an operator.
water SCADA [4]. The attack drives the underlying physical
plant towards unsafe states by solving the partial differential B. Generality
equationsthatmodelthewaterplantdynamics.Theauthorsdo
not discuss details of how such attacks can be implemented in
HARVEYinvolvedreverseengineeringofareal-worldcom-
mercial PLC device and binary software modules. Although
practical real-world settings and the involved challenges. Sim-
we worked on a specific model, the techniques we used, such
ilarly,system-theoreticmodels [39][5]havebeenproposedto
as JTAG debugging and binary analysis, can be generalized
identify stealthy cyber-physical attacks against the power grid
to PLC and controllers from other vendors, because they
either through compromised measurements or dynamic load-
generally follow similar technical approaches such as scan-
alteringattacks.However,themodelsassumethatattackerhas
cycle-based execution paradigm followed by periodic I/O
already compromised the required assets. These models could
interrupts and memory updates. Additionally, the proposed
be utilized by HARVEY to model the spoofed measurements
two-waydatamanipulationattackcanbeimplementedonother
being sent to the HMI.
(not necessarily power grid) control system settings, where
controller devices are used to monitor and control underlying
VIII. DISCUSSIONSANDMITIGATIONS physical plants.
Wediscussthegeneralityof HARVEY,anddescribepoten- HARVEY can be protected against using three major mit-
tial mitigation mechanisms that could be deployed to protect igation solutions: i) remote attestation allows a verifier to
critical infrastructures against similar attacks. check the software integrity of a system. A trusted component
provides an authenticated measurement of the memory of the
A. Unique Challenges in ICS device to be attested. Different approaches specifically for
embedded systems have been developed and could be applied
In this section we elaborate on some of the unique to PLCs [11], [18], [45]; ii) with secure boot, the integrity of
challenges in the ICS space by comparing our PLC rootkit a device’s configuration is not verified by an external entity
againstrootkitsknownfromworkstationsandservers.Wealso but by thedevice itself possibly using atrusted platform mod-
elaborate on the relation of industrial control systems and the ule[6].Securebootensuresthatonlyaknownandtrustworthy
Internet of Things (IoT). softwarecanbeloadedonadevice.Securebootcouldbeused
to ensure the integrity of PLC firmware; and iii) an external
Rootkits. The concept of rootkits, or more generally, com- bump-in-the-wire device between the PLC controller and the
promising the privileged software of a computing system with physicalplantcouldbemonitoringthetwo-waysensor-to-PLC
thegoalofhidinghasbeenknownfordecades[29].However, andPLC-to-actuatordatastreams(unlikeTSV[34]thatwould
most known rootkits target commodity operating systems like sit between the HMI and PLC). The solution could possibly
Windows or Linux which have vast amounts of resources that checkwhetherthecontrolcommandsissuedbythePLCsatisfy
can be (mis-)used by the rootkit to hide itself and perform its the plant’s essential safety requirements that must be defined
malicious actions. PLCs, on the contrary, have a significantly by the operators. Additionally, the solution could implement
differentsoftwaredesign(cf.SectionII-A)whichrequiresnew coarse-grained control consistency checks to validate whether
techniques for rootkits in the domain of ICS. sensor measurements and actuation commands are consistent
in terms of how the plant should be controlled.
HARVEY, in particular, aims at manipulating the input and
output of a PLC, i.e., interaction with the physical world.
IX. CONCLUSIONS
“Classical”rootkitsoperateonlywithinthedeterministiccyber
world, which makes hiding and other actions simpler. For We presented HARVEY, a PLC rootkit that implements a
instance, a typical hiding method of Windows rootkits is to physics-awareman-in-the-middleattackagainstcyber-physical
14control systems. HARVEY damages the underlying physical [29] A.Hay, D.Cid, andR. Bray,OSSECHost-Based IntrusionDetection
system, while providing the operators with the exact view Guide. Syngress,2008.
of the system that they would expect to see following their [30] G.Hernandez,O.Arias,D.Buentello,andY.Jin,“Smartnestthermo-
stat:Asmartspyinyourhome,”inBlackHatUSA,2014.
issued control commands. Our experimental results with a
[31] A.KleinmanandA.Wool,“Accuratemodelingofthesiemenss7scada
commercialPLCcontrolleronareal-worldpowersystemtest- protocol for intrusion detection and digital forensics,” The Journal of
bed demonstrates the feasibility of HARVEY in practice. DigitalForensics,SecurityandLaw:JDFSL,2014.
[32] J. Klick, S. Lau, D. Marzin, J.-O. Malchow, and V. Roth, “Internet-
facingplcs-anewbackorifice,”inBlackHatUSA,2015.
REFERENCES
[33] Y. Liu, P. Ning, and M. K. Reiter, “False data injection attacks
[1] “IEEEstandardtestaccessportandboundaryscanarchitecture,”IEEE againststateestimationinelectricpowergrids,”ACMTransactionson
Std.1149.1-2001,2001. InformationandSystemSecurity(TISSEC),2011.
[2] (2010) Federal energy regulatory commission (ferc): Optimal power [34] S.E.McLaughlin,S.A.Zonouz,D.J.Pohly,andP.D.McDaniel,“A
flow and formulation papers. http://www.ferc.gov/industries/electric/ trustedsafetyverifierforprocesscontrollercode.”inProceedingsofthe
indus-act/market-planning/opf-papers.asp. NetworkandDistributedSystemSecurity(NDSS)Symposium,2014.
[3] A. Abbasi and M. Hashemi, “Ghost in the plc: Designing an unde- [35] S. McLaughlin and S. Zonouz, “Controller-aware false data injection
tectable programmable logic controller rootkit via pin control attack,” against programmable logic controllers,” in IEEE SmartGridComm,
2016. 2014.
[4] S.Amin,X.Litrico,S.S.Sastry,andA.M.Bayen,“Stealthydeception [36] J.Mulder,M.Schwartz,M.Berg,J.R.VanHouten,J.Mario,M.A.K.
attacks on water scada systems,” in Proceedings of the 13th ACM Urrea, A. A. Clements, and J. Jacob, “Weaselboard: Zero-day exploit
InternationalConferenceonHybridSystems:ComputationandControl, detectionforprogrammablelogiccontrollers,”tech.reportSAND2013-
ser.HSCC,2010. 8274,SandiaNat’lLaboratories,Tech.Rep.,2013.
[5] S. Amini, H. Mohsenian-Rad, and F. Pasqualetti, “Dynamic load [37] N.I.ofStandardsandTechnology,“FIPS180-4,SecureHashStandard,
altering attacks in smart grid,” in Innovative Smart Grid Technologies Federal Information Processing Standard (FIPS),” http://csrc.nist.gov/
Conference(ISGT),2015IEEEPower&EnergySociety. IEEE,2015. publications/fips/fips180-4/fips-180-4.pdf,Tech.Rep.,2012.
[6] W.Arbaugh,D.Farber,andJ.Smith,“Asecureandreliablebootstrap [38] OPC Foundation. (2015) Open platform communication foundation.
architecture,”inIEEESymposiumonSecurityandPrivacy,1997. https://opcfoundation.org/.
[7] Z. Basnight, J. Butts, J. Lopez, and T. Dube, “Firmware modification [39] F.Pasqualetti,F.Do¨rfler,andF.Bullo,“Cyber-physicalattacksinpower
attacks on programmable logic controllers,” International Journal of networks: Models, fundamental limitations and monitor design,” in
CriticalInfrastructureProtection,2013. IEEECDCandECC. IEEE,2011.
[8] D. Beresford, “Exploiting Siemens Simatic S7 PLCs,” in Black Hat [40] J. Reeves, “Autoscopy jr.: Intrusion detection for embedded control
USA2011,ser.BlackHatUSA’11. systems dartmouth computer science technical report tr2011-704 a
thesis,” Ph.D. dissertation, DARTMOUTH COLLEGE Hanover, New
[9] W.Bolton,Programmablelogiccontrollers. Newnes,2015. Hampshire,2011.
[10] S.Bose,S.H.Low,T.Teeraratkul,andB.Hassibi,“Equivalentrelax- [41] R. L. Rivest, A. Shamir, and L. Adleman, “A method for obtaining
ations of optimal power flow,” Automatic Control, IEEE Transactions digitalsignaturesandpublic-keycryptosystems,”Commun.ACM,1983.
on,2015.
[42] Rockwell Automation. (2015) Rockwell automation download
[11] F.Brasser,B.ElMahjoub,A.-R.Sadeghi,C.Wachsmann,andP.Koe- center. http://compatibility.rockwellautomation.com/Pages/
berl,“TyTAN:TinyTrustAnchorforTinyDevices,”inProceedingsof MultiProductDownload.aspx?famID=4&Keyword=Controller&crumb=
the52ndAnnualDesignAutomationConference,ser.DAC,2015. 112.
[12] M. Bru¨ggemann and R. Spenneberg, “Plc-blaster der virus im in- [43] J. Rrushi, H. Farhangi, C. Howey, K. Carmichael, and J. Dabell, “A
dustrienetz,” https://events.ccc.de/congress/2015/Fahrplan/events/7229. quantitative evaluation of the target selection of havex ics malware
html,2015. plugin.”
[13] S. Cheung, B. Dutertre, M. Fong, U. Lindqvist, K. Skinner, and [44] C.D.Schuett,“Programmablelogiccontrollermodificationattacksfor
A.Valdes,“Usingmodel-basedintrusiondetectionforscadanetworks,” useindetectionanalysis,”DTICDocument,Tech.Rep.,2014.
in Proceedings of the SCADA Security Scientific Symposium, Miami
[45] R. Strackx, F. Piessens, and B. Preneel, “Efficient isolation of trusted
Beach,Florida,jan2007. subsystemsinembeddedsystems,”inSecurityandPrivacyinCommu-
[14] E.Chien,L.OMurchu,andN.Falliere,“W32.Duqu-Theprecursorto nication Networks, ser. Lecture Notes of the Institute for Computer
thenextStuxnet,”SymanticSecurityResponse,Tech.Rep.,2011. Sciences, Social Informatics and Telecommunications Engineering.
[15] R.Christie,“Powersystemstestcasearchive,”ElectricalEngineering Springer,2010,vol.50.
dept.,UniversityofWashington,2000. [46] Symantic,“WindowsRootkitOverview,”SymanticSecurityResponse,
[16] D.Cooper,S.Santesson,S.Farrell,S.Boeyen,R.Housley,andW.Polk, Tech.Rep.,2005.
“Internetx.509publickeyinfrastructurecertificateandcertificaterevo- [47] TechNavio. (2014) Global Industrial Control Systems (ICS)
cationlist(crl)profile,”https://tools.ietf.org/html/rfc5280,2008. Security Market 2014-2018. http://www.technavio.com/report/
[17] K.R.Davis,C.M.Davis,S.Zonouz,R.B.Bobba,R.Berthier,L.Gar- global-industrial-control-systems-ics-security-market%C2%
cia, P. W. Sauer et al., “A cyber-physical modeling and assessment A02014-2018.
frameworkforpowergridinfrastructures,”2015. [48] TexasInstruments.(2011-2013)StellarisLM4F120H5QRROMUser’s
[18] K. E. Defrawy, A. Francillon, D. Perito, and G. Tsudik, “SMART: Guide.www.ti.com/lit/ug/spmu245a/spmu245a.
Secure and Minimal Architecture for (Establishing Dynamic) Root of [49] Texas Instruments. (2007-2014) Stellaris LM3S2793 Microcontroller
Trust,”inNDSS,2012. DataSheet.www.ti.com/lit/gpn/lm3s2793.
[19] H. Dommel and W. Tinney, “Optimal power flow solutions,” IEEE [50] L. Xie, Y. Mo, and B. Sinopoli, “False data injection attacks in
TransactionsonPowerApparatusandSystems,1968. electricitymarkets,”inSmartGridCommunications(SmartGridComm),
[20] K.T.Erickson,“Programmablelogiccontrollers.” InstituteofElectrical 2010FirstIEEEInternationalConferenceon. IEEE,2010.
andElectronicsEngineers,1996. [51] D. Yang, A. Usynin, and J. W. Hines, “Anomaly-based intrusion
[21] S.Etigowni,D.Tian,G.Hernandez,K.Butler,andS.Zonouz,“Cpac: detectionforscadasystems,”2006.
Mitigating attacks against critical infrastructure with cyber-physical [52] B.ZhuandS.Sastry,“SCADA-specificintrusiondetection/prevention
accesscontrol,”inAnnualComputerSecurityApplicationsConference systems:Asurveyandtaxonomy,”inProceedingsoftheFirstWorkshop
(ACSAC),2016. onSecureControlSystems,2010.
[22] EuropeanNetworkandInformationSecurityAgency(ENISA).(2011) [53] S. Zonouz, C. M. Davis, K. R. Davis, R. Berthier, R. B. Bobba, and
Protectingindustrialcontrolsystems–recommendationsforEuropeand W. H. Sanders, “SOCCA: A security-oriented cyber-physical contin-
MemberStates.https://www.enisa.europa.eu/. gencyanalysisinpowerinfrastructures,”SmartGrid,IEEETransactions
on,2014.
[23] F-SecureLabs,“BLACKENERGYandQUEDAGH:Theconvergence
ofcrimewareandAPTattacks,”2016. [54] S.Zonouz,K.M.Rogers,R.Berthier,R.B.Bobba,W.H.Sanders,and
T.J.Overbye,“Scpse:Security-orientedcyber-physicalstateestimation
[24] N. Falliere, L. O. Murchu, and E. Chien, “W32.Stuxnet Dossier,”
SymanticSecurityResponse,Tech.Rep.,2010. for power grid critical infrastructures,” IEEE Transactions on Smart
Grid,2012.
[25] J.FitzPatrickandM.King,“Nsaplayset:Jtagimplants,”2015.
[55] S.Zonouz,J.Rrushi,andS.McLaughlin,“Detectingindustrialcontrol
[26] D.Formby,P.Srinivasan,A.Leonard,J.Rogers,andR.Beyah,“Who’s malwareusingautomatedplccodeanalytics,”Security&Privacy,IEEE,
in control of your control system? device fingerprinting for cyber- 2014.
physical systems.” in Proceedings of the Network and Distributed
SystemSecurity(NDSS)Symposium,2016.
[27] A.FrancillonandC.Castelluccia,“Codeinjectionattacksonharvard-
architecture devices,” in Proceedings of the 15th ACM Conference on
ComputerandCommunicationsSecurity,ser.CCS’08,2008.
[28] A. Go´mez-Expo´sito, A. J. Conejo, and C. Can˜izares, Electric energy
systems:analysisandoperation. CRCPress,2016.
15