Cracking Android
5
Pattern Lock in
Attempts!
Guixin Ye
Northwest University (China), Lancaster University (UK), Bath University (UK)Attacking Scenario !
!
• Alice and Bob go to a party (or library
etc.)!
• Alice leaves her phone unattended for a
few minutes, thinking this is okay as she
uses PATTERN LOCK protection!
!
Can Bob quickly install
malware on Alice’s phone?!
2How can Bob bypass pattern
lock?!
60
30
0
-30
-60
-60 -30 0 30 60
Bob only need to observe the fingertip movement!!
3Evil Bob films how Alice draws the pattern from a
distance of 2-3 meters. No need to see the
screen content. !Tracking !
Bob marks two areas of interest, and runs a
vision algorithm to track the fingertip movement. !
5Tracking Example!
60
30
0
-30
-60
-60 -30 0 30 60
The pattern
Tracking algorithm Bob wants this!
60
30
0
-30
-60
-60 -30 0 30 60
6
Resulted fingertip movement trajectoryView Transformation !
60 60
S = TS
30 30
1
0
0
-30
-30
⎛cosθ -sinθ⎞
-60
T = -60
⎜ ⎟
-60 -30 0 30 60
sinθ cosθ
-60 -30 0 30 60
⎝ ⎠
Camera’s perspective
User’s perspective
7Trajectory to Candidate Patterns !
60
30
0
-30
-60
-60 -30 0 30 60
Fingertip Trajectory Candidate Patterns
8A large number of possibilities!
60
30
0
……
-30
-60
-60 -30 0 30 60
Fingertip Trajectory Possible Patterns (>100)
9Use Geometric information!
Pattern Line Line
Lock Length Direction
10Example: Identify Candidate
Patterns !
Length &
Direction
Length &
Rejected patterns
Length
Direction
Candidate patterns
11Test on Alice’s Phone !
Correct pattern
12Another Example !
80
40
0
-40
-80
-80 -40 0 40 80
Pattern Complex
Trajectory Pattern
13Evaluation Setup!
120 patterns from 215 users!
plus!
some of the most complex patterns!
Other pattern grids!
Xiaomi MI4, Meizu2, Huawei Honor7,
Samsung Note4!
14Example Patterns!
!
!
!
!
Simple Medium Complex!
15100%
80%
60%
40%
20%
0%
Simple Median Complex
The complexity of pattern locks
etar
sseccus
gnikcarC
Complex patterns are less secure!
1 attempt
2 attempts
3 attempts
4 attempts
5 attempts
Over 95% of the patterns can be cracked in 5
attempts
1640
30
20
10
0
1 2 3 4 5
Number of candidate patterns
snrettap
fo
rebmuN
Up to 5 candidate patterns generated!
Simple
Median
Complex
Candidate Pattern
For most median and all complex patterns, our
system produces just ONE candidate pattern.
17Threat distance reaches 2.5m!
100%
80%
60%
40%
20%
0%
1 1.5 2 2.5 3 3.5
Distance(Meter)
Over 80% of the patterns can be cracked within a
distance of 2.5 meters away from the target device.
18
etar
sseccus
gnikcarC 1 attempt
2 attempts
3 attempts
4 attempts
5 attempts100%
90%
80%
70%
60%
Simple Median Complex
etar
sseccus
gnikcarC
More dots helps, but only
for simple patterns!
4×4 5×5 6×6
19Conclusions!
Pattern lock is vulnerable under
video based attacks!
!
Complex patterns could be less
secure!
!
Data available at:!
https://dx.doi.org/10.17635/lancaster/researchdata/113!
20Back Up!
Related work
Camera Shake
How to identify candidate pattern
How to define the complexity of pattern lock
Video recording devices
21Existing Researches on Pattern Lock
Smudge Attack Wireless-based Attack
22Video-based Attacks on PIN- or text-based
passwords
Text-based: Directly facing the keyboard or the screen
PIN-based: The dynamics of hand during typing
23Pattern Lock v.s. PIN- or text-based
password
How to map the fingertip movements
to a graphical structure?
Existing attacks methods cannot be
usCeodnti ntuoou sc proaintcs k pDaistctreeter kney sltorockeks
How to identify two overlapping lines?
How can the algorithm adapt to the
different size of pattern grid
Overlapping lines Different size of pattern grid
24Camera Shake Effect!
100
50
0
-50
-100
-100 -50 0 50 100
Unique pattern Tracking process Expected trajectory
100
50
0
-50
-100
-100 -50 0 50 100
25
Actual trajectoryCamera Shake Calibration!
Fixed point
Fixed point Fixed point
100
50
0
-50
-100
-100 -50 0 50 100
Correct pattern
w/ camera !
shake calibration
26Solution: Identify Candidate
Patterns!
CP ={L; D}
(l , l , l ; d , d , d )
1 2 3 l l l
1 2 3
Fingertip Trajectory Geometric Features
l L is the collection of the relative line segments.!
l D is collection of the directions corresponding to the
line segment.!
27Example: Extracting Geometric Features!
Length Feature Direction Feature
S
T
-650 1
-700
-750
-800
-850
-900
E
T-950
120 140 160 180 200 220 240 260
2
L : (l , l , l )
ST T T T E
1 1 2 2
All line directions
D : (5,11, 5)
28Pattern Collection and Category!
​𝐶​𝑆↓𝑃 =​𝑆↓𝑃 ×​log↓2 (​𝐿↓𝑃 +​𝐼↓𝑃 +​𝑂↓𝑃 )
ü ​𝑆 ↓ 𝑃 i s the number of connected dots!
ü
​𝐿 ↓ 𝑃
i s the total length of all line segments that form the pattern !
ü ​𝐼 ↓ 𝑃 are the number of intersections!
ü ​𝑂 ↓ 𝑃 are the number of overlapping linear segments
ü Simple pattern（40）: !
​​𝑆↓𝑃 ∈[6.34,19)
ü Median Pattern（40）: !
​​𝑆↓𝑃 ∈[19,33)
ü Complex pattern（40）:
​​𝑆↓𝑃 ∈[33,46.8)
29Video Recording!
l User Participation!
10 postgraduate: 5 male and 5 female students
l Test Phones!
Brands
Xiaomi Huawei Samsung
Size !
MI4 Honor7 Note4
Height(cm)×Height(cm) 13.9×6.9 14.3×7.2 15.4×7.9
l Record Device!
Apple iPhone4S, Xiaomi MI4 and Meizu2!
30