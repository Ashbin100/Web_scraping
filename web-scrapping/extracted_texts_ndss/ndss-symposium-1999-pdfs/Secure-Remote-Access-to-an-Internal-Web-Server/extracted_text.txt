S e c u r e R e m o t e A c c e s s t
C h r i s t i a n G i l m o r e D a v i d
A T & T L a b s { R e s e a r c h
f c g i l m o r e , d a v e k , r u b
A b s t r a c t
W e a d d r e s s t h e p r o b le m o f s e c u r e r e m o t e a c c e s s t o
a s i t e ’ s i n t e r n a l w e b s e r v e r f r o m o u t s i d e t h e (cid:12) r e w a l l.
T h e g o a l i s t o g i v e a u t h o r i z e d u s e r s a c c e s s t o s e n -
s i t i v e i n f o r m a t i o n , w h i le p r o t e c t i n g t h e i n f o r m a t i o n
f r o m o t h e r s . W e i m p le m e n t e d o u r s o lu t i o n u s i n g a
o n e - t i m e p a s s w o r d s c h e m e f o r c li e n t a u t h e n t i c a t i o n
a n d S S L f o r c o n (cid:12) d e n t i a li t y . O u r m a i n d e s i g n c o n -
s i d e r a t i o n s w e r e s e c u r i t y , p e r f o r m a n c e , e a s e o f u s e ,
a v a i la b i li t y , a n d s c a le . W e w e r e f u r t h e r c o n s t r a i n e d
b y t h e d e s i r e t o le a v e o u r (cid:12) r e w a l l a n d lo c a l i n f r a s t r u c -
t u r e u n c h a n g e d .
1 I n t r o d u c t i o n
M o s t la r g e o r g a n iz a t io n s t o d a y h a v e t o r e s o r t t o
u s in g (cid:12) r e w a lls t o p r o t e c t t h e m s e lv e s f r o m w o u ld - b e
h o s t ile a t t a c k e r s o n t h e I n t e r n e t . W h ile (cid:12) r e w a lls a r e
a n in c o n v e n ie n c e , w h e n w e ll a d m in is t e r e d , t h e y d o a
r e a s o n a b le j o b o f is o la t in g a n o r g a n iz a t io n f r o m t h e
r e s t o f t h e w o r ld . T h e s e c u r it y p o lic y u s u a lly a m o u n t s
t o t o t a l t r u s t o f a ll in s id e r s a n d t o t a l m is t r u s t o f o u t -
s id e r s , w h e r e t h e (cid:12) r e w a ll d e (cid:12) n e s t h e b o u n d a r y [2 ].
A s a r e s u lt o f c la s s if y in g u s e r s a s in s id e r s o r o u t -
s id e r s , c o m p a n ie s c a n h a v e d i(cid:11) e r e n t in t e r n a l a n d e x -
t e r n a l w e b v ie w s . P e o p le in s id e t h e (cid:12) r e w a ll h a v e a c -
c e s s t o t h e in t e r n a l s it e , w h ic h c o n t a in s s e n s it iv e d a t a
s u c h a s c o m p a n y s t r a t e g y , b u s in e s s p la n s , e t c . I n a d -
d it io n , t h e y c a n u p d a t e p e r s o n a l in f o r m a t io n s u c h a s
t h e p a y r o ll d a t a a n d b e n e (cid:12) t a llo c a t io n s . T h e la t t e r
is o f t e n p r o t e c t e d b y s im p le p a s s w o r d s o n t o p o f S S L
c o n n e c t io n s [5 ].
T h e e x t e r n a l v ie w o f a w e b s it e is u s u a lly c o m m e r -
c ia l a n d g e a r e d t o w a r d s c u s t o m e r s . C o m p a n ie s o f t e n
u s e t h e ir e x t e r n a l w e b s it e t o d is p la y p r o d u c t in f o r -
m a t io n , d e t a ils f o r in v e s t o r s , a n d o t h e r m a r k e t in g m a -
t e r ia l. M o r e s o p h is t ic a t e d o r g a n iz a t io n s u s e t h e ir e x -
t e r n a l w e b s it e f o r c u s t o m e r t r a n s a c t io n s , b illin g , a n d
c u s t o m e r s e r v ic e .
I t is c o m m o n p r a c t ic e f o r t h e s a m e f u lly q u a li(cid:12) e d
o
K
, F
i n
a n I n t e r n a l W e b S e r v e r
o r m a n n A v i e l D . R u b i n
l o r h a m P a r k , N J , U S A
g @ r e s e a r c h . a t t . c o m
d o m a in n a m e t o r e f e r t o t h e in t e r n a l s it e w h e n a u s e r
a c c e s s t h e w e b f r o m t h e in s id e , a n d t o t h e e x t e r n a l
s it e w h e n a n e x t e r n a l u s e r m a k e s a r e q u e s t . F o r e x -
w w w . r e s e a r c h . a t t . c o ma m p le , h e r e a t A T & T , is a n
a k a l i c e . r e s e a r c h . a t t . c o ma lia s t o , a w e b s e r v e r b e -
w w w . r e s e a r c h . a t t . c o mh in d t h e (cid:12) r e w a ll, a n d is a n
a k p u b l i c . r e s e a r c h . a t t . c o ma lia s f o r f o r u s e r s o u t -
s id e t h e (cid:12) r e w a ll. E m p lo y e e s c a n e v e n h a v e t w o v e r -
s io n s o f t h e ir h o m e p a g e , b o t h r e f e r e n c e d b y
h t t p : / / w w w . r e s e a r c h . a t t . c o m / i n f o / u s e r n a m e .
a k a l i c eT h e w e b p a g e o n m a y c o n t a in p r o p r ie t a r y
a k p u b l i cin f o r m a t io n , w h e r e a s t h e c o p y o n s h o u ld
n o t .
A p r o b le m a r is e s w h e n in s id e r s t r a v e l o u t s id e o f
t e l n e tt h e (cid:12) r e w a ll b o u n d a r y . M o s t s it e s a llo w u s e r s
f t pa n d a c c e s s t o t h e ir m a c h in e s f r o m t h e o u t s id e
s o t h a t t h e y c a n r e a d e - m a il a n d e d it (cid:12) le s . U s u -
a lly , t h e u s e r s a r e a u t h e n t ic a t e d t h r o u g h s o m e s t r o n g
o n e - t im e p a s s w o r d m e c h a n is m in h a r d w a r e o r s o f t -
w a r e [8 ]. W h ile u s e r s h a v e a le g it im a t e r ig h t t o a c -
c e s s t h e in t e r n a l w e b s e r v e r , it is n o t a c c e s s ib le t o
t h e m . T h e b e s t t h e y c a n d o is t e ln e t t o a n in -
t e r n a l m a c h in e a n d r u n a t e x t - b a s e d b r o w s e r , s u c h
h t t p : / / w w w . s l c c . e d u / l y n x /a s ly n x [ ]. W h ile t e x t -
b a s e d b r o w s e r s c a n b e q u it e u s e f u l, t h e y h a v e s e v e r e
d r a w b a c k s . T h e r e is n o s u p p o r t f o r m u lt im e d ia , e x e -
c u t a b le c o n t e n t , h e lp e r a p p lic a t io n s a n d o t h e r r e c e n t
f e a t u r e s o f b r o w s e r s . E v e n w o r s e , s in c e t e ln e t c o n n e c -
t io n s a r e u s u a lly u n e n c r y p t e d , t h e w e b c o n t e n t t r a v e ls
1
t o t h e r e m o t e s it e in t h e c le a r . F in a lly , p u b lic I n t e r -
n e t k io s k s ( e .g . a t t h e a ir p o r t ) m a y c o n t a in a c c e s s
t o H T M L b r o w s e r s b u t n o a c c e s s t o t e ln e t o r o t h e r
I n t e r n e t s e r v ic e s .
A b a d i e t . a l. p r e s e n t a s o lu t io n t h a t u s e s a w e b
t u n n e l o n t h e (cid:12) r e w a ll f o r a c c e s s f r o m o u t s id e t h e (cid:12) r e -
w a ll [1 ]. T h e ir s o lu t io n r e q u ir e s c h a n g e s t o t h e (cid:12) r e w a ll
a n d t h e u s e o f c lie n t - s id e J a v a s c r ip t in t h e b r o w s e r .
O u r g o a l is t o a llo w a c c e s s w it h o u t a n y m o d i(cid:12) c a t io n
t o t h e in t e r n a l in f r a s t u c t u r e , a n d in p a r t ic u la r w it h -
1 I t is lik e ly t h a t S S H [1 9 ], S S L t e ln e t , a n d I P S E C w h ic h
s o lv e t h is p r o b le m , w ill g a in in p o p u la r it y .o u t c h a n g in g t h e (cid:12) r e w a ll o r t h e e n d w e b s e r v e r . W e
a c h ie v e t h is w it h o u t r e q u ir in g J a v a s c r ip t .
W e la y e r a s t r o n g c lie n t a u t h e n t ic a t io n m e c h a n is m
o n t o p o f S S L t o a llo w le g it im a t e u s e r s a c c e s s t o a n
in t e r n a l w e b s it e f r o m o u t s id e o f t h e (cid:12) r e w a ll. T h e
id e a is t o m a k e t h e s e s s io n a s t r a n s p a r e n t a s p o s s ib le
f o r t h e u s e r w it h o u t c o m p r o m is in g t h e s e c u r it y o f t h e
in f o r m a t io n . W e d o t h is w it h o u t a n y c h a n g e s t o o u r
(cid:12) r e w a ll o r in t e r n a l in f r a s t r u c t u r e . T h e s y s t e m a llo w s
u s e r s t o a c c e s s t h e in t e r n a l w e b f r o m o u t s id e t h e (cid:12) r e -
w a ll. T h is is u s e f u l f o r e m p lo y e e s w h o a r e o n t h e r o a d ,
o r w h o r e c e iv e t h e ir h o m e a c c e s s f r o m a t h ir d p a r t y
I n t e r n e t S e r v ic e P r o v id e r ( I S P ) .
2 C l i e n t a u t h e n t i c a t i o n
S t r o n g c lie n t a u t h e n t ic a t io n s c h e m e s e x is t f o r a p -
t e l n e t f t pp lic a t io n s s u c h a s a n d . M o s t n o t a b le
a r e c h a lle n g e / r e s p o n s e h a r d w a r e t o k e n s a n d o n e - t im e
p a s s w o r d s c h e m e s b a s e d o n h a s h c h a in in g [8 , 9 ] o r
p s e u d o r a n d o m f u n c t io n s [1 7 ].
C lie n t a u t h e n t ic a t io n f o r t h e w e b e x is t s in t h e f o r m
o f c lie n t c e r t i(cid:12) c a t e s is s u e d b y o r g a n iz a t io n s s u c h a s
V e r is ig n a n d T h a w t e . H o w e v e r , t h e id e n t it y v e r i(cid:12) c a -
t io n m e c h a n is m s o f t h e s e o r g a n iz a t io n s a r e o f t e n in -
a d e q u a t e [1 8 ] a n d t h u s , t h e s e m e c h a n is m s a r e n o t in
w id e s p r e a d u s e . W e im p le m e n t e d o u r s c h e m e u s in g
h a s h c h a in in g [1 1 ] ( s e e S e c t io n 5 .1 ) .
3 O u r e n v i r o n m e n t
F o llo w in g s t a n d a r d p r a c t ic e , o u r (cid:12) r e w a ll p o lic y a l-
lo w s h o s t s b e h in d t h e (cid:12) r e w a ll t o e s t a b lis h T C P c o n -
n e c t io n s t o h o s t s o u t s id e t h e (cid:12) r e w a ll o n a n y p o r t ,
w h ile in b o u n d c o n n e c t io n s a r e t ig h t ly r e s t r ic t e d . T h u s
a n y m e c h a n is m t h a t g iv e s a c c e s s t o u s e r s o n t h e o u t -
s id e m u s t in v o lv e e it h e r o p e n in g a n in b o u n d p o r t o n
t h e (cid:12) r e w a ll o r in it ia t in g a c o n n e c t io n f r o m t h e in s id e .
O u r in t e n t is t o la y e r o u r s o lu t io n o n t o p o f a n e x is t in g
in f r a s t r u c t u r e , s o w e o p t f o r t h e la t t e r .
A n o t h e r f e a t u r e o f o u r (cid:12) r e w a ll is t h a t it t e a r s d o w n
in a c t iv e c o n n e c t io n s e v e r y 1 5 m in u t e s . W e in it ia t e o u r
s e r v ic e f r o m b e h in d t h e (cid:12) r e w a ll, s o w e h a v e t o m a k e
s u r e t h a t t h e r e is a lw a y s a w a y f o r e x t e r n a l c lie n t s t o
c o n t a c t t h e in t e r n a l w e b s e r v e r w h e n d e s p it e t h e f a c t
t h a t id le c o n n e c t io n s a r e t o r n d o w n b y t h e (cid:12) r e w a ll.
W e a s s u m e t h a t u s e r s r e q u ir e o c c a s io n a l a c c e s s
f r o m u n t r u s t e d s it e s s u c h a s I n t e r n e t c a f e s o r t e r m i-
n a l r o o m s a t c o n f e r e n c e s . O u r o n ly r e q u ir e m e n t is
t h a t t h e w e b c lie n t b e S S L e n a b le d . W e b u ild u s e r
a u t h e n t ic a t io n in t o o u r p r o t o c o l. W e r e f e r t o t h e w e b
2
c lie n t a s a D u m b W e b T e r m in a l ( D W T ) . W e s t r iv e
t o t r e a t t h e D W T a s \ u n t r u s t e d " t o t h e e x t e n t p o s -
s ib le ; n o n e t h e le s s , t h e a d m in is t r a t o r o f t h e D W T h a s
c o m p le t e c o n t r o l o f a ll d a t a c o m in g in a n d o u t o f t h e
m a c h in e . S o , in o u r m o d e l, w e m u s t a s s u m e t h a t a n y
in t e r n a l w e b c o n t e n t v ie w e d o n a D W T c o u ld b e s e -
c r e t ly r e c o r d e d a n d c o p ie d b y t h e s it e a d m in is t r a t o r .
W h a t w e d o n o t a llo w , h o w e v e r , is f o r t h e a d m in is -
t r a t o r t o b e a b le t o a c c e s s o t h e r s e n s it iv e c o n t e n t b y
v ir t u e o f o b s e r v in g s o m e t h in g .
I t is p o s s ib le t h a t V ir t u a l P r iv a t e N e t w o r k ( V P N )
t e c h n o lo g y c o u ld b e u s e d t o a llo w a c c e s s t o t h e in -
t e r n a l w e b , b u t w e h a v e n o t a d o p t e d a n y o f t h e s e
p r o d u c t s a t o u r s it e . F u r t h e r m o r e , w e b e lie v e t h a t
m a n y in s t it u t io n s w o u ld p r e f e r t o u s e a lig h t w e ig h t ,
f r e e s o lu t io n s u c h a s o u r s , r a t h e r t h a n t o in v e s t in
V P N p r o d u c t s j u s t f o r in t e r n a l w e b a c c e s s .
4 A r c h i t e c t u r e
O u r a r c h it e c t u r e is d ia g r a m e d in F ig u r e 1 . T h e
m a in c o m p o n e n t o f o u r s y s t e m is t h e p r o x y . O f n e -
c e s s it y , t h e r e is o n e s u b c o m p o n e n t in s id e t h e (cid:12) r e w a ll
a n d o n e o n t h e o u t s id e . A u s e r o n a D W T c o n n e c t s
t o t h e p r o x y t h r o u g h t h e I n t e r n e t w it h a n a u t h e n -
t ic a t io n r e q u e s t , u s in g a s p e c ia l U R L t h a t c o n t a in s
h is / h e r u s e r n a m e . N e x t , t h e p r o x y c o n t a c t s t h e a u -
t h e n t ic a t io n s e r v e r t o v e r if y t h a t t h e r e q u e s t is f r o m
a v a lid u s e r . O n c e a u t h e n t ic a t io n c o m p le t e s , r e q u e s t s
f r o m t h e u s e r a r e f o r w a r d e d t o t h e in t e r n a l w e b s e r v e r ,
w h ic h r e s p o n d s a s u s u a l. N o m o d i(cid:12) c a t io n is r e q u ir e d
t o t h e D W T , t h e (cid:12) r e w a ll o r t h e in t e r n a l w e b s e r v e r .
F ig u r e 2 s h o w s t h e p r o x y in m o r e d e t a il. T h e
p u s h w e bin t e r n a l m a c h in e , w h ic h w e c a ll , m a in t a in s
a c o n t r o l c o n n e c t io n t o t h e e x t e r n a l m a c h in e c a lle d
a b s e n t . T h is is n e c e s s a r y b e c a u s e o u r (cid:12) r e w a ll d o e s
a b s e n t p u s h w e bn o t a llo w c o n n e c t io n s f r o m t o . U s e r s
a b s e n ta t a D W T r e q u e s t a c o n n e c t io n t o b y t y p -
a b s e n t . r e s e a r c h . a t t . c o min g in a U R L w it h a s t h e
a b s e n th o s t n a m e . W h e n r e c e iv e s a c o n n e c t io n f r o m
t h e b r o w s e r , it r e c o r d s s o m e in f o r m a t io n a b o u t t h e
c o n n e c t io n a n d s e n d s a r e q u e s t a lo n g t h e c o n t r o l c o n -
n e c t io n . P u s h w e b t h e n o p e n s a d a t a c o n n e c t io n t o
a b s e n t . A b s e n t u s e s t h e d a t a c o n n e c t io n t o f o r w a r d
p u s h w e br e q u e s t s t o , w h ic h f o r w a r d s t h e m t o t h e w e b
s e r v e r . T h e w e b s e r v e r p r o c e s s e s t h e r e q u e s t a n d r e -
p u s h w e bt u r n s a n H T T P r e p ly t o . T h e r e p ly is f o r -
a b s e n tw a r d e d t o , w h ic h s e n d s it b a c k t o t h e D W T ,
w h e r e it is d is p la y e d f o r t h e u s e r .
W e b p a g e s r e c e iv e d f r o m t h e w e b s e r v e r m a y c o n -
t a in lin k s t o o t h e r p a g e s b e h in d t h e (cid:12) r e w a ll. I f t h e
lin k s a r e n o t c h a n g e d , t h e n f u t u r e r e q u e s t s w ill n o tAuth
proxy
server
Internet
DWT
Web
server
Firewall
F
(cid:12)
ig
r e
u
w
r
a
e
ll
1 :
a n
A
d
r
o
c
n
h
e
i t
o
e
n
c t
t h
u
e
r e
o
:
u t
T
s
h
id
e
e .
m a in c o m p o n e n t s o f t h e s y s t e m . T h e p r o x y h a s o n e s u b c o m p o n e n t b e h in d t h e
Web
server DWT
pushweb absent
llaweriF
control connection
web request
web request
web reply
web reply
data connections
PROXY
T h e p r o x y :F ig u r e 2 : T h e p r o x y c o n s is t s o f a n in t e r n a l a
p u s h w e b a b s e n tc a ll , o n t h e in s id e , a n d a m a c h in e c a lle d
a b s e n t a b s e. W h e n a w e b r e q u e s t s c o m e s f r o m a D W T ,
o p e n a d a t a c o n n e c t io n , w h ic h is u s e d f o r t h e a c t u a l c o m m
b e a b le t o a c c e s s in t e r n a l p a g e s . F o r e x a m p le , a lin k
m a y b e o f t h e f o r m :
< a h r e f = " h t t p : / / m y h o s t . r e s e a r c h . a t t . c o m /
p r o p r i e t a r y . h t m l " > B u s i n e s s p l a n < / a > .
W h e n t h e u s e r c lic k s o n \ B u s in e s s p la n " , t h e D W T
m y h o s ta t t e m p t s t o c o n n e c t d ir e c t ly t o t h e m a c h in e ,
a n d , o f c o u r s e , t h e (cid:12) r e w a ll d o e s n o t a llo w t h is . T o
p u s h w e bs o lv e t h is , d o e s s o m e p r o c e s s in g o n w e b
a b s e n tp a g e s b e f o r e s e n d in g t h e m t o . F ir s t , a ll r e la -
t iv e U R L s a r e t r a n s la t e d t o a b s o lu t e U R L s w it h h o s t
n a m e s a n d d ir e c t o r ie s . U R L s t h a t a r e o u t s id e o f t h e
t r u s t e d d o m a in a r e n o t c h a n g e d f u r t h e r . H o w e v e r ,
U R L s t h a t a r e b e h in d t h e (cid:12) r e w a ll a r e p r e p e n d e d w it h
s o m e s e c u r it y in f o r m a t io n ( s e e S e c t io n 5 .4 ) . T h e n ,
a b s e n tn e w U R L s a r e c o n s t r u c t e d t h a t p o in t t o a n d
in c lu d e t h e o r ig in a l U R L . F o r e x a m p le , t h e U R L
h t t p :/ / w w w .r e s e a r c h .a t t .c o m / p r o je c t s /
is r e w r it t e n a s
h t t p s :/ / a b s e n t .r e s e a r c h .a t t .c o m / g e t u r l= u s e r /
2 b 5 d b 8 6 c 1 f6 e / h t t p :/ / w w w .r e s e a r c h .a t t .c o m / p r o je c t s /
I n g e n e r a l, r e w r it t e n U R L s c o n t a in t h e f o llo w in g in -
f o r m a t io n :
3
n d a n e x t e r n a l c o m p o n e n t . W e u s e a m a c h in e t h a t w e
o n t h e o u t s id e . P u s h e b o p e n s a c o n t r o l c o n n e c t io n t o
n t p u s h w e bu s e s t h e c o n t r o l c o n n e c t io n t o in s t r u c t t o
u n ic a t io n .
(cid:15) h t t p s : / / a b s e n t . r e s e a r c h . a t t . c o m / E v -
e r y r e w r it t e n U R L s t a r t s w it h t h is s t r in g . I t
a b s e n tp o in t s t h e D W T t o o n p o r t 4 4 3 .
(cid:15) c m d = u s e r \ c m d " c a n b e lo g in , g e t u r l, lo g o u t , o r
r e s p a n d in d ic a t e s t h e a c t io n t o b e t a k e nO T P
p u s h w e bb y w it h t h e r e q u e s t . \ u s e r " c o n t a in s
t h e n a m e o f t h e u s e r . T h is is h is / h e r lo g in a c -
c o u n t I D .
(cid:15) h e x d a t a T h is is e x p la in e d in S e c t io n 5 .4 .
(cid:15) o r i g i n a l - u r l T h is is t h e o r ig in a l U R L t h a t w a s
c o n t a in e d in t h e p a g e , c o n v e r t e d t o a n a b s o lu t e
U R L if n e c e s s a r y .
R e c a ll t h a t o n e o f o u r g o a ls is t o m a k e t h e b r o w s -
in g e x p e r ie n c e t h e s a m e a s w h e n u s e r s a r e b e h in d t h e
(cid:12) r e w a ll. R e w r it in g U R L s a c h ie v e s t h is . P a g e s a p -
p e a r t h e s a m e t o u s e r s , b u t w h e n lin k s a r e c lic k e d o n ,
a b s e n tt h e p a g e s a r e r e q u e s t e d t h r o u g h . T h e o n ly
d i(cid:11) e r e n c e s u s e r s m ig h t n o t ic e a r e t h e a p p e a r a n c e s o f
c o d i(cid:12) e d U R L s in t h e m e s s a g e w in d o w o f t h e b r o w s e r
w h e n t h e m o u s e p a s s e s o v e r lin k s , a n d t h e U R L t h a t
is d is p la y e d in t h e lo c a t io n w in d o w .
a b s e n tI n o u r s y s t e m , f o r w a r d s a ll r e q u e s t s t o
p u s h w e b . P u s h w e b in t u r n , r e m o v e s t h e s u b s t r in gh t t p s : / / a b s e n t . r e s e a r c h . a t t . c o m / a n d p r o c e s s e s
t h e r e m a in d e r o f t h e r e q u e s t b a s e d o n t h e v a lu e s o f
c m d u s e ra n d .
5 A u t h e n t i c a t i o n a n d s e c u r i t y
S e c u r it y is p a r a m o u n t w h e n w e c o n s id e r e x p o r t -
in g p r iv a t e a n d c o n (cid:12) d e n t ia l in f o r m a t io n o u t s id e o f t h e
(cid:12) r e w a ll. W e m u s t a s s u r e t h a t o n ly v a lid u s e r s c a n a c -
c e s s t h e in t e r n a l w e b , w h ile a c t iv e a t t a c k e r s o n t h e
I n t e r n e t c a n n o t . I n t h is s e c t io n , w e d e s c r ib e o u r t e c h -
n iq u e s f o r a u t h e n t ic a t in g c lie n t s a n d m a in t a in in g t h e
p r iv a c y o f t h e in f o r m a t io n f r o m ille g it im a t e o u t s id e r s .
5 . 1 H a s h c h a i n i n g
T h e o r ig in a l id e a f o r h a s h c h a in in g is d u e t o L a m -
p o r t [1 1 ]. T h e r e a r e t w o p h a s e s t o a u t h e n t ic a t io n
u s in g h a s h c h a in in g . I n t h e i n i t i a li z a t i o n p h a s e , a
p w nu s e r p ic k s a s t r o n g p a s s w o r d , a n d a n u m b e r , ,
a n d u s in g a w e ll- k n o w n c r y p t o g r a p h ic a lly s t r o n g o n e -
n f y f p ww a y h a s h f u n c t io n , , c o m p u t e s = ( ) . T h is
n fa m o u n t s t o a p p lic a t io n s o f t o t h e p a s s w o r d . T h e
yv a lu e is s t o r e d o n a n a u t h e n t ic a t io n s e r v e r .
0
yI n t h e a u t h e n t i c a t i o n p h a s e , t h e u s e r s e n d s =
i
f p w i n (cid:0)( ) , w h e r e is in it ia lly 1 , t o t h e a u t h e n t ic a - 0
y f yt io n s e r v e r . T h e s e r v e r c h e c k s t o s e e if = ( ) . I f
s o , a u t h e n t ic a t io n is s u c c e s s f u l, o t h e r w is e it f a ils . I f
ys u c c e s s f u l, t h e a u t h e n t ic a t io n s e r v e r r e p la c e s w it h
0
y i, t h e u s e r d e c r e m e n t s b y 1 , a n d t h e p r o c e s s c o n -
t in u e s .
T h e s e c u r it y o f t h e s y s t e m lie s in t h e f a c t t h a t a n
e a v e s d r o p p e r o n t h e n e t w o r k c a n n o t c o m p u t e a n y o n e -
t im e p a s s w o r d s f r o m p r e v io u s ly u s e d p a s s w o r d s . T h e
fu s e o f a c r y p t o g r a p h ic a lly s t r o n g h a s h f u n c t io n f o r
e n s u r e s t h a t .
T h e r e is a n I n t e r n e t R F C [7 ] t h a t d e s c r ib e s a s t a n -
d a r d o n e - t im e p a s s w o r d s c h e m e t h a t u s e s h a s h c h a in s
f o r a u t h e n t ic a t io n . T h e S / K E Y a n d O P I E o n e - t im e
p a s s w o r d s y s t e m s a r e f r e e ly a v a ila b le , w id e ly u s e d im -
p le m e n t a t io n s o f t h is s t a n d a r d .
5 . 2 U s e r a u t h e n t i c a t i o n
W e u s e O P I E f o r a u t h e n t ic a t io n . T o u s e A b s e n t ,
u s e r s m u s t h a v e a n e n t r y in t h e O P I E k e y s d a t a b a s e .
a b s e n t i n i tT o d o t h is , t h e y r u n t h e p r o g r a m w h ic h
o p i e i n i tis a s u b s e t o f t h e f u n c t io n a lit y o f . T h e
nu s e r s s p e c if y t h e n u m b e r o f o n e - t im e p a s s w o r d s ,
p wa n d a s e c r e t p a s s p h r a s e , . M D 5 [1 6 ] is u s e d a s t h e
f s e t u i do n e - w a y h a s h f u n c t io n , . T h e p r o g r a m r u n s
n
n ; f p wt o t h e d a t a b a s e a d m in is t r a t o r a n d w r it e s ( )
4
in t o t h e O P I E d a t a b a s e , a lo n g w it h s o m e o t h e r in -
f o r m a t io n a b o u t t h e u s e r s . A t t h is p o in t , u s e r s a r e
in it ia liz e d t o u s e A b s e n t .
A n in it ia liz e d u s e r c a n u s e a n y d u m b w e b t e r m i-
n a l ( D W T ) , a u t h e n t ic a t e , a n d a c c e s s t h e in t e r n a l w e b .
T h e (cid:12) r s t t h in g a u s e r d o e s is is s u e a lo g in r e q u e s t b y
t y p in g in a s p e c ia l U R L .
h t t p s :/ / a b s e n t .r e s e a r c h .a t t .c o m / lo g in = u s e r
a b s e n tT h e m e c h a n ic s o f t h e c o m m u n ic a t io n b e t w e e n
p u s h w e ba n d a r e d is c u s s e d in S e c t io n 6 . F o r t h e p u r -
p o s e s o f t h is s e c t io n , w e a s s u m e a d a t a c o n n e c t io n b e -
a b s e n t p u s h w e b a b s e n tt w e e n a n d e x is t s . f o r w a r d s
p u s h w e bt h e r e q u e s t t o , w h ic h im m e d ia t e ly n e g o t ia t e s
a n S S L c o n n e c t io n w it h t h e D W T ( s e e n e x t s e c t io n ) ,
a b s e n tw h ile b lin d ly f o r w a r d s d a t a p a c k e t s b e t w e e n
2
a b s e n tt h e m . A t t h is p o in t , a c t s a s a w ir e .
p u s h w e bO n c e t h e S S L c o n n e c t io n is e s t a b lis h e d ,
lo o k s u p t h e u s e r in t h e O P I E d a t a b a s e . I f t h e u s e r is
p u s h w e br e g is t e r e d , s u b m it s a r e q u e s t t o t h e a u t h e n -
t ic a t io n s e r v e r w h ic h g e n e r a t e s a n O P I E c h a lle n g e .
P u s h w e b t h e n c o n s t r u c t s a n H T M L p a g e w it h a f o r m
f o r t h e u s e r t o e n t e r t h e O P I E r e s p o n s e a n d s e n d s t h e
p a g e o v e r t h e S S L c o n n e c t io n t o t h e D W T . A n O P I E
c h a lle n g e is o f t h e f o r m
o t p - m d 5 3 8 6 b u 5 4 1 4 e x t
w h e r e o t p - m d 5 in d ic a t e s t h a t M D 5 is t h e h a s h f u n c -
t io n , 3 8 6 is t h e n u m b e r o f t im e s t o it e r a t e t h e f u n c -
t io n , a n d b u 5 4 1 4 is t h e s e e d f o r t h e g e n e r a t o r . F ig -
u r e 3 s h o w s t h e O P I E c h a lle n g e p a g e . T h e u s e r e n -
t e r s t h e r e s p o n s e in t o t h e f o r m a n d c lic k s t h e s u b m it
b u t t o n . A lis t o f o n e - t im e p a s s w o r d s c a n b e p r in t e d
o n p a p e r in a d v a n c e o r c o m p u t e d u s in g a c a lc u la t o r .
T o c o m p u t e a r e s p o n s e , t h e u s e r e n t e r s t h e s e e d , t h e
n u m b e r o f t im e s t o it e r a t e a n d t h e s e c r e t p a s s p h r a s e
in t o a n O P I E c a lc u la t o r . O n e o f t h e r e a s o n s w e c h o s e
O P I E is t h a t c a lc u la t o r s a r e b e c o m in g w id e s p r e a d .
W e u s e a p u b lic d o m a in a p p lic a t io n o n o u r P a lm P i-
h t t p : / / w w w . l i n e t . i t / p i l o t / a / p i l o t o t p . z i plo t [ ]
t o a u t h e n t ic a t e .
A f t e r t h e u s e r s u b m it s t h e o n e - t im e p a s s w o r d , it
p u s h w e bp a s s e s o v e r t h e S S L c o n n e c t io n t o , w h ic h
s e n d s t h e r e s p o n s e t o t h e a u t h e n t ic a t io n s e r v e r . I f
t h e a u t h e n t ic a t io n s u c c e e d s , t h e n a n e n t r y is c r e a t e d
in a u s e r t a b le , a n d t h e p a g e r e q u e s t e d in t h e c h a l-
le n g e f o r m is r e t u r n e d t o t h e u s e r . O n e o f t h e (cid:12) e ld s
2
T h is is s im ila r t o S S L t u n n e lin g . W e s im p ly fo r w a r d p a c k -
e t s a n d d o n o t u s e N e t s c a p e ’s t u n n e lin g p r o t o c o l ( I n t e r n e t d r a ft
b y L u o t o n e n , 1 9 9 7 ) b e c a u s e t h a t r e la t e s t o p r o x y in g S S L fr o m
a b r o w s e r u s in g t h e C O N N E C T c o m m a n d , a n d w e a r e a s s u m -
in g t h a t t h e u s e r m a y n o t h a v e a c c e s s t o t h e p r o x y s e t t in g s in
t h e b r o w s e r .O p i e c h a l l e n g e p a g e :F ig u r e 3 : T h e u s e r r e c e iv
in t h e u s e r t a b le e n t r y is a n e x p ir a t io n t im e . I n o u r
s y s t e m a n a u t h e n t ic a t io n is v a lid f o r 2 0 m in u t e s . A f -
t e r t h a t , t h e u s e r is p r e s e n t e d w it h a n o t h e r c h a lle n g e
p a g e .
I t is im p o r t a n t t h a t t h e o n e - t im e p a s s w o r d c h a l-
le n g e a n d r e s p o n s e o c c u r o v e r a n e s t a b lis h e d S S L c o n -
n e c t io n . O n e - t im e p a s s w o r d s y s t e m s s u c h a s O P I E
a n d S / K E Y h a v e b e e n s h o w n t o b e v u ln e r a b le t o a c -
t iv e a t t a c k s [1 7 ]. T h e c o n (cid:12) d e n t ia lit y a n d r e p la y p r e -
v e n t io n p r o p e r t ie s o f S S L e n s u r e t h a t a p la y - in - t h e -
m id d le a t t a c k ( e .g . w h e r e t h e r e s p o n s e f r o m t h e u s e r
is b lo c k e d a n d t h e n la t e r u s e d b y t h e in t r u d e r ) is n o t
p o s s ib le .
5 . 3 C o n n e c t i o n c o n (cid:12) d e n t i a l i t y
P a c k e t s b e t w e e n t h e D W T a n d t h e (cid:12) r e w a ll a r e v u l-
n e r a b le t o s n i(cid:14) n g a t t a c k s . T h e r e f o r e , w e m u s t e s t a b -
lis h a p r iv a t e c h a n n e l b e t w e e n p u s h w e b a n d t h e D W T .
a b s e n tW h ile t h is c h a n n e l p a s s e s t h r o u g h t h e p r o x y ,
t h e p r o x y is n o t p r iv y t o t h e d a t a p a s s e d a lo n g it ; it
s im p ly f o r w a r d s p a c k e t s a lo n g t h e c h a n n e l. T o a c c o m -
p lis h t h is , w e u s e H T T P o v e r S S L , a s im p le m e n t e d in
t h e A p a c h e - S S L w e b s e r v e r . W e f u r t h e r r e s t r ic t t h e
s e t o f c ip h e r s s u p p o r t e d o n t h e s e r v e r t o t h o s e p r o -
v id in g \ U .S . d o m e s t ic - q u a lit y " e n c r y p t io n , a s s h o w n
e s
5
t h is p a g e w h e n lo g g in g in f o r t h e A b s e n t s e r v ic e .
in T a b le 1 .
I t is im p o r t a n t t h a t u s e r s c h e c k t h e s e c u r it y in -
f o r m a t io n a b o u t t h e ir S S L c o n n e c t io n t o e n s u r e t h a t
p u s h w e bt h e y a r e c o m m u n ic a t in g w it h . O t h e r w is e ,
a n im p o s t e r c o u ld s u b s t it u t e s o m e o t h e r v a lid s e r v e r
c e r t i(cid:12) c a t e a n d e lic it O P I E p a s s w o r d s f r o m t h e u s e r ,
o r f e e d h im / h e r b o g u s c o n t e n t . M o s t b r o w s e r s a r e
c o n (cid:12) g u r e d t o w a r n t h e u s e r if t h e n a m e in a c e r t i(cid:12) -
c a t e d o e s n o t m a t c h t h e s it e r e q u e s t e d . T h u s , t h e
p u s h w e bc e r t i(cid:12) c a t e f o r a c t u a lly c o n t a in s t h e n a m e
a b s e n t . r e s e a r c h . a t t . c o m .
A t p r e s e n t w e d o n o t s u p p o r t in t e r n a l S S L s e r v e r s .
I f a n in t e r n a l s e r v e r u s e s S S L , t h e n w e h a v e t o la y e r
o u r s e c u r e c o n n e c t io n o v e r t h a t S S L c o n n e c t io n . T h is
is p r e s e n t s s o m e p r o b le m s ( s e e S e c t io n 8 ) .
5 . 4 O t h e r s e c u r i t y f e a t u r e s
5 . 4 . 1 A u t h e n t i c a t e d U R L s
O n e o f t h e im p o r t a n t s e c u r it y f e a t u r e s o f o u r s y s t e m is
t h a t n o a d v e r s a r y s h o u ld b e a b le t o a c c e s s t h e in t e r n a l
w e b s e r v e r . T o t h a t e n d , w e b in d e v e r y U R L t o a n
a u t h e n t ic a t e d u s e r . W h e n a u s e r a u t h e n t ic a t e s u s in g
t h e o n e - t im e p a s s w o r d s c h e m e , a n e n t r y is c r e a t e d in
p u s h w e ba u s e r t a b le o n t h e s e r v e r . W e g e n e r a t e aS S L _ R S A _ W I T H _ R C 4 _ 1 2 8 _ M D 5
S S L _ R S A _ W I T H _ R C 4 _ 1 2 8 _ S H A
S S L _ R S A _ W I T H _ I D E A _ C B C _ S H A
S S L _ R S A _ W I T H _ D E S _ C B C _ S H A
S S L _ R S A _ W I T H _ 3 D E S _ E D E _ C B C _ S H A
S S L _ D H _ D S S _ W I T H _ D E S _ C B C _ S H A
S S L _ D H _ D S S _ W I T H _ 3 D E S _ E D E _ C B C _ S H A
S S L _ D H _ R S A _ W I T H _ D E S _ C B C _ S H A
S S L _ D H _ R S A _ W I T H _ 3 D E S _ E D E _ C B C _ S H A
S S L _ D H E _ D S S _ W I T H _ D E S _ C B C _ S H A
S S L _ D H E _ D S S _ W I T H _ 3 D E S _ E D E _ C B C _ S H A
S S L _ D H E _ R S A _ W I T H _ D E S _ C B C _ S H A
S S L _ D H E _ R S A _ W I T H _ 3 D E S _ E D E _ C B C _ S H A
T a b le 1 : T h e S S L c ip
r a n d o m k e y f o r t h e u s e r a n d a d d it t o t h e t a b le . R e c a ll
t h a t w h e n a u s e r r e t r ie v e s a p a g e , a ll o f t h e in t e r n a l
U R L s a r e r e w r it t e n . T h e f o r m a t o f t h e n e w U R L is
h t t p s :/ / a b s e n t .r e s e a r c h .a t t .c o m / g e t u r l= u s e r /
2 b 5 d b 8 6 c 1 f6 e / o r ig in a l-u r l
T h e (cid:12) e ld im m e d ia t e ly p r e c e d in g t h e o r ig in a l- u r l c o n -
t a in s s o m e s e c u r it y in f o r m a t io n . T h e (cid:12) r s t t w o c h a r -
a c t e r s , in t h is c a s e 2 b , c o r r e s p o n d t o t h e h e x id e c im a l
r e p r e s e n t a t io n o f t h e le n g t h in b y t e s o f t h e o r ig in a l- u r l
( s e e S e c t io n 5 .4 .2 ) . T h e r e m a in in g d a t a , 5 d b 8 6 c 1 f 6 e ,
r e p r e s e n t t h e o u t p u t o f a M e s s a g e A u t h e n t ic a t io n
C o d e ( M A C ) f u n c t io n , t r u n c a t e d t o t h e 4 0 m o s t s ig -
n i(cid:12) c a n t b it s . T o c o m p u t e t h e M A C , t h e s e r v e r u s e s
t h e k e y in t h e u s e r t a b le a n d t h e o r ig in a l U R L . T r u n -
c a t in g a M A C m a k e s it m o r e d i(cid:14) c u lt f o r a n a t t a c k e r
t o e x h a u s t iv e ly s e a r c h f o r t h e k e y b e c a u s e t h e r e a r e
m a n y p o s s ib le k e y s t h a t c o u ld p r o d u c e t h e s h o r t e n e d
o u t p u t [1 3 , 1 5 ]. I n c h o o s in g 4 0 b it s , w e t r a d e o (cid:11) t h e
a m o u n t o f w o r k it r e q u ir e s f o r a n a t t a c k e r t o e x h a u s -
t iv e ly g e n e r a t e a v a lid M A C v e r s u s t h e le n g t h o f t h e
U R L s . M o s t s y s t e m s lim it U R L le n g t h t o 2 5 6 b y t e s ,
s o w e w a n t e d t o a d d a s lit t le a s p o s s ib le t o t h is . T o
g e n e r a t e a v a lid U R L w it h a v a lid M A C , a n a t t a c k e r
4 0
w o u ld h a v e t o t e s t o n t h e o r d e r o f 2 U R L s w it h
r a n d o m M A C s . T h e b ir t h d a y a t t a c k [1 3 ] t h a t w o u ld
2 0
r e q u ir e 2 t r ia ls d o e s n o t w o r k h e r e b e c a u s e t h e s a m -
p le s p a c e f o r U R L s is lim it e d t o v a lid U R L s o n t h e
s e r v e r . S in c e e v e r y t r ia l r e q u ir e s a r e q u e s t f r o m t h e
s e r v e r a n d k e y s e x p ir e e v e r y 2 0 m in u t e s , it is in f e a s ib le
f o r a n a t t a c k e r t o g e n e r a t e a v a lid U R L . I n a d d it io n ,
w e lo g u n s u c c e s s f u l r e q u e s t s , a n d a n e x h a u s t iv e s e a r c h
is im m e d ia t e ly o b v io u s o n t h e s e r v e r .
p u s h w e bW h e n t h e s e r v e r r e c e iv e s a U R L , it (cid:12) r s t
c h e c k s t h a t t h e u s e r is v a lid ( i.e . r e g is t e r e d w it h A b -
s e n t ) . I t t h e n c h e c k s t h a t t h e le n g t h o f t h e U R L is
h e r
6
s u it e s u s e d b y p u s h w e b
c o r r e c t . F in a lly , it r e t r ie v e s t h e k e y f r o m t h e u s e r
t a b le , c o m p u t e s t h e M A C , a n d c o m p a r e s t h e m o s t
s ig n i(cid:12) c a n t 4 0 b it s t o t h e M A C . I f a ll o f t h e s e t e s t s
a r e c o r r e c t t h e n t h e p a g e is r e t r ie v e d . I f t h e k e y h a s
e x p ir e d , t h e s e r v e r s e n d s a n e w o n e - t im e p a s s w o r d a u -
t h e n t ic a t io n f o r m . T h is r e s u lt s in a n e w M A C in g k e y
f o r t h e u s e r a f t e r s u c c e s s f u l a u t h e n t ic a t io n . T h u s , o ld
U R L s w it h M A C s f r o m e x p ir e d k e y s , a r e u s e le s s .
5 . 4 . 2 C G I s c r i p t s
W h e n a u s e r s u b m it s in f o r m a t io n t o t h e s e r v e r in
a f o r m u s in g a G E T m e t h o d , a U R L c o n t a in in g
t h e n a m e s a n d v a lu e s o f t h e in p u t b o x e s is p a s s e d
f r o m t h e D W T t o t h e s e r v e r . T h is U R L c a n n o t
p u s h w e bb e M A C e d in a d v a n c e b y b e c a u s e t h e r e
is n o w a y t o k n o w w h a t v a lu e s t h e u s e r w ill e n -
t e r . F o r e x a m p le , s a y t h a t a C G I s c r ip t is r e f e r -
a b s e n te n c e d b y t h e f o llo w in g U R L ( w h e r e r e p r e s e n t s
a b s e n t . r e s e a r c h . a t t . c o m )
a b s e n th t t p s :/ / / g e t u r l= a lic e / 3 2 a 5 d 3 8 6 c f6 e / h t t p :/ /
w w w .r e s e a r c h .a t t .c o m / ~ a lic e / c g i-b in / r e g .c g i
T h e U R L s e n t t o t h e s e r v e r w h e n t h e u s e r s u b m it s
c o u ld b e
a b s e n th t t p s :/ / / g e t u r l= a lic e / 3 2 a 5 d 3 8 6 c f6 e / h t t p :/ /
w w w .r e s e a r c h .a t t .c o m / ~ a lic e / c g i-b in / r e g .c g i& n a m e = b o
T h e M A C is c o r r e c t f o r t h e (cid:12) r s t 5 0 b y t e s o f t h e o r ig -
in a l U R L , b u t it d o e s n o t in c lu d e \ & n a m e = b o b " .
T h e r e f o r e , w e in c lu d e t h e le n g t h , in h e x , o f t h e o r i g -
i n a l U R L t h a t r e f e r e n c e s t h e C G I s c r ip t . I n t h e
a b o v e e x a m p le t h e le n g t h is 5 0 , w h ic h is h e x 3 2 .
bT h e m o s t s ig n i(cid:12) c a n t 4 0 b it s o f t h e a c t u a l M A C a r e
x a d c f e0 5 3 8 6 6 .
T h e e (cid:11) e c t is t h a t a u t h e n t ic a t e d u s e r s c a n e x e c u t e
C G I s c r ip t s a s lo n g a s t h e ir k e y s a r e v a lid . A C G I
s c r ip t t h a t is M A C e d b y a n e x p ir e d k e y c a n n o t b e
in v o k e d . A p o t e n t ia l d a n g e r is t h a t a n a t t a c k e r w h o
c a n s u r m is e t h a t a p a r t ic u la r r e q u e s t is a C G I f o r m
c a n r e p la y t h e m e s s a g e t o c a u s e t h e s c r ip t t o e x e c u t e
a g a in w it h t h e s a m e in p u t d a t a a s b e f o r e . F o r t u n a t e ly ,
S S L p r o t e c t s a g a in s t r e p la y a t t a c k s , s o o u r s y s t e m is
n o t v u ln e r a b le t o t h is .
5 . 4 . 3 G e n e r a t i n g r a n d o m k e y s
T h e s e c u r it y o f a n y s y s t e m t h a t u s e s c r y p t o g r a p h ic
o p e r a t io n s lie s in t h e u n p r e d ic t a b ilit y o f t h e k e y s . A s
d e s c r ib e d a b o v e , o u r s y s t e m r e q u ir e s t h a t t h e s e r v e r
g e n e r a t e a s e c r e t k e y c o r r e s p o n d in g t o e a c h u s e r t o
c o m p u t e t h e M A C s o f U R L s . W e e m p lo y a n e x p e n s iv e
f u n c t io n t o g e n e r a t e a s r a n d o m a s e e d a s p o s s ib le ,
f o llo w e d b y a s p e e d y o p e r a t io n t o g e n e r a t e u s e r k e y s
f r o m t h e in it ia l r a n d o m n e s s .
r a n d l i bO u r s y s t e m e m p lo y s t h e p a c k a g e f r o m
c r y p t o lib [1 0 ] a s a \ t r u e " r a n d o m n u m b e r g e n e r a t o r .
T h is p a c k a g e c o lle c t s a s m u c h in f o r m a t io n a s p o s s ib le
f r o m t h e h o s t e n v ir o n m e n t a n d m ix e s it u s in g c r y p -
t o g r a p h ic f u n c t io n s . T h e s o f t w a r e u s e s in f o r m a t io n
a b o u t n e t w o r k c o n n e c t io n s , t h e p r o c e s s t a b le , m e m -
o r y , d is k , e t c . T h e p r o c e s s is v e r y t e d io u s a n d s lo w .
t r u e r a n dT h e r e f o r e , w e c a ll t h e f u n c t io n o n ly u p o n
s e r v e r s t a r t u p t o g e n e r a t e a m a s t e r k e y . T h e n , w e u s e
D E S [1 4 ] a s a p s e u d o r a n d o m f u n c t io n w it h t h e m a s t e r
s e c r e t a s t h e k e y , t o g e n e r a t e a ll o t h e r M A C k e y s .
I t is im p o r t a n t t o n o t e t h a t t h e r e c e n t r e s u lt s s h o w -
in g 5 6 b it D E S t o b e v u ln e r a b le t o e x h a u s t iv e s e a r c h
[6 ] d o n o t in a n y w a y im p a c t t h e a p p r o p r ia t e n e s s o f
D E S a s a p s e u d o r a n d o m n u m b e r g e n e r a t o r ( P R N G ) .
W h e n D E S is u s e d a s a P R N G , t h e r e a r e n o p la in -
t e x t / c ip h e r t e x t p a ir s f o r a n a t t a c k e r t o u s e , a n d t h u s ,
a D E S c r a c k in g m a c h in e c a n n o t b e u s e d t o p r e d ic t
t h e o u t p u t o f t h e g e n e r a t o r . T h is is t r u e b e c a u s e t h e
M A C k e y s t h a t w e g e n e r a t e ( t h e o u t p u t o f D E S ) a n d
r a n d l i bt h e in it ia l r a n d o m s e e d ( o b t a in e d f r o m ) a r e
n e v e r a v a ila b le t o t h e a t t a c k e r .
A f t e r g e n e r a t in g t h e m a s t e r s e c r e t , a c o u n t e r is in i-
t ia liz e d . T h e n , e v e r y t im e a n e w k e y is n e e d e d , w e
n e w k e y D E S m a s t e r k e y ; c o u n t e rc o m p u t e - = ( - ) a n d
t h e n in c r e m e n t t h e c o u n t e r . T h is h a s t h e a d v a n t a g e
t h a t c o m p u t in g n e w k e y s is f a s t , w h ile c r a c k in g t h e s e
k e y s w it h o u t k n o w le d g e o f t h e m a s t e r k e y is d i(cid:14) c u lt .
T o illu s t r a t e t h is , w e d e s c r ib e h o w t h e a t t a c k e r
m ig h t c r a c k t h e m a s t e r - k e y f r o m w h ic h t h e u s e r k e y s
a r e d e r iv e d . F ir s t , t h e a t t a c k e r m u s t c o lle c t U R L s
c o n t a in in g M A C s f r o m o n e u s e r . T h e s e a r e lim it e d in
7
n u m b e r b y t h e lif e t im e o f t h e k e y ( 2 0 m in u t e s ) a n d t h e
n u m b e r o f lin k s in t h e r e q u e s t s m a d e b y t h e u s e r . I n
a d d it io n , t h e U R L s a r e g e n e r a lly u n a v a ila b le t o o u t -
s id e s in o u r s y s t e m b e c a u s e S S L is u s e d . N e x t , t h e
a t t a c k e r m u s t c o m p u t e t h e u s e r ’s k e y . T h is a m o u n t s
t o b r e a k in g H M A C , a t a s k c o n s id e r e d t o b e in f e a s i-
b le . E v e n if t h e a t t a c k e r (cid:12) n d s a k e y t h a t c o m p u t e s a ll
o f t h e M A C s c o r r e c t ly , t h e r e is n o g u a r a n t e e t h a t it
is t h e r ig h t k e y b e c a u s e t h e t r u n c a t io n o f t h e M A C s
t o 4 0 b it s r e s u lt s in m a n y p o s s ib le k e y s ( s e e S e c t io n
5 .4 .1 ) . F in a lly , t h e a t t a c k e r k n o w s t h a t u s e r k e y s a r e
p r o d u c e d b y a p p ly in g D E S t o a c o u n t e r , s o a r e a s o n -
a b le g u e s s c a n b e m a d e a b o u t t h e in p u t v a lu e . T h u s ,
a f t e r d o in g a ll o f t h is w o r k , t h e a t t a c k e r c a n p r o d u c e
P ; C Pf ga p a ir w h e r e is a r a n g e o f p o s s ib le p la in -
Ct e x t ( s o m e c o u n t e r v a lu e ) a n d is a p o s s ib le c ip h e r -
t e x t ( a u s e r ’s M A C k e y ) . T o o b t a in m o r e p a ir s , t h e
a t t a c k e r m u s t b r e a k H M A C f o r a n o t h e r u s e r . T h e
4 3
b e s t k n o w n t e c h n iq u e s f o r b r e a k in g D E S in v o lv e 2
p la in t e x t / c ip h e r t e x t p a ir s [1 3 ]. A s s t a t e d a b o v e , b r u t e
f o r c e in n o t a n o p t io n b e c a u s e e v e n t h e c ip h e r t e x t s a r e
n o t k n o w n t o t h e a t t a c k e r . W e c o n c lu d e t h a t it is n o t
f e a s ib le f o r a n a t t a c k e r t o c r a c k t h e m a s t e r k e y . F o r
a d d it io n a l s e c u r it y , w e n o t e t h a t t h e m a s t e r k e y d o e s
n o t r e p r e s e n t a n y s t a t e in t h e s y s t e m ; it is o n ly u s e d
t o s e e d a P R N G . S o , it c a n b e c h a n g e d a t a n y t im e
t r u e r a n db y c a llin g a g a in .
5 . 4 . 4 O t h e r i s s u e s
F o r m a x im u m s e c u r it y , it is im p o r t a n t t h a t u s e r s
c le a r t h e m e m o r y a n d d is k c a c h e a n d t h e n k ill t h e ir
b r o w s e r . I n a d d it io n , w e in c lu d e t h e H T T P d ir e c t iv e
C a c h e - C o n t r o l : n o - c a c h e in e v e r y p a g e . T h is h a s
t h e e (cid:11) e c t o f f o r c in g t h e b r o w s e r n o t t o c a c h e p a g e s .
T h e m e t h o d is n o t f o o l- p r o o f , a s u s e r s c o u ld s t ill s a v e
t h e p a g e t h e y a r e v ie w in g o n t o t h e r e m o t e m a c h in e ,
b u t t h e r e is a lim it t o h o w m u c h w e c a n p r o t e c t t h e
in f o r m a t io n f r o m u s e r s w h o a r e d e t e r m in e d t o e x p o s e
it .
6 I m p l e m e n t a t i o n
W h e r e v e r p o s s ib le , w e u s e d e x is t in g s o f t w a r e t o im -
p le m e n t A b s e n t . T h is b o t h s im p li(cid:12) e s s e c u r it y a n a ly s is
( if w e c a n a s s u m e t h e c o m p o n e n t p a r t s t o b e s e c u r e )
a n d r e d u c e s o u r c o d in g e (cid:11) o r t ( p a r t ic u la r ly in t h e c a s e
o f t h e in t e r n a l p r o x y a n d o n e - t im e p a s s w o r d s y s t e m s ) .
F o r t h is r e a s o n , o n ly t h e A b s e n t d a e m o n it s e lf c o n s is t s
e n t ir e ly o f o r ig in a l c o d e ; m o s t o f t h e o t h e r c o m p o n e n t s
m a k e u s e o f e x it in g c o d e .
T h e A b s e n t s y s t e m c o n s is t s o f t w o d a e m o n s
t h a t im p le m e n t t h e f u n c t io n s o f t h e e x t e r n a l s e r v e r(
t
c
p
f
a b s e n t d p u s h w e b) a n d in t e r n a l p r o x y ( ) , a n d t h e p r o -
o c o l w it h w h ic h t h e s e d a e m o n s c o m m u n ic a t e o v e r a
o n t r o l c h a n n e l. T h e c o n t r o l c h a n n e l is o p e n e d b y
u s h w e b a t s t a r t u p . T h e p r o t o c o l o n t h is c h a n n e l is
a ir ly s im p le , c o n s is t in g o f (cid:12) v e m e s s a g e s :
H E L O t i m e s t a m p ; m a c(cid:15) p u s h w e b( ) : S e n t b y
a b s e n t dw h e n o p e n in g t h e c o n t r o l c h a n n e l.
c h e c k s t h a t t h e t im e s t a m p is w it h in a r e a s o n a b le
a m o u n t o f t im e f r o m t h e c u r r e n t t im e ( t o p r e -
v e n t r e p la y a t t a c k s ) a n d e n s u r e s t h a t t h e s u p -
p lie d M A C is in f a c t H M A C - M D 5 ( s e c r e t , t im e s -
s e c r e tt a m p ) , w h e r e is a M A C in g s e c r e t c o n -
s t r u c t e d a t in s t a lla t io n t im e a n d s h a r e d b y t h e
t w o d a e m o n s . I f t h e M A C m a t c h e s a n d t h e
s o u r c e o f t h e c o n n e c t io n is t h e c o n (cid:12) g u r e d a d -
p u s h w e bd r e s s o f , t h e c o n n e c t io n is a s s u m e d b y
a b s e n t d t o b e v a lid . I f n o t , t h e c o n n e c t io n a t -
t e m p t is r e j e c t e d .
(cid:15) C O P E N ( i d , t i m e s t a m p , c li e n t s o c k a d d r , M A C ) :
a b s e n t dW h e n a c lie n t c o n n e c t s t o , t h is m e s s a g e
p u s h w e bis s e n t t o t o in d ic a t e t h a t a n e w d a t a
c o n n e c t io n f o r t h e c lie n t s h o u ld b e o p e n e d . T h is
c o n n e c t io n w ill b e u s e d f o r p r o x ie d d a t a b e t w e e n
c l i e n t s o c k a d d rp u s h w e bt h e c lie n t a n d . T h e is
a B e r k e le y - s t y le s o c k e t a d d r e s s , in d ic a t in g t h e
s it e f r o m w h ic h t h e c lie n t is c o n n e c t in g . T h e
i d a b s e n t da r g u m e n t is u s e d b y t o id e n t if y t h e
p u s h w e bc lie n t ; it h a s n o m e a n in g t o , a n d is e s -
s e n t ia lly a n o p a q u e v a lu e w h ic h s h o u ld s im p ly
t i m e s t a m p M A Cb e r e t u r n e d . T h e a n d (cid:12) e ld s
H E L Op u s h w e ba r e c h e c k e d b y a s in t h e m e s -
s a g e , w it h t h e e x c e p t io n t h a t t h e M A C c o v e r s
a ll t h e a r g u m e n t s t o t h e c o n t r o l m e s s a g e .
C O P E N R i d ; t i m e s t a m p ; M A C(cid:15) ( ) :
C O P E N RT h e m e s s a g e is n o t , s t r ic t ly s p e a k -
in g , c o n t r o l c h a n n e l p r o t o c o l. I t is s e n t a lo n g
p u s h w e ba n e w d a t a d a t a c h a n n e l b y a f t e r t h e
c o n n e c t io n is o p e n e d . O n r e c e ip t o f t h e m e s s a g e ,
t i m e s t a m pa b s e n t d d o e s t h e u s u a l c h e c k s o n
M A C i da n d a n d , if t h e v a lu e r e f e r s t o a w a it -
in g c o n n e c t io n , b e g in s a c t in g a s a p r o x y f o r t h e
c lie n t .
P I N G t i m e s t a m p ; M A C(cid:15) ( ) ,
P O N G t i m e s t a m p ; M A C( ) : O u r (cid:12) r e w a ll t im e s
o u t in a c t iv e c o n n e c t io n s a f t e r a p e r io d o f t im e .
T o p r e v e n t t h is , A b s e n t im p le m e n t s a s im p le
k e e p a liv e p r o t o c o l. T h e s e m e s s a g e s im p le m e n t
t h a t p r o t o c o l. P e r io d ic a lly , e it h e r s id e m a y s e n d
P I N Ga m e s s a g e . T h e s e n d in g s id e e x p e c t s t o
P O N Gr e c e iv e a m e s s a g e w it h in a r e a s o n a b le
p e r io d o f t im e . I f n o n e is r e c e iv e d , t h e c o n t r o l
8
a b s e n t dc o n n e c t io n is a s s u m e d t o b e d e a d ; if
n o t ic e s t h is , it s t o p s a c c e p t in g n e w c lie n t c o n -
n e c t io n s u n t il a n e w c o n t r o l c o n n e c t io n is e s -
t a b lis h e d ( e x is t in g c o n n e c t io n s c o n t in u e t o b e
p u s h w e bs e r v ic e d ) . I f n o t ic e s t h is , it a t t e m p t s
t o r e e s t a b lis h t h e c o n t r o l c o n n e c t io n .
N o t e t h a t a ll c o n t r o l m e s s a g e s h a v e a s s o c ia t e d
M A C s o v e r t h e ir a r g u m e n t s . B o t h d a e m o n s a r e f a ir ly
d r a c o n ia n a b o u t d e a lin g w it h in c o r r e c t M A C v a lu e s .
I f a n in c o r r e c t M A C is r e c e iv e d , t h e c o n t r o l c o n n e c -
t io n is im m e d ia t e ly c lo s e d . T h is s u g g e s t s a f a ir ly s im -
p le d e n ia l- o f - s e r v ic e a t t a c k b a s e d o n t h e in j e c t io n o f
b o g u s p a c k e t s . N o a t t e m p t h a s b e e n m a d e a t t h is
p o in t t o r e p a ir t h is p r o b le m , a n d t h e a u t h o r s w e lc o m e
s u g g e s t io n s .
a b s e n t d is a s im p le ( r o u g h ly 9 0 0 lin e s ) , s t a n d a lo n e
C p r o g r a m . A s id e f r o m im p le m e n t a t io n o f t h e p r o t o -
c o l d e s c r ib e d a b o v e , it is a n u n r e m a r k a b le b lin d p r o x y .
p u s h w e bT h e in t e r n a l d a e m o n , , is m o r e c o m p le x .
T h e d a e m o n c o n s is t s o f t h r e e p a r t s :
(cid:15) A m o d i(cid:12) e d A p a c h e w e b s e r v e r
(cid:15) T h e U R L - r e w r it in g h a n d le r
(cid:15) T h e o n e - t im e p a s s w o r d in t e r f a c e
T h e c h o ic e o f A p a c h e a s t h e b a s e u p o n w h ic h t o
p u s h w e bb u ild w a s d r iv e n p r im a r ily b y t h e f a c t t h a t
p u s h w e bA p a c h e it s e lf p r o v id e s m o s t o f t h e f e a t u r e s
r e q u ir e s :
(cid:15) A n S S L im p le m e n t a t io n ( w it h A p a c h e / S S L )
(cid:15) A p r o x y
(cid:15) A w e b s e r v e r
(cid:15) A v a ila b le s o u r c e .
6 . 1 M o d i (cid:12) c a t i o n s t o A p a c h e
T h e m o d i(cid:12) c a t io n s t o t h e A p a c h e s o u r c e a r e m in -
im a l; t h e y c o n s is t m a in ly o f r e p la c in g A p a c h e ’s
c o n n e c t io n - a c c e p t in g c o d e w it h c o d e t h a t o n r e c e ip t
C O P E No f a m e s s a g e o n t h e c o n t r o l c h a n n e l, c r e -
a b s e n ta t e s a n e w c o n n e c t io n t o t h e d a e m o n . O n c e
t h e s o c k e t a d d r e s s o f t h is n e w c o n n e c t io n is s e t t o
s o c k a d d r C O P E Nc l i e n t v a lu e s u p p lie d w it h t h et h e
m e s s a g e , t h e c o n n e c t io n a p p e a r s t o a p a c h e t o b e a
n o r m a l c lie n t c o n n e c t io n f r o m t h e c lie n t a d d r e s s . T h is
s p o o (cid:12) n g a llo w s A p a c h e ’s a c c e s s c o n t r o l a n d lo g g in g
f u n c t io n s t o b e h a v e n o r m a lly , a n d p e r m it s u s t o u s e
t h e r e m a in d e r o f t h e A p a c h e c o d e u n m o d i(cid:12) e d . T h e
c h a n g e s t o A p a c h e s o u r c e e n t a il f e w e r t h a n 1 0 0 lin e s
o f C .6 . 2 U R L - r e w r i t i n g h a n d l e r
W e ’v e w r it e n a n a p a c h e h a n d le r t o d e a l w it h a ll
t a s k s t h a t a r e p r e f o r m e d o n c e t h e c o n n e c t io n is e s -
t a b lis h e d . T h e s e in c lu d e h a n d lin g r e q u e s t s , a u t h e n t i-
c a t in g u s e r s , f e t c h in g w e b d o c u m e n t s , r e w r it in g U R L s
in H T M L d o c u m e n t s , a n d r e t u r n in g t h e d o c u m e n t t o
a b s e n tt h e c lie n t ( t h r o u g h ) . A p a c h e a llo w s t h ir d p a r -
t ie s t o w r it e h a n d le r s t o (cid:12) t in t o c e r t a in p h a s e s o f e a c h
t r a n s a c t io n . W e ’v e w r it t e n o u r h a n d le r in p e r l t o u t i-
liz e it s p o w e r f u l r e g u la r e x p r e s s io n f u n c t io n a lit y a n d
t o a v o id r e c o m p ilin g e v e r y t im e t h e c o d e c h a n g e s . T h e
c h a n g e s r e q u ir e o n ly a m in o r a d d it io n t o t h e A p a c h e
s t a r t u p c o n (cid:12) g u r a t io n (cid:12) le s . T h is h a n d le r , w h ic h in -
v o lv e s f e w e r t h a n 5 0 0 lin e s o f c o d e , is in v o k e d d u r in g
t h e U R L t r a n s la t io n p h a s e .
T h e (cid:12) r s t s t e p is t o d e t e r m in e w h e t h e r t h e c o m m a n d
l o g i n , O T P r e s p o n s e , l o g o u t g e t u r lv a lu e is , o r .
l o g i nF o r a r e q u e s t , t h e c o d e e n s u r e s t h a t t h e u s e r
is r e g is t e r e d a n d s e n d s t h e O T P c h a lle n g e t o t h e
O T P r e s p o n s ec lie n t . W h e n a n c o m m a n d is r e c e iv e d ,
w e c h e c k t h e v a lid it y o f t h e r e s p o n s e . I f v a lid , t h e u s e r
is lo g g e d in , a n d t h e r e q u e s t e d p a g e ( in c lu d e d a s p a r t
o f t h e O T P r e s p o n s e ) is r e t u r n e d t o t h e c lie n t w it h a ll
o f t h e U R L s o n t h e p a g e t h a t r e f e r e n c e o u r in t e r n a l
l o g o u td o m a in r e w r it t e n . U p o n a r e q u e s t , t h e M A C
o f t h e lo g o u t U R L is c h e c k e d a n d , if v a lid , t h e u s e r
is lo g g e d o u t . T h e lo g o u t c o n s is t s o f r e m o v in g t h e ir
p u s h w e be n t r y in t h e t a b le o n , in p a r t ic u la r , d e le t in g
t h e ir M A C k e y . O t h e r w is e , w e a s s u m e t h a t it is a
f o r g e r y a n d r e t u r n a n e r r o r .
g e t u r lW h e n a c o m m a n d is r e c e iv e d , o u r h a n d le r
c h e c k s t h e M A C o f t h e r e q u e s t e d U R L a n d , if v a lid ,
s u b m it s t h e r e q u e s t t o t h e in t e r n a l w e b s e r v e r . I f
C o n t e n t - t y p et h e o f t h e r e s p o n s e f r o m t h e s e r v e r is
" t e x t / h t m l " , t h e d o c u m e n t is t h e n p a r s e d t o id e n t if y
a ll lin k s o n t h e p a g e . E v e r y lin k c o n t a in in g a r e la -
t iv e U R L is c o n v e r t e d t o o n e c o n t a in in g a n a b s o lu t e
U R L b y a d d in g t h e \ h t t p :/ / " p r o t o c o l, t h e c o m p le t e
s e r v e r n a m e ( s u c h a s m u s ic .r e s e a r c h .a t t .c o m ) , a n d t h e
p r o p e r p a t h in f o r m a t io n ( e .g . r e p la c in g ../ f o o .h t m l
w it h / d ir / f o o .h t m l) t o t h e U R L if t h e y a r e m is s in g .
A s e c o n d p a s s is t h e n m a d e t h r o u g h t h e d o c u m e n t
t o p r e p e n d t h e A b s e n t in f o r m a t io n t o e a c h U R L . F i-
n a lly , a lo g o u t b u t t o n is a d d e d t o t h e p a g e , a n d t h e
C o n t e n t - l e n g t h h e a d e r is a d j u s t e d t o m a t c h t h e n e w
C o n t e n t - t y p ela r g e r d o c u m e n t le n g t h . I f t h e is n o t
" t e x t / h t m l " , t h e r e s p o n s e f r o m t h e s e r v e r r e m a in s
u n e d it e d . F in a lly , t h e H T T P r e s p o n s e is r e t u r n e d t o
t h e c lie n t .
9
6 . 3 P e r f o r m a n c e
T h e m o s t s ig n i(cid:12) c a n t p e r f o r m a n c e b o t t le n e c k in A b -
s e n t is t h e p a r s in g e n g in e . T h e r e f o r e , w e b u ilt a
s p e c ia l- p u r p o s e p a r s e r t h a t le a v e s m o s t H T M L u n -
t o u c h e d , a n d is c o n c e r n e d o n ly w it h t a g s t h a t c a n
c o n t a in U R L s . I n a d d it io n t o t h e o v e r h e a d o f p a r s -
in g , a M A C is c o m p u t e d f o r e a c h lin k , r e s u lt in g in 2
c o m p u t a t io n s o f M D 5 . A s U R L le n g t h is lim it e d t o
2 5 6 b y t e s , t h e h a s h f u n c t io n o n ly it e r a t e s o n c e f o r e a c h
c a ll. T h u s , a p a g e c o n t a in in g 7 5 0 lin k s r e q u ir e s 1 5 0 0
it e r a t io n s o f M D 5 . H o w e v e r , w e (cid:12) n d t h a t t h is is o n ly
s ig n i(cid:12) c a n t ( i.e . p e r c e p t ib le ) f o r p a g e s w it h a t r e m e n -
d o u s n u m b e r o f lin k s . M o s t p a g e s a r e p r o c e s s e d v e r y
q u ic k ly w it h a n u n n o t ic e a b le o v e r h e a d .
A s a n e x t r e m e e x a m p le , w e e x a m in e d a p a g e w it h
3 3 9 8 lin k s . T h e s iz e o f t h e o r ig in a l H T M L (cid:12) le is
1 1 6 ,9 9 7 b y t e s . T h is p a g e t a k e s 1 8 s e c o n d s t o p a r s e
a n d c o n v e r t a ll t h e U R L s , in c lu d in g c h a n g in g r e la t iv e
U R L s t o a b s o lu e , p a r s in g , a n d c o m p u t in g M A C s o n
p u s h w e bo u r , a S p a r c U lt r a 2 . T h e s a m e o p e r a t io n
t o o k a lm o s t a m in u t e u s in g a n o (cid:11) t h e s h e lf p a r s e r .
T h e r e s u lt in g p a g e is 3 6 3 ,4 9 7 b y t e s lo n g , a 3 1 1 % in -
c r e a s e in s iz e . T h u s , p e r f o r m a n c e is s t r o n g ly t ie d t o
t h e n u m b e r o f lin k s o n a p a g e . I t is o u r e x p e r ie n c e
t h a t m o s t p a g e s c o n t a in f e w e n o u g h lin k s t h a t t h e
a d d e d la t e n c y is n o t n o t ic e a b le .
7 S e c u r i t y a s s e s s m e n t
T h e s e c u r it y o f o u r s y s t e m r e s t s o n t h e s e c u r it y
o f t h e u n d e r ly in g m e c h a n is m s a n d t h e ir c o m p o s i-
t io n . W e u s e o (cid:11) - t h e - s h e lf s o f t w a r e c o m p o n e n t s s u c h
a s O P I E , S S L E A Y , a n d H M A C . T h e s e p a c k a g e s h a v e
b e e n h e a v ily s c r u t in iz e d b y e x p e r t s in t h e s e c u r it y
(cid:12) e ld , s o w e h a v e s o m e c o n (cid:12) d e n c e in t h e m . W e c o n -
s t a n t ly m o n it o r b u g r e p o r t s o n r e le v a n t n e w s g r o u p s
a n d m a ilin g lis t s , a n d p la n t o u p g r a d e im m e d ia t e ly
a n y c o m p o n e n t t h a t is d is c o v e r e d t o h a v e a s e c u r it y
p r o b le m w h e n a p a t c h is r e le a s e d .
7 . 1 C o m p r o m i s e o f a b s e n t
a b s e n tW e c o n s t a n t ly a n d c a r e f u lly m o n it o r . H o w -
e v e r , t h is m a c h in e is o u t s id e o f t h e (cid:12) r e w a ll, a n d it is
r e a s o n a b le t o a s s u m e t h a t it w ill c o m e u n d e r a t t a c k .
A s s u m in g t h a t a s o p h is t ic a t e d a t t a c k e r m a n a g e s t o
a b s e n tb e c o m e r o o t o n w it h o u t o u r n o t ic in g , w e e x -
a m in e t h e p o s s ib le c o n s e q u e n c e s . T h e a t t a c k e r ’s g o a ls
a r e t h e f o llo w in g :
D e n i a l o f s e r v i c e T h e a t t a c k e r p r e v e n t s v a lid u s e r s
f r o m b e in g a b le t o u s e t h e s y s t e m .P a s s i v e l y e a v e s d r o p o n a u s e r ’ s s e s s i o n T h e a t -
t a c k e r a t t e m p t s t o s e e t h e c o n t e n t s o f t h e u s e r ’s
in t e r a c t io n w it h t h e in t e r n a l w e b s e r v e r w it h o u t
d iv e r t in g f r o m t h e S S L p r o t o c o l.
S e r v e b o g u s i n f o r m a t i o n t o a u s e r I n t h is a t -
t a c k , t h e a t t a c k e r m a s q u e r a d e s a s t h e in t e r n a l
w e b s e r v e r a n d s e r v e s u p (cid:12) c t it io u s in f o r m a t io n
t o t h e u s e r .
O b t a i n v a l i d o n e - t i m e p a s s w o r d s I n
t h is s c e n a r io , t h e a t t a c k e r ’s g o a l is t o f o o l t h e
u s e r in t o e x p o s in g a o n e - t im e p a s s w o r d w it h a
lo w e r n u m b e r t h a n a n y p r e v io u s ly u s e d .
A c c e s s t h e i n t e r n a l w e b T h e a t t a c k e r a t t e m p t s t o
a b s e n tu s e it s c o n t r o l o v e r t o b y p a s s t h e a u t h e n -
t ic a t io n m e c h a n is m a n d a c c e s s p r o t e c t e d c o n -
t e n t o n t h e in t e r n a l w e b s e r v e r .
O b t a i n r o o t o n p u s h w e b T h e a t t a c k e r a t t e m p t s
a b s e n t p u s h w e bt o u s e it s c o n t r o l o v e r t o a t t a c k .
C o m p r o m i s e o f i n t e r n a l n e t w o r k T h e a t t a c k e r
a b s e n ta t t e m p t s t o u s e it s c o n t r o l o v e r t o c o m -
p r o m is e t h e in t e r n a l n e t w o r k in c lu d in g c o n t r o l
o v e r m a c h in e s , a n d (cid:12) le s .
T h e (cid:12) r s t a t t a c k , d e n ia l o f s e r v ic e , is n o t p r e v e n t a b le
a b s e n ta s a n a t t a c k e r w h o c o n t r o ls c a n e a s ily c lo s e
a ll s o c k e t s o n t h e m a c h in e a n d r e f u s e t o c o m m u n ic a t e
w it h a n y o n e . W e m o n it o r t h e m a c h in e f o r t h is c o n d i-
t io n a n d c a n d e t e c t s u c h d e n ia l o f s e r v ic e a t t a c k s . T h e
s e c o n d a t t a c k is m o r e d i(cid:14) c u lt f o r t h e a t t a c k e r . A b s e n t
s e r v e s o n ly a s a n S S L p r o x y . I t b lin d ly f o r w a r d s S S L
p u s h w e bd a t a b e t w e e n a n d t h e c lie n t . T h e r e a r e n o
a b s e n te n c r y p t io n / d e c r y p t io n k e y s s t o r e d o n . T h e r e -
f o r e , t h e r e is n o w a y t h a t t h e a t t a c k e r c a n e a v e s d r o p
o n a s e s s io n w it h o u t b r e a k in g S S L o r p e r f o r m in g a
m o r e a c t iv e a t t a c k .
T o s e r v e b o g u s in f o r m a t io n t o t h e u s e r , t h e a t t a c k e r
m u s t e s t a b lis h a n S S L c o n n e c t io n w it h t h e b r o w s e r .
T o d o t h is , it m u s t s e r v e a v a lid c e r t i(cid:12) c a t e . S u c h
c e r t i(cid:12) c a t e s a r e n o t t o o d i(cid:14) c u lt t o o b t a in . I f s u c h a n
a t t a c k is s u c c e s s f u l, t h e s e r v e r c o u ld f o o l t h e u s e r in t o
r e v e a lin g s e c r e t o n e - t im e p a s s w o r d s . T h e o n ly w a y
t o p r e v e n t t h is a t t a c k is t o r e q u ir e u s e r s t o c h e c k t h e
s e c u r it y in f o r m a t io n in t h e c e r t i(cid:12) c a t e w h e n t h e y u s e
t h e s y s t e m , a n d t o v e r if y t h a t t h e n a m e o f t h e s e r v e r
3
in t h e c e r t i(cid:12) c a t e is \ a b s e n t " .
3
E v e n t h o u g h t h e S S L c o n n e c t io n is b e t w e e n t h e D W T a n d
p u s h w e b a b s e n t, t h e c lie n t c e r t i(cid:12) c a t e w e s e r v e h a s t h e n a m e in
it . T h is is b e c a u s e t h e D W T c o n n e c t s t o a n a d d r e s s t h a t s t a r t s
h t t p s :/ / a b s e n t .r e s e a r c h .a t t .c o m / s o w e u s e t h e n a m e a b s e n t in
t h e c e r t i(cid:12) c a t e s o t h a t t h e b r o w s e r w o n ’t c o m p la in t h a t t h e n a m e
o f t h e s e r v e r a n d t h e n a m e in t h e c e r t i(cid:12) c a t e d o n ’t m a t c h . T h e
1 0
p u s h w e bW it h o u t c o m p r o m is in g , t h e in t e r n a l
s e r v e r , S S L , o r o n e - t im e p a s s w o r d s , t h e r e is n o w a y t o
a b s e n tu s e a c c e s s t o t o g e t t o t h e in t e r n a l w e b s e r v e r .
a b s e n tT h is is b e c a u s e t h e o n ly m e s s a g e s c o m in g f r o m
p u s h w e b p u s h w e bt o a r e c o n t r o l m e s s a g e s in s t r u c t in g
t o o p e n d a t a c o n n e c t io n s . T h e s e c o n n e c t io n s a r e u s e d
a b s e n tt o f o r w a r d S S L t r a (cid:14) c . A n a t t a c k e r o n c a n e x -
p u s h w e bh a u s t r e s o u r c e s o n , b u t t h a t is t h e e x t e n t o f
t h e d a m a g e p o s s ib le . S im ila r ly , b a r r in g b u (cid:11) e r o v e r -
(cid:13) o w a t t a c k s a n d o t h e r s u c h v u ln e r a b ilit ie s r e la t e d t o
b u g s in t h e s o f t w a r e , t h e r e is n o w a y t o u s e r o o t a c -
a b s e n t p u s h w e bc e s s o n t o b r e a k in t o o r t h e in t e r n a l
n e t w o r k m o r e e a s ily t h a n f r o m a n a r b it r a r y h o s t o n
t h e I n t e r n e t .
7 . 2 C o m p r o m i s e o f p u s h w e b
p u s h w e bB e c a u s e r u n s b e h in d t h e (cid:12) r e w a ll, a r o o t
c o m p r o m is e c o u ld b e d e v a s t a t in g . B e s id e s c o m p r o -
m is in g a ll a c c e s s c o n t r o l o n w e b c o n t e n t , a n a t t a c k e r
c o u ld la u n c h a t t a c k s o n t h e in t e r n a l (cid:12) le s y s t e m a n d
o n u s e r a c c o u n t s . T o c o m p r o m is e t h is m a c h in e , a n a t -
p u s h w e bt a c k e r n e e d s t o e x p lo it v u ln e r a b ilit ie s in t h e
c o d e o r e x is t in g w e a k n e s s e s in t h e (cid:12) r e w a ll. T h e la t -
t e r is a p r o b le m in d e p e n d e n t o f o u r s e r v ic e , a n d w e
a s s u m e t h a t o t h e r s a r e p r o t e c t in g t h e p e r im e t e r . W e
w e r e v e r y c a r e f u l a b o u t m e m o r y a llo c a t io n t o a v o id
b u (cid:11) e r o v e r (cid:13) o w p r o b le m s ( t h e le a d in g c a u s e o f s o f t -
w a r e s e c u r it y (cid:13) a w s [4 ].)
W e t a k e t h e f o llo w in g s p e c ia l p r e c a u t io n s o n
p u s h w e b .
(cid:15) p u s h w e bT h e s e r v e r r u n s a s u s e r n o b o d y , w h ic h
h a s p e r m is s io n s o n ly t o r e a d a n d w r it e (cid:12) le s
n e e d e d f o r t h e A b s e n t s e r v ic e .
(cid:15) p u s h w e bN o o t h e r s e r v ic e s a r e a v a ila b le f r o m .
(cid:15) p u s h w e bT h e r e a r e n o r e g u la r u s e r a c c o u n t s o n ,
j u s t a d m in is t r a t iv e a c c o u n t s t o m a n a g e t h e A b -
s e n t s e r v ic e .
(cid:15) A ll im p o r t a n t a c t io n s a n d e s p e c ia lly e r r o r c o n -
d it io n s a r e lo g g e d , a n d t h e lo g s a r e m o n it o r e d
c lo s e ly . W e h o p e e v e n t u a lly t o lo g o n a W O R M
( w r it e o n c e - r e a d m a n y ) d is k .
(cid:15) A ll m a c h in e s e x c e p t t h e in t e r n a l w e b s e r v e r a r e
p u s h w e bc o n (cid:12) g u r e d t o r e f u s e c o n n e c t io n s f r o m .
T h e s e p r e c a u t io n s m a k e it m o r e d i(cid:14) c u lt f o r a n a t -
p u s h w e bt a c k o n t o le a d t o f u r t h e r c o m p r o m is e o f t h e
in t e r n a l n e t w o r k . T h e lo g s a r e c r u c ia l t o p e n e t r a t io n
p r iv a t e k e y c o r r e s p o n d in g t o t h e p u b lic k e y in t h e c e r t i(cid:12) c a t e is
p u s h w e bk e p t o n ly o n .d e t e c t io n a n d r e c o v e r y . T o d a t e , t h e r e h a v e b e e n n o
p u s h w e b a b s e n ts u c c e s s f u l c o m p r o m is e s o f o r ( t o o u r
k n o w le d g e ) .
8 L i m i t a t i o n s
O n e f u n d a m e n t a l p r o b le m in o u r s y s t e m is t h e in -
a b ilit y t o a c c e s s s e c u r e s e r v e r s b e h in d t h e (cid:12) r e w a ll.
T h e r e a s o n is t h a t t h e S S L p r o t o c o l e s t a b lis h e s a s e -
c u r e c o n n e c t io n b e t w e e n t h e s e r v e r a n d t h e e n d c lie n t .
I f a n e x t e r n a l u s e r c o n t a c t s a n in t e r n a l s e r v e r t h r o u g h
a b s e n t , t h e r e a r e t w o p o s s ib ilit ie s . T h e (cid:12) r s t is t h a t
t h e u s e r ’s r e m o t e m a c h in e a n d t h e s e c u r e s e r v e r e s t a b -
lis h a n S S L c o n n e c t io n d ir e c t ly . T h e s e c o n d o p t io n is
a b s e n tt h a t t h e c lie n t a n d e s t a b lis h a n S S L c o n n e c -
a b s e n tt io n , a n d e s t a b lis h e s a s e c u r e c o n n e c t io n t o
t h e s e r v e r a n d a c t s a s a f o r w a r d in g a g e n t . E a c h o f
t h e s e a p p r o a c h e s is p r o b le m a t ic .
I n t h e (cid:12) r s t s c e n a r io , t h e r e is n o w a y t o r e w r it e t h e
a b s e n tU R L s t o p o in t b a c k t o s o a n y a t t e m p t t o a c -
c e s s a lin k o n a p a g e f r o m a s e c u r e s e r v e r is b lo c k e d
b y t h e (cid:12) r e w a ll. T h u s , it m u s t b e p o s s ib le t o s e e t h e
c o n t e n t s o f p a g e s s e r v e d t o t h e c lie n t ( t h e s e c o n d s c e -
a b s e n tn a r io ) . H o w e v e r , a s t h e a d m in is t r a t o r s o f , w e
d o n o t w a n t t h e r e s p o n s ib ilit y o f b e in g a b le t o o b s e r v e
t r a (cid:14) c t h a t is s u p p o s e d t o b e c o n (cid:12) d e n t ia l. F o r e x a m -
p le , if a u s e r a c c e s s e s h is / h e r p r iv a t e p a y r o ll d a t a ,
a n d a d is p u t e la t e r a r is e s a b o u t a w e b t r a n s a c t io n , it
w o u ld b e p o s s ib le t o b la m e u s , s in c e w e h a d a c c e s s t o
t h e d a t a . F o r t h is a n d o t h e r , s im ila r r e a s o n s , w e d o
n o t s u p p o r t a c c e s s t o s e c u r e s e r v e r s b e h in d t h e (cid:12) r e -
w a ll.
A n o t h e r lim it a t io n o f A b s e n t is t h a t s o m e f u n c -
t io n a lit y is lo s t w h e n U R L s a r e d y n a m ic a lly g e n e r -
a t e d o n t h e c lie n t s id e b y a s c r ip t in g la n g u a g e s u c h a s
J a v a s c r ip t . T h e r e is n o w a y t o p a r s e t h e H T M L a n d
(cid:12) n d t h e s e U R L s . I f t h e U R L s r e f e r e n c e s o m e t h in g
b e h in d t h e (cid:12) r e w a ll, t h e s u b s e q u e n t r e q u e s t w ill f a il.
T h e r e is n o t h in g t h a t c a n b e d o n e a b o u t t h is w it h o u t
a n a ly z in g t h e s c r ip t in g c o d e , a n d t h is is k n o w n t o b e
v e r y h a r d t o d o . I t ’s a c t u a lly im p o s s ib le f o r g e n e r a l-
p u r p o s e c o d e [3 ].
A s m e n t io n e d in S e c t io n 3 , w e d o n o t h a v e V P N
t e c h n o lo g y a v a ila b le t o u s . I t is c le a r t h a t a n in -
t e g r a t e d v ir t u a l p r iv a t e n e t w o r k is a b e t t e r s o lu t io n
t h a n t h e o n e w e h a v e p r o v id e d . F ir s t , it is m o r e t r a n s -
p a r e n t t o t h e u s e r s , a n d s e c o n d , it is m o r e s e c u r e . T h is
is b e c a u s e o u r s y s t e m is c o m p o s e d o f s e v e r a l d i(cid:11) e r e n t
c o m p o n e n t s , S S L , A p a c h e , O P I E , a n d o u r o w n c o d e .
W h ile t h e s e c u r it y o f o n e - t im e p a s s w o r d s is b e lie v e d
t o b e w e ll u n d e r s t o o d , a n d S S L h a s b e e n a n a ly z e d
c a r e f u lly , lit t le o r n o a n a ly s is o f t h e c o m p o s it io n o f
1 1
t h e s e s y s t e m s h a s b e e n d o n e . I n f a c t p r o t o c o l c o m p o -
s it io n is a v e r y h a r d p r o b le m a n d h a s le d t o s e c u r it y
p r o b le m s in t h e p a s t [1 2 ]. G iv e n o u r g o a l o f p r o v id in g
in t e r n a l w e b a c c e s s f r o m s it e s s u c h a s t e r m in a l r o o m s
a t c o n f e r e n c e s a n d I n t e r n e t c a f e s , it s e e m s t h a t a V P N
s o lu t io n is n o t f e a s ib le .
9 C o n c l u s i o n s
W e p r e s e n t A b s e n t , a s y s t e m f o r p r o v id in g s e -
c u r e a c c e s s t o a n in t e r n a l w e b s e r v e r f r o m o u t s id e
o f t h e (cid:12) r e w a ll. W e m a k e u s e o f t h e s e c u r e s o c k e t
la y e r ( S S L ) p r o t o c o l t o a c h ie v e c o n (cid:12) d e n t ia lit y a n d
o n e - t im e p a s s w o r d s f o r u s e r a u t h e n t ic a t io n . A b s e n t is
d e s ig n e d t o m in im iz e c h a n g e t o o u r lo c a l in f r a s t r u c -
t u r e a n d t o m a k e u s e o f o (cid:11) - t h e - s h e lf s e c u r it y c o m -
p o n e n t s . T h e k e y d e s ig n c o n s id e r a t io n s w e r e s e c u -
r it y , p e r f o r m a n c e , e a s e o f u s e , a v a ila b ilit y a n d s c a le .
O u r s y s t e m is c u r r e n t ly in p r o d u c t io n u s e b y r e -
s e a r c h e r s a t A T & T . T h e c o d e is f r e e ly a v a ila b le a t
h t t p : / / w w w . r e s e a r c h . a t t . c o m / p r o j e c t s / a b s e n t .
A c k n o w l e d g e m e n t s
W e t h a n k S a m A le x a n d e r , P e t e r H o n e y m a n , L a r r y
J a c k e l, M ic h a e l K o c h e is e n , U r s M u lle r , M ic h a e l R e -
it e r , a n d S t u a r t S t u b b le b in e , f o r h e lp f u l c o m m e n t s .
R e f e r e n c e s
[1 ] M a r t in A b a d i, A n d r e w B ir r e ll, R a y m ie S t a t a ,
a n d E d w a r d W o b b e r . S e c u r e w e b t u n n e lin g . P r o -
c e e d i n g s o f t h e S e v e n t h I n t e r n a t i o n a l W o r ld W i d e
W e b C o n f e r e n c e . C o m p u t e r N e t w o r k s a n d I S D N
S y s t e m s , 3 0 :5 3 1 { 5 3 9 , A p r il 1 9 9 8 .
[2 ] B ill C h e s w ic k a n d S t e v e B e llo v in . F i r e w a l ls a n d
I n t e r n e t S e c u r i t y : R e p e l li n g t h e W i ly H a c k e r .
A d d is o n - W e s le y P u b lis h in g C o m p a n y , 1 9 9 4 .
[3 ] M . E . D a v is a n d E . J . W e y u k e r . C o m p u t a b i l-
i t y , C o m p le x i t y , a n d L a n g u a g e s . A c a d e m ic P r e s s ,
I n c , 1 9 8 3 .
[4 ] S im s o n G a r (cid:12) n k e l a n d G e n e S p a (cid:11) o r d . P r a c t i c a l
U n i x & I n t e r n e t S e c u r i t y . O ’R e illy & A s s o c ia t e s ,
I n c ., 1 9 9 6 .
[5 ] S im s o n G a r (cid:12) n k e l a n d G e n e S p a (cid:11) o r d . W e b S e c u -
r i t y & C o m m e r c e . O ’R e illy & A s s o c ia t e s , I n c .,
1 9 9 7 . A p p e n d ix C .[6
[7
[8
[9
[1 0
[1 1
[1 2
[1 3
[1 4
[1 5
[1 6
[1 7
[1 8
[1 9
]
]
]
]
]
]
]
]
]
]
]
]
]
]
J o h n G ilm o r e . E F F b u ild s D E S c r a c k e r t h a t
p r o v e s t h a t d a t a e n c r y p t io n s t a n d a r d is in s e c u r e .
E F F p r e s s r e le a s e , J u ly 1 9 9 8 .
N . H a lle r a n d C . M e t z . A o n e - t im e p a s s w o r d
s y s t e m . I n t e r n e t R e q u e s t F o r C o m m e n t s ( R F C )
1 9 3 8 , M a y 1 9 9 6 .
N e il H a lle r . T h e s / k e y ( t m ) o n e - t im e p a s s w o r d
s y s t e m . S y m p o s i u m o n N e t w o r k a n d D i s t r i b u t e d
S y s t e m S e c u r i t y , p a g e s 1 5 1 { 1 5 7 , F e b r u a r y 1 9 9 4 .
f t p :/ / t h u m p e r .b e llc o r e .c o m / p u b / n m h / s k e y / .
N a v a l R e s e a r c h L a b s . O p ie s o f t w a r e d is t r ib u t io n ,
1 9 9 6 . f t p :/ / f t p .n r l.n a v y .m il/ p u b / s e c u r it y / o p ie / .
J o h n B . L a c y . C r y p t o L ib : C r y p t o g r a p h y in s o f t -
w a r e . U S E N I X S e c u r i t y C o n f e r e n c e I V , p a g e s
1 { 1 8 , 1 9 9 3 .
L e s lie L a m p o r t . P a s s w o r d a u t h e n t ic a t io n w it h
in s e c u r e c o m m u n ic a t io n . C o m m u n i c a t i o n s o f t h e
A C M , 2 4 ( 1 1 ) :7 7 0 { 7 7 1 , N o v e m b e r 1 9 8 1 .
D a v id M a r t in , S . R a j a g o p a la n , a n d A v ie l D . R u -
b in . B lo c k in g j a v a a p p le t s a t t h e (cid:12) r e w a ll. P r o c .
I n t e r n e t S o c i e t y S y m p o s i u m o n N e t w o r k a n d D i s -
t r i b u t e d S y s t e m S e c u r i t y , p a g e s 1 6 { 2 6 , 1 9 9 7 .
A .J . M e n e z e s , P . V . O o r s c h o t , a n d S . A . V a n -
s t o n e . H a n d b o o k o f A p p li e d C r y p t o g r a p h y . C R C
P r e s s , 1 9 9 7 .
N a t io n a l B u r e a u o f S t a n d a r d s . D a t a e n c r y p t io n
s t a n d a r d . F e d e r a l I n f o r m a t i o n P r o c e s s i n g S t a n -
d a r d s P u b li c a t i o n , 1 ( 4 6 ) , 1 9 7 7 .
B a r t P r e n e e l a n d P a u l C . v a n O o r s c h o t . O n t h e
s e c u r it y o f it e r a t e d m e s s a g e a u t h e n t ic a t io n c o d e s .
I E E E T r a n s a c t i o n s o n I n f o r m a t i o n t h e o r y , 1 9 9 8 .
R . R iv e s t . T h e m d 5 m e s s a g e d ig e s t a lg o r it h m .
R F C 1 3 2 1 , A p r il 1 9 9 2 .
A v ie l D . R u b in . I n d e p e n d e n t o n e - t im e p a s s -
w o r d s . U S E N I X J o u r n a l o f C o m p u t i n g S y s t e m s ,
9 ( 1 ) , 1 9 9 6 .
A v ie l D . R u b in , D a n ie l G e e r , a n d M a r c u s J .
R a n u m . W e b S e c u r i t y S o u r c e b o o k . J o h n W ile y
& S o n s , I n c ., 1 9 9 7 .
T a t o Y lo n e n . S S H - s e c u r e lo g in c o n n e c t io n s o v e r
t h e in t e r n e t . U S E N I X S e c u r i t y C o n f e r e n c e V I ,
p a g e s 3 7 { 4 2 , 1 9 9 6 .
1 2