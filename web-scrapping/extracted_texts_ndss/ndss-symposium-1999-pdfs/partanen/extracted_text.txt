Distributed Policy Management
for Java 2
ISOC NDSS’99
4-5 February 1999,
San Diego
Jonna Partanen
Helsinki University of Technology
Jonna.Partanen@hut.fiOverview
• Introduction
• Java 2 security model
• Authorization certificates, SPKI
• Using SPKI certificates to improve
Java 2 security policy management
• Implementation
• Conclusions
2 Helsinki University of Technology © Jonna PartanenIntroduction
• We are considering a very large,
distributed Java environment
– Computers
– Cellular phones
– PDAs
• The users want to run software from
many different sources without
compromising security
3 Helsinki University of Technology © Jonna PartanenThe Problem
• How to manage the security policy?
– In a scalable way?
– With minimum dependency of external
security mechanisms?
– In a way transparent to the applications?
4 Helsinki University of Technology © Jonna PartanenProtectionDomains
Security Policy SecureClassLoader
P C
P P C
P C
P
C
C
C
P
C
C
C C
C
C
C
P
P ProtectionDomain
P
P
P P
P P P
JVM
5 Helsinki University of Technology © Jonna PartanenJava 2 Access Control
• When the class tries to access a
protected resource, the
AccessController checks the
permissions in the class’ protection
domain
– The class cannot add permissions to its
protection domain
– The class cannot change its protection
domain
6 Helsinki University of Technology © Jonna PartanenThe Current Solution has
Limitations
• Access rights are defined in local
configuration files
– Changing the policy requires editing the
files
– The files can get very complex
• Access rights are practically static
• How can the administrator know what
access rights a certain class needs?
7 Helsinki University of Technology © Jonna PartanenAuthorization Certificates
• Identity certificates bind a name to a key
– Usually ACLs are then used to define what
the name is allowed to do
• Authorization certificates bind access
rights directly to a key
– Close to the concept of capability
– Can provide anonymity
8 Helsinki University of Technology © Jonna PartanenSPKI Certificates
• Simple Public Key Infrastructure
• Being published as Experimental RFC
• SPKI certificates are signed five-tuples
– Issuer
– Subject
– Delegation
– Tag (i.e. authorization)
– Validity
9 Helsinki University of Technology © Jonna PartanenCertificate Loops
• When authorization is delegated, the
certificates form chains
• When used, the chain is closed into a loop:
A, B, propagate,
Policyadm. Policyadm.
access X, limited
A B
time
A
Self, A, propagate, B, C, limited access
access X, forever to X, forever
B
Self
X Client
Self C
Proves possession of C key
10 Helsinki University of Technology © Jonna PartanenSPKI Certificates for Java
• Issuer, subject, delegation, validity etc.
expressed according to the SPKI specs
• Tag definition is more focused:
tags express Java permission objects
(tag (java-permission
(type java.io.FilePermission)
(target /tmp/myfile) (action read)))
– Tags may also express a set or “any”
permissions
11 Helsinki University of Technology © Jonna PartanenAuthorizing Java Classes
A, D, propagate,
Administrator permission to read SW developer
A key files, this month D key
A
Self, A, propagate, D, h(MyClass), propagate,
all permissions, permission to read file X,
forever forever
Self
D
JVM/Policy Java code
Self key ClassLoader checks MyClass
the hash when MyClass
is loaded
12 Helsinki University of Technology © Jonna PartanenPrototype
• Public interfaces for SPKI certificates
• A Provider that implements the SPKI
certificate functionality
• A Policy that uses dynamic protection
domains and SPKI certificates to grant
permissions
• A simple certificate repository
– Is being replaced with DNS
13 Helsinki University of Technology © Jonna PartanenDistributed ProtectionDomains
• If the protection domains could have
temporary keys, they could delegate
their permissions to other domains
– The JVM must provide the keys
– The JVM must help bind the temporary key
to the object
• For example, a client could authorize an
agent on a server to perform tasks on
its behalf
14 Helsinki University of Technology © Jonna PartanenConclusions
• SPKI certificates can be used to make
Java security policy management
– Secure
– Distributed
– Scalable
– Dynamic
15 Helsinki University of Technology © Jonna Partanen