(cid:3)
E x p e r i m e n t i n g w i t h S h a r e d G e n e r a t i o n o f R S A k e y s
yM i c h a e l M a l k i n T h o m a s W u D a n B o n e h
m i k e y m @ s t a n f o r d . e d u t j w @ c s . s t a n f o r d . e d u d a b o @ c s . s t a n f o r d . e d u
C o m p u t e r S c i e n c e D e p a r t m e n t ,
S t a n f o r d U n i v e r s i t y ,
S t a n f o r d , C A , 9 4 3 0 5 - 9 0 4 5
t u r e g e n e r a t io n ) . T o s h a r e it s p r iv a t e k e y a m o n g fo u rA b s t r a c t
s it e s , t h e C A d o e s t h e fo llo w in g : it p ic k s fo u r r a n d o m
1 4 (cid:0)in t e g e r s d ; : : : ; d in t h e r a n g e [ N ; : : : ; N ] s u c h t h a t
W e d e s c r ib e a n im p le m e n t a t io n o f a d is t r ib u t e d a lg o -
1 2 3 4d + d + d + d = d . E a c h o f t h e s e s h a r e s is t h e n
r it h m t o g e n e r a t e a s h a r e d R S A k e y . A t t h e e n d o f
s t o r e d in a s e p a r a t e lo c a t io n . T o is s u e a c e r t i(cid:12) c a t e ,
t h e c o m p u t a t io n , a n R S A m o d u lu s N = p q is p u b -
t h e C A c r e a t e s a s ig n a t u r e o n a m e s s a g e m b y a s k -
lic ly k n o w n . A ll s e r v e r s in v o lv e d in t h e c o m p u t a t io n id
m o d N . E a c h s it ein g e a c h s it e t o c o m p u t e s = mi
a r e c o n v in c e d t h a t N is a p r o d u c t o f t w o la r g e p r im e s ,
t h e n s e n d s s t o t h e e n t it y r e q u e s t in g t h e c e r t i(cid:12) c a t e .i
h o w e v e r n o n e o f t h e m k n o w t h e fa c t o r iz a t io n o f N .
T h e r e q u e s t in g e n t it y m u lt ip lie s t h e fo u r s ’s t o o b t a ini
I n a d d it io n , a p u b lic e n c r y p t io n e x p o n e n t is p u b lic ly + + +1 2 3 4 dd d d d
= m m o d N . T h u s , a v a lid s ig n a -s = m
k n o w n a n d e a c h s e r v e r h o ld s a s h a r e o f t h e p r iv a t e e x -
t u r e is o b t a in e d . T h e b e a u t y o f t h is s im p le p r o c e d u r e
p o n e n t . S u c h a s h a r in g o f a n R S A k e y h a s m a n y a p -
is t h a t t h e p r iv a t e k e y d is n e v e r r e c o n s t r u c t e d a t a
p lic a t io n s a n d c a n b e u s e d t o s e c u r e s e n s it iv e p r iv a t e
s in g le lo c a t io n . I f a h a c k e r p e n e t r a t e s e v e n t h r e e o f
k e y s . P r e v io u s ly , t h e o n ly k n o w n m e t h o d t o g e n e r -
t h e fo u r s it e s , s h e le a r n s n o in fo r m a t io n a b o u t t h e p r i-
a t e a s h a r e d R S A k e y w a s t h r o u g h a t r u s t e d d e a le r .
v a t e k e y . T o a c h ie v e fa u lt - t o le r a n c e t h e s c h e m e m a y
O u r im p le m e n t a t io n d e m o n s t r a t e s t h e e (cid:11) e c t iv e n e s s o f
b e s lig h t ly m o d i(cid:12) e d s o t h a t a n y 3 - o u t - o f- 4 s it e s c a n
s h a r e d R S A k e y g e n e r a t io n , e lim in a t in g t h e n e e d fo r
is s u e a c e r t i(cid:12) c a t e . I n d e e d , in S E T [1 4 ] t h e p r iv a t e
a t r u s t e d d e a le r .
k e y b e lo n g in g t o t h e r o o t C A is s h a r e d in t h is fa s h io n
a m o n g fo u r e n t it ie s [5 ]. S h a r e d k e y s a r e a ls o u s e d in
t h e O m e g a ( (cid:10) ) p u b lic k e y m a n a g e m e n t s y s t e m d e v e l-
1 I n t r o d u c t i o n
o p e d a t A T & T [1 1 ].
A n im p o r t a n t is s u e le ft o u t o f t h e a b o v e d is c u s s io n
T o p r o t e c t a n R S A p r iv a t e k e y , o n e m a y b r e a k it in t o
is k e y g e n e r a t io n . W h o g e n e r a t e s t h e m o d u lu s N a n d
a n u m b e r o f p ie c e s ( s h a r e s ) a n d s t o r e e a c h p ie c e a t
t r u s t e dt h e p r iv a t e k e y d ? A s im p le s o lu t io n is t o a s k a
a s e p a r a t e lo c a t io n . S e n s it iv e p r iv a t e k e y s , s u c h a s
d e a le r t o g e n e r a t e t w o p r im e s p a n d q , m u lt ip ly t h e m
C e r t i(cid:12) c a t io n A u t h o r it y ( C A ) k e y s , c a n b e p r o t e c t e d
t o g e t N a n d t h e n g e n e r a t e e a n d d . F in a lly , t h e d e a le r
in t h is w a y . F o r t u n a t e ly , fo r t h e R S A c r y p t o s y s t e m it
s p lit s d in t o fo u r p ie c e s a n d s e n d s o n e p ie c e t o e a c h o f
is p o s s ib le t o s h a r e a p r iv a t e k e y a m o n g s e v e r a l s it e s
t h e s it e s . U n fo r t u n a t e ly , a t r u s t e d d e a le r in t r o d u c e s a
w it h o u t h a v in g t o r e c o n s t r u c t t h e k e y in o r d e r t o u s e
s in g le p o in t o f a t t a c k : t h e d e a le r , o r a n y o n e w h o c o m -
it { a C A c a n is s u e c e r t i(cid:12) c a t e s w it h o u t r e c o n s t r u c t in g
p r o m is e s t h e d e a le r , h a s t h e p r iv a t e k e y a n d c a n is -
it s p r iv a t e k e y a t a s in g le lo c a t io n [8 ]. T o e x p la in h o w
s u e fa ls e c e r t i(cid:12) c a t e s . R e c e n t ly , B o n e h a n d F r a n k lin [4 ]
t h is is d o n e w e b r ie (cid:13) y r e c a ll t h e d e t a ils o f t h e R S A
s h o w e d h o w t h r e e ( o r m o r e ) s e r v e r s c a n g e n e r a t e a
s y s t e m . L e t N = p q b e a p r o d u c t o f t w o la r g e p r im e s .
w it h o u ts h a r e d R S A k e y a t r u s t e d d e a le r . T h e y d e -
L e t e b e a p u b lic s ig n a t u r e v e r i(cid:12) c a t io n e x p o n e n t a n d
s c r ib e a n e (cid:14) c ie n t d is t r ib u t e d a lg o r it h m t h a t e n a b le s a
d b e t h e c o r r e s p o n d in g p r iv a t e s ig n in g e x p o n e n t . A
n u m b e r o f s it e s t o jo in t ly g e n e r a t e a s h a r e d k e y s o t h a t
h ip r iv a t e R S A k e y is t h e p a ir d ; N ( o t h e r in fo r m a t io n
n o n e o f t h e m k n o w t h e p r iv a t e k e y d o r t h e fa c t o r iz a -
s u c h a s p a n d q is o ft e n in c lu d e d fo r e (cid:14) c ie n t s ig n a -
t io n o f N . O n c e t h e k e y is g e n e r a t e d it c a n b e u s e d fo r
(cid:3) (cid:24)P r o je c t U R L : h t t p : / / w w w . s t a n f o r d . e d u / d a b o / I T T C d is t r ib u t e d c e r t i(cid:12) c a t e g e n e r a t io n a s d e s c r ib e d a b o v e .
y d a r p aS u p p o r t e d b y c o n t r a c t # F 3 0 6 0 2 -9 7 -C -0 3 2 6 .
1D is t r ib u t e d g e n e r a t io n o f a n R S A m o d u lu s w it h a n
u n k n o w n fa c t o r iz a t io n is u s e fu l in o t h e r c o n t e x t s a s
w e ll. F o r in s t a n c e , in t h e F ia t - S h a m ir a u t h e n t ic a t io n
s c h e m e [7 ] a n u m b e r o f e n t it ie s m a y u s e a c o m m o n
m o d u lu s N = p q fo r a u t h e n t ic a t io n , b u t n o n e o f t h e m
s h o u ld k n o w t h e fa c t o r iz a t io n o f N . T h e o r ig in a l F ia t -
S h a m ir s c h e m e c a lls fo r a t r u s t e d d e a le r t o g e n e r a t e N .
T h e B o n e h - F r a n k lin a lg o r it h m e lim in a t e s t h e n e e d fo r
a t r u s t e d d e a le r in t h is c o n t e x t a s w e ll.
I n t h is p a p e r w e s t u d y t h e p r a c t ic a lit y o f d is t r ib u t e d
g e n e r a t io n o f s h a r e d R S A k e y s . I n o r d e r t o a c h ie v e o p -
t im a l p e r fo r m a n c e w e im p le m e n t e d a n u m b e r o f p r a c -
t ic a l o p t im iz a t io n s t h a t g r e a t ly r e d u c e t h e a lg o r it h m ’s
r u n n in g t im e w h ile s t ill ( p r o v a b ly ) p r e s e r v in g s e c u r it y .
T h e p a p e r d e s c r ib e s o u r im p le m e n t a t io n , in c lu d in g t h e
o p t im iz a t io n s w e u s e d , a n d g iv e s d e t a ile d t im in g m e a -
s u r e m e n t s o n t h e a lg o r it h m ’s p e r fo r m a n c e . O u r r e -
s u lt s d e m o n s t r a t e t h e e (cid:11) e c t iv e n e s s o f s h a r e d R S A k e y
g e n e r a t io n . W e h o p e t h e s e r e s u lt s w ill r e d u c e t h e r e -
lia n c e o n t r u s t e d d e a le r s fo r g e n e r a t in g s h a r e d k e y s .
I n o u r e x p e r im e n t s w e u s e d u p t o (cid:12) v e s e r v e r s t o
g e n e r a t e t h e s h a r e d k e y . C o m m u n ic a t io n b e t w e e n t h e
s e r v e r s is p r o t e c t e d u s in g S S L a s im p le m e n t e d in t h e
S S L e a y p a c k a g e b y E r ic Y o u n g [1 7 ]. T o s t o r e t h e
s h a r e d R S A k e y o n d is k w e d e s ig n e d a n a p p r o p r ia t e
A S N .1 s t r u c t u r e a n d s t o r e t h e k e y in P E M fo r m a t .
O n c e t h e s h a r e d k e y is g e n e r a t e d w e p e r fo r m a n u m -
b e r o f t e s t s t o v e r ify p r o p e r s h a r in g . W e d e s c r ib e t h e
im p le m e n t a t io n in d e t a il in S e c t io n 3 .
D e t a ile d t im in g m e a s u r e m e n t s a r e g iv e n in S e c -
t io n 5 . H e r e w e b r ie (cid:13) y s u m m a r iz e t h e r e s u lt s . O u r
o p t im iz e d im p le m e n t a t io n t a k e s u n d e r 9 1 s e c o n d s o n
a v e r a g e t o g e n e r a t e a 1 0 2 4 b it k e y a m o n g t h r e e s e r v e r s
u s in g 3 3 3 M H z P e n t iu m m a c h in e s o n a 1 0 M b p s E t h e r -
n e t . D u r in g t h e e x e c u t io n o f t h e a lg o r it h m e a c h s e r v e r
s e n d s a p p r o x im a t e ly 1 .2 M b o f d a t a a c r o s s t h e n e t w o r k .
A s a n e x p e r im e n t w e a ls o r a n o u r d is t r ib u t e d c o m p u -
t a t io n a c r o s s t h e c o n t in e n t b y u s in g s e r v e r s lo c a t e d a t
v a r io u s p la c e s in t h e U S . W e w e r e a b le t o g e n e r a t e a
1 0 2 4 b it s h a r e d R S A k e y in u n d e r 6 m in u t e s . S u c h a
c o n (cid:12) g u r a t io n m a y b e u s e d w h e n t h e s h a r e s o f a s h a r e d
R S A k e y m u s t b e s t o r e d in r e m o t e lo c a t io n s . T h e o p -
t im iz a t io n s w e u s e d t o a c h ie v e t h is p e r fo r m a n c e a r e
d e s c r ib e d in S e c t io n 4 .
T h e a lg o r it h m c a n b e e a s ily m a d e r o b u s t a g a in s t
a n a t t a c k e r w h o is a b le t o c o r r u p t o n e o f t h e s e r v e r s
d u r in g k e y g e n e r a t io n . T h e a t t a c k e r c a n d is r u p t k e y
g e n e r a t io n ( a n d c o n s e q u e n t ly b e d e t e c t e d ) . H o w e v e r ,
if a s h a r e d k e y is g e n e r a t e d , t h e a t t a c k e r w ill n o t k n o w
t h e fa c t o r iz a t io n o f N o r t h e p r iv a t e k e y d . W e d is c u s s
t h is is s u e in S e c t io n 6 .
2
2 O v e r v i e w
B e fo r e d e s c r ib in g o u r im p le m e n t a t io n a n d t h e p r a c t i-
c a l o p t im iz a t io n s w e b r ie (cid:13) y d e s c r ib e t h e a lg o r it h m fo r
g e n e r a t in g s h a r e d R S A k e y s . T h e a lg o r it h m is s o m e -
w h a t c o m p le x a n d h e r e w e o n ly g iv e a h ig h - le v e l d e -
s c r ip t io n . F o r a d e t a ile d e x p la n a t io n a lo n g w it h p r o o fs
o f s e c u r it y s e e [4 ].
T h e g o a l is t o e n a b le k s e r v e r s t o g e n e r a t e a m o d -
u lu s N = p q a n d e x p o n e n t s e a n d d . A t t h e e n d o f
t h e c o m p u t a t io n a ll s e r v e r s s h o u ld b e c o n v in c e d t h a t
N is t h e p r o d u c t o f t w o p r im e s , h o w e v e r n o n e o f t h e m
s h o u ld k n o w t h e fa c t o r iz a t io n . F u r t h e r m o r e , e s h o u ld
b e p u b lic w h ile d s h o u ld b e s h a r e d a m o n g t h e s e r v e r s
in a w a y t h a t e n a b le s t - o u t - o f- k t h r e s h o ld s ig n a t u r e
g e n e r a t io n . T h a t is , a n y t s e r v e r s s h o u ld b e a b le t o is -
s u e a c e r t i(cid:12) c a t e ( w it h o u t r e c o n s t r u c t in g t h e k e y d ) . A t
(cid:0)t h e s a m e t im e , a n a t t a c k e r w h o p e n e t r a t e s a t m o s t t 1
s e r v e r s s h o u ld n o t b e a b le t o o b t a in a n y in fo r m a t io n
a b o u t t h e p r iv a t e k e y . O u r k e y g e n e r a t io n a lg o r it h m
p r o c e e d s in a n u m b e r o f s t e p s . A t a h ig h le v e l t h e s e
s t e p s a r e a s fo llo w s :
( 1 ) p i c k c a n d i d a t e s : E a c h o f t h e k s e r v e r s p ic k s t w o
r a n d o m n - b it in t e g e r s p ; q a n d k e e p s t h e m s e c r e t .i i
( 2 ) c o m p u t e N : U s in g a p r iv a t e d is t r ib u t e d c o m p u -
t a t io n t h e k s e r v e r s c o m p u t e
1 1(cid:1)N = ( p + : : : + p ) ( q + : : : + q )k k
O t h e r t h a n t h e v a lu e o f N , t h is s t e p r e v e a ls n o
1in fo r m a t io n a b o u t t h e s e c r e t v a lu e s p ; : : : ; p a n dk
1q ; : : : ; q . N o w t h a t N is p u b lic , t h e k s e r v e r s a p -k
p ly t r ia l d iv is io n t o e n s u r e t h a t N is n o t d iv is ib le
b y s m a ll p r im e s .
( 3 ) p r i m a l i t y t e s t : T h e k s e r v e r s e n g a g e in a p r i-
v a t e d is t r ib u t e d c o m p u t a t io n t o t e s t t h a t N is t h e
p r o d u c t o f t w o p r im e s . I f t h e t e s t fa ils , t h e p r o t o -
c o l is r e s t a r t e d fr o m s t e p 1 . A s b e fo r e , t h is s t e p
r e v e a ls n o in fo r m a t io n a b o u t t h e p r iv a t e s h a r e s .
( 4 ) k e y g e n e r a t i o n : G iv e n a p u b lic e n c r y p t io n e x -
p o n e n t e , t h e s e r v e r s u s e a p r iv a t e d is t r ib u t e d c o m -
s h a r e dp u t a t io n t o g e n e r a t e a s e c r e t d e c r y p t io n e x -
p o n e n t d .
B e fo r e d e s c r ib in g h o w e a c h o f t h e s t e p s is im p le -
m e n t e d w e e x p la in t h e s e c u r it y fe a t u r e s a c h ie v e d b y
t h e p r o t o c o l.
1k (cid:0)
b cC o l l u s i o n T h e a lg o r it h m is p r iv a t e . T h a t is ,2
1k (cid:0)
b ce v e n if s e r v e r s s h a r e t h e in fo r m a t io n t h e y2le a r n d u r in g t h e p r o t o c o l, t h e y w ill s t ill n o t b e a b le
t o r e c o v e r t h e fa c t o r iz a t io n o f N o r t h e p r iv a t e k e y
d . H e n c e , w h e n t h r e e o r fo u r s e r v e r s a r e in v o lv e d ,
n o s in g le s e r v e r h a s a n y in fo r m a t io n . W h e n (cid:12) v e
s e r v e r s a r e u s e d , n o p a ir le a r n s a n y t h in g .
H o n e s t p a r t i e s I n t h is s e c t io n w e a s s u m e a ll s e r v e r s
a r e h o n e s t ly fo llo w in g t h e p r o t o c o l. T h is m o d e l is
h o n e s t b u t c u r io u s p a r t ie so ft e n c a lle d | c u r io u s
p a r t ie s le a r n n o t h in g fr o m t h e p r o t o c o l. I n S e c -
t io n 6 w e e x p la in h o w t h e p r o t o c o l c a n b e m a d e
r o b u s t a g a in s t m a lic io u s p a r t ic ip a n t s . T e c h n iq u e s
fo r a c h ie v in g s t r o n g e r r o b u s t n e s s p r o p e r t ie s a r e d e -
s c r ib e d in [9 ].
P r i v a t e a n d a u t h e n t i c a t e d c h a n n e l s T h e c o n -
n e c t io n b e t w e e n s e r v e r i a n d s e r v e r j m u s t b e
s e c u r e . O t h e r w is e , a n a d v e r s a r y c a n t a p a ll
c o m m u n ic a t io n a n d e x p o s e c r it ic a l in fo r m a t io n .
O u r s y s t e m im p le m e n t s p r iv a t e c h a n n e l u s in g t h e
S S L p r o t o c o l a s d e s c r ib e d in S e c t io n 3 .
N2 . 1 D i s t r i b u t e d c o m p u t a t i o n o f
F o r c o m p le t e n e s s , t h e n e x t t h r e e s u b s e c t io n s d e s c r ib e
s t e p s ( 2 ) { ( 4 ) o f t h e a lg o r it h m . T h e r e a d e r m a y s k ip
t o S e c t io n 3 a n d r e fe r b a c k t h e s e s u b s e c t io n s a s n e c e s -
s a r y .
W e b e g in b y d e s c r ib in g t h e p r iv a t e c o m p u t a t io n o f
N ( S t e p 2 ) . E a c h s e r v e r h a s a s e c r e t p ; q . T h e y w is hi i
t o m a k e t h e p r o d u c t N = ( p ) ( q ) p u b lic w it h o u ti i
r e v e a lin g a n y in fo r m a t io n a b o u t t h e ir p r iv a t e s h a r e sP P
b e y o n d w h a t is r e v e a le d b y t h e k n o w le d g e o f N . O u r
t e c h n iq u e is a p r a c t ic a l a d a p t a t io n o f a g e n e r ic s e c u r e
c ir c u it e v a lu a t io n p r o t o c o l d u e t o B e n O r , G o ld w a s s e r
a n d W ig d e r s o n ( B G W ) [1 ]. F r o m h e r e o n , le t P > N
b e s o m e p r im e . U n le s s o t h e r w is e s t a t e d , a ll a r it h m e t ic
o p e r a t io n s a r e d o n e m o d u lo P . T h e p r o t o c o l w o r k s a s
fo llo w s :
1k (cid:0)
b cS t e p 1 : L e t l = . F o r a ll i = 1 ; : : : ; k s e r v e r2
2i p ic k s t w o r a n d o m d e g r e e l p o ly n o m ia ls f ; gi i
Z [x ] s a t is fy in g f ( 0 ) = p a n d g ( 0 ) = q . I n o t h e rP i i i i
w o r d s , t h e c o n s t a n t t e r m o f f ; g a r e s e t t o p ; qi i i i
a n d a ll o t h e r c o e (cid:14) c ie n t s a r e c h o s e n a t r a n d o m . I n
a d d it io n , e a c h s e r v e r i p ic k s a r a n d o m d e g r e e 2 l
Z2p o ly n o m ia l h [x ] s a t is fy in g h ( 0 ) = 0 .i P i
S t e p 2 : F o r a ll i = 1 ; : : : ; k s e r v e r i c o m p u t e s
8 j = 1 ; : : : ; k : p = f ( j )i;j i
q = g ( j )i;j i
h = h ( j )i;j i
3
S e r v e r i t h e n p r iv a t e ly s e n d s t h e t r ip le
h i 6p ; q ; h t o s e r v e r j fo r a ll j = i . N o t ei;j i;j i;j
t h a t t h e p fo r j = 1 ; : : : ; k a r e s t a n d a r d l - o u t - o f-i;j
k S h a m ir s e c r e t s h a r in g s o f p . T h e s a m e h o ld s fo ri
q .i
S t e p 3 : A t t h is p o in t , e a c h s e r v e r i h a s a ll o f
h ip ; q ; h fo r j = 1 ; : : : ; k . S e r v e r i c o m p u t e s :j ;i j ;i j ;i
k kk
(cid:1) q + h ( m o d P )pN = j ;i j ;ij ;ii 11 00
= 1 = 1= 1 j jj X XX
AA @@
S e r v e r i b r o a d c a s t s N t o a ll o t h e r s e r v e r s .i
S t e p 4 : A t t h is p o in t e a c h s e r v e r j h a s a ll v a lu e s N i
fo r i = 1 ; : : : ; k . L e t (cid:11) ( x ) b e t h e p o ly n o m ia l
(cid:11) ( x ) = ( f ( x ) ) ( g ( x ) ) + h ( x ) ( m o d P )j j j
j j jX X X
O b s e r v e t h a t (cid:11) ( i ) = N a n d b y d e (cid:12) n it io n o f f ; gi i i
a n d h w e h a v e (cid:11) ( 0 ) = N . F u r t h e r m o r e , (cid:11) ( x ) is ai
p o ly n o m ia l o f d e g r e e 2 l . W e n o t e t h a t l is d e (cid:12) n e d s o
(cid:21)t h a t k 2 l + 1 . S in c e a ll s e r v e r s h a v e a t le a s t 2 l + 1
p o in t s o n (cid:11) ( x ) t h e y c a n in t e r p o la t e it a n d d is c o v e r
it s c o e (cid:14) c ie n t s . F in a lly , e a c h s e r v e r e v a lu a t e s (cid:11) ( 0 )
a n d o b t a in s N m o d P . S in c e N < P t h e s e r v e r s
le a r n t h e c o r r e c t v a lu e o f N .
F r o m t h e d e s c r ip t io n o f t h e p r o t o c o l it is c le a r t h a t
a ll s e r v e r s le a r n t h e v a lu e N . T h e p r o t o c o l r e q u ir e s
t h a t a t le a s t t h r e e s e r v e r s b e in v o lv e d , in w h ic h c a s e
lin e a r p o ly n o m ia ls a r e u s e d a n d t h e p r o t o c o l is 1 -
p r iv a t e . T h e fo llo w in g le m m a s t a t e s t h a t a c o a lit io n
1k (cid:0)
cb s e r v e r s le a r n s n o o t h e r in fo r m a t io n a b o u t t h eo f 2
p r iv a t e s h a r e s . T h is s t a t e m e n t h o ld s in t h e in fo r m a -
t io n t h e o r e t ic s e n s e { n o c o m p le x it y a s s u m p t io n s a r e
n e e d e d .
1k (cid:0)
G iv e n , a n y c o a lit io n o f s e r v e r sb cL e m m a 2 . 1 N 2
c a n s im u la t e t h e t r a n s c r ip t o f t h e p r o t o c o l. C o n s e -
1k (cid:0)
p r iv a t e .q u e n t ly , t h e p r o t o c o l is cb 2
2 . 1 . 1 S h a r i n g t h e (cid:12) n a l o u t c o m e
I n s o m e c a s e s ( a s in S e c t io n 4 .1 ) w e w is h t o h a v e t h e
s e r v e r s e v a lu a t e t h e fu n c t io n N = ( p ) ( q ) ; h o w -i i
e v e r t h e r e s u lt s h o u ld b e a d d it iv e ly s h a r e d a m o n g t h eP P
s e r v e r s r a t h e r t h a n b e c o m e p u b lic ly a v a ila b le . T h a t
is , a t t h e e n d o f t h e c o m p u t a t io n e a c h s e r v e r s h o u ld
h a v e a n M s u c h t h a ti
k k k
M = ( p ) ( q ) ( m o d P )i i i
= 1 = 1 = 1i i iX X Xa n d n o in fo r m a t io n is r e v e a le d a b o u t t h e p r iv a t e s h a r e s
o r t h e (cid:12) n a l r e s u lt .
T h e m o d i(cid:12) c a t io n t o B G W in o r d e r t o a c h ie v e t h e
a b o v e g o a l is im m e d ia t e . T h e s e r v e r s d o n o t p e r fo r m
S t e p 4 o f t h e p r o t o c o l a n d d o n o t p e r fo r m t h e b r o a d -
c a s t d e s c r ib e d a t t h e e n d o f S t e p 3 . C o n s e q u e n t ly , t h e y
e a c h e n d u p w it h a p o in t o n a p o ly n o m ia l (cid:11) ( x ) o f d e -
g r e e 2 l t h a t e v a lu a t e s t o N a t x = 0 . U s in g L a g r a n g e
in t e r p o la t io n w e k n o w t h a t
k
N = (cid:11) ( 0 ) = (cid:21) ( 0 ) N m o d Pi i
= 1iX
(cid:0) (cid:0)w h e r e (cid:21) ( x ) = ( x j ) = ( i j ) is t h e a p p r o p r ia t ei =j 6 i
L a g r a n g e c o e (cid:14) c ie n t . T h e r e fo r e , r a t h e r t h a n b r o a d c a s tQ
N a t t h e e n d o f S t e p 3 , s e r v e r i s im p ly s e t s M =i i
(cid:21) ( 0 ) N . T h e r e s u lt in g M ’s a r e a n a d d it iv e s h a r in g o fi i i
N a s r e q u ir e d .
2 . 2 D i s t r i b u t e d p r i m a l i t y t e s t
W e d e s c r ib e a s im p li(cid:12) e d v e r s io n o f t h e d is t r ib u t e d p r i-
m a lit y t e s t ( S t e p 3 ) . S e r v e r i h a s t w o s e c r e t n - b it
in t e g e r s p ; q . A t t h is p o in t , a ll s e r v e r s k n o w N w h e r ei i
N = p q = ( p ) ( q ) . T h e y w is h t o d e t e r m in e ifi i
N is t h e p r o d u c t o f t w o p r im e s w it h o u t r e v e a lin g a n yP P
in fo r m a t io n a b o u t t h e fa c t o r s o f N .
D i s t r i b u t e d p r i m a l i t y t e s t :
(cid:3)Z2S
t e p 1 : T h e s e r v e r s p ic k a r a n d o m g . T h eN
v a lu e g is k n o w n t o a ll k s e r v e r s .
+ 11 1N (cid:0) p (cid:0) q
1S t e p 2 : S e r v e r 1 c o m p u t e s v = g m o d N .
+i ip q
m o d N . T h eA ll o t h e r s e r v e r s c o m p u t e v = gi
s e r v e r s e x c h a n g e t h e v v a lu e s w it h e a c h o t h e r a n di
v e r ify t h a t
k
1v = v ( m o d N )i
= 2iY
I f t h e t e s t fa ils t h e n t h e s e r v e r s d e c la r e t h a t N is
n o t a p r o d u c t o f t w o p r im e s . O t h e r w is e , t h e y d e -
c la r e s u c c e s s .
W e r e f e r t o t h e a b o v e t e s t a s a F e r m a t t e s t fo r t e s t -
in g t h a t a n u m b e r is a p r o d u c t o f t w o p r im e s . E s s e n -
t ia lly , w h a t is b e in g t e s t e d is t h a t
+ 1N (cid:0) p (cid:0) q
g = 1 ( m o d N )
n o tN o t e t h a t t h e r e e x is t N t h a t a r e a p r o d u c t o f
t w o p r im e s y e t t h e y a lw a y s p a s s t h e t e s t . T h e d e n -
s it y o f s u c h in t e g e r s is e x t r e m e ly s m a ll ( le s s t h a n 1 in
4
1
a
d
N
B
n
o
s
p
t
2
O
u
s
e
e
a
w
q
T
e
g
p
t
S
S
S
4 0
0 ) [1 2 ]. A fu ll p r o b a b ilis t ic p r im a lit y t e s t ( t h a t o n ly
d m it s in t e g e r s t h a t a r e a p r o d u c t o f t w o p r im e s ) w a s
e s ig n e d b y B o n e h a n d F r a n k lin [4 ]. O n c e a n in t e g e r
t h a t p a s s e s t h e F e r m a t t e s t a b o v e is fo u n d , t h e fu ll
o n e h - F r a n k lin t e s t c a n b e a p p lie d t o e n s u r e t h a t t h e
u m b e r is in d e e d a p r o d u c t o f t w o p r im e s . C u r r e n t ly
u r im p le m e n t a t io n o n ly t e s t s t h e n u m b e r u s in g t h e
im p le F e r m a t t e s t p r o t o c o l a b o v e .
W h e n N is t h e p r o d u c t o f t w o d is t in c t p r im e s , t h e
r im a lit y t e s t p r o t o c o l r e v e a ls n o in fo r m a t io n a b o u t
h e p r iv a t e s h a r e s o f t h e p a r t ic ip a n t s .
. 3 S h a r e d g e n e r a t i o n o f p u b l i c a n d
p r i v a t e k e y s
n c e t h e s e r v e r s s u c c e s s fu lly c o n s t r u c t a n R S A m o d -
lu s N = p q = ( p ) ( q ) t h e y w is h t o c o m p u t ei i
1(cid:0)
h a r e s o f d = e m o d (cid:30) ( N ) fo r a g iv e n e n c r y p t io nP P
x p o n e n t e ( S t e p 4 ) . A t t h e e n d o f t h e c o m p u t a t io n
a c h s e r v e r s h o u ld h a v e a d s u c h t h a t d = d . T h e r ei i
r e t w o a p p r o a c h e s fo r d o in g s o . T h e (cid:12) r s t a p p r o a c hP
2 0
o r k s fo r s m a ll e ( s a y e < 2 ) b u t is v e r y e (cid:14) c ie n t r e -
u ir in g v e r y lit t le c o m m u n ic a t io n b e t w e e n t h e s e r v e r s .
h e s e c o n d w o r k s fo r a n y e a n d is s t ill e (cid:14) c ie n t , h o w -
v e r it r e q u ir e s m o r e c o m m u n ic a t io n . S in c e s ig n a t u r e
e n e r a t io n u s u a lly m a k e s u s e o f a s m a ll R S A p u b lic e x -
o n e n t ( s o t h a t s ig n a t u r e v e r i(cid:12) c a t io n is fa s t ) w e c h o s e
o im p le m e n t t h e (cid:12) r s t a p p r o a c h a s d e s c r ib e d b e lo w .
1 1 1(cid:0) (cid:0)t e p 1 : S e r v e r 1 lo c a lly c o m p u t e s (cid:30) = N p q + 1 .
(cid:0) (cid:0)A ll o t h e r s e r v e r s lo c a lly c o m p u t e (cid:30) = p q .i i i
O b s e r v e t h a t (cid:30) ( N ) = (cid:30) .i
P
t e p 2 : T h e s e r v e r s jo in t ly d e t e r m in e t h e v a lu e o f
‘ = (cid:30) ( N ) m o d e . S in c e ‘ = (cid:30) m o d e , it is p o s -i
s ib le t o c o m p u t e ‘ w it h o u t r e v e a lin g a n y o t h e r in -P
fo r m a t io n a b o u t t h e p r iv a t e s h a r e s . T o d o s o w e
u s e a s im p le p r o t o c o l d u e t o B e n a lo h [3 ] w h ic h
(cid:0)is k 1 p r iv a t e : e a c h s e r v e r i c r e a t e s a n a d d i-
t iv e s h a r in g o f (cid:30) , n a m e ly (cid:30) = (cid:13) m o d ei i i;jj
fo r r a n d o m (cid:13) . I t t h e n s e n d s (cid:13) t o s e r v e r j .i;j i;jP
S e r v e r j n o w h a s (cid:13) fo r a ll i . I t c o m p u t e s t h ei;j
s u m (cid:11) = (cid:13) m o d e a n d s e n d s (cid:11) t o a ll o t h e rj i;j ji
s e r v e r s . T h e n e a c h s e r v e r lo c a lly c o m p u t e s (cid:11) jP j
w h ic h s a t is (cid:12) e s (cid:11) = (cid:30) = ‘ m o d e .j j Pj
P P1(cid:0)
t e p 3 : L e t (cid:16) = ‘ m o d e . T h e n , it is n o t d i(cid:14) c u lt
(cid:0) (cid:1)t o s e e t h a t d = ( (cid:16) (cid:30) + 1 ) = e . E a c h p a r t y i lo c a lly
c o m p u t e s :
(cid:0) (cid:1)(cid:16) (cid:30) i
d =i
(cid:22) e (cid:23)
A s a r e s u lt w e h a v e d = d + r m o d (cid:30) ( N ) w h e r ei
(cid:20)0 r < k . PS t e p 4 : T h e a b o v e s h a r in g o f d e n a b le s
s h a r e d d e c r y p t io n [8 ] u s in g t h e e q u a lit y
id r d
(cid:17)c c c m o d N . S e r v e r 1 d e t e r -
m in e s t h e v a lu e o f r b y t r y in g a ll p o s s ib le v a lu e sQ
(cid:20) (cid:20)o f 0 r k d u r in g a t r ia l d e c r y p t io n . I t t h e n
1s u b t r a c t s r fr o m it s o w n s h a r e d .
T h e a b o v e a p p r o a c h le a k s ‘ = (cid:30) ( N ) m o d e a n d r .
T h is is a t o t a l o f lo g e + lo g k b it s . A s a r e s u lt t h is2 2
a p p r o a c h o n ly w o r k s fo r s m a ll e . I n o u r im p le m e n t a -
t io n w e u s e e = 6 5 5 3 7 , a s t a n d a r d s m a ll p u b lic e x p o -
n e n t . W e e m p h a s iz e t h a t a n a lt e r n a t e a p p r o a c h w o r k s
fo r a ll e a n d d o e s n ’t le a k a n y in fo r m a t io n ( s e e [4 ]) . W e
c h o s e n o t t o im p le m e n t it s in c e it is m o r e c o s t ly .
t k2 . 4 - o u t - o f - s h a r i n g
T h e p r e v io u s s u b s e c t io n e x p la in s h o w w e o b t a in a
k - o u t - o f- k s h a r in g o f d . H o w e v e r , t o p r o v id e fa u lt -
t o le r a n c e it is o ft e n d e s ir a b le t o h a v e a t - o u t - o f- k s h a r -
in g e n a b lin g a n y s u b s e t o f t s e r v e r s t o a p p ly t h e p r iv a t e
k e y . W e e x p la in h o w t o a c h ie v e 2 - o u t - o f- 3 s h a r in g o f
t h e R S A k e y . T h is a p p r o a c h g e n e r a liz e s t o a n y t - o u t -
o f- k a s lo n g a s k is n o t t o o b ig ( e .g . k < 2 0 ) . S t a n d a r d
S h a m ir s e c r e t s h a r in g [1 5 ] is in a d e q u a t e s in c e t h e p r i-
v a t e k e y w o u ld h a v e t o b e r e c o n s t r u c t e d a t a s in g le
lo c a t io n in o r d e r fo r it t o b e u s e d .
W e (cid:12) r s t e x p la in t h e s t r u c t u r e o f a 2 - o u t - o f- 3 R S A
s ig n a t u r e g e n e r a t io n s c h e m e . W r it e t h e p r iv a t e k e y d
1 2 3 4 1 2 3 4a s d = d + d = d + d w h e r e d ; d ; d ; d a r e r a n d o m
(cid:0)in t e g e r s in [ N ; N ]. E a c h o f t h e t h r e e s e r v e r is g iv e n
s h a r e s a c c o r d in g t o t h e fo llo w in g t a b le :
S 1 S 2 S 3
1 2 1d d d
3 4d d
O b s e r v e t h a t a n y p a ir o f s e r v e r s c a n g e n e r a t e a s ig -
n a t u r e ( w it h o u t h a v in g t o r e c o n s t r u c t t h e k e y ) . N o
s in g le s e r v e r h a s a n y in fo r m a t io n a b o u t d . T h e p r i-
v a t e s h a r e o f t h e k e y g iv e n t o e a c h s e r v e r is c o m p o s e d
o f N a n d a lis t o f d ’s . A s a r e s u lt , in t h e im p le m e n -i
t a t io n w e d e (cid:12) n e a n e w A S N .1 p r iv a t e k e y s t r u c t u r e ,
a s d e s c r ib e d in S e c t io n 3 .2 . W e n o t e t h a t a n a lt e r -
n a t e a p p r o a c h t o a t - o u t - o f- k s h a r in g o f a n R S A k e y
is d e s c r ib e d in [1 3 ].
W e c a n n o w e x p la in h o w a t - o u t - o f- k s h a r in g o f d
a s a b o v e c a n b e g e n e r a t e d b y t h e s e r v e r s t h e m s e lv e s
( w it h o u t a t r u s t e d d e a le r ) . O n c e t h e s e r v e r s g e n e r a t e
a k - o u t - o f- k s h a r in g ( a s e x p la in e d in t h e p r e v io u s s e c -
t io n ) t h e y c a n e a s ily c o n v e r t it in t o a t - o u t - o f- k s h a r in g
a s fo llo w s : e a c h s e r v e r i c o n s t r u c t s a t - o u t - o f- k s h a r in g
5
( a s t h e a b o v e t a b le ) o f it s o w n s h a r e d . I t t h e n s e n d si
t o s e r v e r j t h e s h a r e s o f d t h a t b e lo n g t o j . F in a lly ,i
e a c h s e r v e r a d d s u p a ll t h e s h a r e s it r e c e iv e d fr o m t h e
o t h e r s e r v e r s . T h e r e s u lt in g d ’s a r e a t - o u t - o f- k s h a r -i
in g o f d .
3 I m p l e m e n t a t i o n d e t a i l s
O u r im p le m e n t a t io n c o n s is t s o f t w o in d e p e n d e n t c o m -
p o n e n t s . T h e (cid:12) r s t is a c o m m u n ic a t io n s p a c k a g e
( C O M ) t h a t a b s t r a c t s lo w le v e l c o m m u n ic a t io n s . I t
p r o v id e s e n c r y p t e d lin k s b e t w e e n s e r v e r s a s w e ll a s a
c o n v e n ie n t in t e r fa c e fo r s e n d in g a b s t r a c t d a t a t y p e s ,
s u c h a s la r g e n u m b e r s , o v e r t h e n e t w o r k . T h e s e c -
o n d c o m p o n e n t is t h e a lg o r it h m m o d u le ( G E N ) t h a t
im p le m e n t s t h e k e y g e n e r a t io n a lg o r it h m . O u r c o d e is
w r it t e n in C fo r h ig h p e r fo r m a n c e a n d e a s y in t e g r a t io n
in t o e x is t in g p r o d u c t s .
3 . 1 C o m m u n i c a t i o n s p a c k a g e
T h e c lie n t s a n d s e r v e r s u s e a c o m m u n ic a t io n s p a c k a g e
b a s e d o n S S L t o e n s u r e t h e a u t h e n t ic it y a n d c o n (cid:12) d e n -
t ia lit y o f c o n n e c t io n s . T h e c o m m u n ic a t io n s p a c k a g e
h a n d le s t h e fo llo w in g t a s k s in t e r n a lly :
(cid:15) T u n n e lin g c o m m u n ic a t io n s u s in g a n u n d e r ly in g s e -
c u r e t r a n s p o r t , lik e S S L .
(cid:15) P r o v id in g a n in t u it iv e , p la t fo r m - in d e p e n d e n t in t e r -
fa c e fo r r e a d in g a n d w r it in g a b s t r a c t d a t a t y p e s ,
lik e la r g e in t e g e r s .
(cid:15) M a n a g in g a la r g e n u m b e r o f s im u lt a n e o u s n e t w o r k
c o n n e c t io n s a n d p r e s e n t in g a s im p li(cid:12) e d n e t w o r k in g
A P I fo r h ig h e r - le v e l c o d e .
(cid:15) H a n d lin g t r a n s p a r e n t e n d - t o - e n d a u t h e n t ic a t io n
u s in g t e c h n iq u e s s u c h a s c e r t i(cid:12) c a t e s a n d s e q u e n c e
n u m b e r s .
(cid:15) M a x im iz in g e (cid:14) c ie n c y b y t a k in g a d v a n t a g e o f
b u (cid:11) e r in g a n d n o n b lo c k in g I / O .
I n s h o r t , t h e p a c k a g e e n s u r e s t h a t t h e u n d e r ly in g
p r o t o c o l s e c u r it y a s s u m p t io n s m e n t io n e d e a r lie r a r e
m e t w h ile a b s t r a c t in g a w a y t h e c o m p le x it ie s o f a s y n -
c h r o n o u s n e t w o r k in g a n d a n y o p t im iz a t io n s w e im p le -
m e n t a t t h e c o m m u n ic a t io n s le v e l.
A c o n (cid:12) g u r a t io n (cid:12) le , w h ic h is r e a d u p o n p r o g r a m
s t a r t u p , c o n t a in s n e t w o r k s e t t in g s fo r t h e c lie n t s a n d
s e r v e r s , s u c h a s I P a d d r e s s e s , p o r t n u m b e r s , a n d p a t h -
n a m e s . I n s t e a d o f r e q u ir in g e a c h p r o g r a m t o k n o w a llt h e d e t a ils o f e a c h s e r v e r , t h e A P I a llo w s s e r v e r s t o b e
r e fe r e n c e d d ir e c t ly b y n u m b e r . T h e c o m m u n ic a t io n
p a c k a g e t a k e s c a r e o f t h e m a p p in g s b e t w e e n s e r v e r
n u m b e r a n d a d d r e s s / p o r t in fo r m a t io n . I n a d d it io n ,
it h a n d le s p e e r id e n t i(cid:12) c a t io n t r a n s p a r e n t ly , s o t h a t a
s e r v e r k n o w s t h e id e n t it y o f a n y c lie n t s t h a t c o n t a c t
it .
3 . 1 . 1 A u t h e n t i c a t i o n
A s s t a t e d e a r lie r , t h e c o m m u n ic a t io n s p a c k a g e is b a s e d
o n E r ic Y o u n g ’s S S L e a y [1 7 ] p a c k a g e . C lie n t a n d
s e r v e r c e r t i(cid:12) c a t e s a r e is s u e d b y a p r iv a t e C A , w h o s e
p u b lic k e y is d is t r ib u t e d b y h a n d t o a ll c lie n t s a n d
s e r v e r s b e fo r e h a n d . E a c h p a r t y h a s it s o w n c e r t i(cid:12) c a t e ,
s ig n e d b y t h is C A , w h ic h c o n t a in s it s o w n id e n t it y a s
p a r t o f t h e s ig n e d c e r t i(cid:12) c a t e d a t a . F o r e x a m p le , t h e
c e r t i(cid:12) c a t e fo r s e r v e r 0 h a s a s u b je c t (cid:12) e ld t h a t lo o k s
lik e :
/ C = U S / S T = C a l i f o r n i a / O = S t a n f o r d U n i v e r s i t y /
O U = I T T C P r o j e c t / C N = [ S E R V E R 0 ]
T h e n a m e (cid:12) e ld c o n t a in s t h e a u t h e n t ic a t e d id e n t it y
o f t h e p a r t y , w h ic h c a n b e v e r i(cid:12) e d b y c lie n t s a n d o t h e r
s e r v e r s .
A t t h e m o m e n t o u r a p p r o a c h t o a u t h e n t ic a t io n is
a d - h o c . A ft e r a ll, t h e m e t h o d o f a u t h e n t ic a t io n d e -
p e n d s o n t h e e n v ir o n m e n t in w h ic h o u r s y s t e m is u s e d .
F o r in s t a n c e , w h e n g e n e r a t in g a C A p r iv a t e k e y , a u -
t h e n t ic a t io n c a n b e d o n e u s in g c e r t i(cid:12) c a t e s g e n e r a t e d
b y a h ig h e r le v e l C A . F o r a r o o t C A a u t h e n t ic a t io n
c a n b e d o n e u s in g t h e c u r r e n t C A r o o t k e y . I n o t h e r
e n v ir o n m e n t s w h e r e s h a r e d k e y s a r e u s e d a u t h e n t ic a -
t io n c a n b e d o n e u s in g s t a n d a r d c e r t i(cid:12) c a t e s is s u e d b y
a C A .
I n a d d it io n t o c e r t i(cid:12) c a t e a u t h e n t ic a t io n , t h e c o m -
m u n ic a t io n s p a c k a g e k e e p s t r a c k o f s e q u e n c e n u m b e r s
fo r e a c h p a ir o f p a r t ie s . T h is a llo w s t h e s y s t e m t o
d e t e c t w h e n a p r iv a t e k e y is c o m p r o m is e d a n d u s e d ,
s in c e t h is w o u ld in t r o d u c e a s k e w b e t w e e n t h e s e -
q u e n c e n u m b e r s h e ld b y t h e s e r v e r s a n d t h e le g it im a t e
c lie n t .
3 . 1 . 2 M u l t i p a r t y I / O
T h e r e a r e m a n y in s t a n c e s w h e r e c o n v e n t io n a l n e t w o r k
p r o g r a m m in g c a n le a d t o c o n s id e r a b le im p le m e n t a t io n
in e (cid:14) c ie n c ie s , e v e n u n d e r n o r m a l u s a g e . C o n s id e r a n
a p p lic a t io n o f t h r e s h o ld d e c r y p t io n w h e n o n e o f t h e
s e r v e r s h a s fa ile d . O n e o f t h e b e n e (cid:12) t s o f t h r e s h o ld
d e c r y p t io n is t h e a b ilit y t o t o le r a t e t h e lo s s o f o n e o r
m o r e s h a r e s . H o w e v e r , if o n e n a iv e ly a t t e m p t s t o c o n -
6
n e c t t o e a c h s e r v e r in s e r ie s , t h e p r o c e d u r e w ill s t a ll
w h e n t h e n o n - fu n c t io n in g s e r v e r is r e a c h e d .
n o n -I n s t e a d , t h e c o m m u n ic a t io n s p a c k a g e u s e s
b lo c k in g I / O u n d e r n e a t h t o a lle v ia t e t h is p r o b le m . I n
t h is m o d e , w h e n t h e c o m m u n ic a t io n s p a c k a g e m a k e s
a n I / O r e q u e s t , it t e lls t h e o p e r a t in g s y s t e m t o r e -
t u r n im m e d ia t e ly in s t e a d o f w a it in g u n t il t h e o p e r a -
t io n c a n b e c o m p le t e d . T h is is u s e fu l w h e n c o m m u n i-
c a t in g w it h m u lt ip le p a r t ie s , b e c a u s e t h e a p p lic a t io n
c a n o p e n m u lt ip le c o n n e c t io n s a n d h a v e t h e c o m m u n i-
c a t io n s p a c k a g e d e liv e r p a c k e t s o n s e v e r a l o f t h e c o n -
n e c t io n s w it h o u t w a it in g fo r a c k n o w le d g m e n t s . T h is
r e d u c e s t h e a m o u n t o f t im e s p e n t w a it in g o n t h e n e t -
w o r k t o it s t h e o r e t ic a l m in im u m .
T h e c o r e o f t h e c o m m u n ic a t io n s p a c k a g e is a s t a t e
m a c h in e t h a t t r a c k s t h e s t a t u s o f e a c h c o n n e c t io n .
T h is s t a t e m a c h in e h a n d le s t h e in it ia l c o n n e c t io n e s -
t a b lis h m e n t a n d n e g o t ia t e s t h e in it ia l a u t h e n t ic a t io n
h a n d s h a k e s t r a n s p a r e n t ly t o t h e a p p lic a t io n . T h is a p -
p r o a c h is n e e d e d b e c a u s e m u lt ip le c o n n e c t io n s , in d if-
fe r e n t s t a g e s , m a y b e in p r o g r e s s s im u lt a n e o u s ly . A ll
d a t a is b u (cid:11) e r e d in t e r n a lly a n d d e liv e r e d t o t h e a p p li-
c a t io n a s c o m p le t e a n d w e ll- fo r m e d p a c k e t s .
3 . 2 K e y s t o r a g e
T h e S S L e a y p a c k a g e s u p p o r t s r e a d in g a n d w r it in g
b o t h p u b lic a n d p r iv a t e k e y s in P E M fo r m a t . O u r
p r iv a t e s h a r e s a n d s h a r e d p u b lic k e y s a r e r e p r e s e n t e d
in t e r n a lly a s e x t e n s io n s o f t h e s t a n d a r d R S A k e y d a t a
1
s t r u c t u r e . O n d is k , w e s u p p o r t a P E M - e n c o d e d
A S N .1 fo r m a t s im ila r t o t h a t u s e d fo r R S A k e y s . T h e
p r iv a t e a n d p u b lic s h a r e fo r m a t s a r e d e s c r ib e d in T a -
b le 1 . N o t e t h a t n o n e o f t h e s e (cid:12) le s c o n t a in s t h e o p -
1(cid:0)
(cid:0) (cid:0)t io n a l v a lu e s d m o d p 1 ; d m o d q 1 , o r q m o d p
n o r m a lly u s e d t o o p t im iz e R S A c o m p u t a t io n s b e c a u s e
n o n e o f t h e p a r t ie s c a n c o n s t r u c t t h e s e v a lu e s .
id
T h e v a lu e s g a n d g m o d N s t o r e d in t h e p u b lic
s h a r e d k e y a r e u s e d t o d e t e c t in c o r r e c t ( o r p o s s ib ly
c o m p r o m is e d ) p r iv a t e s h a r e o p e r a t io n s b y t h e s h a r e
s e r v e r s . T h e ir fu n c t io n is n o t d is c u s s e d in t h is p a p e r .
3 . 3 T e s t i n g t h e s h a r e d k e y s
O n c e a s h a r e d k e y is g e n e r a t e d a m o n g t h e s e r v e r s it
u n d e r g o e s a n u m b e r o f t e s t s t o v e r ify p r o p e r s h a r in g .
T h e (cid:12) r s t t h in g t h e s e r v e r s d o is t r ia l d e c r y p t io n : e a c h
s e r v e r p ic k s a r a n d o m m e s s a g e , e n c r y p t s it u s in g t h e
1
B e c a u s e S S L e a y s u p p o r t s s o m e d e g r e e o f o b je c t p o ly m o r -
p h is m , o u r \ e x t e n d e d " R S A k e y s c a n b e u s e d in t e r c h a n g e a b ly
w it h \ o r d in a r y " R S A k e y s in S S L e a y .P r iv a t e s h a r e (cid:12) le fo r m a t
D a t a T y p e F ie ld
I N T E G E R V e r s io n
I N T E G E R N
I N T E G E R e
I N T E G E R k ( n u m b e r o f s e t s )
1I N T E G E R d
. . . .
. .
I N T E G E R d k
T a b le 1 : P r iv a t e a n d
p u b lic k e y , a n d s e n d s t h e r e s u lt t o a ll o t h e r s e r v e r s .
E a c h s e r v e r t h e n a p p lie s it s p r iv a t e s h a r e t o t h e c i-
p h e r t e x t a n d s e n d s t h e r e s u lt b a c k t o t h e o r ig in a t in g
s e r v e r . T h e o r ig in a t in g s e r v e r c o m b in e s a ll t h e r e s u lt s
a n d c o m p a r e s t h e r e s u lt in g p la in t e x t t o t h e o r ig in a l
r a n d o m m e s s a g e it c h o s e .
W h e n o u r s y s t e m is r u n in a t e s t m o d e , m o r e a g -
g r e s s iv e t e s t in g is d o n e o n t h e o u t p u t . O n c e t h e k e y is
g e n e r a t e d , a ll s e r v e r s s e n d t h e ir s h a r e s o f t h e p r iv a t e
k e y d t o a ll o t h e r s e r v e r s . T h e y a ls o s e n d t h e ir p r iv a t e
s h a r e s o f t h e fa c t o r s p a n d q . E a c h s e r v e r t h e n v e r i(cid:12) e s
t h a t p a n d q a r e b o t h p r im e , t h a t N = p q , a n d t h a t
(cid:1)e d = 1 m o d (cid:30) ( N ) . T h is t e s t s h o u ld c le a r ly n o t b e
d o n e u n d e r n o r m a l s y s t e m o p e r a t io n s in c e it e x p o s e s
t h e p r iv a t e k e y t o e a c h o f t h e s e r v e r s , d e fe a t in g t h e
m a in p o in t o f k e y s h a r in g .
4 P r a c t i c a l o p t i m i z a t i o n s
W e d e s c r ib e s e v e r a l p r a c t ic a l o p t im iz a t io n s w e u s e t o
im p r o v e t h e p e r fo r m a n c e o f d is t r ib u t e d k e y g e n e r a -
t io n . F ir s t , w e e x p la in t h e m a in r e a s o n w h y o u r im -
p le m e n t a t io n is s lo w e r t h a n s t a n d a r d s in g le u s e r g e n -
e r a t io n . T o g e n e r a t e a n R S A k e y , a s in g le u s e r r e -
p e a t e d ly p ic k s r a n d o m n u m b e r s u n t il t w o p r im e s a r e
fo u n d . T h e s e p r im e s a r e m u lt ip lie d t o fo r m N = p q .
T h e p r o b a b ilit y t h a t a r a n d o m n - b it in t e g e r is p r im e
is a p p r o x im a t e ly 1 = n . C o n s e q u e n t ly , a n a v e r a g e o f n
p r o b e s a r e n e e d e d u n t il a p r im e is fo u n d ; 2 n a r e n e e d e d
u n t il t w o p r im e s a r e fo u n d . T h is a p p r o a c h c a n n o t b e
u s e d in d is t r ib u t e d k e y g e n e r a t io n s in c e t h e p r im e fa c -
t o r s h a v e t o b e k e p t s e c r e t . I n s t e a d , in o u r im p le m e n -
t a t io n t h e s e r v e r s (cid:12) r s t s h a r e t w o r a n d o m n - b it in t e g e r s
p a n d q . T h e s h a r e d n u m b e r s a r e m u lt ip lie d t o o b t a in
N = p q a n d a d o u b le - p r im a lit y t e s t is t h e n d ir e c t ly
a p p lie d t o N . T h e p r o b a b ilit y t h a t b o t h p a n d q a r e
2
s im u lt a n e o u s ly p r im e is a s y m p t o t ic a lly 1 = n . T h e r e -
p u
7
b
P u b lic k e y (cid:12) le fo r m a t
D a t a T y p e F ie ld
I N T E G E R V e r s io n
I N T E G E R N
I N T E G E R e
I N T E G E R g ( g e n e r a t o r )
I N T E G E R k ( n u m b e r o f s e t s )
1d
I N T E G E R g m o d N
. .
. .
. .
kd
I N T E G E R g m o d N
lic s h a r e d k e y fo r m a t s
2
fo r e , n a iv e ly o n e h a s t o p e r fo r m n p r o b e s o n a v e r a g e
u n t il a s u it a b le N is fo u n d . T h is is m u c h w o r s e t h a n
t h e e x p e c t e d 2 n p r o b e s n e e d e d in s in g le u s e r g e n e r a -
t io n , r e s u lt in g in a s lo w d o w n o f a fa c t o r o f 2 5 6 ( !) fo r a
1 0 2 4 b it R S A m o d u lu s . O u r (cid:12) r s t a n d m o s t s ig n i(cid:12) c a n t
o p t im iz a t io n e lim in a t e s m u c h o f t h is s lo w d o w n b y a n
d is t r ib u t e d s ie v in ga p p r o a c h w e c a ll . O t h e r o p t im iz a -
t io n s t a k e a d v a n t a g e o f t h e d is t r ib u t e d e n v ir o n m e n t in
w h ic h t h e c o m p u t a t io n t a k e s p la c e .
4 . 1 D i s t r i b u t e d s i e v i n g
T h e g o a l o f d is t r ib u t e d s ie v in g is t o e n s u r e t h a t in
S t e p 1 ( S e c t io n 2 ) o f t h e a lg o r it h m , w h e n t h e s e r v e r s
g e n e r a t e s h a r e s o f t w o r a n d o m in t e g e r p a n d q , t h e s e
in t e g e r s a r e n o t d iv is ib le b y s m a ll p r im e s . U n fo r t u -
n a t e ly , s in c e p m u s t r e m a in s e c r e t ly s h a r e d a m o n g t h e
1s e r v e r s a s p = p + : : : + p it is n o t p o s s ib le t o e (cid:14) -k
c ie n t ly p e r fo r m t r ia l d iv is io n o n p . I n s t e a d , w e u s e a
t e c h n iq u e t h a t e n a b le s e a c h s e r v e r t o p ic k a r a n d o m
s h a r e p a n d b e g u a r a n t e e d t h a t p is n o t d iv is ib lei i
b y s m a ll p r im e s . O u r m e t h o d le a k s n o in fo r m a t io n {P
s e r v e r i le a r n s n o t h in g a b o u t t h e s h a r e s o f p b e lo n g in g
t o o t h e r s e r v e r s .
T h is s in g le o p t im iz a t io n r e s u lt s in a 1 0 - fo ld im p r o v e -
m e n t in r u n n in g t im e w h e n g e n e r a t in g a 1 0 2 4 - b it m o d -
u lu s . I n w h a t fo llo w s w e le t M b e t h e p r o d u c t o f
a ll o d d s m a ll p r im e s u p t o s o m e b o u n d w h ic h w e c a ll
s ie v in g b o u n dt h e . T h e o n ly c o n s t r a in t is t h a t M b e
s m a lle r t h a n p .
S t e p 1 : E a c h s e r v e r i p ic k s a r a n d o m in t e g e r a in t h ei
r a n g e [1 ; : : : ; M ] s u c h t h a t a is r e la t iv e ly p r im e t oi
M . T o d o s o , w e u s e a c la s s ic s ie v in g t e c h n iq u e : t h e
s e r v e r p ic k s a r a n d o m in t e g e r r b e t w e e n 1 a n d M .
I t t h e n in it ia liz e s a s m a ll b o o le a n a r r a y r e p r e s e n t -
in g t h e in t e g e r s r ; r + 1 ; r + 2 ; : : : ; r + 3 0 . F o r e a c h
o f t h e s m a ll p r im e d iv is o r s o f M it lo o p s t h r o u g ht h e a r r a y a n d c r o s s e s o u t t h e e le m e n t s d iv is ib le b y
t h a t p r im e . F in a lly , it s e t s a t o b e t h e (cid:12) r s t e n t r yi
t h a t w a s n o t c r o s s e d o u t . I f a ll e n t r ie s w e r e c r o s s e d
o u t t h e p r o c e s s is r e s t a r t e d a n d a n e w r a n d o m a i
is c h o s e n .
I n g e n e r a l, t h e s iz e o f t h e a r r a y s h o u ld b e p r o p o r -
t io n a l t o lo g lo g M . A n a r r a y o f s iz e 3 0 w a s e x p e r -
im e n t a lly p r o v e n t o b e s u (cid:14) c ie n t fo r o u r p u r p o s e s .
S t e p 2 : S in c e e a c h a is a r a n d o m in t e g e r r e la t iv e lyi
1 (cid:1) (cid:1) (cid:1)p r im e t o M , t h e ir p r o d u c t a = a a m o d M isk
a ls o a r a n d o m in t e g e r r e la t iv e ly p r im e t o M . W e
n e e d t o c o n v e r t t h is m u lt ip lic a t iv e s h a r in g o f a in t o
a n a d d it iv e s h a r in g . M o r e p r e c is e ly , e a c h s e r v e r
s h o u ld o b t a in a p r iv a t e b in t h e r a n g e [0 ; : : : ; M ]i
1s u c h t h a t a = b + : : : + b m o d M . N o in fo r m a t io nk
a b o u t a s h o u ld b e le a k e d .
W e c o n v e r t t h e m u lt ip lic a t iv e s h a r in g a =
1 (cid:1) (cid:1) (cid:1)a a m o d M t o a n a d d it iv e s h a r in g b y c o n -k
s id e r in g o n e s e r v e r a t a t im e . S u p p o s e fo r s o m e
‘
1(cid:20) (cid:1) (cid:1) (cid:1)1 ‘ < k t h e v a lu e a = a a m o d M is‘ ‘= 1i
a lr e a d y c o n v e r t e d in t o a n a d d it iv e s h a r in gQ
1a = b + : : : + b ( m o d M )‘ ;‘ k ;‘
+ 1 1 + 1(cid:1) (cid:1) (cid:1)I n it ia lly ‘ = 1 . T o c o n v e r t a = a a t o‘ ‘
a n a d d it iv e s h a r in g w e r u n t h e a lg o r it h m o f S e c -
t io n 2 .1 .1 o n t h e in p u t
1 1(cid:1)( b + : : : + b ) ( u + : : : + u ) ( m o d M );‘ k ;‘ k
+ 1 + 1 6w h e r e u = a a n d u = 0 fo r i = ‘ + 1 . T h e‘ ‘ i
a lg o r it h m p r o d u c e s t h e r e q u ir e d a d d it iv e s h a r in g
+ 1 1 + 1 + 1a = b + : : : + b o f t h e p r o d u c t . A ft e r‘ ;‘ k ;‘
(cid:0) (cid:0)k 1 it e r a t io n s o f t h is p r o c e d u r e ( fo r ‘ = 1 ; : : : ; k
11 ) w e o b t a in t h e d e s ir e d a d d it iv e s h a r in g a = b +
1 (cid:1) (cid:1) (cid:1): : : + b m o d M o f a a m o d M . T h e p r iv a c yk k
a c h ie v e d is id e n t ic a l t o t h a t o f S e c t io n 2 .1 .1 , h e n c e
n o in fo r m a t io n a b o u t a m o d M is le a k e d .
S t e p 3 : F in a lly , e a c h s e r v e r i p ic k s a r a n d o m r inin
2
t h e r a n g e [0 ; ] a n d s e t s p = r M + b . C le a r ly ,i i iM
(cid:17)p = p a m o d M a n d h e n c e p is n o t d iv is ib lei
b y a n y s m a ll p r im e fa c t o r s .P
O n e c a v e a t in t h e p r o c e d u r e o f S t e p 2 is t h a t t h e
a lg o r it h m o f S e c t io n 2 .1 .1 is c a r r ie d o u t m o d u lo M
w h ic h is n o t p r im e . T h is is n o t a p r o b le m a s lo n g
a s t h e s m a lle s t p r im e fa c t o r o f M is n o t s m a lle r t h a n
t h e n u m b e r o f p a r t ie s k . S h a m ir s e c r e t s h a r in g is n o t
Zp o s s ib le in w h e n t h e s m a lle s t p r im e fa c t o r o f MM
is le s s t h a n k . T h e a lg o r it h m o f S e c t io n 2 .1 .1 c a n n o t
b e e x e c u t e d m o d u lo s u c h M . I n o u r e x p e r im e n t s t h e
n u m b e r o f s e r v e r s is a lw a y s le s s t h a n 7 . H e n c e , w e
8
(cid:1) (cid:1) (cid:1) (cid:1) (cid:1)a p p ly d is t r ib u t e d s ie v in g m o d u lo M = 7 1 1 1 3 p ‘
w h e r e p is t h e s ie v in g b o u n d . T o e n s u r e t h a t p a n d‘
q a r e n o t d iv is ib le b y 2 ; 3 a n d 5 w e (cid:12) x t h e ir v a lu e s
m o d u lo 3 0 .
4 . 2 T e s t i n g c a n d i d a t e s i n p a r a l l e l
W h ile g e n e r a t in g a n d t e s t in g a p a r t ic u la r c a n d id a t e ,
t h e a lg o r it h m is s y n c h r o n o u s . A ll s e r v e r s s t e p fr o m
o n e p h a s e t o a n o t h e r in s y n c h r o n y . A s a r e s u lt , t im e is
w a s t e d a t v a r io u s s y n c h r o n iz a t io n p o in t s . T o im p r o v e
p e r fo r m a n c e w e r u n m u lt ip le t h r e a d s o n e a c h s e r v e r .
T h r e a d 1 o n e a c h s e r v e r t a lk s t o t h r e a d 1 o n o t h e r
s e r v e r s , t h r e a d 2 t a lk s t o t h r e a d 2 o n o t h e r s e r v e r s ,
a n d s o o n . A s a r e s u lt , m u lt ip le c a n d id a t e s a r e t e s t e d
a t o n c e a n d s y n c h r o n iz a t io n o v e r h e a d is r e d u c e d . O n c e
o n e o f t h e t h r e a d s (cid:12) n d s a m o d u lu s , t h e s e a r c h t e r m i-
n a t e s a n d a ll o t h e r t h r e a d s d ie . C u r r e n t ly , e a c h s e t o f
t h r e a d s c o m m u n ic a t e o n a s e p a r a t e s e t o f p o r t s .
M u lt it h r e a d in g t h e k e y g e n e r a t io n p r o c e s s g r e a t ly
im p r o v e s p e r fo r m a n c e . S e c t io n 5 g iv e s t im in g m e a -
s u r e m e n t s t o illu s t r a t e it s e (cid:11) e c t . A s e x p e c t e d , m u l-
t it h r e a d in g g iv e s t h e g r e a t e s t b e n e (cid:12) t s in s it u a t io n s
w h e r e s y n c h r o n iz a t io n is t a k in g a lo t o f t im e .
I t is p o s s ib le t o e s t im a t e t h e n u m b e r o f it e r a t io n s
t h a t a t h r e a d m u s t c o m p le t e b e fo r e (cid:12) n d in g a n R S A
m o d u lu s . I f ‘ is t h e n u m b e r o f it e r a t io n s t h a t a s in g le -
t h r e a d e d im p le m e n t a t io n w o u ld e x p e c t t o r u n b e fo r e
(cid:12) n d in g a m o d u lu s , t h e n a n im p le m e n t a t io n w it h n
t h r e a d s e x p e c t s
1
:it e r a t io n s = 1 n
(cid:0) (cid:0)1 ( 1 )‘
11 nn
(cid:0) (cid:25) (cid:0)is s m a ll, w e h a v e ( 1 ) 1 , a n d h e n c eS in c e ‘ ‘ ‘
‘
(cid:25)it e r a t io n s :
n
T h e t im in g m e a s u r e m e n t s in S e c t io n 5 g e n e r a lly fo l-
lo w t h is fo r m u la . T h e y d o n o t m a t c h e x a c t ly d u e t o
r a n d o m (cid:13) u c t u a t io n s .
A n in t e r e s t in g c o n s e q u e n c e is t h e d im in is h in g g a in
o f m u lt it h r e a d in g . I n c r e a s in g t h e n u m b e r o f t h r e a d s
fr o m n t o n + 1 c a u s e s t h e e x p e c t e d n u m b e r o f it e r a -
ll
t io n s t o g o fr o m t o , r e s u lt in g in a d e c r e a s e o f a+ 1n n
fa c t o r o f
l = n + 1 n
= :
l = n n + 1
n
A s t h e n u m b e r o f t h r e a d s b e c o m e s la r g e r , t e n d s+ 1n
t o 1 , h e n c e a d d in g n e w t h r e a d s h a s lit t le e (cid:11) e c t o n t h e
n u m b e r o f it e r a t io n s n e e d e d t o (cid:12) n d a m o d u lu s .A d d in g n e w t h r e a d s s lo w s d o w n t h e s e r v e r s , b u t n o t
a s m u c h a s w o u ld b e e x p e c t e d u n d e r n o r m a l c ir c u m -
s t a n c e s . F o r e x a m p le , w h e n g o in g fr o m o n e t h r e a d t o
t w o t h r e a d s , t h e s e r v e r s d o n o t o p e r a t e a t h a lf t h e ir
s p e e d b e c a u s e o n e t h r e a d c a n u t iliz e t h e C P U w h ile
t h e o t h e r is w a it in g fo r a n o t h e r s e r v e r t o s y n c h r o n iz e .
T h e o p t im a l n u m b e r o f t h r e a d s is t h e r e s u lt o f t h is
t r a d e o (cid:11) . A d d in g t h r e a d s lo w e r s t h e e x p e c t e d n u m b e r
o f it e r a t io n s , w h ile s lo w in g d o w n e a c h it e r a t io n . S in c e
it is v e r y h a r d t o c a lc u la t e t h is t r a d e o (cid:11) , t h e o p t im a l
n u m b e r o f t h r e a d s is fo u n d b y e x p e r im e n t a t io n ( S e e
S e c t io n 5 ) .
4 . 3 P a r a l l e l t r i a l d i v i s i o n
R e c a ll t h a t o n c e N is c o m p u t e d t h e s e r v e r s p e r fo r m
t r ia l d iv is io n o n it b e fo r e in v o k in g t h e d is t r ib u t e d p r i-
m a lit y t e s t ( S t e p 2 in S e c t io n 2 ) . T h e k s e r v e r s c a n
p e r fo r m t h is t r ia l d iv is io n in p a r a lle l { e a c h s e r v e r is in
c h a r g e o f v e r ify in g t h a t N is n o t d iv is ib le b y s o m e s e t
o f s m a ll p r im e s . T h is c a n b e e (cid:14) c ie n t ly d o n e b y h a r d -
1 2c o d in g a ll s m a ll p r im e s p ; p ; : : : ; p ( g r e a t e r t h a n t h el
s ie v in g b o u n d ) in a lis t . S e r v e r i is in c h a r g e o f t e s t in g
t h a t N is n o t d iv is ib le b y a n y o f t h e p r im e s p in t h ej
lis t fo r w h ic h j = i m o d k . T h is fa c t o r o f k s p e e d u p
e n a b le s u s t o u s e a la r g e t r ia l d iv is io n b o u n d , in c r e a s -
in g t h e e (cid:11) e c t iv e n e s s o f t r ia l d iv is io n .
T o fu r t h e r im p r o v e p e r fo r m a n c e o f t r ia l d iv is io n w e
d iv id e b y m u lt ip le p r im e s a t o n c e . F o r in s t a n c e , t o
t e s t if p is d iv is ib le b y 5 o r 7 o n e c a n c o m p u t e p m o d 5
a n d t h e n p m o d 7 a n d v e r ify t h a t b o t h v a lu e s a r e n o t
z e r o . H o w e v e r , o n e c a n c o m p u t e a = p m o d 3 5 a t t h e
c o s t o f o n e d iv is io n ; b y t e s t in g if g c d ( a ; 3 5 ) = 1 , it c a n
b e s e e n if e it h e r 5 o r 7 ( o r b o t h ) d iv id e a . T o t a k e
a d v a n t a g e o f t h is t r ic k , w e p a c k a s m a n y s m a ll p r im e s
a s p o s s ib le in t o a s in g le 3 2 b it s w o r d W a n d c o m p u t e
p m o d W . H e n c e , a t t h e c o s t o f o n e d iv is io n w e t e s t
m u lt ip le s m a ll p r im e s . T h is p a c k in g o f s m a ll p r im e s
in t o 3 2 - b it w o r d s is d o n e b e fo r e t h e a lg o r it h m b e g in s
a n d is id e n t ic a l o n a ll s e r v e r s .
4 . 4 L o a d b a l a n c i n g
I n S t e p ( 3 ) o f t h e p r im a lit y t e s t ( S e c t io n 2 .2 ) s e r v e r
+ 1 1 1N (cid:0) p (cid:0) q
11 h a s t o c o m p u t e v = g m o d N w h ile a ll
+i ip q
o t h e r s e r v e r s o n ly h a v e t o c o m p u t e v = g m o d N .i
N o t ic e t h a t N + 1 is r o u g h ly 2 n b it s w h ile p + q isi i
o n ly a b o u t n b it s . C o n s e q u e n t ly , s e r v e r 1 h a s t o w o r k
t w ic e a s h a r d a s t h e o t h e r s e r v e r s . I d e a lly , a s e r v e r
w o u ld b e c h o s e n a t r a n d o m fo r e v e r y it e r a t io n a n d
g iv e n t h e r o le o f s e r v e r 1 . H o w e v e r , c h o o s in g a r a n -
d o m s e r v e r w o u ld r e q u ir e c o m m u n ic a t io n b e t w e e n a ll
9
o f t h e s e r v e r s , a n d is t h u s u n d e s ir a b le . A d e t e r m in -
is t ic m e t h o d t o e v e n t h in g s o u t is t o a s s ig n t h e r o le
o f s e r v e r 1 t o a d i(cid:11) e r e n t s e r v e r fo r e a c h t h r e a d , a n d
in c r e m e n t t h is s e r v e r a ft e r e a c h it e r a t io n . T h is w a y
+ 1N
t h e c o m p u t a t io n o f g m o d N is n o t a lw a y s d o n e
o n t h e s a m e s e r v e r le a d in g t o b e t t e r lo a d b a la n c in g .
F u r t h e r m o r e , t h e r a n d o m iz e d t im in g o f t h e it e r a t io n s
w ill r e s u lt in a fa ir ly r a n d o m a n d e v e n d is t r ib u t io n o f
t h e r o le o f s e r v e r 1 . A s a r e s u lt , p r im a lit y t e s t t im e is
r e d u c e d b y u p t o a fa c t o r o f t w o .
5 T i m i n g m e a s u r e m e n t s
W e m e a s u r e d t h e p e r fo r m a n c e o f d is t r ib u t e d k e y g e n -
e r a t io n in a n u m b e r o f e n v ir o n m e n t s . F ir s t , w e m e a -
s u r e d t h e p e r fo r m a n c e o f o u r im p le m e n t a t io n fo r a
n u m b e r o f c o m m o n R S A k e y s iz e s . T a b le 2 s u m m a -
r iz e s o u r r e s u lt s w h e n r u n n in g t h e s y s t e m o n t h r e e
s e r v e r s . N o t e t h a t a ll o f t h e m e a s u r e m e n t s , e x c e p t fo r
n e t w o r k t r a (cid:14) c , a r e g iv e n a s a n a v e r a g e p e r t h r e a d . F o r
e x a m p le , T a b le 2 s h o w s t h a t w h e n c o m p u t in g a 5 1 2 - b it
m o d u lu s , e a c h t h r e a d s p e n t a n a v e r a g e o f 5 5 .7 m s p e r
it e r a t io n e x e c u t in g t h e B G W p r o t o c o l. A ll t im e s a r e in
m illis e c o n d s , u n le s s o t h e r w is e n o t e d . N e t w o r k t r a (cid:14) c
m e a s u r e m e n t s a r e g iv e n fo r t h e e n t ir e k e y - g e n e r a t io n
p r o c e s s , a n d r e (cid:13) e c t t h e t o t a l lo a d o n t h e n e t w o r k . T h e
s a m e a m o u n t o f t r a (cid:14) c is s e n t a s is r e c e iv e d , s o o n ly
o n e s t a t is t ic is g iv e n in t h e t a b le .
W e u s e d 3 3 3 M H z P e n t iu m I I ’s r u n n in g S o la r is 2 .5 .1 .
T h e s e r v e r s a r e c o n n e c t e d b y a 1 0 - M e g a b it E t h e r n e t .
C o m m u n ic a t io n b e t w e e n t h e s e r v e r s is p r o t e c t e d b y
S S L , a n d t h e o p t im a l ( la r g e s t ) s ie v in g b o u n d is u s e d .
T h e (cid:12) r s t c o lu m n m e a s u r e s t h e t im e fo r d is t r ib u t e d
s ie v in g fo r b o t h p a n d q ( S e c t io n 4 .1 ) . T h e s e c o n d
c o lu m n m e a s u r e s t h e a v e r a g e t im e p e r it e r a t io n fo r
t h e B G W p r o t o c o l, w h ic h is u s e d fo u r t im e s in s ie v in g
a n d o n c e in t h e d is t r ib u t e d c o m p u t a t io n o f N ( S e c -
t io n 2 .1 ) . N e x t w e m e a s u r e t h e a v e r a g e t im e p e r it -
e r a t io n o f t r ia l d iv is io n w it h a b o u n d o f 1 5 ,0 0 0 . T h e
n e x t t w o c o lu m n s g iv e b o t h t h e a v e r a g e r u n n in g t im e
o f t h e p r im a lit y t e s t a n d n u m b e r o f t im e s it w a s e x e -
c u t e d . F o llo w in g t h is is t h e n u m b e r o f it e r a t io n s u n t il
a m o d u lu s is fo u n d a n d t h e t o t a l a v e r a g e r u n n in g t im e
p e r it e r a t io n . F in a lly , t h e a v e r a g e n e t w o r k t r a (cid:14) c p e r
k e y g e n e r a t io n is g iv e n in m e g a b y t e s . T h e t im in g s a r e
a v e r a g e d o v e r 2 0 e x e c u t io n s o f t h e a lg o r it h m . N o t e
t h a t t h e t o t a l t im e t o g e n e r a t e a 1 0 2 4 - b it k e y is a p -
p r o x im a t e ly 9 0 s e c o n d s .
W e d o n o t g iv e t h e t im e t o g e n e r a t e a s h a r in g o f t h e
s ig n in g e x p o n e n t d o n c e t h e m o d u lu s is fo u n d ( S e c -
t io n 2 .3 ) s in c e it is n e g lig ib le c o m p a r e d t o t h e r e s t o fS ie v in g B G W t r ia l d iv . p r im e t e s t
t im e t im e t im e t im e n u m
5 1 2 b it 3 9 .9 5 5 .7 2 .4 3 7 .6 3 6 .4
1 0 2 4 b it 3 6 2 .4 8 2 .6 2 .3 6 3 7 .2 4 9 .1
2 0 4 8 b it 3 6 9 .3 4 7 0 .9 3 .6 4 1 7 7 .3 2 3 3 .9
T a b le 2 : S h a r e d k e y g e n e r a t io
t h e c o m p u t a t io n . T h e s e t im e s r a n g e s fr o m 2 0 m s fo r a
5 1 2 - b it k e y t o 5 0 0 m s fo r a 2 0 4 8 - b it k e y .
E x p e r im e n t a lly , 2 t h r e a d s p e r s e r v e r is o p t im a l fo r
a 5 1 2 - b it k e y a n d 6 t h r e a d s p e r s e r v e r is o p t im a l fo r a
1 0 2 4 - b it k e y . F o r 2 0 4 8 b it s , 6 t h r e a d s a ls o a p p e a r s t o
b e o p t im a l.
T h e r e is a la r g e d i(cid:11) e r e n c e s b e t w e e n t h e 1 0 2 4 - b it k e y
a n d t h e 2 0 4 8 - b it k e y in t h e n u m b e r o f p r im a lit y t e s t s
a n d t h e n u m b e r o f it e r a t io n s . T h is d i(cid:11) e r e n c e is m u c h
s m a lle r b e t w e e n t h e 5 1 2 - b it k e y a n d t h e 1 0 2 4 - b it k e y
b e c a u s e t h e 5 1 2 - b it k e y u s e s 2 t h r e a d s p e r s e r v e r , w h ile
t h e o t h e r t w o u s e 6 t h r e a d s p e r s e r v e r . S in c e t h e n u m -
p e r t h r e a db e r s g iv e n a r e t h e a v e r a g e , t h e d i(cid:11) e r e n c e s
b e t w e e n t h e 5 1 2 - b it k e y a n d t h e 1 0 2 4 - b it k e y a r e a c t u -
a lly q u it e la r g e . F o r e x a m p le , t h e 5 1 2 - b it k e y r e q u ir e s
(cid:1)a n a v e r a g e o f 2 3 8 it e r a t io n s o v e r a ll ( 2 3 8 = 1 1 9 2 ) ,
w h ile t h e 1 0 2 4 - b it k e y r e q u ir e s a n a v e r a g e o f 7 8 0 it e r -
(cid:1)a t io n s o v e r a ll ( 7 8 0 = 1 3 0 6 ) .
I t is in t e r e s t in g t o n o t e t h a t fo r a 1 0 2 4 b it k e y t h e
n u m b e r o f p r im a lit y t e s t s is a b o u t a t h ir d o f t h e n u m -
b e r o f it e r a t io n s . T r ia l d iv is io n u p t o 1 5 0 0 0 is a b le t o
e lim in a t e t w o t h ir d s o f t h e c a n d id a t e s w it h o u t a p r i-
m a lit y t e s t . N o r m a lly , t r ia l d iv is io n is m u c h m o r e e f-
fe c t iv e . H o w e v e r , d u e t o t h e d is t r ib u t e d s ie v in g , t h e e f-
fe c t o f t r ia l d iv is io n is d im in is h e d . N e v e r t h e le s s , e lim i-
n a t in g t w o t h ir d s o f t h e c a n d id a t e s is s ig n i(cid:12) c a n t . N o t e
t h a t , a s e x p e c t e d , t h e e (cid:11) e c t o f t r ia l d iv is io n is s m a lle r
fo r t h e 2 0 4 8 b it m o d u lu s ( o n ly 1 in 2 m o d u li a r e (cid:12) l-
t e r e d o u t b y it ) .
F i x e d k e y , v a r y i n g c o n d i t i o n s I n T a b le 3 w e (cid:12) x
t h e k e y s iz e t o 1 0 2 4 b it s a n d s t u d y o u r s y s t e m ’s b e h a v -
io r u n d e r d i(cid:11) e r e n t c o n d it io n s . W e g e n e r a t e a s h a r e d
k e y a m o n g d i(cid:11) e r e n t n u m b e r s o f s e r v e r s : 3 ,4 a n d 5 . A ll
s e r v e r s r u n 6 t h r e a d s .
R u n n in g t im e is m e a s u r e d w h e n a ll c o m m u n ic a t io n
is s e n t in t h e c le a r a n d w h e n S S L is u s e d t o s e c u r e
c o m m u n ic a t io n . P e r fo r m a n c e is m e a s u r e d o v e r a w id e
a r e a n e t w o r k ( W A N ) , a n d w h e n a ll s e r v e r s r u n o n a
s in g le m a c h in e . I n a ll t h e s e e x p e r im e n t s , t h e t r ia l d i-
v is io n b o u n d is s e t a s in t h e p r e v io u s t a b le . A g a in ,
a ll m e a s u r e m e n t s a r e in m illis e c o n d s u n le s s o t h e r w is e
n o t e d .
1 0
n
it e r a t io n s t o t a l n e t n u m b e r o f
t im e n u m t im e t r a (cid:14) c t h r e a d s
7 7 .2 1 1 9 0 .1 5 m in 0 .1 8 0 M b 2
6 9 6 .9 1 3 0 1 .5 1 m in 1 .1 6 2 M b 6
2 1 9 8 .0 4 9 5 1 8 .1 3 m in 7 .4 8 M b 6
t im e a m o n g t h r e e s e r v e r s .
T h e (cid:12) r s t (cid:12) v e r o w s s h o w t h e r e s u lt s fr o m r u n n in g t h e
a lg o r it h m o n d i(cid:11) e r e n t n u m b e r s o f s e r v e r s , w it h a n d
w it h o u t S S L e n a b le d . D is a b lin g S S L r e s u lt s in a s m a ll
in c r e a s e in p e r fo r m a n c e w h ic h g r o w s a s t h e n u m b e r o f
s e r v e r s in c r e a s e s . I n c r e a s in g t h e n u m b e r o f s e r v e r s r e -
s u lt s in a s u b s t a n t ia l d e c r e a s e in p e r fo r m a n c e . T h is is
d u e t o a n in c r e a s e in s y n c h r o n iz a t io n t im e , a n in c r e a s e
in t h e d is t r ib u t e d s ie v in g t im e , a n d a n in c r e a s e in n e t -
w o r k t r a (cid:14) c . W e n o t e t h a t t h e t w o e x t r a s e r v e r s u s e d
fo r e x p e r im e n t s w it h fo u r a n d (cid:12) v e s e r v e r s a r e o ld e r
a n d m u c h s lo w e r t h a n t h e o t h e r t h r e e .
T h e lin e la b e le d \ W A N " is e s p e c ia lly in t e r e s t in g .
T h e t h r e e s e r v e r s in v o lv e d w e r e t w o c o m p u t e r s a t
S t a n fo r d a n d o n e a t t h e U n iv e r s it y o f W is c o n s in -
M a d is o n . W e h a v e t h u s p e r fo r m e d t h e (cid:12) r s t t r a n s c o n t i-
n e n t a l, d is t r ib u t e d R S A k e y g e n e r a t io n . T h is t a k e s a n
a v e r a g e o f a b o u t 5 .7 m in u t e s . W e w e r e s t y m ie d in o u r
w is h t o p e r fo r m t h e (cid:12) r s t in t e r c o n t in e n t a l, d is t r ib u t e d
R S A k e y g e n e r a t io n b y U S e x p o r t la w s .
E (cid:11) e c t o f s i e v i n g T o d e m o n s t r a t e t h e e (cid:11) e c t iv e n e s s
o f d is t r ib u t e d s ie v in g w e m e a s u r e d t h e a lg o r it h m ’s
r u n n in g t im e o n a s in g le t h r e a d w it h d i(cid:11) e r e n t s ie v -
in g b o u n d s . C le a r ly , a la r g e r s ie v in g b o u n d is b e t t e r .
T h e r e s u lt s in T a b le 4 a r e t h e t im e s fo r g e n e r a t in g a
5 1 2 - b it m o d u lu s o n t h r e e s e r v e r s w it h c o m m u n ic a t io n
p r o t e c t e d b y S S L . S ie v in g im p r o v e s p e r fo r m a n c e b y
m o r e t h a n a fa c t o r o f 1 0 fo r a 1 0 2 4 b it m o d u lu s .
T h e t a b le s h o w s h o w s ie v in g d r a m a t ic a lly r e d u c e s
t h e n u m b e r o f it e r a t io n s u n t il a k e y is fo u n d . T h e
la r g e r t h e n u m b e r , t h e m o r e e (cid:11) e c t iv e s ie v in g b e c o m e s .
T h e r e fo r e , t h e k e y g e n e r a t io n p r o g r a m a u t o m a t ic a lly
(cid:12) n d s t h e la r g e s t a c c e p t a b le s ie v in g b o u n d fo r e a c h k e y
s iz e , g iv e n t h e c o n s t r a in t t h a t M < p ( S e c t io n 4 .1 ) .
M u l t i - t h r e a d i n g A s d is c u s s e d in S e c t io n 4 .2 , t o
r e d u c e t h e t im e w a s t e d o n s y n c h r o n iz a t io n it m a k e s
s e n s e t o r u n m u lt ip le t h r e a d s o n e a c h o f t h e s e r v e r s .
W h ile o n e t h r e a d is w a it in g t o s y n c h r o n iz e w it h it s
p e e r s , o t h e r t h r e a d s c a n e x e c u t e . T a b le 5 s h o w s t h a t
r u n n in g s e v e r a l t h r e a d s in p a r a lle l r e s u lt s in a la r g e
d e c r e a s e in r u n n in g t im e . A s e x p e c t e d , e a c h it e r a t io n
t a k e s lo n g e r , b u t fe w e r it e r a t io n s a r e r e q u ir e d u n t il3
3
4
4
5
S
S
S
S
S
S
e r v e r s N
e r v e r s Y
e r v e r s N
e r v e r s Y
e r v e r s Y
W A N Y
L o c a l N
L o c a l Y
T a b le
S ie v e 1 5 0
S ie v e 5 0
N o s ie v e
t h r e a d s / s
o n e
fo u r
(cid:12) v e
s ix
s e v e n
S L
o
e s
o
e s
e s
e s
o
e s
3 :
e r v
S ie v e B G W t r ia l d iv . p r im e t e s t t im e p e r t o t a l
t im e t im e t im e t im e it e r a t io n t im e
3 2 6 4 1 3 2 .2 6 2 8 6 9 5 1 .5 1 m in
3 6 2 8 3 2 .3 6 3 7 6 9 7 1 .5 1 m in
6 8 9 8 6 1 1 .5 2 0 3 5 1 7 0 7 3 .7 0 m in
8 0 4 1 0 1 7 1 .9 2 1 7 3 1 9 0 9 4 .1 4 m in
1 4 6 6 1 7 3 1 1 .9 2 0 1 3 2 5 8 9 5 .6 1 m in
7 7 4 1 0 1 2 6 .3 1 6 2 6 1 7 0 4 5 .6 9 m in
2 6 3 3 3 4 2 .7 1 7 0 2 1 0 1 4 2 .2 0 m in
2 6 7 3 3 7 3 .3 1 8 9 9 1 1 1 5 2 .4 2 m in
T h e e (cid:11) e c t o f c h a n g in g t h e n u m b e r a n d lo c a lit y o f s e r v e r s
S ie v in g t r ia l d iv . p r im e t e s t it e r a t io n s t o t a l
t im e t im e t im e n u m t im e n u m t im e
2 2 .6 1 .8 3 6 .1 8 9 4 6 .8 2 8 8 1 4 .0 s e c
1 9 .1 1 .0 3 0 .7 9 9 4 3 .8 6 0 7 2 6 .6 s e c
N / A 1 .4 3 4 1 4 9 1 1 1 0 7 9 4 1 1 7 .0 s e c
T a b le 4 : T h e e (cid:11) e c t o f s ie v in g o n r u n n in g t im e
B G W t r ia l d iv . p r im e t e s t it e r a t io n s t o t a l
. t im e t im e t im e t im e n u m t im e
4 6 .5 2 .2 2 0 1 .3 3 1 9 .5 1 1 0 2 5 .8 7 m in
6 7 .6 2 .2 4 1 4 .5 5 2 9 .3 3 6 5 3 .2 2 m in
7 7 .1 2 .2 5 2 7 .2 6 2 2 .7 1 8 5 1 .9 2 m in
8 2 .6 2 .3 6 3 7 .2 6 9 6 .9 1 3 0 1 .5 1 m in
8 7 .5 2 .5 8 1 0 .8 7 8 1 .4 1 2 9 1 .6 8 m in
T a b le 5 : T h e e (cid:11) e c t o f m u lt ip le t h r e a d s
1 1o n e o f t h e t h r e a d s (cid:12) n d s a m o d u lu s . W e g e n e r a t e d t h e
1 0 2 4 - b it k e y s a m o n g t h r e e s e r v e r s w it h S S L e n a b le d .
M u lt it h r e a d in g is m o s t b e n e (cid:12) c ia l w h e n s y n c h r o n iz a -
t io n t a k e s a lo t o f t im e . T h is is m o s t o b v io u s in t h e
W A N t r ia ls a n d in t h e t r ia ls w it h 5 s e r v e r s . W h e n r u n -
n in g t h e s e t e s t s s in g le - t h r e a d e d , k e y g e n e r a t io n w a s
v e r y c h o p p y ; b u r s t s o f c a lc u la t io n s w e r e fo llo w e d b y
p e r io d s o f w a it in g . W h e n r u n n in g m u lt it h r e a d e d , k e y
g e n e r a t io n p r o c e e d s s m o o t h ly , m a k in g m u c h b e t t e r u s e
o f t h e s e r v e r s ’ p r o c e s s o r s . O n t h e W A N , g e n e r a t in g
a 1 0 2 4 - b it k e y w it h a s in g le t h r e a d t o o k 2 6 .5 m in -
u t e s , w h ile it t o o k o n ly 5 .7 m in u t e s u s in g 6 t h r e a d s
p e r s e r v e r .
6 R o b u s t n e s s
U p u n t il n o w w e a s s u m e d a ll p a r t ie s a r e h o n e s t ly fo l-
lo w in g t h e k e y g e n e r a t io n p r o t o c o l. F o r s o m e a p p li-
c a t io n s it is d e s ir a b le t o m a k e t h e p r o t o c o l r o b u s t
a g a in s t a c t iv e a d v e r s a r ie s t h a t c h e a t d u r in g t h e p r o -
t o c o l. S in c e t h e R S A fu n c t io n is v e r i(cid:12) a b le ( t h e p a r -
t ie s c a n s im p ly c h e c k t h a t t h e y c o r r e c t ly d e c r y p t e n -
c r y p t e d t e s t m e s s a g e s ) a c t iv e a d v e r s a r ie s a r e lim it e d
in t h e a m o u n t o f d a m a g e t h e y c a n c a u s e . H o w e v e r , it
m a y s t ill b e p o s s ib le t h a t a p a r t y c h e a t d u r in g t h e p r o -
t o c o l a n d c o n s e q u e n t ly b e a b le t o fa c t o r t h e r e s u lt in g
N . S im ila r ly , a p a r t y c a n c h e a t a n d c a u s e a n o n - R S A
m o d u lu s t o b e in c o r r e c t ly a c c e p t e d .
W e d e s c r ib e a s im p le m e t h o d fo r m a k in g o u r n o n -
r o b u s t p r o t o c o l r o b u s t w h e n t h e n u m b e r o f p a r t ic i-
p a n t s is s m a ll ( e .g . le s s t h a n t e n ) . C o n s id e r t h e c a s e
o f fo u r p a r t ie s w h e r e a t m o s t o n e o f t h e m is m a lic io u s .
O n e c a n r u n t h e n o n - r o b u s t p r o t o c o l u n t il a c a n d i-
d a t e m o d u lu s N is fo u n d . A t t h is p o in t t h e p r o t o c o l
is r u n fo u r m o r e t im e s , o n c e fo r e a c h t r ip le t o f u s e r s .
1 1I n t h e (cid:12) r s t r u n , p a r t y 1 s h a r e s h e r v a lu e s p ; q w it h
0 0 0
1t h e o t h e r t h r e e p a r t ie s b y w r it in g p = p + p + p2 3 4
0 0 0 0 0
1a n d q = q + q + q w h e r e p ; q a r e r a n d o m in -2 3 4 j j
0 0
t e g e r s in t h e r a n g e [0 ; N ]. P a r t y 1 t h e n s e n d s p ; qi i
t o p a r t y i fo r i = 2 ; 3 ; 4 . P a r t y i a d d s t h e s e v a lu e s
t o it s o w n p ; q . N e x t , p a r t ie s 2 ; 3 ; a n d 4 r u n o u ri i
n o n - r o b u s t p r o t o c o l a m o n g t h e t h r e e o f t h e m ( ig n o r -
in g p a r t y 1 ) . I f t h e r e s u lt in g N d o e s n o t m a t c h t h e
N c o m p u t e d w h e n a ll fo u r p a r t ie s w e r e in v o lv e d , o r
if N t u r n s o u t t o n o t b e a n R S A m o d u lu s , t h e N is
r e je c t e d a n d t h e p a r t ie s a n n o u n c e t h a t o n e o f t h e m
is m is b e h a v in g . T h is e x p e r im e n t is r e p e a t e d w it h a ll
fo u r t r ip le t s { e a c h t im e e x a c t ly o n e p a r t y is e x c lu d e d
fr o m t h e c o m p u t a t io n . A s s u m in g a t m o s t o n e p a r t y is
m a lic io u s , t h e r e s u lt in g N m u s t b e a p r o d u c t o f t w o
la r g e p r im e s . F u r t h e r m o r e , t h e m a lic io u s p a r t y c a n n o t
1 2
k n o w t h e fa c t o r iz a t io n o f N s in c e a t n o p o in t in t h e
p r o t o c o l d o e s a n h o n e s t p a r t y r e v e a l a n y in fo r m a t io n
a b o u t it ’s s h a r e t o a n o t h e r s in g le p a r t y . T h is a p p r o a c h
e n a b le s t h e p a r t ie s t o d e t e c t c h e a t in g , b u t it d o e s n o t
h e lp in d e t e c t in g t h e m a lic io u s p a r t y .
I n g e n e r a l, w h e n k p a r t ie s a r e e n g a g e d in o u r n o n -
r o b u s t p r o t o c o l, a n d c o f t h e m a r e m a lic io u s , t h e p r o -
k
t o c o l c a n b e m a d e r o b u s t a t t h e c o s t o f e x t r a in v o -c
1k (cid:0) c (cid:0)
(cid:0) (cid:1)b cc a t io n s . T h e r e s u lt in g c o m p u t a t io n is p r iv a t e .2
C le a r ly t h is a p p r o a c h c a n o n ly b e a p p lie d a s lo n g a s
b o t h k a n d c a r e v e r y s m a ll.
R e c e n t ly , F r a n k e l, M a c K e n z ie a n d Y u n g [9 ] s h o w e d
1k (cid:0)
cb m a -h o w o u r p r o t o c o l c a n b e m a d e t o w it h s t a n d 2
lic io u s p a r t ie s . T h e ir a p p r o a c h e n a b le s t h e p a r t ie s t o
d e t e c t a n d e x c lu d e t h e m a lic io u s p a r t y . I n p r a c t ic e ,
o n e c o u ld r u n o u r n o n - r o b u s t p r o t o c o l u n t il a m o d u -
lu s N is fo u n d w h ic h is b e lie v e d t o b e a p r o d u c t o f t w o
p r im e s . T h e n , t h e r o b u s t F r a n k e l- M a c K e n z ie - Y u n g
p r o t o c o l c a n b e u s e d t o d e t e r m in e t h a t n o m a jo r it y
o f p a r t ie s c h e a t e d d u r in g t h e n o n - r o b u s t p h a s e . F o r
m o r e r e s u lt s o n r o b u s t g e n e r a t io n o f s h a r e d R S A k e y s
s e e [2 ].
7 C o n c l u s i o n s
T h e g o a l o f t h is p a p e r is t o d e m o n s t r a t e t h e e (cid:11) e c t iv e -
n e s s o f s h a r e d R S A k e y g e n e r a t io n . O u r o p t im iz e d
im p le m e n t a t io n a n d t im in g m e a s u r e m e n t s s h o w t h a t
d is t r ib u t e d k e y g e n e r a t io n is a v ia b le m e t h o d fo r g e n -
e r a t in g s h a r e d R S A k e y s . U s in g t h r e e 3 3 3 M H z P C ’s
o n a 1 0 M b p s E t h e r n e t w e w e r e a b le t o g e n e r a t e 1 0 2 4
b it s h a r e d R S A k e y s in u n d e r 9 1 s e c o n d s . O n a w id e
a r e a n e t w o r k , u s in g s e r v e r s a c r o s s t h e U S , w e w e r e a b le
t o g e n e r a t e k e y s in u n d e r 6 m in u t e s . T h e s e p e r fo r -
m a n c e (cid:12) g u r e s a r e a c h ie v e d u s in g a n u m b e r o f e (cid:11) e c t iv e
o p t im iz a t io n s a n d b y m u lt i- t h r e a d in g t h e k e y g e n e r -
a t io n p r o c e s s . W e h o p e t h e s e r e s u lt s c a n b e u s e d t o
r e d u c e t h e n e e d fo r t r u s t e d d e a le r s . O u r c o d e w ill b e
m a d e a v a ila b le o n t h e p r o je c t ’s w e b s it e .
W e n o t e t h a t S p a ld in g a n d W r ig h t [1 6 ] p r e v io u s ly
im p le m e n t e d a v e r s io n o f t h e B o n e h - F r a n k lin k e y g e n -
s im u la t e se r a t io n a lg o r it h m . T h e ir im p le m e n t a t io n
t h e d is t r ib u t e d e n v ir o n m e n t o n a s in g le m a c h in e in
a s in g le p r o c e s s . C o n s e q u e n t ly , t h e t im in g m e a s u r e -
m e n t s d o n ’t r e (cid:13) e c t n e t w o r k la t e n c ie s o r t h e p a r a lle lis m
o b t a in e d b y m u lt ip le s e r v e r s . T h e ir im p le m e n t a t io n
d o e s n o t u s e d is t r ib u t e d s ie v in g s in c e t h e t e c h n iq u e
w a s u n k n o w n a t t h e t im e .
T o o b t a in d is t r ib u t e d k e y g e n e r a t io n in u n d e r 9 1 s e c -
o n d s w e d e s ig n e d a n d im p le m e n t e d a n u m b e r o f p r a c -t ic
s ie
in
a d
R
a
v
r
v
e
l o p t im iz a t io n s . T h e m o s t s ig n i(cid:12) c a n t is d is t r ib u t e d
in g , w h ic h is r e s p o n s ib le fo r a 1 0 - fo ld im p r o v e m e n t
u n n in g t im e . O t h e r o p t im iz a t io n s t a k e a d d it io n a l
a n t a g e o f t h e d is t r ib u t e d e n v ir o n m e n t .
f e r e n c e s
[1 ] M . B e n - O r , S . G o ld w a s s e r , A . W ig d e r -
s o n , \ C o m p le t e n e s s t h e o r e m s fo r n o n -
c r y p t o g r a p h ic fa u lt t o le r a n t d is t r ib u t e d c o m -
p u t a t io n " , S T O C 1 9 8 8 , p p . 1 { 1 0 .
[2 ] S . B la c k b u r n , S . B la k e - W ils o n , M .
B u r m e s t e r , S . G a lb r a it h , \ S e c u r e c o n -
s t r u c t io n o f s h a r e d R S A k e y s " , P r e p r in t .
[3 ] J . B e n a lo h ( C o h e n ) , \ S e c r e t s h a r in g h o m o -
m o r p h is m s : k e e p in g s h a r e s o f a s e c r e t s e -
c r e t ," C r y p t o ’8 6 , 2 5 1 - 2 6 0 .
[4 ] D . B o n e h , M . F r a n k lin , \ E (cid:14) c ie n t g e n e r a t io n
o f s h a r e d R S A k e y s " , in P r o c e e d in g s C r y p t o ’
9 7 , p p . 4 2 5 { 4 3 9 .
R o o t C e r t A u t h o r it y[5 ] C e r t C o , ,
h t t p : / / w w w . c e r t c o . c o m
[6 ] C . C o c k s , \ S p lit k n o w le d g e g e n e r a t io n o f
R S A p a r a m e t e r s " , A v a ila b le fr o m t h e a u t h o r
c l i f f c o c k s @ c e s g . g o v . u k .
[7 ] A . F ia t a n d A . S h a m ir , \ H o w t o p r o v e y o u r -
s e lf: P r a c t ic a l s o lu t io n s t o id e n t i(cid:12) c a t io n a n d
s ig n a t u r e p r o b le m s ," C r y p t o ’8 6 , 1 8 6 - 1 9 4 .
[8 ] Y . F r a n k e l, \ A p r a c t ic a l p r o t o c o l fo r la r g e
g r o u p o r ie n t e d n e t w o r k s " , E u r o c r y p t 8 9 , p p .
5 6 { 6 1 .
[9 ] Y . F r a n k e l, P . M a c K e n z ie , M . Y u n g , \ R o -
b u s t e (cid:14) c ie n t d is t r ib u t e d R S A k e y g e n e r a -
t io n " , S T O C 1 9 9 8 , p p . 6 6 3 { 6 7 2 .
[1 0 ] P . G e m m e l, \ A n in t r o d u c t io n t o t h r e s h o ld
c r y p t o g r a p h y " , in C r y p t o B y t e s , a t e c h n ic a l
n e w s le t t e r o f R S A L a b o r a t o r ie s , V o l. 2 , N o .
7 , 1 9 9 7 .
[1 1 ] M . R e it e r , M . F r a n k lin , J . L a c y , R . W r ig h t ,
\ T h e (cid:10) k e y m a n a g e m e n t s e r v ic e " , P r o c e e d -
in g s o f t h e 3 r d A C M c o n fe r e n c e o n C o m p u t e r
a n d C o m m u n ic a t io n S e c u r it y , 1 9 9 6 .
[1 2 ] R . R iv e s t , \ F in d in g fo u r m illio n la r g e r a n d o m
p r im e s " , P r o c e e d in g s o f C r y p t o ’9 1 .
1 3
[1
[1
[1
[1
[1
3
4
5
6
7
]
]
]
]
]
T . R a b in , \ A
o ld a n d p r o a
C r y p t o ’ 9 8 .
S e c u r e E le c t
h t t p : / / w w w . v
A . S h a m ir , \ H
o f t h e A C M , V
S . S p a ld in g , R
fo r m a n c e o f S
t io n " , I n p r o c e
E .
h t t p : / / w w w . s
s im p li(cid:12) e d a p p r o a c h t o t h r e s h
c t iv e R S A " , P r o c e e d in g s o
r o n ic T r a n s a c t io n s ( S E T )
i s a . c o m
o w t o s h a r e a s e c r e t " , C o m m
o l. 2 2 , 1 9 7 9 , p p . 6 1 2 { 6 1 3 .
. W r ig h t , " E x p e r im e n t a l P e r
h a r e d R S A M o d u lu s G e n e r a
e d in g s o f S O D A ’9 9 .
Y o u n g , S S L e a y
s l e a y . o r g /
-
f
,
.
-
-
,A p p
A ll s y
in v o lv
c o n (cid:12) g
; - - - - -
; - - -
; - - - - -
N u m _ S e
T h r e a d
H o m e D i
W o r d _ S
L o g _ L e
; S i e v
S i e v e :
T r i a l D
P u b l i c
K e y _ L e
; P o s s
T e s t _ M
; - - - - -
; - - -
; - - - - -
; S e r v
; S e r v
; S e r v
S e r v e r
S h a r e _
S e r v e r
S e r v e r
S e r v e r
S e r v e r
S e r v e r
S h a r e _
S e r v e r
S e r v e r
S e r v e r
S e r v e r
S e r v e r
S h a r e _
S e r v e r
S e r v e r
S e r v e r
S e r v e r
S e r v e r
S h a r e _
S e r v e r
S e r v e r
S e r v e r
S e r v e r
s
e
u
-
-
r
s
r
i
v
i
i
_
n
i
o
-
-
e
e
e
_
I
_
_
_
_
_
I
_
_
_
_
_
I
_
_
_
_
_
I
_
_
_
_
e n d i x : C
t e m c o n (cid:12) g u r
d a s w e ll a s
r a t io n (cid:12) le . W
- - - - - - - - - - - - -
P a r t 1 : G e n e r
- - - - - - - - - - - - -
v e r s : 3
: 4
: / I T T C /
z e : 3 2
e l : N o t i f y
n g a n d t r i a l
T r u e
v _ E n d : 1 7 8 0 0
K e y : 6 5 5 3 7
g t h : N o r m a l
b l e k e y - l e n g t
d e : F a l s e
- - - - - - - - - - - - -
P a r t 2 : S e r v e
- - - - - - - - - - - - -
r _ C e r t : l o c a t
r _ K e y : l o c a t
r _ T r a n s p o r t :
I P _ A d d r _ 0 :
P _ P o r t _ 0 :
C e r t _ 0 :
K e y _ 0 :
T r a n s p o r t _ 0 :
S e q u e n c e _ F i l e
I P _ A d d r _ 1 :
P _ P o r t _ 1 :
C e r t _ 1 :
K e y _ 1 :
T r a n s p o r t _ 1 :
S e q u e n c e _ F i l e
I P _ A d d r _ 2 :
P _ P o r t _ 2 :
C e r t _ 2 :
K e y _ 2 :
T r a n s p o r t _ 2 :
S e q u e n c e _ F i l e
I P _ A d d r _ 3 :
P _ P o r t _ 3 :
C e r t _ 3 :
K e y _ 3 :
T r a n s p o r t _ 3 :
S e q u e n c e _ F i l e
a
t
-
a
-
L
d
h
-
r
-
i
i
_
_
_
_
o n
t io n
y p e
e in
- - - -
l c o
- - - -
o g /
i v i s
s :
- - - -
p a r
- - - -
o n o
o n o
C l e a
0 :
1 :
2 :
3 :
(cid:12)
p a
o f
c lu
- - -
n f i
- - -
i o n
W e a
- - -
a m e
- - -
f s
f s
r t
s a g
8 7 1
c e r
k e y
c l e
s e q
c a r
8 7 1
c e r
k e y
c l e
s e q
e p i
8 7 1
c e r
k e y
c l e
s e q
a m y
8 7 1
c e r
k e y
c l e
s e q
g u r a t i
r a m e t e r s
R S A k e y
d e a n e x a
- - - - - - - - - -
g u r a t i o n p
- - - - - - - - - -
; N u m b e r
; 3 2 o r
; M i n i m u
b o u n d s
k = 5 1 2 b i
- - - - - - - - - -
t e r s - - -
- - - - - - - - - -
e r v e r ’ s c e
e r v e r ’ s p r
r a n s p o r t v
a 3 . s t a n f o r
3
t _ s 0 . p e m
_ s 0 . p e m
a r
0
d i n a l 4 . s t a
3
t _ s 1 . p e m
_ s 1 . p e m
a r
1
c 2 . s t a n f o r
3
t _ s 2 . p e m
_ s 2 . p e m
a r
2
5 . s t a n f o r d
3
t _ s 2 . p e m
_ s 2 . p e m
a r
2
o
a
t
m
-
a
-
6
m
t
r
i
s
d
n
d
.
r
o
-
r
-
o
4
s
t
v
.
.
f
.
e
n
e
p
-
a
-
f
p
,
i
a
e
o
e
d
(cid:12) l e
lo c a t e d in o n e
g e n e r a t e . T o r
le c o n (cid:12) g u r a t io
- - - - - - - - - - -
t m e r s - - -
- - - - - - - - - - -
t h r e a d s p e r s e
b i t s p e r w o r d .
r i o r i t y o f l o g g
N o r m a l = 1 0 2 4
f i c a t e .
t e k e y .
S S L t r a n s p o r t
d u
r d . e d u
d u
u
c o n (cid:12) g u r
e d u c e a d
n (cid:12) le .
r v e r .
e d m e s s a g
, S t r o n g
1 4
a
m
e
t
s
=
io
in
.
2
n (cid:12) le . T
is t r a t iv
0 4 8 .
e
h is
o v
in
e r
c
h
lu
e a
d
d
e
,
s
a
I P
ll s
a
e
d
r
d
v
r e s
e r s
s
u
e s
s e
o f
a
a
n
ll
id
s
e
e
n
r v e
t ic
r
a
s
l