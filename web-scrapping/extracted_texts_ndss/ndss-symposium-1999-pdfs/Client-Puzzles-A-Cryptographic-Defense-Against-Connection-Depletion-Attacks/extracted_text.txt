Client Puzzles
A Cryptographic Defense Against Connection
Depletion Attacks
Ari Juels and John Brainard
RSA LaboratoriesConnection Depletion:
The ProblemHow to disable a restaurant
Restauranteur
SaboteurTable for four
O.K.,
at 8 o’clock.
Restauranteur
Name of Mr. Smith. Mr. Smith
Saboteur
Saboteur vs. RestauranteurRestauranteur
No More Tables!
SaboteurAn example: TCP SYN flooding
Server
“T“CTPC Pc ocnonnencetciotino,n p, lpelaesaes.e” .”
“O.K. Please send ack.”
“O.K. Please send ack.”
Client
Bufferu TCP SYN is a real-world problem
– Panix, mid-Sept. 1996 (NYT)
– New York Times, late Sept. 1996
– Others
u Similar attacks may be mounted against
e-mail, SSL, etc. -- resources other than
memorySome defenses against
connection depletionIP Tracing (or Syncookies)
Server
Client
Hi. My name is
Request
10.100.16.126.
Buffer
Problems:
•Can be evaded, particularly on, e.g., Ethernet
•Does not allow for proxies, anonymityDigital signatures
Server
Client
Buffer
Problems:
•Requires carefully regulated PKI
•Does not allow for anonymityConnection timeout (for buffers)
Server
Client
Problem: Hard to achieve balance between security
and latency demandsThrow away requests at random
Server
Client ? ”
o
e
ll
H
“
“Hello?”
“
H
ell
o
?”
Buffer
Problem: Legitimate clients must keep retrying in
high volume attacksOur solution: client puzzlesIntuition
???
Please solve this
Table for four
puzzle.
O.K.,O.K.
at 8 o’clock.
Name of Mr. Smith. Mr. Smith
RestauranteurIntuition
Suppose:
u A puzzle takes an hour to solve
u There are 40 tables in restaurant
u Reserve at most one day in advance
A legitimate patron can easily reserve a table,
but:Intuition
???
??? ???
???
???
???
Would-be saboteur has too many puzzles to solveThe client puzzle protocol
R Server
Service request
Client
Resource
O.K.Remarks
u Can use puzzles for any type of
resource
u Only have to distribute puzzles when
under attack
u Can scale hardness of puzzles
depending on severity of attackWhat does a puzzle look like?Puzzle basis:
partial hash inversion
k bits
?
X’X ?
pre-ima ge
partial image
160 bits
hash
Y
image
Pair (X’, Y) is k-bit-hard puzzlePuzzle construction
Client Server
R
Service request
Secret SPuzzle construction
Server computes:
S T R
secret time request
hash
Puzzle
X
pre-image
hash
Y
imagePuzzle properties
u Puzzles are stateless (client provides T
and R with puzzle)
u Puzzles are easy to verify
u Hardness of puzzles can be carefully
controlled
u Puzzles use standard cryptographic
primitivesWhere to use client puzzles?Some pros
Avoids many flaws in other solutions, e.g.:
u Allows for anonymous connections
u Does not require PKI
u Does not require retries -- even under
heavy attackDrawback
u Requires special-purpose software,
e.g., browser plug-inClient puzzles seem most suitable for internal
networks
Candidate technology for RSA/Security Dynamics
enterprise security serversConclusionsWhat’s in the paper
u Introduces idea of puzzles for on-the-fly
resource access control
u Detailed puzzle and protocol description
u Discussion of overhead
– How long to process puzzle solution?
– How many extra tables?o
o
T
u Rigorous mathematical treatment of
parameterization/security level
– Solving puzzles is a probabilistic process --
attacker may get lucky
u Protocol can be simplified and made
more efficientMore work on puzzles
Puzzles have also been proposed for:
u Controlling spam (DN94, BGJMM98)
u Auditing server usage (FM97)
u Time capsules (RSW96)More to be done
u How to define a puzzle? Search space
vs. sequential workload
u Can puzzle construction be improved?
– Replace hash with, e.g., reduced-round
cipher
u Can puzzles be made to do useful
work?Questions?
e-mail: ari@rsa.com