PSI: Precise Security Instrumenta1on
for Enterprise Networks
Tianlong Yu1, Seyed K. Fayaz1, Michael Collins2,
Vyas Sekar1 and Srini Seshan1
1CMU 2Redjack
1Opera1onal network security s1ll abysmal!
StaNc, IP-based
False +/-
Admin
policies
Manual
orchestraNon
Internet
Intranet
Hardware middleboxes
at “choke point”
Defense not agile Performance interference
2Mo1va1ng example: current defense has key limita1ons
Lack Isola*on Lack Context Lack Agility
Admin
stage1: stage3:
zero-day data exfiltra9on
Not agile
False +?
stage2:
Internet
Intranet
inside a,ack
Interference
No visibility
3Ideal solu1on
Isola*on Context Agility
normal
Expressive Policy Abstrac*on
Reduce False +
suspicious
Admin
Controller
suspicious IP
Agile Orchestra*on
Agility
No Interfe rence Internet
Isolated, Customized
Middleboxes
Full Visibility
4Challenges to realize ideal solu1on
Challenge 2: policy abstracNon
normal
Expressive Policy Abstrac*on
not expressive
suspicious
Admin
Controller
CAhgailell eOnrcghee s3t:r as*caolna ble &
responsive orchestraNon
Internet
CIshoalallteend,g Ceu 1st:o emnifzoedrc ement
cMoindsdtlreabionxeeds by network topology
5How PSI addresses the challenges
Challenge 1: enforcement constrained by
network topology
Challenge 2: Realize expressive policy
abstracNon
Challenge 3: Realize scalable &
responsive orchestraNon
6PSI enforcement
ψmboxes: virtualized middleboxes
SDN-enabled transverse
Enforcement separated
tunneling
from topology
cluster
Internet
Isolated, Customized
Middleboxes
Original Enterprise
Network Topology
7How PSI addresses the challenges
Challenge 1: enforcement constrained by Leverage NFV & SDN to decouple
network topology enforcement from network topology
Challenge 2: realize expressive policy
abstracNon
Challenge 3: Realize scalable &
responsive orchestraNon
8PSI policy abstrac1on
ψFSM ψDAG
header
Egress
Normal Ingress
normal
Context-based
Agile intent
Suspicious IP
intent
evoluNon
header payload
normal
Ingress Egress
Suspicious
suspicious
Drop
data exfiltraNon
Suspicious IP
9How PSI addresses the challenges
Challenge 1: enforcement constrained by Leverage NFV & SDN to decouple
network topology enforcement from network topology
Challenge 2: realize expressive policy Provide context-based & agile policy
abstracNon abstracNon
Challenge 3: realize scalable &
responsiveness orchestraNon
10PSI orchestra1on
header
Egress
Ingress
normal
Scalability: controller has to process
Controller
the control messages for every packet.
Pkt1 normal Pkt1 Egress
Pkt2 normal
Pkt2 Egress
Pkt3 normal Pkt3 Egress
normal tag1 tag1→Egress Proac1ve tag-based forwarding:
- Middleboxes tags the packets
- Switches forwards the packets
based on tags
Ingress Egress
11How PSI addresses the challenges
Challenge 1: enforcement constrained by Leverage NFV & SDN to decouple
network topology enforcement from network topology
Challenge 2: realize expressive policy Provide context-based & agile policy
abstracNon abstracNon
Challenge 3: realize scalable & Extend SDN controller to build scalable and
responsiveness orchestraNon responsive orchestraNon
12PSI implementa1on
Operator
interface
Policy Engine
Security Benefit:
PSI Controller
Prevent more ahacks by
Orchestra1on
removing topology constraints.
Event Channel Control Channel
Scalability of PSI controller:
ψmboxes:
- Maximum throughput
Snort, Bro
- Response Nme
Internet
13Security benefit: prevent more aHacks by removing
topology constraints
Ahack Trace1:
Topology Distributed Firewall/IPS PSI
Advanced Persistent Threats
Apt-mcafee 59% 91%
(Angler EK/Magnitude EK)
Pix-cisco 56% 89%
Ahack Trace2:
Mini-stanford 52% 92%
Insider ahack (FTP/DNS-
All 56% 91%
based data-exfiltraNon)
The fracNon of ahacks prevented
Topological constraints causes “blind spots” in Distributed
Firewall/IPS defense:
• unmanageable switches
• devices connected to mulNple switches
• NAT/DHCP that hides device idenNty
14Scalability of PSI controller
2 3 4 5 6 7 8 9 10
15
tuphguorhT
.xaM
)s/stneve(
5
(cid:1)10
2
1 FSM Size
DAG Size
0
2 3 4 5 6 7 8 9 10
egasU
yromeM
)BG(
10
5
FSM Size
DAG Size
0
2 3 4 5 6 7 8 9 10
Policy Complexity (FSM/DAG Size)
emiT
dnopseR
)sm(
2 3 4 5 6 7 8 9 10
5
FSM Size
DAG Size
0
tuphguorhT
.xaM
)s/stneve(
5
(cid:1)10
2
1 FSM Size
DAG Size
0
2 3 4 5 6 7 8 9 10
egasU
yromeM
)BG(
10
5
FSM Size
DAG Size
0
2 3 4 5 6 7 8 9 10
Policy Complexity (FSM/DAG Size)
emiT
dnopseR
)sm(
5
FSM Size
DAG Size
0
tuphguorhT
.xaM
emiT
esnopseR
)s/stneve(
)sm(
ψFSM ψDAG
Policy Engine
PSI
Controller
Orchestra1on
Event Control
- Max. Throughput: 20K events/s,
support 100K device if every device
generates an event every 5s.
- Response Time: < 10 ms
Policy Complexity (FSM/DAG Size)Conclusion
• TradiNonal enterprise security soluNons have key limitaNons:
• Context, agility, and isolaNon
• PSI: Leverage SDN/NFV to have a cleaner architecture
• PSI contribuNons:
• Isolated and customized middleboxes
• Expressive policy abstrac9on
• Scalable & responsive orchestra9on
• Security benefits
• PSI prevents 35% more ahacks (APT, insider ahacks) than distributed Firewall/IPS.
• PSI reduces performance interference by 85% (See paper)
• Enabler for new capabiliNes (See paper)
• Scalability
• A single PSI controller can support a network with 100k devices
23Backups
17Security benefit: increase coverage over aHacks
Distributed PSI
Firewall/IPS ψcluster
APT
PSI decouples enforcement from
fundamental topology constrains:
Insider (data exfiltraNon) • unmanageable switches
• devices connected to mulNple switches
An enterprise network from MacAfee’s report
• NAT/DHCP
18ψDAG prefetching
Prefetch
next 2 states
Prefetch
next state
S S S
1 2 3
Launch Launch Launch
DAG DAG DAG
1 2 3
DAG
1
DAG
2
DAG
3
19Challenges for expressive policy abstrac1on
Desired policy Current ACL policy
Light IPS: header check
IP with no context
H1
unknown IP
ACL rule for Cisco PIX firewall
H1
Sta9c intent
Light IPS Heavy IPS: payload check
Check the packet header of H1’s outbound
Cannot express:
traffic. And if H1 is accessing an unknown
• Context-based forwarding & processing
IP. Then enforce a payload check.
• Agile intent evoluNon
20Security benefit: reducing collateral damage
DPI+AnNVirus
DPI DPI+AnNVirus
+App Control
1 elephant flow
7 mice flows
Next GeneraNon
Firewall (NGFW)
Collateral damage measured by
PSI reduces performance interference by 85%
average packet drop rate for each flow
21Benefits of PSI op1miza1ons
• ProacNve context-based forwarding reduces
latency by 10X.
• DAG prefetching mechanism reduces security
downNme to zero.
• Scale-out scheme cuts the response Nme down
to 10ms.
• With the opNmizaNons, a single PSI controller
can support a network with 100K devices.
22