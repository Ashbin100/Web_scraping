A Broad View of the Ecosystem of
Socially Engineered Exploit Documents
Stevens Le Blond, Cédric Gilbert, Utkarsh Upadhyay,
Manuel Gomez Rodriguez and David ChoffnesChallenges with measuring targeted attacks
• Low-volume, socially engineered messages that convince
specific victims to install malware
2Challenges with measuring targeted attacks
• Low-volume, socially engineered messages that convince
specific victims to install malware
• Three studies published at Usenix Security’14
• Tibet (Hardy et al.), Middle East (Marczak et al.), and Uyghur (Le Blond et al.)
2Challenges with measuring targeted attacks
• Low-volume, socially engineered messages that convince
specific victims to install malware
• Three studies published at Usenix Security’14
• Tibet (Hardy et al.), Middle East (Marczak et al.), and Uyghur (Le Blond et al.)
2Challenges with measuring targeted attacks
• Low-volume, socially engineered messages that convince
specific victims to install malware
• Three studies published at Usenix Security’14
• Tibet (Hardy et al.), Middle East (Marczak et al.), and Uyghur (Le Blond et al.)
?
2Challenges with measuring targeted attacks
• Low-volume, socially engineered messages that convince
specific victims to install malware
• Three studies published at Usenix Security’14
• Tibet (Hardy et al.), Middle East (Marczak et al.), and Uyghur (Le Blond et al.)
?
Measuring targeted attacks
is a long and difficult process
2Can Anti-Virus Aggregators (VirusTotal) help?
3Can Anti-Virus Aggregators (VirusTotal) help?
3Can Anti-Virus Aggregators (VirusTotal) help?
3Can Anti-Virus Aggregators (VirusTotal) help?
3VirusTotal Statistics (one week)
4VirusTotal Statistics (one week)
4VirusTotal Statistics (one week)
4VirusTotal Statistics (one week)
4VirusTotal Statistics (one week)
4VirusTotal Statistics (one week)
4VirusTotal as a vantage point
to measure targeted attacks
5VirusTotal as a vantage point
to measure targeted attacks
5VirusTotal as a vantage point
to measure targeted attacks
5VirusTotal as a vantage point
to measure targeted attacks
5Research questions
• Do targeted groups upload exploit documents to VirusTotal?
• Can we scale our analysis to hundreds of thousands of samples?
• How do attacks faced by different groups compare with each other?
• Is VirusTotal used by other actors such as attackers and
researchers?
6Outline
1) Methodology
2) Analysis of exploit documents
3) Future work
7Exploit document infection process
Exploit Decoy Malware
8Exploit document infection process
Exploit Decoy Malware
8Exploit document infection process
Exploit Decoy Malware
8Exploit document infection process
Exploit Decoy Malware
8Data acquisition and processing workflow
9Data acquisition and processing workflow
9Can we scale our analysis to hundreds of
thousands of samples? Acquisition
257,635
10Can we scale our analysis to hundreds of
thousands of samples? Acquisition
257,635
10Can we scale our analysis to hundreds of
thousands of samples? Acquisition
257,635 143
10Data acquisition and processing workflow
11Can we scale our analysis to hundreds of
thousands of samples? Detection
257,635 143
12Can we scale our analysis to hundreds of
thousands of samples? Detection
Office w/ EMET Acrobat w/ EMET
SP0 SP1 SP2 SP3 0.0 1.0 2.0 3.0 4.0 5.0
2003 VIII
2007 IX
2010 X
XI
257,635 143
12Can we scale our analysis to hundreds of
thousands of samples? Detection
Office w/ EMET Acrobat w/ EMET
SP0 SP1 SP2 SP3 0.0 1.0 2.0 3.0 4.0 5.0
2003 VIII
2007 IX
2010 X
XI
257,635 143
12Can we scale our analysis to hundreds of
thousands of samples? Detection
Office w/ EMET Acrobat w/ EMET
SP0 SP1 SP2 SP3 0.0 1.0 2.0 3.0 4.0 5.0
2003 VIII
2007 IX
2010 X
XI
257,635 143 - 219,794 -29
37,841 114
12How many versions of
readers do we have to test?
# affected versions
FDC
13How many versions of
readers do we have to test?
# affected versions
Few exploits are portable
across all reader versions
FDC
13Data acquisition and processing workflow
14Can we scale our analysis to hundreds of
thousands of samples? Extraction
Office w/ EMET Acrobat w/ EMET
SP0 SP1 SP2 SP3 0.0 1.0 2.0 3.0 4.0 5.0
2003 VIII
2007 IX
2010 X
XI
257,635 143 - 219,794 -29
37,841 114
15Can we scale our analysis to hundreds of
thousands of samples? Extraction
Office w/ EMET Acrobat w/ EMET Office w/ driver Acrobat w/ driver
SP0 SP1 SP2 SP3 0.0 1.0 2.0 3.0 4.0 5.0
SP0 SP1 SP2 SP3 0.0 1.0 2.0 3.0 4.0 5.0
2003 VIII 2003 VIII
2007 IX 2007 IX
2010 X 2010 X
XI XI
257,635 143 - 219,794 -29
37,841 114
15Can we scale our analysis to hundreds of
thousands of samples? Extraction
Office w/ EMET Acrobat w/ EMET Office w/ driver Acrobat w/ driver
SP0 SP1 SP2 SP3 0.0 1.0 2.0 3.0 4.0 5.0
SP0 SP1 SP2 SP3 0.0 1.0 2.0 3.0 4.0 5.0
2003 VIII 2003 VIII
2007 IX 2007 IX
2010 X 2010 X
XI XI
257,635 143 - 219,794 -29
37,841 114
15Can we scale our analysis to hundreds of
thousands of samples? Extraction
Office w/ EMET Acrobat w/ EMET Office w/ driver Acrobat w/ driver
SP0 SP1 SP2 SP3 0.0 1.0 2.0 3.0 4.0 5.0
SP0 SP1 SP2 SP3 0.0 1.0 2.0 3.0 4.0 5.0
2003 VIII 2003 VIII
2007 IX 2007 IX
2010 X 2010 X
XI XI
257,635 143 - 219,794 -29 -34,026 -11
37,841 114 3,815 103
15Data acquisition and processing workflow
16Can we scale our analysis to hundreds of
thousands of samples? Analysis
Office w/ EMET Acrobat w/ EMET Office w/ driver Acrobat w/ driver
SP0 SP1 SP2 SP3 0.0 1.0 2.0 3.0 4.0 5.0 SP0 SP1 SP2 SP3 0.0 1.0 2.0 3.0 4.0 5.0
2003 VIII 2003 VIII
2007 IX 2007 IX
2010 X 2010 X
XI XI
257,635 143 - 219,794 -29 -34,026 -11
37,841 114
3,815 103
17Can we scale our analysis to hundreds of
thousands of samples? Analysis
Office w/ EMET Acrobat w/ EMET Office w/ driver Acrobat w/ driver
SP0 SP1 SP2 SP3 0.0 1.0 2.0 3.0 4.0 5.0 SP0 SP1 SP2 SP3 0.0 1.0 2.0 3.0 4.0 5.0
2003 VIII 2003 VIII
2007 IX 2007 IX
2010 X 2010 X
XI XI
257,635 - 219,794 -34,026
37,841
3,815
17Can we scale our analysis to hundreds of
thousands of samples? Analysis
Malware
Office w/ EMET Acrobat w/ EMET Office w/ driver Acrobat w/ driver Translators sandboxes
SP0 SP1 SP2 SP3 0.0 1.0 2.0 3.0 4.0 5.0 SP0 SP1 SP2 SP3 0.0 1.0 2.0 3.0 4.0 5.0
2003 VIII 2003 VIII
2007 IX 2007 IX
2010 X 2010 X
XI XI
- 219,794
-34,026
37,841
3,815
17Can we scale our analysis to hundreds of
thousands of samples? Analysis
Malware
Office w/ EMET Acrobat w/ EMET Office w/ driver Acrobat w/ driver Translators sandboxes
SP0 SP1 SP2 SP3 0.0 1.0 2.0 3.0 4.0 5.0 SP0 SP1 SP2 SP3 0.0 1.0 2.0 3.0 4.0 5.0
2003 VIII 2003 VIII
2007 IX 2007 IX
2010 X 2010 X
XI XI
- 219,794
-34,026
37,841
3,815
17Can we scale our analysis to hundreds of
thousands of samples? Analysis
Malware
Office w/ EMET Acrobat w/ EMET Office w/ driver Acrobat w/ driver Translators sandboxes
SP0 SP1 SP2 SP3 0.0 1.0 2.0 3.0 4.0 5.0 SP0 SP1 SP2 SP3 0.0 1.0 2.0 3.0 4.0 5.0
2003 VIII 2003 VIII
2007 IX 2007 IX
2010 X 2010 X
XI XI
- 219,794
-34,026
2,447 3,705
37,841
3,815
17Outline
1) Methodology
2) Analysis of exploit documents
3) Future work
18Do targeted groups upload exploit documents on
VirusTotal? Likely targets (inferred from decoys)
19Do targeted groups upload exploit documents on
VirusTotal? Likely targets (inferred from decoys)
19Do targeted groups upload exploit documents on
VirusTotal? Likely targets (inferred from decoys)
19Do targeted groups upload exploit documents on
VirusTotal? Likely targets (inferred from decoys)
VirusTotal gives visibility into
attacks targeting numerous groups
19How attacks faced by different groups compare with
each other? Languages of decoys
noitcarF
20How attacks faced by different groups compare with
each other? Languages of decoys
noitcarF
20How attacks faced by different groups compare with
each other? Languages of decoys
noitcarF
20How attacks faced by different groups compare with
each other? Languages of decoys
noitcarF
20How attacks faced by different groups compare with
each other? Languages of decoys
Decoys tend to use the official
language of the groups they target
noitcarF
20How attacks faced by different groups
compare with each other? Malware targeting
21How attacks faced by different groups
compare with each other? Malware targeting
21How attacks faced by different groups
compare with each other? Malware targeting
21How attacks faced by different groups
compare with each other? Malware targeting
21How attacks faced by different groups
compare with each other? Malware targeting
From our dataset, malware families
tend to target one or two countries
21Targeted regions
• Chinese influence: Tibet, Uyghur, Taiwan
• Asia Pacific: Myanmar, the Philippines, Thailand, and Vietnam
• Asia Pacific, G20: India, Indonesia, Japan, and South Korea
• Russia and USAHow do attacks faced by different groups compare
with each other? Malware targeting (cont.)
noitcarF
23How do attacks faced by different groups compare
with each other? Malware targeting (cont.)
noitcarF
23How do attacks faced by different groups compare
with each other? Malware targeting (cont.)
noitcarF
23How do attacks faced by different groups compare
with each other? Malware targeting (cont.)
noitcarF
23How do attacks faced by different groups compare
with each other? Malware targeting (cont.)
Malware found in multiple countries
tend to target a confined region
noitcarF
23Outline
1) Methodology
2) Analysis of exploit documents
3) Future work
24Future work
• Monitoring operator behavior of targeted malware
• Analysis of evasions techniques, attackers operations,
and other attack vectors
• Deploy on-premises and cloud-based services for
analysis of email attachments
25Take home messages
• Complementary methodology to measure targeted attacks at scale
• At-risk groups upload exploit documents to VirusTotal
• Groups tend to be targeted with tailored decoys and malware families
• Preliminary impact
• Service deployed at email provider with 100,000+ users
• Dataset and academic service available at https://slingshot.dedis.ch
26Frequently Asked Questions
• What are the observational biases of using VirusTotal?
• What are the common types of malicious documents that you filtered out?
• Why did you focus on exploit documents?
• What precautions did you take to reduce false negatives?
• Did you find indications of successful compromises?
stevens.leblond@epfl.ch
27What are the observational biases of using
VirusTotal?
• Coverage of targeted attacks is limited to those users and
organizations who upload suspicious files
• VirusTotal’s visibility is likely skewed towards users who work
with non-classified material
• VirusTotal dataset offers a partial coverage of attacks where
individuals and NGOs are likely over-representedWhat are the most common malicious documents
that you filtered out?Why did you focus on exploit documents?
• Exploit documents are the most common vector of targeted
attacks identified by related work
• Macros require additional user approval and can be forcibly
disabled by system administrators
• Used against a range of targets including NGOs, news agencies,
and military, governmental and intelligence agenciesWhat precautions did you take to reduce false
negatives?
• Reducing detection FNs
• Cross validated EMET detection results with ground truth from the WUC dataset
• 29/143 WUC documents were not detected by EMET, none of them FNs (16 Mac OS X, 9
wrong reader version, 2 password, and 2 without exploit)
• Reducing extraction FNs
• Manually inspected EMET detections that didn’t write files to disk
• 29/4,259 documents detected by EMET did not write any files to disk, none of them FNs (6
crashes, 4 experimental, and 19 dysfunctional)
• None of our analyses depends on the lack of evasion techniques in the malware
embedded in exploit documentsDid you find indication of successful compromises?
• Coded decoys based on their languages, the countries they refer to,
ethnic groups and dates, and whether they targeted specific
individuals or organizations
• Native speakers independently coded the documents written in
Russian, Traditional Chinese, Uyghur, and Vietnamese
• Identified documents likely exfiltrated from compromised systems and
used as decoys in exploit documents targeting new, related victimsDid you find indication of successful
compromises (cont.)?
noitcarFDid you find indication of successful
compromises (cont.)?
Most groups were targeted
with replayed decoys
noitcarFDid you find evidence of zero-day vulnerabilities?
• We collaborated with a large AV vendor to determine the CVE tags of the exploited
reader vulnerabilities
• The vendor scanned all the exploit documents that we detected and compared the
resulting CVE with the majority of VirusTotal tags
• If the two CVEs matched, no further action was taken
• Otherwise, the sample was analyzed manually
• Samples for which the CVE release date was after the date of upload on VirusTotal
were examined manually to determine the CVE’s correctness
• Based on this methodology, we didn’t find evidence of zero-day vulnerabilitiesCan you estimate the dates of the decoys?
• We coded decoys according to their languages, the countries they refer to,
ethnic groups and dates, and whether they targeted specific individuals or
organizations
• Native speakers independently coded the documents written in Russian,
Traditional Chinese, Uyghur, and VietnameseCan you estimate the dates of the decoys (cont.)?
noitcarFCan you estimate the dates of the decoys (cont.)?
All groups exhibited decoys referring
to a least one year in 2013-2015
noitcarF