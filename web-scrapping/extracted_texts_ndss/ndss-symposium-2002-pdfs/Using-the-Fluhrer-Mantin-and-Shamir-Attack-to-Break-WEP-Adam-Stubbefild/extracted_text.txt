Using the Fluhrer, Mantin, and Shamir Attack
to Break WEP
∗
AdamStubblefield JohnIoannidis AvielD.Rubin
ComputerScienceDept.
RiceUniversity AT&TLabs–Research,FlorhamPark,NJ
astubble@cs.rice.edu {ji,rubin}@research.att.com
Abstract andthenincrementthembyoneforeveryuse. Thisre-
sults in high likelihood that keystreams will be reused,
leading to simple cryptanalytic attacks against the ci-
WeimplementedanattackagainstWEP,thelink-layer pher,anddecryptionofmessagetraffic.Theauthorsver-
security protocol for 802.11 networks. The attack was ifiedthisexperimentallyanddescribeotherweaknesses
described in a recent paper by Fluhrer, Mantin, and aswell.Forexample,thespacefromwhichIVsarecho-
Shamir. Withourimplementation,andpermissionofthe senistoosmall,virtuallyguaranteeingreuse,andlead-
networkadministrator,wewereabletorecoverthe128 ingtothesamecryptanalyticattacksjustdescribed. The
bitsecretkeyusedinaproductionnetwork,withapas- paperalsoshowsthatmessageauthenticationinWEPis
siveattack.TheWEPstandardusesRC4IVsimproperly, broken.
and the attack exploits this design failure. This paper Fluhrer, Mantin, and Shamir describe a passive
describestheattack, howweimplementedit, and some ciphertext-onlyattackagainstRC4asusedinWEP[4].
optimizationstomaketheattackmoreefficient. Wecon- Theattackexploitsthemethodinwhichthestandardde-
clude that802.11 WEP is totallyinsecure, and we pro- scribesusingIVsfortheRC4streamcipher. Intheirpa-
videsomerecommendations. per, the authors state, Note that we have not attempted
to attack an actual WEP connection, and hence do not
claim that WEP is actually vulnerable to this attack.
1 Introduction Basedonthedescriptionintheirpaper,wesuccessfully
implemented the attack, proving that WEP is in fact
Wireless networking has taken off, due in large part
completely vulnerable. The purpose of this paper is to
to the availability of the 802.11 standard. While an-
describeourimplementation,alongwithsomeenhance-
otherstandard, Bluetooth, isalsogaininginpopularity,
mentstoimprovetheperformanceoftheattack.
the longer range and higher speeds achieved by 802.11
makeittheprotocolofchoiceforwirelessLANs.Office
2 OverviewoftheWEPattack
buildings, conferences, and even many residences now
offer 802.11 connectivity. The PC cards that are most
In this section we present an overview of the WEP
oftenusedinthesenetworksprovideasecurityprotocol
protocol and review briefly how the attack of Fluhrer,
calledWiredEquivalentPrivacy(WEP).
Mantin, and Shamir can be applied to WEP. For a de-
WEP is easy to administer. The device using the
taileddescriptionofWEPwereferthereadertotheof-
802.11 card is configured with a key, that in practice
ficial802.11standard[7].
usually consists of a password or a key derived from
Encryption in WEP uses a secret key, k, shared be-
a password. The same key is deployed on all devices,
tween an access point and a mobile node. To compute
including the access points. The idea is to protect the
a WEP frame, the plaintext frame data, M, is first con-
wirelesscommunicationfromdevicesthatdonotknow
catenatedwithits(non-cryptographic)checksumc(M),
thekey. to produce M·c(M) (where · denotes concatenation).
Borisov,GoldbergandWagnerdemonstratedsomese-
Then,aperpacketinitializationvector(IV)isprepended
curityflawsinWEP[1]. TheyexplainedthatWEPfails tothesecretkey,k,tocreatethepacketkey,IV·k. The
to specify how IVs for RC4 are specified. Several PC
RC4 stream cipher is then initialized using this packet
cards reset IVs to zero every time they are initialized,
key,andtheoutputbytesofthecipherareexclusive-ored
∗ResearchdonewhileasummerinternatAT&TLabs (denoted⊕)withthechecksummedplaintexttogeneratetheciphertext: 3 Implementation
C=(M·c(M))⊕RC4(IV·k) Inimplementingthisattack,wehadthreegoals. First
andforemost,wewantedtoverifythattheattackcould
work in the real world. Second, we were interested in
The actual WEP data is the per-packet IV prepended
how cheaply and easily the attack could be launched.
tothisciphertext,C.
Lastly, we wanted to see what improvements could be
madetoboththegeneralRC4attackandtheWEPattack
2.1 TheKnownIVAttackofFluhrer,Mantin,
in particular. In this section we report on our success
andShamir
at the first two goals, while reserving discussion about
For completeness, we include a short description of attackoptimizationstoSection4.
theattackofFluhrer, Mantin, andShamir[4]here. We
refer the reader to the original paper for the motivation 3.1 SimulatingtheAttack
anddetails.
BeforetryingtobreakWEP,wecreatedasimulation
Tobegin,wedescribethestructureoftheRC4stream
oftheRC4attacktobothverifyourunderstandingofthe
cipher (a full description can be found in [9]). RC4
weaknessandtogatherinformationabouthowmanyre-
consists of two parts, a key scheduling algorithm and
solvedpacketswecouldexpectwouldberequiredwhen
an output generator. In WEP, the key scheduling algo-
mountingtheactualattack. Thecodingofthesimulated
rithm uses either a 64-bit packet key (40-bit secret key
attacktook undertwohours, includingafew optimiza-
plus24-bitIV)ora128-bitkey(104-bitsecretkeyplus
tions. Thesimulationshowedthattheattackwasalways
24-bit IV) to set up the RC4 state array, S, which is a
permutationof{0,...,255}. Theoutputgeneratoruses able to recover the full key when given 256 probable
resolved cases.2 We also observed that although 60 re-
thestatearrayStocreateapseudorandomsequence.
solved cases (the number recommended in the Fluhrer
The attack utilizes only the first byte of output from
et. al. paper) were usually enough to determine a key
the pseudorandom sequence, so we focus our attention
byte,therewereinstancesinwhichmorewererequired.
there. Theequationforthisfirstbyteofoutputisgiven
Because at this point we had not thoroughly investi-
byS[S[1]+S[S[1]]. Thus,afterthekeysetupstage,this
gatedhowaccuratelywewouldbeabletodeterminethe
first byte depends on only three values of the state ar-
first output byte of the RC4 pseudorandom sequence,
ray (S[1], S[S[1]], S[S[1]+S[S[1]]). The attack is based
we also simulated the effect that sometimes guessing
onourabilitytoderiveinformationaboutthekeybyob-
wrong would have on the attack. We were pleased to
serving this value. We defer the discussion of how to
seethataslongasthenumberofincorrectguesseswas
recover the value of this first byte from a WEP cipher-
keptsmall,thecorrectkeybytewouldstillbereturned,
textstreamuntilSection3.
thoughsometimesmoreresolvedcaseswereneeded.
Tomounttheattack,wesearchforIVsthatplacethe
keysetupalgorithmintoastatewhichleaksinformation
3.2 CapturingthePackets
about the key. Using the terminology of Fluhrer et al.,
we refer to these key-leaking cases as resolved. It is
Surprisingly,capturingWEPencryptedpacketsoffof
simple to test whether a particular packet provides an
our wireless network proved to be the most time con-
IV and output byte that result in a resolved condition,
suming part of the attack. There are a number of com-
thoughwereferthereadertotheFluhreret.al.paperfor
mercial software programs that are able to both cap-
the conditions under which they occur1. Each resolved
ture and decode 802.11 packets, such as NAI’s “Snif-
packet leaks information about only one key byte, and
fer”andWildpacket’s“AiroPeek,”thoughbothproducts
wemustcorrectlyguesseachkeybytebeforeanypacket
cost thousands of dollars. Because we wanted to show
givesusinformationaboutalaterkeybyte.
thattheattackcouldbedonebyanadversarywithlim-
Wesaywemust“guess”eachkeybyteastheattackis
ited resources, we purchased a $100 Linksys wireless
statisticalinnature;eachresolvedpacketgivesusa5%
card, based on the Intersil Prism II chipset. We made
chanceofguessingacorrectkeybyteanda95%chance
thischoicebecausethePrismIIallowsmuchofitscom-
ofguessingincorrectly. However, bylookingatalarge
putationtobecompletedinsoftwareandbecausethere
number of these resolved cases, we can expect to see a
was a Linux driver available that could grab raw WEP
biastowardthetruekeybytes.
encrypted packets. Though we did not know it at the
1Itisimportanttousethecriteriagiveninsection7ratherthanthe time,thischipsethasbeenusedbyotherstomountdic-
criteriagiveninappendixA.TheIVslistedinappendixAareonlya
subsetoftheIVswhichcanresolve. Wereturntothisinsection4of 2CasescorrespondingtoIVsoftheform(B+3,255,N)asinthe
thispaper. Fluhreret.al.paper.tionaryandbruteforceattacksagainstWEP.3 sulation header is added for both ARP and IP traffic.8
We used both the linux-wlan-ng prism2 This discovery actually made the attack even easier, as
driver4andamodifiedversionofTimNewsham’spatch all IP and ARP packets would now have the same first
to re-enable raw packet monitoring,5 to get the card plaintext byte (0xAA, the SNAP designation).9 If the
workinginLinux. Wewerethenabletouseamodified network in question also carries legacy IPX traffic, the
versionofthepacketsnifferethereal6tocaptureraw first plaintext byte will not be 0xAA for these packets.
WEP encrypted packets and to decode the data neces- However,asweshowedinoursimulation,aslongasthe
saryforourattacktool. IPandARPpacketsgreatlyoutnumbertheIPXpackets,
Thereisoneproblemwithusingthiscardasopposed theattackisstillpossible. Ifthenetworkcarriesmostly
to a more sophisticated solution. The prism2 chipset IPX traffic, the attack should be modified to use either
doesrequestatransmissiontime-slotevenwheninmon- 0xFFor0xE0insteadof0xAA.
itormode. Manyinexpensivebasestationsdonotreport Although our actual attack used the improvements
this,thoughasoftwarehackcanallowLinuxcomputers discussed in the next section, we present an outline of
runningasaccesspointstoregisteranSNMPtrapeach how a naive attack could work here. It is interesting to
timethatanodejoinsorleavesthenetwork[5]. Thisin- notethateventhisbaselineversionoftheattackwould
formationdoesnotdirectlyindicatelikelyattackers,but still be successful in a short period of time (a day or
couldbecombinedwithotherinformationinanIDSto two at most) and with an even smaller amount of com-
locateuserswhoregisterwithabasestaionbutnotwith putation when compared to the improved implementa-
whatever network level access controls exist. Also, we tion,assumingthatthewirelessnetworkinquestionhad
knowofnopracticalreasonwhythis“registration”with areasonableamountoftraffic.
thenetworkisnecessary;theremayevenexistconsumer Tobegin,wecollectedalargenumberofpacketsfrom
802.11 chipsets which support listening without regis- ourwirelessnetwork. Tospeedtheprocessupforsome
tering (perhaps even the prism2 chipset in some other of our experiments late at night when network volume
undocumentedmode). was low, we artificially increased the load on the wire-
Evenwiththehardwareandsoftwareproblems,from less network by ping flooding a wireless node. (We
thetimethatwefirstdecidedtolookatthisproblem,it could have waited until more traffic was created; this
tooklessthanaweekforthethecardtobeorderedand is not an active attack.) Because we are able to predict
shipped, the test-bed to be set up, the problems to be the value of the first byte of any plaintext, the fact that
debugged,andafullkeytoberecovered. we changed the makeup of the network traffic did not
affecttheseexperiments. InlookingattheIVsofthese
3.3 MountingtheAttack collectedpackets,wediscoveredthatthewirelesscards
useasimplecountertocomputetheIV,whereinthefirst
The last piece in actually mounting the attack was
byteisincrementedfirst.10
determining the true value of the first plaintext byte of Figure1showsthebasicattackusedtorecoveraWEP
each packet, so that we could could infer the first byte key. In section A.1 of Fluhrer et. al., the authors pos-
ofthepseudorandomsequencefromthefirstciphertext tulate that 4,000,000 packets would be sufficient with
byte. We originally looked at tcpdump output of de- thisbaselineattack;wefoundthenumbertobebetween
cryptedtraffic(usingacorrectlykeyedcard7),andwere 5,000,000and6,000,000forourkey.Thisnumberisstill
planningonusingpacketlengthtodifferentiatebetween not unreasonable, as we were able to collect that many
ARPandIPtraffic(bothofwhichhavewellknownfirst packetsinafewhoursonapartiallyloadednetwork.
bytesintheirheaders)asthesewerebyfarthetwomost
common types of traffic on our network. After imple- 4 Improvingtheattack
menting this, however, we discovered that the attack
In this section we discuss several modifications that
didn’t seem to work. We then tried hand decrypting
canbemadetoimprovetheperformanceofthekeyre-
packets to determine whether tcpdump was working
coveryattackonWEP.Whilenotnecessaryforthecom-
correctlyanddiscoveredthatanadditional802.2encap-
promisetobeeffective,theycandecreasebothtimeand
spacerequirementsforanattacker.
3See Blackhat ‘01 presentation at http://www.lava.net/
˜newsham/wlan/WEP_password_cracker.ppt 8WeeventuallytracedthisbacktoRFC1042[8].
4Availablefromhttp://www.linux-wlan.com/ 9Somevendors,suchasCiscouseaproprietaryOID[2]. Fortu-
5Available from http://www.lava.net/˜newsham/ nately,italsobeingswith0xAA.
wlan/ 10OthercardshavebeenreportedtochooseIVsatrandom,tocount
6Availablefromhttp://www.ethereal.com/ inbigendianorder,ortoswitchbetweentwoIVs. Thislastclassare
7Notethatacorrectlykeyedcardisnotneeded; wesimplyused cardsarenotvulnerabletotheattackinthispaper,althoughtheybreak
onetodesigntheattack. badlyundertheattacksofBorisovetal.[1].RecoverWEPKey()
Key[0...KeySize]=0
forKeyByte=0...KeySize
Counts[0...255]=0
foreachpacket→P
ifP.IV∈{(KeyByte+3,0xFF,N)|N∈0x00...0xFF}
Counts[SimulateResolved(P,Key)]+=1
Key[KeyByte]=IndexOfMaximumElement(Counts)
returnKey
Figure1.ThebasicattackonWEP.Dependingontheactualkeyused,thisattackcantakebetween4,000,000and6,000,000
packetstorecovera128-bitkey. TheSimulateResolvedfunctioncomputesthevaluedescribedinsection7.1ofFluhreret
al.
4.1 ChoosingIVs was likely to be part of a user memorable passphrase
bycheckingwhetherthebytevaluecorrespondedtoan
In the baseline attack (the one described in Ap-
ASCIIletter,number,orpunctuationsymbol.
pendix A of Fluhrer et. al.), only IVs of a particular
This pair of optimizations turned out to provide an
formareconsidered(thosecorrespondingto(KeyByte+
astoundingdecreaseinthenumberofpacketsrequired.
3,0xFF,N) where KeyByte is the current KeyByte we
Inparallelwithreceivingpackets(onanothermachine,
areguessingandN isunrestricted). However,wefound
though this is not really necessary), we were continu-
thatthereareotherIVsthatcanresultinaresolvedstate,
ally attempting to guess the key by choosing the most
and that testing all IVs instead of only the subset sug-
likelycandidatesbasedontheresolvedcaseswehadal-
gestedbytheFluhreret. al. papercanbedoneinparal-
readygathered. Intheeventof”ties”forthenextmost
lelwithreceivingpackets. Thisconclusionwasverified
likelybyte,wegavepriorityfirstto(inorder):lowercase
by Adi Shamir [10], who also noted that these packets
letters, uppercase letters, numbers, symbols, other byte
appearmoreoftenforhigherkeybytes.
values.
4.2 GuessingEarlyKeyBytes
4.3 SpecialResolvedCases
As the Fluhrer, Mantin, and Shamir attack works by
buildingonpreviouslydiscoveredkeybytes,recovering As Shamir pointed out to us, there are cases when a
earlykeybytesiscritical. Therearetwoapproachesthat resolvedcasecanprovideanevenbetterindicationasto
wetriedbothseparatelyandtogether. Thefirstutilized aparticularkeybyte. Ifthereisaduplicationamongthe
the way that the IVs were generated, namely that we threevaluesatpositionsS[1],S[S[1]],andS[S[1]+S[S[1]]
wouldreceivepacketsthatresolvedforlotsofdifferent (i.e. these are only two distinct values), then the prob-
key bytes before necessarily receiving enough resolv- ability that these positions in the S permutation remain
ing packets to predict the early key bytes.11 We would unchangedjumpsfrome−3≈5%toe−2≈13%.Wecan
therefore use the resolving cases that we had received thus treat the evidence from these cases as about three
tonarrowdownthepossibilitiesfortheearlykeybytes. timesmoreconvincingasastandardresolvedcase.
Wewerethenabletotestcandidatekeysbydetermining
iftheWEPchecksumonadecryptedpacketturnedout
4.4 CombiningtheOptimizations
correctly.
Thesecondapproachexploitedthepoorkeymanage-
Figure 2 shows the key recovery algorithm after all
ment available in WEP implementations. Since WEP
of the improvements described above. The improve-
keys have to be entered manually, we assumed that in-
mentsdropthenumberofpacketsrequiredfromaround
steadofgivingclientsalongstringofhexdigits,auser
5,000,000toaround1,000,000.
memorablepassphrasewouldbeused. Afterexamining
the test wireless cards at our disposal, we determined
that the user-memorable passphrase is simply used raw 5 Discussion
asthekey(i.e. theASCIIisused; nohashingisdone).
Although hashing does not protect against a dictionary There are many variables that can affect the perfor-
attack,itwouldhavehelpedinthiscircumstance,aswe manceofthekeyrecoveryattackonWEP.Inthissection
were able to determine directly whether each key byte wesummarizetheeffectofsomeofthesevariablesand
11See Figure 6 of Fluhrer et. al.; resolved cases are much more lookathowtheWEPdesigncouldbeslightlyalteredto
likelytooccurforlaterkeybytes. preventthisparticularattack.RecoverWEPKeyImproved(CurrentKeyGuess,KeyByte)
Counts[0...255]=0
foreachpacket→P
ifResolved?(P.IV)
Counts[SimulateResolved(P,CurrentKeyGuess)]+=Weight(P,CurrentKeyGuess)
foreachSelectMaximalIndexesWithBias(Counts)→ByteGuess
CurrentKeyGuess[KeyByte]=ByteGuess
ifEqual?(KeyByte,KeyLength)
ifCheckChecksums(CurrentKeyGuess)
returnCurrentKeyGuess
else
Key=RecoverWEPKeyImproved(CurrentKeyGuess,KeyByte+1)
ifnotEqual?(Key,Failure)
returnKey
returnFailure
Figure 2. The improved attack on WEP. Depending on the actual key used, this attack can take between 1,000,000 and
2,000,000packetstorecovera128-bitkey. TheSimulateResolvedfunctioncomputesthevaluedescribedinsection7.1of
Fluhreretal.,theCheckChecksumscheckstoseeifakeycausesthechecksumsintheWEPpacketstocomeoutcorrectly,and
theResolved?predicatecheckstoseeifagivenpacketresultsinaresolvedcondition.TheSelectMaximalIndicesWith-
Biasfunctioncorrespondstotheoptimizationinsection4.2. TheWeightfunctionreturns3iftheresolvedcasecorresponds
toaspecialresolvedcaseasdescribedinsection4.3,and1otherwise.
5.1 IVSelection also the problem of distributing this key to the users.
Many sites use a human memorable password to easy
Since the WEP standard does not specify how IVs
thiskeydistribution. Thereishowevernostandardway
shouldbechosen,thereareavarietyofIVgenerationin
of mapping these passwords to a WEP key. The cur-
useincurrent802.11cards. Themajorityofcardsseem
rent solution is mapping the ASCII value directly to a
touseoneofthreemethods:counters,randomselection,
keybyte. Wewouldrecommendswitchingtoeitherus-
orvalue-flipping(i.e.switchingbetweentwoIVvalues).
ing a secure (non-memorable) WEP key or having the
Thisattackispossiblewitheitherofthefirsttwotypes
keysetupsoftwarehashthepasswordtothekeyusinga
of IV selection. Value-flipping prevents this attack at
cryptographic hash function. Note that neither of these
the expense of reusing the pseudorandom stream every
solutionspreventtheattack, onlymakeitslightlymore
otherpacket. Thisisnotareasonabletrade-off.
difficult.
Counter modes are the most accommodating of this
There do exist proprietary solutions that allow each
attack. In these cards, the IV is incremented with each
mobile node to use a distinct WEP key, most notably
packetsent(startingeitherat0oratsomerandomvalue
Cisco’s LEAP protocol. LEAP sets up a per-user, per-
whenthecardispoweredon).Withcountermodecards,
session WEP key when a user first authenticates to the
an attacker is practically guaranteed a nice distribution
network. Thiscomplicatestheattack,butdoesnotpre-
ofresolvingpacketsamongthekeybytes. Randomse-
vent it so long as a user’s ”session” lasts sufficiently
lectionofeachIVisnotmuchbetter,asthereareenough
long.Wewouldrecommendsecurelyrekeyingeachuser
expected resolved cases that although the distribution
aftereveryapproximately10,000packets.
mightnotbequiteasgoodasthecountermodes,itwon’t
bemuchworse.
5.3 RC4
In short, there does not seem to be a way of choos-
ingIVstomitigatetheeffectsofthisattackwithoutex-
RC4isanefficientstreamcipherthatcanbeusedse-
plicitlytestingeachIVandkeypairtoseeifitresolves
curely. The implementation of RC4 in SSL is not af-
before sending it. This would require extra processing
fectedbytheFluhreret. al. attack. Thereasonsarethat
power and would decrease the already small space of
SSLpre-processestheencryptionkeyandIVbyhashing
IVs.
withbothMD5andSHA-1[3]. Thusdifferentsessions
haveunrelatedkeys.Inaddition,inSSL,RC4statefrom
5.2 KeySelection
previouspacketsisusedinfuturepackets,sothattheal-
The lack of key management in WEP certainly con- gorithmdoesnotrekeyaftereachpacket.
tributestotheeaseofthekeyrecoveryattack. Mostnet- Afurtherrecommendation(RSASecurityInc.’sstan-
works use a single shared key between the basestation dardrecommendation)isforapplicationstodiscardthe
andallmobilenodes. Besidesthesuiteof”disgruntled first256bytesofRC4output. Thismaybeabitexpen-
ex-employeewhoknowsthekey”styleattacks,thereis siveforverysmallpackets,butifsessionstateismain-tainedacrosspackets,thatcostisamortized. Acknowledgments
Insummary,RC4canbeusedaspartofasecurityso-
We thank Bill Aiello, Steve Bellovin, Scott Fluhrer,
lution. However, care must be taken when implement-
BobMiller,RonRivest,AdiShamir,DaveWagner,and
ingitsothatkeymaterialisnotleaked. Oneoftherisks
DanWallachforhelpfulcommentsanddiscussions.
ofalgorithmsthathavesuchcaveatsisthatprotocolde-
WeinformedStuartKerry,the802.11WorkingGroup
signerswithoutastronggroundingincryptographyand
Chair,thatwesuccessfullyimplementedtheFluhrer,et
securitymaynotbeawareofthecorrectwaytoimple-
al. attack. Stuartrepliedthatthe802.11WorkingGroup
mentthem,andthisisexactlywhathappenedinthecase
is in the process of revising the security, among other
ofWEP.
aspects,ofthestandardandappreciatesthislineofwork
asvaluableinputfordevelopingrobusttechnicalspeci-
6 Conclusionsandrecommendations
fications.
We implemented the attack described by Fluhrer et.
al. in several hours. It then took a few days to figure References
out which tools to use and what equipment to buy to
[1] N. Borisov, I. Goldberg, and D. Wagner. Intercepting
successfullyreadkeysoffof802.11wirelessnetworks.
mobile communications: The insecurity of 802.11. In
Ourattackusedoffoftheshelfhardwareandsoftware,
MOBICOM2001,Rome,Italy,July2001.
andtheonlypieceweprovidedwastheimplementation
[2] D.Cafarelli. Personalcommunications,2001.
of the RC4 attack, along with some optimizations. We [3] T. Dierks and C. Allen. The TLS Protocol,
believethatwehavedemonstratedtheultimatebreakof Version 1.0. Internet Engineering Task Force,
WEP, which is the recovery of the secret key by obser- Jan. 1999. RFC-2246, ftp://ftp.isi.edu/
vationoftraffic. in-notes/rfc2246.txt.
Since the inital report of our attack appeared, oth- [4] S. Fluhrer, I. Mantin, and A. Shamir. Weaknesses in
ers have duplicated our results. Although we did not thekeyschedulingalgorithmofRC4. InEighthAnnual
WorkshoponSelectedAreasinCryptography,Toronto,
release our code, there are now two publicly available
Canada,Aug.2001.
toolsforbreakingWEPkeys. Asalways,oncesecurity
[5] M.Hamrick. Personalcommunications,2001.
attacks become known, exploits are available to script
[6] S. Kent and R. Atkinson. Security architecture for the
kiddies,whodonotneedtounderstandthetechnicalde-
Internetprotocol. RequestforComments2401,Internet
tails to break systems. The two tools that we know of EngineeringTaskForce,November1998.
areAirsnortandWEPCrack. [7] L. M. S. C. of the IEEE Computer Society. Wireless
Given this attack, we believe that 802.11 networks LANmediumaccesscontrol(MAC)andphysicallayer
should be viewed as insecure. We recommend the fol- (PHY)specifications. IEEEStandard802.11,1999Edi-
lowingforpeopleusingsuchwirelessnetworks. tion,1999.
[8] J.PostelandJ.K.Reynolds. Standardforthetransmis-
• Assumethatthelinklayeroffersnosecurity. sionofIPdatagramsoverIEEE802networks. Request
for Comments 1042, Internet Engineering Task Force,
• Use higher-level security mechanisms such as Feb.1988.
IPsec [6] and SSH [11] for security, instead of re- [9] B. Schneier. Applied Cryptography - Protocols, Algo-
lyingonWEP. rithms,andSourceCodeinC. JohnWiley&Sons,Inc.,
1994.
• Treat all systems that are connected via 802.11 as [10] A.Shamir. Personalcommunications,2001.
external. Place all access points outside the fire- [11] T.Ylonen. SSH-secureloginconnectionsovertheIn-
wall. ternet. USENIX Security Conference VI, pages 37–42,
1996.
• Assume that anyone within physical range can
communicateonthenetworkasavaliduser. Keep
in mind that an adversary may utilize a sophisti-
cated antenna with much longer range than found
onatypical802.11PCcard.
TheexperiencewithWEPshowsthatitisdifficultto
getsecurityright. Flawsateverylevel,includingproto-
coldesign,implementation,anddeployment,canrender
asystemcompletelyvulnerable. Onceaflawedsystem
ispopularenoughtobecomeatarget,itisusuallyashort
timebeforethesystemisdefeatedinthefield.